import{s as ze,G as Ht,D as xt,H as Ut,I as yn,J as sn,M as an,N as cn,O as fn,a4 as Ie,a5 as De,d as T,g as $,p as _,j as x,n as Le,m as Ee,z as bt,C as gt,A as tt,e as z,c as P,q as Ne,w as nt,b as U,h as W,k as D,o as Ce,af as he,P as Gt,ae as un,v as ke,r as je,a6 as Nt,u as le,E as At,t as ae,f as ce,l as Ve,a8 as En,ag as In}from"../chunks/scheduler.DwJgbGBW.js";import{S as Pe,i as Te,c as oe,a as re,m as se,t as F,b as Z,d as ie,g as Me,e as Be,h as Dn,j as Cn}from"../chunks/index.BqK3W3D7.js";import{r as ht,a as dt,t as st,m as $t,l as Ot,e as ve,n as ft,o as Qe,v as Vt,q as yt,s as hn,p as Mt,u as Et,b as _t,h as Dt,w as qn,d as jt,Z as Sn,f as Wt,M as Vn,x as dn,P as Nn,i as An,y as Mn,z as Bn,A as Ln}from"../chunks/index.Czvmgksn.js";import{b as Rt,d as fe,f as zn,e as Pn}from"../chunks/index.B6SuMdlM.js";import{s as Ct,a as Ue,M as vt,F as ut,Q as Tn,f as Hn}from"../chunks/QKVWeightPopover.BSyGmwO7.js";import{P as On,a as Bt,H as Xt,A as pn}from"../chunks/image.BbYIOFIf.js";import{g as jn,a as Gn,t as Rn,b as mt}from"../chunks/index.Bvv8kWA4.js";import{a as Fn,i as gn,b as xn,c as Un,l as Wn}from"../chunks/linear.LCz6N8DR.js";import{b as Xn}from"../chunks/paths.DuyUE96o.js";function Zn(n){let e;const l=n[4].default,t=sn(l,n,n[6],null);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,o){t&&t.m(r,o),e=!0},p(r,o){t&&t.p&&(!e||o&64)&&an(t,l,r,r[6],e?fn(l,r[6],o,null):cn(r[6]),null)},i(r){e||(F(t,r),e=!0)},o(r){Z(t,r),e=!1},d(r){t&&t.d(r)}}}function Yn(n){let e,l;const t=[{rounded:!0},{shadow:!0},n[1],{class:n[0]}];let r={$$slots:{default:[Zn]},$$scope:{ctx:n}};for(let o=0;o<t.length;o+=1)r=Ht(r,t[o]);return e=new On({props:r}),e.$on("show",n[5]),{c(){oe(e.$$.fragment)},l(o){re(e.$$.fragment,o)},m(o,s){se(e,o,s),l=!0},p(o,[s]){const f=s&3?jn(t,[t[0],t[1],s&2&&Gn(o[1]),s&1&&{class:o[0]}]):{};s&64&&(f.$$scope={dirty:s,ctx:o}),e.$set(f)},i(o){l||(F(e.$$.fragment,o),l=!0)},o(o){Z(e.$$.fragment,o),l=!1},d(o){ie(e,o)}}}function Kn(n,e,l){const t=["type","defaultClass"];let r=xt(e,t),{$$slots:o={},$$scope:s}=e,{type:f="dark"}=e,{defaultClass:i="py-2 px-3 text-sm font-medium"}=e;const a={dark:"bg-gray-900 text-white dark:bg-gray-700",light:"border-gray-200 bg-white text-gray-900",auto:" bg-white text-gray-900 dark:bg-gray-700 dark:text-white border-gray-200 dark:border-gray-700",custom:""};let d;function h(m){yn.call(this,n,m)}return n.$$set=m=>{l(8,e=Ht(Ht({},e),Ut(m))),l(1,r=xt(e,t)),"type"in m&&l(2,f=m.type),"defaultClass"in m&&l(3,i=m.defaultClass),"$$scope"in m&&l(6,s=m.$$scope)},n.$$.update=()=>{r.color?l(2,f="custom"):l(1,r.color="none",r),["light","auto"].includes(f)&&l(1,r.border=!0,r),l(0,d=Rn("tooltip",i,a[f],e.class))},e=Ut(e),[d,r,f,i,o,h,s]}class xe extends Pe{constructor(e){super(),Te(this,e,Kn,Yn,ze,{type:2,defaultClass:3})}}function mn(n=[],e){const l=n.map(s=>s.logit/e),t=l.map(s=>Math.exp(s)),r=t.reduce((s,f)=>s+f,0);return n.map((s,f)=>({...s,adjustedLogit:l[f],adjustedProbability:t[f]/r,adjustedExp:t[f]}))}function vn(n){const e=[];let l=0;for(const r of n)l+=r.probability,e.push(l);const t=Math.random();for(let r=0;r<e.length;r++)if(t<e[r])return n[r];return n[0]}const Qn=!0,ms=Object.freeze(Object.defineProperty({__proto__:null,prerender:Qn},Symbol.toStringTag,{value:"Module"}));function Jn(n,e){let l;if(e===void 0)for(const t of n)t!=null&&(l<t||l===void 0&&t>=t)&&(l=t);else{let t=-1;for(let r of n)(r=e(r,++t,n))!=null&&(l<r||l===void 0&&r>=r)&&(l=r)}return l}function eo(n,e){e===void 0&&(e=n,n=Rt);for(var l=0,t=e.length-1,r=e[0],o=new Array(t<0?0:t);l<t;)o[l]=n(r,r=e[++l]);return function(s){var f=Math.max(0,Math.min(t-1,Math.floor(s*=t)));return o[f](s-f)}}function to(n,e){return e.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function lo(){var n=0,e=.5,l=1,t=1,r,o,s,f,i,a=gn,d,h=!1,m;function k(H){return isNaN(H=+H)?m:(H=.5+((H=+d(H))-o)*(t*H<t*o?f:i),a(h?Math.max(0,Math.min(1,H)):H))}k.domain=function(H){return arguments.length?([n,e,l]=H,r=d(n=+n),o=d(e=+e),s=d(l=+l),f=r===o?0:.5/(o-r),i=o===s?0:.5/(s-o),t=o<r?-1:1,k):[n,e,l]},k.clamp=function(H){return arguments.length?(h=!!H,k):h},k.interpolator=function(H){return arguments.length?(a=H,k):a};function V(H){return function(R){var X,q,S;return arguments.length?([X,q,S]=R,a=eo(H,[X,q,S]),k):[a(0),a(.5),a(1)]}}return k.range=V(Rt),k.rangeRound=V(Un),k.unknown=function(H){return arguments.length?(m=H,k):m},function(H){return d=H,r=H(n),o=H(e),s=H(l),f=r===o?0:.5/(o-r),i=o===s?0:.5/(s-o),t=o<r?-1:1,k}}function _n(){var n=Fn(lo()(gn));return n.copy=function(){return to(n,_n())},xn.apply(n,arguments)}const{theme:ee}=ht(dt),de=200,Zt={"gray-blue":{0:ee.colors.gray[de],100:ee.colors.blue[de]},"gray-blue-last":{0:ee.colors.gray[de],100:ee.colors.blue[de]},"purple-indigo":{0:ee.colors.purple[de],100:ee.colors.indigo[de]},"purple-indigo-last":{0:ee.colors.purple[de],100:ee.colors.indigo[de]},"indigo-blue":{0:ee.colors.indigo[de],100:ee.colors.blue[de]},"indigo-blue-last":{0:ee.colors.indigo[de],100:ee.colors.blue[de]},"blue-white":{0:ee.colors.blue[de],100:ee.colors.white},"red-white":{0:ee.colors.red[de],100:ee.colors.white},"green-white":{0:ee.colors.green[de],100:ee.colors.white},"red-purple":{0:ee.colors.red[de],100:ee.colors.purple[de]},"blue-purple":{90:ee.colors.blue[de],100:ee.colors.purple[de]},"green-purple":{0:ee.colors.green[de],100:ee.colors.purple[de]},"blue-gray":{0:ee.colors.blue[de],100:ee.colors.gray[de]},"blue-white-blue":{0:ee.colors.blue[de],40:ee.colors.white,60:ee.colors.white,100:ee.colors.blue[de]},"blue-white-blue-last":{0:ee.colors.blue[de],40:ee.colors.white,60:ee.colors.white,100:ee.colors.blue[de]},"transparent-purple":{0:{color:ee.colors.purple[100],opacity:0},100:{color:ee.colors.purple[100],opacity:1}},"transparent-purple2":{0:{color:ee.colors.purple[400],opacity:0},100:{color:ee.colors.purple[200],opacity:1}},"transparent-purple-last":{0:{color:ee.colors.purple[100],opacity:0},100:{color:ee.colors.purple[100],opacity:1}},"transparent-purple2-last":{0:{color:ee.colors.purple[400],opacity:0},100:{color:ee.colors.purple[200],opacity:1}},"blue-blue":{0:ee.colors.blue[de],100:ee.colors.blue[de]},"red-red":{0:ee.colors.red[de],100:ee.colors.red[de]},"green-green":{0:ee.colors.green[de],100:ee.colors.green[de]},"blue-blue2":{0:ee.colors.blue[de],100:ee.colors.blue[de]},"red-red2":{0:ee.colors.red[de],100:ee.colors.red[de]},"green-green2":{0:ee.colors.green[de],100:ee.colors.green[de]},"blue-blue-last":{0:ee.colors.blue[de],100:ee.colors.blue[de]},"red-red-last":{0:ee.colors.red[de],100:ee.colors.red[de]},"green-green-last":{0:ee.colors.green[de],100:ee.colors.green[de]},"blue-blue2-last":{0:ee.colors.blue[de],100:ee.colors.blue[de]},"red-red2-last":{0:ee.colors.red[de],100:ee.colors.red[de]},"green-green2-last":{0:ee.colors.green[de],100:ee.colors.green[de]},"gray-gray":{0:ee.colors.gray[de],100:ee.colors.gray[de]},"purple-purple":{0:ee.colors.purple[de],100:ee.colors.purple[de]},"purple-purple-last":{0:ee.colors.purple[de],100:ee.colors.purple[de]}};function no(n){let e,l,t,r;return{c(){e=Ie("svg"),t=Ie("svg"),this.h()},l(o){e=De(o,"svg",{id:!0,class:!0,style:!0}),T(e).forEach($),t=De(o,"svg",{class:!0,style:!0}),T(t).forEach($),this.h()},h(){_(e,"id","back"),_(e,"class","sankey-back absolute left-0 top-0 h-full w-full"),_(e,"style",l=`z-index:${n[2].attention_head_num-1};`),_(t,"class","sankey-top absolute left-0 top-0 h-full w-full"),_(t,"style",r=`z-index:${n[2].attention_head_num};`)},m(o,s){x(o,e,s),n[4](e),x(o,t,s),n[5](t)},p(o,[s]){s&4&&l!==(l=`z-index:${o[2].attention_head_num-1};`)&&_(e,"style",l),s&4&&r!==(r=`z-index:${o[2].attention_head_num};`)&&_(t,"style",r)},i:Le,o:Le,d(o){o&&($(e),$(t)),n[4](null),n[5](null)}}}const oo=80;function ro(n,e,l){let t,r,o;Ee(n,st,S=>l(3,r=S)),Ee(n,$t,S=>l(2,o=S));const{theme:s}=ht(dt);let f,i,a;const d={attention:[{from:".attention .query .head-rest",to:".head-block .query .vector",gradientId:"blue-blue2",opacity:.4},{from:".attention .key .head-rest",to:".head-block .key .vector",gradientId:"red-red2",opacity:.4},{from:".attention .value .head-rest",to:".head-block .value .vector",gradientId:"green-green2",opacity:.4},{from:".attention .head-out .vector",to:".mlp .initial .vector .head-rest",gradientId:"transparent-purple",opacity:.4}]},h=()=>{const B=Ue(i).append("defs");Object.keys(Zt).forEach(O=>{const M=Zt[O],L=B.append("linearGradient").attr("id",O).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");Object.keys(M).forEach(c=>{let p,v;typeof M[c]!="string"?(p=M[c].color,v=M[c].opacity):(p=M[c],v=1),L.append("stop").attr("offset",`${c}%`).attr("stop-color",p).attr("stop-opacity",v)})})};let m=1,k;const V=async()=>{await gt();const S=Ue(i),B=Ue(f);[{dataMap:t,svg:S},{dataMap:d,svg:B}].forEach(({dataMap:O,svg:M})=>{M.selectAll("g.path-group").data(Object.keys(O)).join("g").attr("class",c=>`path-group ${c}`).on("mouseenter",(c,p)=>{clearTimeout(k),Ot.set(p);const v=Ue(`g.${p}`).selectAll("path");m=v.nodes()[0].getAttribute("opacity"),v.transition().duration(300).style("opacity",Number(m)+.2)}).on("mouseleave",(c,p)=>{k=setTimeout(()=>{Ot.set(null)},300),Ue(`g.${p}`).selectAll("path").transition().duration(300).style("opacity",m)}).selectAll("path.sankey-path").data(c=>O[c].map(v=>{const w=Ct(v.from).nodes(),I=Ct(v.to).nodes();return w.map((C,y)=>{const g=C.getBoundingClientRect(),u=I[y].getBoundingClientRect(),E=v.curve||oo,N=(v.pathGenerator||H)(g,u,E),A=I.length>1&&y===w.length-1;let j=v.gradientId;return A&&document.getElementById(v.gradientId+"-last")&&(j=v.gradientId+"-last"),{id:v.id,isLast:y===w.length-1,path:N,fill:v.type==="stroke"?"none":v.gradientId?`url(#${j})`:v.fill,opacity:v.opacity,stroke:v.type==="stroke"?v.gradientId?`url(#${v.gradientId})`:v.fill:"none"}})}).flat()).join("path").attr("class",c=>`sankey-path ${c.id||""} ${c.isLast?"last":""}`).attr("fill",c=>c.fill).attr("stroke",c=>c.stroke).attr("stroke-width",2).attr("opacity",c=>c.opacity||1).attr("d",c=>c.path)})},H=(S,B,O)=>{const M=window.scrollY,L=window.scrollX;return`
        M ${S.right+L},${S.top+M}
        C ${S.right+L+O},${S.top+M} ${B.left+L-O},${B.top+M} ${B.left+L},${B.top+M}
        L ${B.left+L},${B.bottom+M}
        C ${B.left+L-O},${B.bottom+M} ${S.right+L+O},${S.bottom+M} ${S.right+L},${S.bottom+M}
        Z
    `};bt(()=>(h(),a=new ResizeObserver(B=>{V(),R()}),(document==null?void 0:document.querySelectorAll(".resize-watch")).forEach(B=>a.observe(B)),()=>{a.disconnect()}));const R=()=>{const S=Ue(i),B=Ct(".residual-start path.head").nodes(),O=Ct(".residual-end path.head").nodes(),M=B.map((L,c)=>{const p=L.getBoundingClientRect(),v=O[c].getBoundingClientRect(),w=p.right,I=p.top,C=v.left,y=v.top;return{x1:w,y1:I,x2:C,y2:y,id:L.id}});S.selectAll("line.residual-connector").data(M).join("line").attr("class",L=>`residual-connector ${L.id}`).attr("x1",L=>L.x1).attr("y1",L=>L.y1).attr("x2",L=>L.x2).attr("y2",L=>L.y2).attr("stroke",s.colors.gray[400]).attr("stroke-width",1).style("opacity",0)};function X(S){tt[S?"unshift":"push"](()=>{f=S,l(0,f)})}function q(S){tt[S?"unshift":"push"](()=>{i=S,l(1,i)})}return n.$$.update=()=>{n.$$.dirty&8&&(t={embedding:[{from:".embedding .vector-column .column.vectors .vector",to:".attention .vector",gradientId:"gray-blue",opacity:.6,pathGenerator:(S,B,O)=>{const M=window.scrollY,L=window.scrollX,c=30;return`
					M ${S.right+L},${S.top+M}
					L ${S.right+c+L},${S.top+M}
					C ${S.right+c+L+O},${S.top+M} ${B.left+L-O},${B.top+M} ${B.left+L},${B.top+M}
					L ${B.left+L},${B.bottom+M}
					C ${B.left+L-O},${B.bottom+M} ${S.right+c+L+O},${S.bottom+M} ${S.right+c+L},${S.bottom+M}
					L ${S.right+L},${S.bottom+M}
					Z
				`}}],attention:[{from:".attention .query .sub-vector.head1",to:".head-block .query .vector",gradientId:"blue-blue"},{from:".attention .key .sub-vector.head1",to:".head-block .key .vector",gradientId:"red-red"},{from:".attention .value .sub-vector.head1",to:".head-block .value .vector",gradientId:"green-green"},{from:".attention .head-out .vector",to:".mlp .initial .head1",gradientId:"purple-purple"},{from:".head-block .key .vector",to:".attention-initial .main g.g-row",id:"key-to-attention",type:"stroke",gradientId:"red-purple",curve:30,pathGenerator:(S,B,O)=>{const M=window.scrollY,L=window.scrollX,c=S.top+M+S.height/2,p=B.top+M+B.height/2,v=S.right+L+O,w=B.left+L-O;return`
			    M ${S.right+L},${c}
			    C ${v},${c} ${w},${p} ${B.left+L},${p}
					L ${B.right+L},${p}
			`}},{from:".head-block .query .vector",to:`.attention-matrix.attention-initial .main g.g-row-${r.length-1} circle`,gradientId:"blue-purple",id:"query-to-attention",type:"stroke",curve:20,pathGenerator:(S,B,O)=>{const M=window.scrollY,L=window.scrollX,c=S.top+M+S.height/2,p=B.left+L+B.width/2;return`
			    M ${S.right+L},${c}
			    L ${p-O},${c}
			    A ${O},${O} 0 0 1 ${p},${c+O}
			    L ${p},${B.bottom+M}
			`}},{from:".attention-matrix.attention-out .main svg",to:".attention .head-out",gradientId:"transparent-purple2",id:"to-attention-out",opacity:.4,curve:20,pathGenerator:(S,B,O)=>{const M=window.scrollY,L=window.scrollX;return`
			    M ${S.right+L},${S.top+M}
			    C ${S.right+L+O},${S.top+M} ${B.left+L-O},${B.top+M} ${B.left+L},${B.top+M}
			    L ${B.left+L},${B.bottom+M}
			    C ${B.left+L-O},${B.bottom+M} ${S.right+L+O},${S.bottom+M} ${S.right+L},${S.bottom+M}
			    Z
			`}},{from:".head-block .value",to:".attention .head-out",gradientId:"green-purple",id:"to-attention-out",opacity:.4,curve:60,pathGenerator:(S,B,O)=>{const M=window.scrollY,L=window.scrollX;return`
        M ${S.right+L},${S.top+M} 
        C ${B.left-O},${S.top+M} ${B.left+L-O},${S.top+M} ${B.left+L},${B.top+M}
        L ${B.left+L},${B.bottom+M}
        C ${B.left+L-O},${S.bottom+M} ${B.left-O},${S.bottom+M} ${S.right+L},${S.bottom+M}
        Z
    `}}],mlp:[{from:".mlp .column.initial .vector",to:".mlp .projections .vector",gradientId:"purple-indigo",curve:50,opacity:.4,pathGenerator:(S,B,O)=>{const M=window.scrollY,L=window.scrollX,c=49;return`
					M ${S.right+L},${S.top+M}
					L ${S.right+c+L},${S.top+M}
					C ${S.right+c+L+O},${S.top+M} ${B.left+L-O},${B.top+M} ${B.left+L},${B.top+M}
					L ${B.left+L},${B.bottom+M}
					C ${B.left+L-O},${B.bottom+M} ${S.right+c+L+O},${S.bottom+M} ${S.right+c+L},${S.bottom+M}
					L ${S.right+L},${S.bottom+M}
					Z
				`}},{from:".mlp .projections .vector",to:".mlp .column.out .vector",gradientId:"indigo-blue",curve:50,opacity:.4,pathGenerator:(S,B,O)=>{const M=window.scrollY,L=window.scrollX,c=20;return`
					M ${S.right+L},${S.top+M}
					C ${S.right+L+O},${S.top+M} ${B.left-c+L-O},${B.top+M} ${B.left-c+L},${B.top+M}
					L ${B.left+L},${B.top+M}
					L ${B.left+L},${B.bottom+M}
					L ${B.left-c+L},${B.bottom+M}
					C ${B.left-c+L-O},${B.bottom+M} ${S.right+L+O},${S.bottom+M} ${S.right+L},${S.bottom+M}
					L ${S.right+L},${S.bottom+M}
					Z
				`}}],"transformer-blocks":[{from:".mlp .out .vector",to:".transformer-blocks .column.final .vector",gradientId:"blue-white-blue",opacity:.6,pathGenerator:(S,B,O)=>{const M=window.scrollY,L=window.scrollX;return`
        M ${S.right+L},${S.top+M}
        C ${S.right+L+O},${S.top+M} ${B.left+L-O},${B.top+M} ${B.left+L},${B.top+M}
        L ${B.left+L},${B.bottom+M}
        C ${B.left+L-O},${B.bottom+M} ${S.right+L+O},${S.bottom+M} ${S.right+L},${S.bottom+M}
        Z
    `}}],"linear-softmax":[{from:".transformer-blocks .final .vector.last-token ",to:".softmax .content .vector",gradientId:"blue-gray",opacity:.4}]}),n.$$.dirty&8&&typeof window<"u"&&r&&(V(),R())},[f,i,o,r,X,q]}class so extends Pe{constructor(e){super(),Te(this,e,ro,no,ze,{})}}function Yt(n,e,l){const t=n.slice();return t[6]=e[l],t[8]=l,t}function io(n){let e,l,t,r,o;return{c(){e=z("div"),l=z("div"),r=U(),this.h()},l(s){e=P(s,"DIV",{class:!0,style:!0});var f=T(e);l=P(f,"DIV",{class:!0,style:!0}),T(l).forEach($),r=W(f),f.forEach($),this.h()},h(){_(l,"class","card svelte-z5n2f7"),_(l,"style",t=`width: ${n[1].width}px; height: ${n[1].height}px;`),_(e,"class","rest absolute"),_(e,"style",o=`transform:translate(${n[8]*ft.x}px,${n[8]*ft.y}px) scale(${1-ft.scale*n[8]}); 
      z-index: ${n[2].attention_head_num-n[8]};opacity:${Math.max(.1,1-n[8]*Qt)};`)},m(s,f){x(s,e,f),D(e,l),D(e,r)},p(s,f){f&2&&t!==(t=`width: ${s[1].width}px; height: ${s[1].height}px;`)&&_(l,"style",t),f&4&&o!==(o=`transform:translate(${s[8]*ft.x}px,${s[8]*ft.y}px) scale(${1-ft.scale*s[8]}); 
      z-index: ${s[2].attention_head_num-s[8]};opacity:${Math.max(.1,1-s[8]*Qt)};`)&&_(e,"style",o)},i:Le,o:Le,d(s){s&&$(e)}}}function ao(n){let e,l,t;const r=n[4].default,o=sn(r,n,n[3],null);return{c(){e=z("div"),o&&o.c(),l=U(),this.h()},l(s){e=P(s,"DIV",{class:!0,style:!0});var f=T(e);o&&o.l(f),l=W(f),f.forEach($),this.h()},h(){_(e,"class","w-full"),_(e,"style","z-index: 200;")},m(s,f){x(s,e,f),o&&o.m(e,null),D(e,l),n[5](e),t=!0},p(s,f){o&&o.p&&(!t||f&8)&&an(o,r,s,s[3],t?fn(r,s[3],f,null):cn(s[3]),null)},i(s){t||(F(o,s),t=!0)},o(s){Z(o,s),t=!1},d(s){s&&$(e),o&&o.d(s),n[5](null)}}}function Kt(n){let e,l,t,r;const o=[ao,io],s=[];function f(i,a){return i[8]===0?0:1}return e=f(n),l=s[e]=o[e](n),{c(){l.c(),t=nt()},l(i){l.l(i),t=nt()},m(i,a){s[e].m(i,a),x(i,t,a),r=!0},p(i,a){l.p(i,a)},i(i){r||(F(l),r=!0)},o(i){Z(l),r=!1},d(i){i&&$(t),s[e].d(i)}}}function co(n){let e,l,t=ve(Array(n[2].attention_head_num+1).fill(0)),r=[];for(let s=0;s<t.length;s+=1)r[s]=Kt(Yt(n,t,s));const o=s=>Z(r[s],1,1,()=>{r[s]=null});return{c(){e=z("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=P(s,"DIV",{class:!0});var f=T(e);for(let i=0;i<r.length;i+=1)r[i].l(f);f.forEach($),this.h()},h(){_(e,"class","multi-head flex w-full svelte-z5n2f7")},m(s,f){x(s,e,f);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null);l=!0},p(s,[f]){if(f&15){t=ve(Array(s[2].attention_head_num+1).fill(0));let i;for(i=0;i<t.length;i+=1){const a=Yt(s,t,i);r[i]?(r[i].p(a,f),F(r[i],1)):(r[i]=Kt(a),r[i].c(),F(r[i],1),r[i].m(e,null))}for(Me(),i=t.length;i<r.length;i+=1)o(i);Be()}},i(s){if(!l){for(let f=0;f<t.length;f+=1)F(r[f]);l=!0}},o(s){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)Z(r[f]);l=!1},d(s){s&&$(e),Ne(r,s)}}}let Qt=.1;function fo(n,e,l){let t;Ee(n,$t,a=>l(2,t=a));let{$$slots:r={},$$scope:o}=e,s,f={width:0,height:0};bt(()=>{const a=new ResizeObserver(d=>{for(let h of d){const{width:m,height:k}=h.contentRect;l(1,f={width:m,height:k})}});return a.observe(s),()=>{a.unobserve(s)}});function i(a){tt[a?"unshift":"push"](()=>{s=a,l(0,s)})}return n.$$set=a=>{"$$scope"in a&&l(3,o=a.$$scope)},[s,f,t,o,r,i]}class uo extends Pe{constructor(e){super(),Te(this,e,fo,co,ze,{})}}const at=n=>n;function ho(n){let e,l,t,r,o,s,f="QK<sup>T</sup>",i,a,d,h,m,k,V,H,R,X="Mask",q,S,B,O,M,L,c,p,v="Softmax",w,I,C,y,g,u,E="Attention",b,N,A,j,K,ue;return r=new vt({props:{className:"main",data:n[0],showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),m=new vt({props:{className:"prev absolute top-0 left-0 pointer-events-none",data:n[0],showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),V=new vt({props:{className:"main opacity-0",data:at(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),O=new vt({props:{className:"prev absolute top-0 left-0  pointer-events-none",data:at(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),L=new vt({props:{className:"main opacity-0",data:at(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,showValue:!0,shape:"circle",colorScale:"purple"}}),y=new vt({props:{className:"main",data:at(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,showValue:!1,shape:"circle",colorScale:"purple"}}),{c(){e=z("div"),l=z("div"),t=z("div"),oe(r.$$.fragment),o=U(),s=z("div"),s.innerHTML=f,a=U(),d=z("div"),h=z("div"),oe(m.$$.fragment),k=U(),oe(V.$$.fragment),H=U(),R=z("div"),R.textContent=X,q=U(),S=z("div"),B=z("div"),oe(O.$$.fragment),M=U(),oe(L.$$.fragment),c=U(),p=z("div"),p.textContent=v,I=U(),C=z("div"),oe(y.$$.fragment),g=U(),u=z("div"),u.textContent=E,this.h()},l(Y){e=P(Y,"DIV",{class:!0});var G=T(e);l=P(G,"DIV",{role:!0,tabindex:!0,class:!0});var te=T(l);t=P(te,"DIV",{class:!0});var ne=T(t);re(r.$$.fragment,ne),o=W(ne),s=P(ne,"DIV",{class:!0,"data-svelte-h":!0}),Ce(s)!=="svelte-1gw7aya"&&(s.innerHTML=f),ne.forEach($),a=W(te),d=P(te,"DIV",{class:!0});var Q=T(d);h=P(Q,"DIV",{});var we=T(h);re(m.$$.fragment,we),k=W(we),re(V.$$.fragment,we),we.forEach($),H=W(Q),R=P(Q,"DIV",{class:!0,"data-svelte-h":!0}),Ce(R)!=="svelte-1kil1k9"&&(R.textContent=X),Q.forEach($),q=W(te),S=P(te,"DIV",{class:!0});var qe=T(S);B=P(qe,"DIV",{});var ge=T(B);re(O.$$.fragment,ge),M=W(ge),re(L.$$.fragment,ge),ge.forEach($),c=W(qe),p=P(qe,"DIV",{class:!0,"data-svelte-h":!0}),Ce(p)!=="svelte-1w9l1cd"&&(p.textContent=v),qe.forEach($),I=W(te),C=P(te,"DIV",{class:!0});var He=T(C);re(y.$$.fragment,He),g=W(He),u=P(He,"DIV",{class:!0,"data-svelte-h":!0}),Ce(u)!=="svelte-1t0maa5"&&(u.textContent=E),He.forEach($),te.forEach($),G.forEach($),this.h()},h(){_(s,"class","text-gray-400"),_(t,"class",i=he(fe("attention-matrix attention-qk flex flex-col items-center",{"attention-initial":n[1]}))+" svelte-1lvbtg6"),_(R,"class","text-gray-400"),_(d,"class","attention-matrix attention-mask flex flex-col items-center svelte-1lvbtg6"),_(p,"class","text-gray-400"),_(S,"class",w=he(fe("attention-matrix attention-softmax flex flex-col items-center",{"attention-out":n[1]}))+" svelte-1lvbtg6"),_(u,"class","text-gray-400"),_(C,"class",b=he(fe("attention-matrix attention-result flex flex-col items-center",{"attention-initial":!n[1],"attention-out":!n[1]}))+" svelte-1lvbtg6"),Gt(()=>n[15].call(C)),_(l,"role","button"),_(l,"tabindex","0"),_(l,"class",A=he(fe("attention-matrix-container relative flex gap-3 p-3 pb-1",{active:n[1]}))+" svelte-1lvbtg6"),_(e,"class","flex items-center gap-8 px-10")},m(Y,G){x(Y,e,G),D(e,l),D(l,t),se(r,t,null),D(t,o),D(t,s),n[11](t),D(l,a),D(l,d),D(d,h),se(m,h,null),D(h,k),se(V,h,null),D(d,H),D(d,R),n[12](d),D(l,q),D(l,S),D(S,B),se(O,B,null),D(B,M),se(L,B,null),D(S,c),D(S,p),n[13](S),D(l,I),D(l,C),se(y,C,null),D(C,g),D(C,u),n[14](C),N=un(C,n[15].bind(C)),j=!0,K||(ue=[ke(l,"click",n[8]),ke(l,"keydown",n[8])],K=!0)},p(Y,[G]){const te={};G&1&&(te.data=Y[0]),G&128&&(te.cellHeight=Y[7]),G&128&&(te.cellWidth=Y[7]),r.$set(te),(!j||G&2&&i!==(i=he(fe("attention-matrix attention-qk flex flex-col items-center",{"attention-initial":Y[1]}))+" svelte-1lvbtg6"))&&_(t,"class",i);const ne={};G&1&&(ne.data=Y[0]),G&128&&(ne.cellHeight=Y[7]),G&128&&(ne.cellWidth=Y[7]),m.$set(ne);const Q={};G&1&&(Q.data=at(Y[0])),G&128&&(Q.cellHeight=Y[7]),G&128&&(Q.cellWidth=Y[7]),V.$set(Q);const we={};G&1&&(we.data=at(Y[0])),G&128&&(we.cellHeight=Y[7]),G&128&&(we.cellWidth=Y[7]),O.$set(we);const qe={};G&1&&(qe.data=at(Y[0])),G&128&&(qe.cellHeight=Y[7]),G&128&&(qe.cellWidth=Y[7]),L.$set(qe),(!j||G&2&&w!==(w=he(fe("attention-matrix attention-softmax flex flex-col items-center",{"attention-out":Y[1]}))+" svelte-1lvbtg6"))&&_(S,"class",w);const ge={};G&1&&(ge.data=at(Y[0])),G&128&&(ge.cellHeight=Y[7]),G&128&&(ge.cellWidth=Y[7]),y.$set(ge),(!j||G&2&&b!==(b=he(fe("attention-matrix attention-result flex flex-col items-center",{"attention-initial":!Y[1],"attention-out":!Y[1]}))+" svelte-1lvbtg6"))&&_(C,"class",b),(!j||G&2&&A!==(A=he(fe("attention-matrix-container relative flex gap-3 p-3 pb-1",{active:Y[1]}))+" svelte-1lvbtg6"))&&_(l,"class",A)},i(Y){j||(F(r.$$.fragment,Y),F(m.$$.fragment,Y),F(V.$$.fragment,Y),F(O.$$.fragment,Y),F(L.$$.fragment,Y),F(y.$$.fragment,Y),j=!0)},o(Y){Z(r.$$.fragment,Y),Z(m.$$.fragment,Y),Z(V.$$.fragment,Y),Z(O.$$.fragment,Y),Z(L.$$.fragment,Y),Z(y.$$.fragment,Y),j=!1},d(Y){Y&&$(e),ie(r),n[11](null),ie(m),ie(V),n[12](null),ie(O),ie(L),n[13](null),ie(y),n[14](null),N(),K=!1,je(ue)}}}let po=16,go=20,mo=10;function vo(n,e,l){let t,r,o;Ee(n,st,c=>l(9,r=c)),Ee(n,Qe,c=>l(10,o=c)),ht(dt);let{data:s}=e,f,i,a,d,h=0,m=!1;const k=Nt("block-id"),V=()=>{l(1,m=!m),m?(Qe.set({id:k}),X()):(Qe.set({id:null}),q())};let H=mt.timeline(),R=mt.timeline();const X=()=>{R.progress(1);const c=document.querySelectorAll("div.sankey g.attention path.key-to-attention"),p=document.querySelectorAll("div.sankey g.attention path.query-to-attention"),v=document.querySelectorAll("div.sankey g.attention path.to-attention-out");[...c,...p].forEach(C=>{const y=C.getTotalLength();C.style.strokeDasharray=y,C.style.strokeDashoffset=y});const w=1.2,I=Number((w/r.length).toFixed(2));H.set([i.querySelector(".prev"),a.querySelector(".prev")],{opacity:1}).set([i.querySelector(".main"),a.querySelector(".main")],{opacity:0}),H.set(v,{opacity:0}),H.to(d,{opacity:0,display:"none",duration:.2}),H.set(f,{width:"auto",display:"flex",opacity:0}).to(f,{opacity:1,duration:.5}).to(c,{strokeDashoffset:0,stagger:I,duration:w,ease:"power2.out"}).to(p,{strokeDashoffset:0,stagger:I,duration:w,ease:"power2.out"},"<").from(f.querySelectorAll("svg circle"),{scale:0,transformOrigin:"50% 50%",opacity:0,delay:w/r.length,stagger:Number((w/Math.pow(r.length,2)).toFixed(2)),ease:"power2.out",duration:w},"<"),H.set(i,{width:0,x:h*-1,opacity:0}).to(i,{opacity:1,display:"flex",width:h,x:0,duration:.5}).to(i.querySelector(".prev"),{opacity:0,duration:1}).to(i.querySelector(".main"),{opacity:1,duration:1},"<"),H.set(a,{width:0,x:h*-1,opacity:0}).to(a,{opacity:1,display:"flex",width:h,x:0,duration:.4}).to(a.querySelector(".prev"),{opacity:0,duration:1}).to(a.querySelector(".main"),{opacity:1,duration:1},"<"),H.to(v,{opacity:.5})},q=()=>{H.progress(1),R.to([f,i,a],{opacity:0,display:"none",width:0,duration:.5}),R.to(d,{opacity:1,display:"flex",duration:.5},0)};function S(c){tt[c?"unshift":"push"](()=>{f=c,l(2,f)})}function B(c){tt[c?"unshift":"push"](()=>{i=c,l(3,i)})}function O(c){tt[c?"unshift":"push"](()=>{a=c,l(4,a)})}function M(c){tt[c?"unshift":"push"](()=>{d=c,l(5,d)})}function L(){h=this.offsetWidth,l(6,h)}return n.$$set=c=>{"data"in c&&l(0,s=c.data)},n.$$.update=()=>{n.$$.dirty&512&&l(7,t=Math.min(go,Math.max(1/r.length*po*6,mo))),n.$$.dirty&1026&&o.id!==k&&m&&(l(1,m=!1),q())},[s,m,f,i,a,d,h,t,V,r,o,S,B,O,M,L]}class _o extends Pe{constructor(e){super(),Te(this,e,vo,ho,ze,{data:0})}}function bo(n){let e;return{c(){e=z("canvas"),this.h()},l(l){e=P(l,"CANVAS",{class:!0}),T(e).forEach($),this.h()},h(){_(e,"class","svelte-ex5m8"),le(e,"active",n[0])},m(l,t){x(l,e,t),n[4](e)},p(l,[t]){t&1&&le(e,"active",l[0])},i:Le,o:Le,d(l){l&&$(e),n[4](null)}}}let $o=100;const Lt=1;function ko(n,e,l){const{theme:t}=ht(dt);let{active:r=!1}=e,{data:o=new Array($o).fill(0).map(m=>Math.random())}=e,{colorScale:s=void 0}=e,f;const i=typeof s=="string"?s:"gray",a=typeof s=="function"?s:Rt(t.colors[i][100],t.colors[i][400]);function d(){const m=f.getContext("2d");if(!m)return;const k=f.parentElement.clientWidth,V=f.parentElement.clientHeight;m.clearRect(0,0,k,V);let H=4;l(1,f.width=k*H,f),l(1,f.height=V*H,f),l(1,f.style.width=`${k}px`,f),l(1,f.style.height=`${V}px`,f);for(let R=0;R<V/Lt;R++){const X=o[R];m.fillStyle=a(X),m.fillRect(0,R*Lt*H,k*H,Lt*H)}}bt(()=>{const m=Vt.subscribe(d);return()=>{m()}});function h(m){tt[m?"unshift":"push"](()=>{f=m,l(1,f)})}return n.$$set=m=>{"active"in m&&l(0,r=m.active),"data"in m&&l(2,o=m.data),"colorScale"in m&&l(3,s=m.colorScale)},n.$$.update=()=>{n.$$.dirty&6&&o&&f&&d()},[r,f,o,s,h]}class lt extends Pe{constructor(e){super(),Te(this,e,ko,bo,ze,{active:0,data:2,colorScale:3})}}function Jt(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function el(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function tl(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function ll(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function nl(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function wo(n){let e,l=n[6].dimension*3+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension*3+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function yo(n){let e,l=n[6].dimension/n[6].attention_head_num+"",t,r;return{c(){e=ae("Head1 Query, size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"Head1 Query, size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension/o[6].attention_head_num+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Eo(n){let e,l=n[6].dimension/n[6].attention_head_num+"",t,r;return{c(){e=ae("Head1 Key, size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"Head1 Key, size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension/o[6].attention_head_num+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Io(n){let e,l=n[6].dimension/n[6].attention_head_num+"",t,r;return{c(){e=ae("Head1 Value size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"Head1 Value size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension/o[6].attention_head_num+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Do(n){let e,l=n[6].dimension/n[6].attention_head_num+"",t,r;return{c(){e=ae("Head1 Attention Out, size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"Head1 Attention Out, size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension/o[6].attention_head_num+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function ol(n){let e,l="Q";return{c(){e=z("span"),e.textContent=l},l(t){e=P(t,"SPAN",{"data-svelte-h":!0}),Ce(e)!=="svelte-10ub4hf"&&(e.textContent=l)},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function rl(n){let e,l="K";return{c(){e=z("span"),e.textContent=l},l(t){e=P(t,"SPAN",{"data-svelte-h":!0}),Ce(e)!=="svelte-1c09r6x"&&(e.textContent=l)},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function sl(n){let e,l="V";return{c(){e=z("span"),e.textContent=l},l(t){e=P(t,"SPAN",{"data-svelte-h":!0}),Ce(e)!=="svelte-j40kxg"&&(e.textContent=l)},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function il(n){let e,l,t,r,o,s,f,i,a,d,h,m,k,V,H,R,X,q,S,B,O,M,L,c,p;t=new lt({props:{colorScale:"blue",active:n[3]===n[17]}});let v=n[3]!==n[17]&&ol();d=new lt({props:{colorScale:"red",active:n[3]===n[17]}});let w=n[3]!==n[17]&&rl();X=new lt({props:{colorScale:"green",active:n[3]===n[17]}});let I=n[3]!==n[17]&&sl();function C(){return n[11](n[17])}return{c(){e=z("div"),l=z("div"),oe(t.$$.fragment),r=U(),o=z("div"),s=U(),f=z("div"),v&&v.c(),i=U(),a=z("div"),oe(d.$$.fragment),h=U(),m=z("div"),k=U(),V=z("div"),w&&w.c(),H=U(),R=z("div"),oe(X.$$.fragment),q=U(),S=z("div"),B=U(),O=z("div"),I&&I.c(),M=U(),this.h()},l(y){e=P(y,"DIV",{class:!0,role:!0});var g=T(e);l=P(g,"DIV",{class:!0});var u=T(l);re(t.$$.fragment,u),r=W(u),o=P(u,"DIV",{class:!0}),T(o).forEach($),s=W(u),f=P(u,"DIV",{class:!0});var E=T(f);v&&v.l(E),E.forEach($),u.forEach($),i=W(g),a=P(g,"DIV",{class:!0});var b=T(a);re(d.$$.fragment,b),h=W(b),m=P(b,"DIV",{class:!0}),T(m).forEach($),k=W(b),V=P(b,"DIV",{class:!0});var N=T(V);w&&w.l(N),N.forEach($),b.forEach($),H=W(g),R=P(g,"DIV",{class:!0});var A=T(R);re(X.$$.fragment,A),q=W(A),S=P(A,"DIV",{class:!0}),T(S).forEach($),B=W(A),O=P(A,"DIV",{class:!0});var j=T(O);I&&I.l(j),j.forEach($),A.forEach($),M=W(g),g.forEach($),this.h()},h(){_(o,"class",he(`sub-vector x1-12 head1 ${bn}`)+" svelte-1m1b7zh"),_(f,"class","sub-vector head-rest grow svelte-1m1b7zh"),_(l,"class",he(`sub-vector query relative flex grow flex-col ${So}`)+" svelte-1m1b7zh"),_(m,"class",he(`sub-vector x1-12 head1 ${$n}`)+" svelte-1m1b7zh"),_(V,"class","sub-vector head-rest grow svelte-1m1b7zh"),_(a,"class",he(`sub-vector key relative flex grow flex-col ${Vo}`)+" svelte-1m1b7zh"),_(S,"class",he(`sub-vector x1-12 head1 ${kn}`)+" svelte-1m1b7zh"),_(O,"class","sub-vector head-rest grow svelte-1m1b7zh"),_(R,"class",he(`sub-vector value relative flex grow flex-col ${No}`)+" svelte-1m1b7zh"),_(e,"class","qkv-weighted vector x3 flex flex-col"),_(e,"role","group"),le(e,"last",n[17]===n[1].length-1)},m(y,g){x(y,e,g),D(e,l),se(t,l,null),D(l,r),D(l,o),D(l,s),D(l,f),v&&v.m(f,null),D(e,i),D(e,a),se(d,a,null),D(a,h),D(a,m),D(a,k),D(a,V),w&&w.m(V,null),D(e,H),D(e,R),se(X,R,null),D(R,q),D(R,S),D(R,B),D(R,O),I&&I.m(O,null),D(e,M),L=!0,c||(p=[ke(e,"mouseenter",C),ke(e,"mouseleave",n[12])],c=!0)},p(y,g){n=y;const u={};g&8&&(u.active=n[3]===n[17]),t.$set(u),n[3]!==n[17]?v||(v=ol(),v.c(),v.m(f,null)):v&&(v.d(1),v=null);const E={};g&8&&(E.active=n[3]===n[17]),d.$set(E),n[3]!==n[17]?w||(w=rl(),w.c(),w.m(V,null)):w&&(w.d(1),w=null);const b={};g&8&&(b.active=n[3]===n[17]),X.$set(b),n[3]!==n[17]?I||(I=sl(),I.c(),I.m(O,null)):I&&(I.d(1),I=null),(!L||g&2)&&le(e,"last",n[17]===n[1].length-1)},i(y){L||(F(t.$$.fragment,y),F(d.$$.fragment,y),F(X.$$.fragment,y),L=!0)},o(y){Z(t.$$.fragment,y),Z(d.$$.fragment,y),Z(X.$$.fragment,y),L=!1},d(y){y&&$(e),ie(t),v&&v.d(),ie(d),w&&w.d(),ie(X),I&&I.d(),c=!1,je(p)}}}function al(n){let e,l,t=n[15]+"",r,o,s,f;return{c(){e=z("div"),l=z("span"),r=ae(t),o=U(),s=z("div"),f=U(),this.h()},l(i){e=P(i,"DIV",{class:!0});var a=T(e);l=P(a,"SPAN",{class:!0});var d=T(l);r=ce(d,t),d.forEach($),o=W(a),s=P(a,"DIV",{class:!0}),T(s).forEach($),f=W(a),a.forEach($),this.h()},h(){_(l,"class","label float svelte-1m1b7zh"),_(s,"class",he(`vector x1-12  ${bn}`)+" svelte-1m1b7zh"),_(e,"class","head1 cell x1-12 text-xs"),le(e,"last",n[17]===n[1].length-1)},m(i,a){x(i,e,a),D(e,l),D(l,r),D(e,o),D(e,s),D(e,f)},p(i,a){a&2&&t!==(t=i[15]+"")&&Ve(r,t),a&2&&le(e,"last",i[17]===i[1].length-1)},d(i){i&&$(e)}}}function cl(n){let e,l,t=n[15]+"",r,o,s,f,i;return{c(){e=z("div"),l=z("span"),r=ae(t),o=U(),s=z("div"),f=U(),this.h()},l(a){e=P(a,"DIV",{class:!0});var d=T(e);l=P(d,"SPAN",{class:!0});var h=T(l);r=ce(h,t),h.forEach($),o=W(d),s=P(d,"DIV",{class:!0}),T(s).forEach($),f=W(d),d.forEach($),this.h()},h(){_(l,"class","label float svelte-1m1b7zh"),_(s,"class",he(`vector x1-12 ${$n}`)+" svelte-1m1b7zh"),_(e,"class",i="head1 cell x1-12 text-xs class:last="+(n[17]===n[1].length-1)+" svelte-1m1b7zh")},m(a,d){x(a,e,d),D(e,l),D(l,r),D(e,o),D(e,s),D(e,f)},p(a,d){d&2&&t!==(t=a[15]+"")&&Ve(r,t),d&2&&i!==(i="head1 cell x1-12 text-xs class:last="+(a[17]===a[1].length-1)+" svelte-1m1b7zh")&&_(e,"class",i)},d(a){a&&$(e)}}}function fl(n){let e,l,t=n[15]+"",r,o,s,f;return{c(){e=z("div"),l=z("span"),r=ae(t),o=U(),s=z("div"),f=U(),this.h()},l(i){e=P(i,"DIV",{class:!0});var a=T(e);l=P(a,"SPAN",{class:!0});var d=T(l);r=ce(d,t),d.forEach($),o=W(a),s=P(a,"DIV",{class:!0}),T(s).forEach($),f=W(a),a.forEach($),this.h()},h(){_(l,"class","label float svelte-1m1b7zh"),_(s,"class",he(`vector x1-12 ${kn}`)+" svelte-1m1b7zh"),_(e,"class","head1 cell x1-12 text-xs"),le(e,"last",n[17]===n[1].length-1)},m(i,a){x(i,e,a),D(e,l),D(l,r),D(e,o),D(e,s),D(e,f)},p(i,a){a&2&&t!==(t=i[15]+"")&&Ve(r,t),a&2&&le(e,"last",i[17]===i[1].length-1)},d(i){i&&$(e)}}}function ul(n){let e,l,t;return{c(){e=z("div"),l=z("div"),t=U(),this.h()},l(r){e=P(r,"DIV",{class:!0});var o=T(e);l=P(o,"DIV",{class:!0}),T(l).forEach($),t=W(o),o.forEach($),this.h()},h(){_(l,"class",he(`vector x1-12 ${Ao}`)+" svelte-1m1b7zh"),_(e,"class","head1 cell x1-12"),le(e,"last",n[17]===n[1].length-1)},m(r,o){x(r,e,o),D(e,l),D(e,t)},p(r,o){o&2&&le(e,"last",r[17]===r[1].length-1)},d(r){r&&$(e)}}}function Co(n){let e,l,t,r,o="Query",s,f,i,a,d="Key",h,m,k,V,H="Value",R,X,q,S,B,O,M,L,c="Out",p,v,w,I,C=n[6].attention_head_num+"",y,g,u,E=ve(n[1]),b=[];for(let G=0;G<E.length;G+=1)b[G]=al(ll(n,E,G));let N=ve(n[1]),A=[];for(let G=0;G<N.length;G+=1)A[G]=cl(tl(n,N,G));let j=ve(n[1]),K=[];for(let G=0;G<j.length;G+=1)K[G]=fl(el(n,j,G));S=new _o({props:{data:n[4]}});let ue=ve(n[1]),Y=[];for(let G=0;G<ue.length;G+=1)Y[G]=ul(Jt(n,ue,G));return{c(){e=z("div"),l=z("div"),t=z("div"),r=z("div"),r.textContent=o,s=U();for(let G=0;G<b.length;G+=1)b[G].c();f=U(),i=z("div"),a=z("div"),a.textContent=d,h=U();for(let G=0;G<A.length;G+=1)A[G].c();m=U(),k=z("div"),V=z("div"),V.textContent=H,R=U();for(let G=0;G<K.length;G+=1)K[G].c();X=U(),q=z("div"),oe(S.$$.fragment),B=U(),O=z("div"),M=z("div"),L=z("div"),L.textContent=c,p=U();for(let G=0;G<Y.length;G+=1)Y[G].c();v=U(),w=z("div"),I=ae("Head 1 of "),y=ae(C),this.h()},l(G){e=P(G,"DIV",{class:!0,style:!0});var te=T(e);l=P(te,"DIV",{class:!0});var ne=T(l);t=P(ne,"DIV",{class:!0});var Q=T(t);r=P(Q,"DIV",{class:!0,"data-svelte-h":!0}),Ce(r)!=="svelte-1a2739d"&&(r.textContent=o),s=W(Q);for(let be=0;be<b.length;be+=1)b[be].l(Q);Q.forEach($),f=W(ne),i=P(ne,"DIV",{class:!0});var we=T(i);a=P(we,"DIV",{class:!0,"data-svelte-h":!0}),Ce(a)!=="svelte-bmmhtu"&&(a.textContent=d),h=W(we);for(let be=0;be<A.length;be+=1)A[be].l(we);we.forEach($),m=W(ne),k=P(ne,"DIV",{class:!0});var qe=T(k);V=P(qe,"DIV",{class:!0,"data-svelte-h":!0}),Ce(V)!=="svelte-17pe084"&&(V.textContent=H),R=W(qe);for(let be=0;be<K.length;be+=1)K[be].l(qe);qe.forEach($),ne.forEach($),X=W(te),q=P(te,"DIV",{class:!0});var ge=T(q);re(S.$$.fragment,ge),ge.forEach($),B=W(te),O=P(te,"DIV",{class:!0});var He=T(O);M=P(He,"DIV",{class:!0});var Se=T(M);L=P(Se,"DIV",{class:!0,"data-svelte-h":!0}),Ce(L)!=="svelte-68unf9"&&(L.textContent=c),p=W(Se);for(let be=0;be<Y.length;be+=1)Y[be].l(Se);Se.forEach($),He.forEach($),v=W(te),w=P(te,"DIV",{class:!0});var _e=T(w);I=ce(_e,"Head 1 of "),y=ce(_e,C),_e.forEach($),te.forEach($),this.h()},h(){_(r,"class","title svelte-1m1b7zh"),_(t,"class","column query"),_(a,"class","title svelte-1m1b7zh"),_(i,"class","column key"),_(V,"class","title svelte-1m1b7zh"),_(k,"class","column value"),_(l,"class","qkv flex h-full flex-col justify-center gap-[5rem] pl-[6rem]"),_(q,"class","resize-watch attention-matrix flex"),_(L,"class","title svelte-1m1b7zh"),_(M,"class","column out"),_(O,"class","head-out mx-[2rem]"),_(w,"class","head-title absolute bottom-2 right-3 text-right text-gray-400"),_(e,"class","head-block flex w-full items-center justify-between px-2"),_(e,"style",g=`height:${n[7]}px;`)},m(G,te){x(G,e,te),D(e,l),D(l,t),D(t,r),D(t,s);for(let ne=0;ne<b.length;ne+=1)b[ne]&&b[ne].m(t,null);D(l,f),D(l,i),D(i,a),D(i,h);for(let ne=0;ne<A.length;ne+=1)A[ne]&&A[ne].m(i,null);D(l,m),D(l,k),D(k,V),D(k,R);for(let ne=0;ne<K.length;ne+=1)K[ne]&&K[ne].m(k,null);D(e,X),D(e,q),se(S,q,null),D(e,B),D(e,O),D(O,M),D(M,L),D(M,p);for(let ne=0;ne<Y.length;ne+=1)Y[ne]&&Y[ne].m(M,null);D(e,v),D(e,w),D(w,I),D(w,y),u=!0},p(G,te){if(te&2){E=ve(G[1]);let Q;for(Q=0;Q<E.length;Q+=1){const we=ll(G,E,Q);b[Q]?b[Q].p(we,te):(b[Q]=al(we),b[Q].c(),b[Q].m(t,null))}for(;Q<b.length;Q+=1)b[Q].d(1);b.length=E.length}if(te&2){N=ve(G[1]);let Q;for(Q=0;Q<N.length;Q+=1){const we=tl(G,N,Q);A[Q]?A[Q].p(we,te):(A[Q]=cl(we),A[Q].c(),A[Q].m(i,null))}for(;Q<A.length;Q+=1)A[Q].d(1);A.length=N.length}if(te&2){j=ve(G[1]);let Q;for(Q=0;Q<j.length;Q+=1){const we=el(G,j,Q);K[Q]?K[Q].p(we,te):(K[Q]=fl(we),K[Q].c(),K[Q].m(k,null))}for(;Q<K.length;Q+=1)K[Q].d(1);K.length=j.length}const ne={};if(te&16&&(ne.data=G[4]),S.$set(ne),te&2){ue=ve(G[1]);let Q;for(Q=0;Q<ue.length;Q+=1){const we=Jt(G,ue,Q);Y[Q]?Y[Q].p(we,te):(Y[Q]=ul(we),Y[Q].c(),Y[Q].m(M,null))}for(;Q<Y.length;Q+=1)Y[Q].d(1);Y.length=ue.length}(!u||te&64)&&C!==(C=G[6].attention_head_num+"")&&Ve(y,C),(!u||te&128&&g!==(g=`height:${G[7]}px;`))&&_(e,"style",g)},i(G){u||(F(S.$$.fragment,G),u=!0)},o(G){Z(S.$$.fragment,G),u=!1},d(G){G&&$(e),Ne(b,G),Ne(A,G),Ne(K,G),ie(S),Ne(Y,G)}}}function qo(n){let e,l,t="<div>Multi-head Self Attention</div>",r,o,s,f,i,a,d,h,m,k,V,H,R,X,q,S,B,O,M,L,c,p,v,w,I;m=new xe({props:{triggeredBy:".attention .qkv-weighted",placement:"right",class:"popover text-sm font-light",$$slots:{default:[wo]},$$scope:{ctx:n}}}),V=new xe({props:{triggeredBy:".attention .query .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[yo]},$$scope:{ctx:n}}}),R=new xe({props:{triggeredBy:".attention .key .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Eo]},$$scope:{ctx:n}}}),q=new xe({props:{triggeredBy:".attention .value .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Io]},$$scope:{ctx:n}}}),B=new xe({props:{triggeredBy:".attention .out .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Do]},$$scope:{ctx:n}}});let C=ve(n[1]),y=[];for(let u=0;u<C.length;u+=1)y[u]=il(nl(n,C,u));const g=u=>Z(y[u],1,1,()=>{y[u]=null});return c=new uo({props:{$$slots:{default:[Co]},$$scope:{ctx:n}}}),{c(){e=z("div"),l=z("div"),l.innerHTML=t,r=U(),o=z("div"),s=z("div"),f=U(),i=z("div"),d=U(),h=z("div"),oe(m.$$.fragment),k=U(),oe(V.$$.fragment),H=U(),oe(R.$$.fragment),X=U(),oe(q.$$.fragment),S=U(),oe(B.$$.fragment),O=U();for(let u=0;u<y.length;u+=1)y[u].c();M=U(),L=z("div"),oe(c.$$.fragment),this.h()},l(u){e=P(u,"DIV",{class:!0});var E=T(e);l=P(E,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-n6swon"&&(l.innerHTML=t),r=W(E),o=P(E,"DIV",{class:!0});var b=T(o);s=P(b,"DIV",{class:!0}),T(s).forEach($),f=W(b),i=P(b,"DIV",{class:!0,style:!0}),T(i).forEach($),d=W(b),h=P(b,"DIV",{class:!0});var N=T(h);re(m.$$.fragment,N),k=W(N),re(V.$$.fragment,N),H=W(N),re(R.$$.fragment,N),X=W(N),re(q.$$.fragment,N),S=W(N),re(B.$$.fragment,N),O=W(N);for(let j=0;j<y.length;j+=1)y[j].l(N);N.forEach($),M=W(b),L=P(b,"DIV",{class:!0});var A=T(L);re(c.$$.fragment,A),A.forEach($),b.forEach($),E.forEach($),this.h()},h(){_(l,"class","title svelte-1m1b7zh"),_(l,"role","group"),_(s,"class","bounding transformer-bounding svelte-1m1b7zh"),le(s,"active",n[5]),_(i,"class","bounding attention-bounding svelte-1m1b7zh"),_(i,"style",a=`padding-bottom:${n[6].attention_head_num*ft.y}px`),le(i,"active",n[2]&&!n[8]),_(h,"class","column"),_(L,"class","heads svelte-1m1b7zh"),_(o,"class","content relative svelte-1m1b7zh"),_(e,"class",p=he(fe("attention",n[0]))+" svelte-1m1b7zh")},m(u,E){x(u,e,E),D(e,l),D(e,r),D(e,o),D(o,s),D(o,f),D(o,i),D(o,d),D(o,h),se(m,h,null),D(h,k),se(V,h,null),D(h,H),se(R,h,null),D(h,X),se(q,h,null),D(h,S),se(B,h,null),D(h,O);for(let b=0;b<y.length;b+=1)y[b]&&y[b].m(h,null);D(o,M),D(o,L),se(c,L,null),v=!0,w||(I=[ke(l,"mouseenter",n[9]),ke(l,"mouseleave",n[10])],w=!0)},p(u,[E]){(!v||E&32)&&le(s,"active",u[5]),(!v||E&64&&a!==(a=`padding-bottom:${u[6].attention_head_num*ft.y}px`))&&_(i,"style",a),(!v||E&260)&&le(i,"active",u[2]&&!u[8]);const b={};E&4194368&&(b.$$scope={dirty:E,ctx:u}),m.$set(b);const N={};E&4194368&&(N.$$scope={dirty:E,ctx:u}),V.$set(N);const A={};E&4194368&&(A.$$scope={dirty:E,ctx:u}),R.$set(A);const j={};E&4194368&&(j.$$scope={dirty:E,ctx:u}),q.$set(j);const K={};if(E&4194368&&(K.$$scope={dirty:E,ctx:u}),B.$set(K),E&10){C=ve(u[1]);let Y;for(Y=0;Y<C.length;Y+=1){const G=nl(u,C,Y);y[Y]?(y[Y].p(G,E),F(y[Y],1)):(y[Y]=il(G),y[Y].c(),F(y[Y],1),y[Y].m(h,null))}for(Me(),Y=C.length;Y<y.length;Y+=1)g(Y);Be()}const ue={};E&4194514&&(ue.$$scope={dirty:E,ctx:u}),c.$set(ue),(!v||E&1&&p!==(p=he(fe("attention",u[0]))+" svelte-1m1b7zh"))&&_(e,"class",p)},i(u){if(!v){F(m.$$.fragment,u),F(V.$$.fragment,u),F(R.$$.fragment,u),F(q.$$.fragment,u),F(B.$$.fragment,u);for(let E=0;E<C.length;E+=1)F(y[E]);F(c.$$.fragment,u),v=!0}},o(u){Z(m.$$.fragment,u),Z(V.$$.fragment,u),Z(R.$$.fragment,u),Z(q.$$.fragment,u),Z(B.$$.fragment,u),y=y.filter(Boolean);for(let E=0;E<y.length;E+=1)Z(y[E]);Z(c.$$.fragment,u),v=!1},d(u){u&&$(e),ie(m),ie(V),ie(R),ie(q),ie(B),Ne(y,u),ie(c),w=!1,je(I)}}}const So="bg-blue-200",Vo="bg-red-200",No="bg-green-200",bn="bg-blue-300",$n="bg-red-300",kn="bg-green-300",Ao="bg-purple-300";function Mo(n,e,l){let t,r,o,s,f,i;Ee(n,st,q=>l(1,r=q)),Ee(n,Qe,q=>l(13,o=q)),Ee(n,yt,q=>l(5,s=q)),Ee(n,$t,q=>l(6,f=q)),Ee(n,hn,q=>l(7,i=q));let{className:a=void 0}=e;At("block-id","attention");const d=Nt("block-id");let h=o.id===d,m=!1;function k(){l(2,m=!0)}function V(){l(2,m=!1)}let H=null;const R=q=>{l(3,H=q)},X=()=>{l(3,H=null)};return n.$$set=q=>{"className"in q&&l(0,a=q.className)},n.$$.update=()=>{n.$$.dirty&2&&l(4,t=Array(r.length).fill(0).map(q=>Array(r.length).fill(0).map(S=>Math.random())))},[a,r,m,H,t,s,f,i,h,k,V,R,X]}class Bo extends Pe{constructor(e){super(),Te(this,e,Mo,qo,ze,{className:0})}}function Lo(n){let e,l,t,r,o,s,f,i=n[3]&&hl(n);return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),i&&i.c(),o=Ie("path"),this.h()},l(a){e=P(a,"DIV",{class:!0});var d=T(e);l=P(d,"DIV",{class:!0}),T(l).forEach($),t=W(d),r=De(d,"svg",{class:!0});var h=T(r);i&&i.l(h),o=De(h,"path",{d:!0,class:!0}),T(o).forEach($),h.forEach($),d.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"d",s=`M0,0 L0,${n[6]}`),_(o,"class","svelte-1jqlo12"),_(r,"class","main svelte-1jqlo12"),_(e,"class",f=he(fe("residual residual-end cell",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(a,d){x(a,e,d),D(e,l),D(e,t),D(e,r),i&&i.m(r,null),D(r,o)},p(a,d){a[3]?i?i.p(a,d):(i=hl(a),i.c(),i.m(r,o)):i&&(i.d(1),i=null),d&64&&s!==(s=`M0,0 L0,${a[6]}`)&&_(o,"d",s),d&2&&f!==(f=he(fe("residual residual-end cell",a[1]))+" svelte-1jqlo12")&&_(e,"class",f),d&34&&le(e,"active",a[5])},d(a){a&&$(e),i&&i.d()}}}function zo(n){let e,l,t,r,o,s,f,i=n[3]&&dl(n);return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),i&&i.c(),o=Ie("path"),this.h()},l(a){e=P(a,"DIV",{class:!0});var d=T(e);l=P(d,"DIV",{class:!0}),T(l).forEach($),t=W(d),r=De(d,"svg",{class:!0});var h=T(r);i&&i.l(h),o=De(h,"path",{d:!0,class:!0}),T(o).forEach($),h.forEach($),d.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"d",s=`M0,0 L0,${n[6]}`),_(o,"class","svelte-1jqlo12"),_(r,"class","main svelte-1jqlo12"),_(e,"class",f=he(fe("residual residual-start cell",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(a,d){x(a,e,d),D(e,l),D(e,t),D(e,r),i&&i.m(r,null),D(r,o)},p(a,d){a[3]?i?i.p(a,d):(i=dl(a),i.c(),i.m(r,o)):i&&(i.d(1),i=null),d&64&&s!==(s=`M0,0 L0,${a[6]}`)&&_(o,"d",s),d&2&&f!==(f=he(fe("residual residual-start cell",a[1]))+" svelte-1jqlo12")&&_(e,"class",f),d&34&&le(e,"active",a[5])},d(a){a&&$(e),i&&i.d()}}}function Po(n){let e,l,t,r,o,s,f,i,a,d=n[4]&&pl();return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),o=Ie("circle"),s=Ie("path"),i=U(),d&&d.c(),this.h()},l(h){e=P(h,"DIV",{class:!0});var m=T(e);l=P(m,"DIV",{class:!0}),T(l).forEach($),t=W(m),r=De(m,"svg",{class:!0});var k=T(r);o=De(k,"circle",{class:!0,cx:!0,cy:!0,r:!0}),T(o).forEach($),s=De(k,"path",{class:!0,d:!0}),T(s).forEach($),k.forEach($),i=W(m),d&&d.l(m),m.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"class","icon svelte-1jqlo12"),_(o,"cx","50%"),_(o,"cy","50%"),_(o,"r","3"),_(s,"class","line svelte-1jqlo12"),_(s,"d",f=`
     M 0 0
    C 0 ${n[6]*.25}, ${n[6]*.2} ${n[6]*.25}, ${n[6]*.2} ${n[6]*.5}
    C ${n[6]*.2} ${n[6]*.75}, 0 ${n[6]*.75}, 0 ${n[6]}
  `),_(r,"class","main svelte-1jqlo12"),_(e,"class",a=he(fe("cell ln",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(h,m){x(h,e,m),D(e,l),D(e,t),D(e,r),D(r,o),D(r,s),D(e,i),d&&d.m(e,null)},p(h,m){m&64&&f!==(f=`
     M 0 0
    C 0 ${h[6]*.25}, ${h[6]*.2} ${h[6]*.25}, ${h[6]*.2} ${h[6]*.5}
    C ${h[6]*.2} ${h[6]*.75}, 0 ${h[6]*.75}, 0 ${h[6]}
  `)&&_(s,"d",f),h[4]?d||(d=pl(),d.c(),d.m(e,null)):d&&(d.d(1),d=null),m&2&&a!==(a=he(fe("cell ln",h[1]))+" svelte-1jqlo12")&&_(e,"class",a),m&34&&le(e,"active",h[5])},d(h){h&&$(e),d&&d.d()}}}function To(n){let e,l,t,r,o,s,f,i,a,d=n[4]&&gl();return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),o=Ie("path"),f=Ie("circle"),i=U(),d&&d.c(),this.h()},l(h){e=P(h,"DIV",{class:!0});var m=T(e);l=P(m,"DIV",{class:!0}),T(l).forEach($),t=W(m),r=De(m,"svg",{class:!0});var k=T(r);o=De(k,"path",{class:!0,d:!0}),T(o).forEach($),f=De(k,"circle",{class:!0,cx:!0,cy:!0,r:!0}),T(f).forEach($),k.forEach($),i=W(m),d&&d.l(m),m.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"class","line svelte-1jqlo12"),_(o,"d",s=`M0,0 L0,${n[6]}`),_(f,"class","icon svelte-1jqlo12"),_(f,"cx","50%"),_(f,"cy","50%"),_(f,"r","3"),_(r,"class","main svelte-1jqlo12"),_(e,"class",a=he(fe("cell dropout",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(h,m){x(h,e,m),D(e,l),D(e,t),D(e,r),D(r,o),D(r,f),D(e,i),d&&d.m(e,null)},p(h,m){m&64&&s!==(s=`M0,0 L0,${h[6]}`)&&_(o,"d",s),h[4]?d||(d=gl(),d.c(),d.m(e,null)):d&&(d.d(1),d=null),m&2&&a!==(a=he(fe("cell dropout",h[1]))+" svelte-1jqlo12")&&_(e,"class",a),m&34&&le(e,"active",h[5])},d(h){h&&$(e),d&&d.d()}}}function Ho(n){let e,l,t,r,o,s,f;return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),o=Ie("path"),s=Ie("circle"),this.h()},l(i){e=P(i,"DIV",{class:!0});var a=T(e);l=P(a,"DIV",{class:!0}),T(l).forEach($),t=W(a),r=De(a,"svg",{class:!0});var d=T(r);o=De(d,"path",{class:!0,d:!0}),T(o).forEach($),s=De(d,"circle",{class:!0,cx:!0,cy:!0,r:!0}),T(s).forEach($),d.forEach($),a.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"class","line line1 svelte-1jqlo12"),_(o,"d","M0,0 L0,90%"),_(s,"class","icon svelte-1jqlo12"),_(s,"cx","50%"),_(s,"cy","50%"),_(s,"r","3"),_(r,"class","main svelte-1jqlo12"),_(e,"class",f=he(fe("cell activation",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(i,a){x(i,e,a),D(e,l),D(e,t),D(e,r),D(r,o),D(r,s)},p(i,a){a&2&&f!==(f=he(fe("cell activation",i[1]))+" svelte-1jqlo12")&&_(e,"class",f),a&34&&le(e,"active",i[5])},d(i){i&&$(e)}}}function hl(n){let e;return{c(){e=Ie("path"),this.h()},l(l){e=De(l,"path",{id:!0,class:!0,d:!0}),T(e).forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class","head svelte-1jqlo12"),_(e,"d","M0,0 Q0,-16 -30,-16")},m(l,t){x(l,e,t)},p(l,t){t&1&&_(e,"id",l[0])},d(l){l&&$(e)}}}function dl(n){let e,l,t;return{c(){e=Ie("path"),l=Ie("text"),t=ae("Residual"),this.h()},l(r){e=De(r,"path",{id:!0,class:!0,d:!0}),T(e).forEach($),l=De(r,"text",{x:!0,y:!0,dy:!0,dx:!0,class:!0});var o=T(l);t=ce(o,"Residual"),o.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class","head svelte-1jqlo12"),_(e,"d","M0,0 Q0,-16 30,-16"),_(l,"x","30"),_(l,"y","-26"),_(l,"dy","4"),_(l,"dx","4"),_(l,"class","svelte-1jqlo12")},m(r,o){x(r,e,o),x(r,l,o),D(l,t)},p(r,o){o&1&&_(e,"id",r[0])},d(r){r&&($(e),$(l))}}}function pl(n){let e,l,t,r;return{c(){e=Ie("svg"),l=Ie("path"),t=Ie("text"),r=ae("Layer Normalization"),this.h()},l(o){e=De(o,"svg",{class:!0,width:!0});var s=T(e);l=De(s,"path",{d:!0,class:!0}),T(l).forEach($),t=De(s,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var f=T(t);r=ce(f,"Layer Normalization"),f.forEach($),s.forEach($),this.h()},h(){_(l,"d","M27.3536 4.35355C27.5488 4.15829 27.5488 3.84171 27.3536 3.64645L24.1716 0.46447C23.9763 0.269208 23.6597 0.269208 23.4645 0.464471C23.2692 0.659733 23.2692 0.976316 23.4645 1.17158L26.2929 4L23.4645 6.82843C23.2692 7.02369 23.2692 7.34028 23.4645 7.53554C23.6597 7.7308 23.9763 7.7308 24.1716 7.53554L27.3536 4.35355ZM27 3.5C20.3125 3.50001 15.2969 6.63952 11.5638 11.7944C7.84616 16.9278 5.39057 24.0677 3.75991 32.1346C0.498061 48.2711 0.5 68.3247 0.5 84H1.5C1.5 68.2984 1.50194 48.352 4.74009 32.3328C6.35943 24.3218 8.77884 17.3448 12.3737 12.3809C15.9531 7.4384 20.6875 4.50001 27 4.5V3.5Z"),_(l,"class","svelte-1jqlo12"),_(t,"x","4"),_(t,"y","95"),_(t,"text-anchor","middle"),_(t,"class","svelte-1jqlo12"),_(e,"class","guide svelte-1jqlo12"),_(e,"width","27px"),le(e,"active",!1)},m(o,s){x(o,e,s),D(e,l),D(e,t),D(t,r)},d(o){o&&$(e)}}}function gl(n){let e,l,t,r;return{c(){e=Ie("svg"),l=Ie("path"),t=Ie("text"),r=ae("Dropout"),this.h()},l(o){e=De(o,"svg",{class:!0,width:!0});var s=T(e);l=De(s,"path",{d:!0,class:!0}),T(l).forEach($),t=De(s,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var f=T(t);r=ce(f,"Dropout"),f.forEach($),s.forEach($),this.h()},h(){_(l,"d","M44.3186 4.46399C44.5314 4.28801 44.5613 3.97284 44.3853 3.76004L41.5175 0.292199C41.3416 0.0793953 41.0264 0.0495441 40.8136 0.225525C40.6008 0.401505 40.5709 0.716677 40.7469 0.929481L43.296 4.012L40.2135 6.56113C40.0007 6.73711 39.9709 7.05228 40.1468 7.26509C40.3228 7.47789 40.638 7.50774 40.8508 7.33176L44.3186 4.46399ZM44.0471 3.58091C38.7621 3.08034 27.8926 4.80481 18.3357 11.5838C8.74613 18.386 0.5 30.2626 0.5 50H1.5C1.5 30.5889 9.58721 19.0154 18.9143 12.3994C28.2741 5.76023 38.9045 4.0983 43.9529 4.57645L44.0471 3.58091Z"),_(l,"class","svelte-1jqlo12"),_(t,"x","4"),_(t,"y","60"),_(t,"text-anchor","middle"),_(t,"class","svelte-1jqlo12"),_(e,"class","guide svelte-1jqlo12"),_(e,"width","44px"),le(e,"active",!1)},m(o,s){x(o,e,s),D(e,l),D(e,t),D(t,r)},d(o){o&&$(e)}}}function Oo(n){let e;function l(o,s){if(o[2]==="activation")return Ho;if(o[2]==="dropout")return To;if(o[2]==="ln")return Po;if(o[2]==="residual-start")return zo;if(o[2]==="residual-end")return Lo}let t=l(n),r=t&&t(n);return{c(){r&&r.c(),e=nt()},l(o){r&&r.l(o),e=nt()},m(o,s){r&&r.m(o,s),x(o,e,s)},p(o,[s]){t===(t=l(o))&&r?r.p(o,s):(r&&r.d(1),r=t&&t(o),r&&(r.c(),r.m(e.parentNode,e)))},i:Le,o:Le,d(o){o&&$(e),r&&r.d(o)}}}function jo(n,e,l){let t;Ee(n,Vt,d=>l(6,t=d));let{id:r=void 0}=e,{className:o=void 0}=e,{type:s=void 0}=e,{head:f=!1}=e,{tail:i=!1}=e,{active:a=!1}=e;return n.$$set=d=>{"id"in d&&l(0,r=d.id),"className"in d&&l(1,o=d.className),"type"in d&&l(2,s=d.type),"head"in d&&l(3,f=d.head),"tail"in d&&l(4,i=d.tail),"active"in d&&l(5,a=d.active)},[r,o,s,f,i,a,t]}class It extends Pe{constructor(e){super(),Te(this,e,jo,Oo,ze,{id:0,className:1,type:2,head:3,tail:4,active:5})}}function ml(n,e,l){const t=n.slice();return t[6]=e[l],t[8]=l,t}function Go(n){let e,l=n[1].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&2&&l!==(l=o[1].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function vl(n){let e,l,t,r,o,s;return t=new lt({props:{colorScale:"blue"}}),{c(){e=z("div"),l=z("div"),oe(t.$$.fragment),o=U(),this.h()},l(f){e=P(f,"DIV",{class:!0});var i=T(e);l=P(i,"DIV",{class:!0});var a=T(l);re(t.$$.fragment,a),a.forEach($),o=W(i),i.forEach($),this.h()},h(){_(l,"class",r=he(fe("vector shrink-0 bg-blue-200",{"last-token":n[8]===n[3].length-1}))+" svelte-nx91yw"),_(e,"class","cell svelte-nx91yw"),le(e,"last",n[8]===n[3].length-1)},m(f,i){x(f,e,i),D(e,l),se(t,l,null),D(e,o),s=!0},p(f,i){(!s||i&8&&r!==(r=he(fe("vector shrink-0 bg-blue-200",{"last-token":f[8]===f[3].length-1}))+" svelte-nx91yw"))&&_(l,"class",r),(!s||i&8)&&le(e,"last",f[8]===f[3].length-1)},i(f){s||(F(t.$$.fragment,f),s=!0)},o(f){Z(t.$$.fragment,f),s=!1},d(f){f&&$(e),ie(t)}}}function Ro(n){let e,l,t,r,o,s,f,i,a,d,h,m,k=n[1].layer_num-1+"",V,H,R,X,q="Transformer<br/>Blocks",S,B,O,M,L,c="",p,v,w,I;o=new xe({props:{triggeredBy:".transformer-blocks .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Go]},$$scope:{ctx:n}}});let C=ve(n[3]),y=[];for(let u=0;u<C.length;u+=1)y[u]=vl(ml(n,C,u));const g=u=>Z(y[u],1,1,()=>{y[u]=null});return{c(){e=z("div"),l=z("div"),t=U(),r=z("div"),oe(o.$$.fragment),s=U(),f=z("div"),i=z("div"),a=Ie("svg"),d=Ie("path"),h=U(),m=z("div"),V=ae(k),H=ae(" more"),R=z("br"),X=z("span"),X.innerHTML=q,S=z("br"),B=ae("go here."),O=U();for(let u=0;u<y.length;u+=1)y[u].c();M=U(),L=z("div"),L.innerHTML=c,this.h()},l(u){e=P(u,"DIV",{class:!0,role:!0});var E=T(e);l=P(E,"DIV",{class:!0}),T(l).forEach($),t=W(E),r=P(E,"DIV",{class:!0});var b=T(r);re(o.$$.fragment,b),s=W(b),f=P(b,"DIV",{class:!0});var N=T(f);i=P(N,"DIV",{class:!0});var A=T(i);a=De(A,"svg",{class:!0,width:!0,height:!0,viewBox:!0,fill:!0});var j=T(a);d=De(j,"path",{d:!0,fill:!0}),T(d).forEach($),j.forEach($),h=W(A),m=P(A,"DIV",{class:!0});var K=T(m);V=ce(K,k),H=ce(K," more"),R=P(K,"BR",{}),X=P(K,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(X)!=="svelte-jj13a6"&&(X.innerHTML=q),S=P(K,"BR",{}),B=ce(K,"go here."),K.forEach($),A.forEach($),O=W(N);for(let ue=0;ue<y.length;ue+=1)y[ue].l(N);N.forEach($),M=W(b),L=P(b,"DIV",{class:!0,"data-svelte-h":!0}),Ce(L)!=="svelte-shkdve"&&(L.innerHTML=c),b.forEach($),E.forEach($),this.h()},h(){_(l,"class","title"),_(d,"d","M4.01159 29.4026C4.23396 29.5664 4.54695 29.5188 4.71068 29.2965L7.37882 25.6728C7.54255 25.4504 7.49501 25.1374 7.27264 24.9737C7.05028 24.81 6.73728 24.8575 6.57355 25.0799L4.20188 28.3009L0.980829 25.9292C0.758462 25.7655 0.445469 25.813 0.281739 26.0354C0.118009 26.2578 0.165543 26.5708 0.387911 26.7345L4.01159 29.4026ZM4.80238 28.9249C4.10481 24.3318 4.43981 17.4539 7.67418 11.7465C10.885 6.08071 16.9895 1.5 28 1.5V0.5C16.655 0.5 10.2048 5.25263 6.80417 11.2535C3.42706 17.2128 3.09382 24.3349 3.81372 29.0751L4.80238 28.9249Z"),_(d,"fill","#D1D5DB"),_(a,"class","arrow"),_(a,"width","28"),_(a,"height","30"),_(a,"viewBox","0 0 28 30"),_(a,"fill","none"),_(X,"class","highlight svelte-nx91yw"),_(m,"class","text svelte-nx91yw"),le(m,"active",n[2]),_(i,"class","guide flex items-end gap-1 svelte-nx91yw"),_(f,"class","column final relative svelte-nx91yw"),_(L,"class","second-column svelte-nx91yw"),_(r,"class","content svelte-nx91yw"),_(e,"class",p=he(fe("transformer-blocks",n[0]))+" svelte-nx91yw"),_(e,"role","group")},m(u,E){x(u,e,E),D(e,l),D(e,t),D(e,r),se(o,r,null),D(r,s),D(r,f),D(f,i),D(i,a),D(a,d),D(i,h),D(i,m),D(m,V),D(m,H),D(m,R),D(m,X),D(m,S),D(m,B),D(f,O);for(let b=0;b<y.length;b+=1)y[b]&&y[b].m(f,null);D(r,M),D(r,L),v=!0,w||(I=[ke(e,"mouseenter",n[4]),ke(e,"mouseleave",n[5])],w=!0)},p(u,[E]){const b={};if(E&514&&(b.$$scope={dirty:E,ctx:u}),o.$set(b),(!v||E&2)&&k!==(k=u[1].layer_num-1+"")&&Ve(V,k),(!v||E&4)&&le(m,"active",u[2]),E&8){C=ve(u[3]);let N;for(N=0;N<C.length;N+=1){const A=ml(u,C,N);y[N]?(y[N].p(A,E),F(y[N],1)):(y[N]=vl(A),y[N].c(),F(y[N],1),y[N].m(f,null))}for(Me(),N=C.length;N<y.length;N+=1)g(N);Be()}(!v||E&1&&p!==(p=he(fe("transformer-blocks",u[0]))+" svelte-nx91yw"))&&_(e,"class",p)},i(u){if(!v){F(o.$$.fragment,u);for(let E=0;E<C.length;E+=1)F(y[E]);v=!0}},o(u){Z(o.$$.fragment,u),y=y.filter(Boolean);for(let E=0;E<y.length;E+=1)Z(y[E]);v=!1},d(u){u&&$(e),ie(o),Ne(y,u),w=!1,je(I)}}}function Fo(n,e,l){let t,r,o;Ee(n,$t,a=>l(1,t=a)),Ee(n,yt,a=>l(2,r=a)),Ee(n,st,a=>l(3,o=a));let{className:s=void 0}=e;const f=()=>{yt.set(!0)},i=()=>{yt.set(!1)};return n.$$set=a=>{"className"in a&&l(0,s=a.className)},[s,t,r,o,f,i]}class xo extends Pe{constructor(e){super(),Te(this,e,Fo,Ro,ze,{className:0})}}function Uo(n){let e,l,t,r;return{c(){e=z("div"),l=Ie("svg"),t=Ie("g"),r=Ie("g"),this.h()},l(o){e=P(o,"DIV",{class:!0});var s=T(e);l=De(s,"svg",{class:!0});var f=T(l);t=De(f,"g",{class:!0}),T(t).forEach($),r=De(f,"g",{class:!0}),T(r).forEach($),f.forEach($),s.forEach($),this.h()},h(){_(t,"class","bars"),_(r,"class","bar-labels"),_(l,"class","h-full w-full"),_(e,"class","content-box probability grow svelte-8s3yoj")},m(o,s){x(o,e,s),D(e,l),D(l,t),D(l,r),n[5](l)},p:Le,i:Le,o:Le,d(o){o&&$(e),n[5](null)}}}const _l=4;let Wo=1;function Xo(n,e,l){let t,r;Ee(n,Mt,H=>l(6,t=H)),Ee(n,Et,H=>l(4,r=H));const{theme:o}=ht(dt);let{rowHeight:s}=e,{rowGap:f}=e,{hoveredIndex:i=null}=e,a,d=o.colors.gray[300],h=o.colors.blue[500],m=()=>{const H=r==null?void 0:r.prediction,R=r==null?void 0:r.sampled,X=Ue(a);let q=Wn().domain([0,Jn(H,S=>S.adjustedProbability)]).range([0,(a==null?void 0:a.clientWidth)-_t*3]);X.select("g.bars").selectAll("rect").data(H).join("rect").attr("x",0).attr("y",(S,B)=>B*s+B*f+s/2-_l/2).attr("height",_l).attr("width",S=>q(S.adjustedProbability)).attr("rx",1).attr("ry",1).attr("fill",(S,B)=>B===i?h:(R==null?void 0:R.rank)===B?Dt:d).on("mouseenter",function(S,B){l(1,i=B.rank),Ue(this).style("cursor","pointer")}).on("mouseleave",()=>l(1,i=null)).transition().ease(zn).duration(500).attr("width",S=>q(S.adjustedProbability)),X.select("g.bar-labels").selectAll("text").data(H).join("text").attr("fill",(S,B)=>B===i?h:(R==null?void 0:R.rank)===B?Dt:d).on("mouseenter",function(S,B){l(1,i=B.rank),Ue(this).style("cursor","pointer")}).on("mouseleave",()=>{l(1,i=null)}).attr("x",S=>.4*_t+q(S.adjustedProbability)).attr("y",(S,B)=>B*s+B*f).attr("dy",s/2+3).attr("text-anchor","start").style("font-size","0.75rem").transition().duration(500).tween("text",function(S){const B=Ue(this),O=Pn(B.text().replace("%",""),S.adjustedProbability*100);return function(M){B.text(O(M).toFixed(Wo)+"%")}})};bt(()=>{m()});const k=()=>{if(!a)return;const H=Ue(a);H.selectAll("g.bars rect").attr("fill",(R,X)=>X===i?h:(t==null?void 0:t.rank)===X?Dt:d),H.selectAll("g.bar-labels text").attr("fill",(R,X)=>X===i?h:(t==null?void 0:t.rank)===X?Dt:d)};function V(H){tt[H?"unshift":"push"](()=>{a=H,l(0,a)})}return n.$$set=H=>{"rowHeight"in H&&l(2,s=H.rowHeight),"rowGap"in H&&l(3,f=H.rowGap),"hoveredIndex"in H&&l(1,i=H.hoveredIndex)},n.$$.update=()=>{n.$$.dirty&17&&r&&a&&m(),n.$$.dirty&2&&i!==void 0&&k()},[a,i,s,f,r,V]}class Zo extends Pe{constructor(e){super(),Te(this,e,Xo,Uo,ze,{rowHeight:2,rowGap:3,hoveredIndex:1})}}function bl(n,e,l){const t=n.slice();return t[30]=e[l],t[32]=l,t}function $l(n,e,l){const t=n.slice();return t[33]=e[l],t[32]=l,t}function kl(n,e,l){const t=n.slice();return t[35]=e[l],t[32]=l,t}function Yo(n){let e,l=n[7][n[32]]+"",t,r;return{c(){e=ae("Token ID: "),t=ae(l),r=U()},l(o){e=ce(o,"Token ID: "),t=ce(o,l),r=W(o)},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s[0]&128&&l!==(l=o[7][o[32]]+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function wl(n){let e,l=n[35].token+"",t,r,o,s,f,i;function a(){return n[18](n[32])}return o=new xe({props:{class:"text-xs",placement:"left",type:"light",$$slots:{default:[Yo]},$$scope:{ctx:n}}}),{c(){e=z("div"),t=ae(l),r=U(),oe(o.$$.fragment),this.h()},l(d){e=P(d,"DIV",{role:!0,class:!0});var h=T(e);t=ce(h,l),h.forEach($),r=W(d),re(o.$$.fragment,d),this.h()},h(){var d;_(e,"role","group"),_(e,"class","text-box svelte-oxhaat"),le(e,"highlight",n[32]===n[3]),le(e,"sample_highlight",n[8]===n[32]),le(e,"final_token_highlight",((d=n[9])==null?void 0:d.rank)===n[32])},m(d,h){x(d,e,h),D(e,t),x(d,r,h),se(o,d,h),s=!0,f||(i=[ke(e,"mouseenter",a),ke(e,"mouseleave",n[19])],f=!0)},p(d,h){var k;n=d,(!s||h[0]&4)&&l!==(l=n[35].token+"")&&Ve(t,l),(!s||h[0]&8)&&le(e,"highlight",n[32]===n[3]),(!s||h[0]&256)&&le(e,"sample_highlight",n[8]===n[32]),(!s||h[0]&512)&&le(e,"final_token_highlight",((k=n[9])==null?void 0:k.rank)===n[32]);const m={};h[0]&128|h[1]&64&&(m.$$scope={dirty:h,ctx:n}),o.$set(m)},i(d){s||(F(o.$$.fragment,d),s=!0)},o(d){Z(o.$$.fragment,d),s=!1},d(d){d&&($(e),$(r)),ie(o,d),f=!1,je(i)}}}function yl(n){let e,l='<div class="title-box token-string !justify-end svelte-oxhaat"><div class="title-text svelte-oxhaat">Tokens</div></div> <div class="title-box logits svelte-oxhaat"><div class="title-text svelte-oxhaat">Logits</div></div> <div class="title-box exponents svelte-oxhaat"><div class="title-text svelte-oxhaat">Exponents</div></div> <div class="title-box probability svelte-oxhaat"><div class="title-text svelte-oxhaat">Probability</div></div>';return{c(){e=z("div"),e.innerHTML=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-16l107t"&&(e.innerHTML=l),this.h()},h(){_(e,"class","softmax-subtitle softmax-detail flex text-center text-xs opacity-0 svelte-oxhaat")},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function El(n){let e,l,t,r,o=ve(n[6]),s=[];for(let h=0;h<o.length;h+=1)s[h]=Dl($l(n,o,h));const f=h=>Z(s[h],1,1,()=>{s[h]=null});let i=ve(n[5]),a=[];for(let h=0;h<i.length;h+=1)a[h]=Cl(bl(n,i,h));const d=h=>Z(a[h],1,1,()=>{a[h]=null});return{c(){e=z("div");for(let h=0;h<s.length;h+=1)s[h].c();l=U(),t=z("div");for(let h=0;h<a.length;h+=1)a[h].c();this.h()},l(h){e=P(h,"DIV",{class:!0});var m=T(e);for(let V=0;V<s.length;V+=1)s[V].l(m);m.forEach($),l=W(h),t=P(h,"DIV",{class:!0});var k=T(t);for(let V=0;V<a.length;V+=1)a[V].l(k);k.forEach($),this.h()},h(){_(e,"class","content-box vector-box logits ml-2 svelte-oxhaat"),_(t,"class","content-box vector-box exponents svelte-oxhaat")},m(h,m){x(h,e,m);for(let k=0;k<s.length;k+=1)s[k]&&s[k].m(e,null);x(h,l,m),x(h,t,m);for(let k=0;k<a.length;k+=1)a[k]&&a[k].m(t,null);r=!0},p(h,m){if(m[0]&1864){o=ve(h[6]);let k;for(k=0;k<o.length;k+=1){const V=$l(h,o,k);s[k]?(s[k].p(V,m),F(s[k],1)):(s[k]=Dl(V),s[k].c(),F(s[k],1),s[k].m(e,null))}for(Me(),k=o.length;k<s.length;k+=1)f(k);Be()}if(m[0]&872){i=ve(h[5]);let k;for(k=0;k<i.length;k+=1){const V=bl(h,i,k);a[k]?(a[k].p(V,m),F(a[k],1)):(a[k]=Cl(V),a[k].c(),F(a[k],1),a[k].m(t,null))}for(Me(),k=i.length;k<a.length;k+=1)d(k);Be()}},i(h){if(!r){for(let m=0;m<o.length;m+=1)F(s[m]);for(let m=0;m<i.length;m+=1)F(a[m]);r=!0}},o(h){s=s.filter(Boolean);for(let m=0;m<s.length;m+=1)Z(s[m]);a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)Z(a[m]);r=!1},d(h){h&&($(e),$(l),$(t)),Ne(s,h),Ne(a,h)}}}function Il(n){let e,l=n[33].toFixed(2)+"",t,r,o,s,f,i;function a(){return n[20](n[32])}return o=new xe({props:{class:"text-xs",placement:"left",type:"light",$$slots:{default:[Ko]},$$scope:{ctx:n}}}),{c(){e=z("div"),t=ae(l),r=U(),oe(o.$$.fragment),this.h()},l(d){e=P(d,"DIV",{role:!0,class:!0});var h=T(e);t=ce(h,l),h.forEach($),r=W(d),re(o.$$.fragment,d),this.h()},h(){var d;_(e,"role","group"),_(e,"class","text-box text-center svelte-oxhaat"),le(e,"highlight",n[32]===n[3]),le(e,"sample_highlight",n[8]===n[32]),le(e,"final_token_highlight",((d=n[9])==null?void 0:d.rank)===n[32])},m(d,h){x(d,e,h),D(e,t),x(d,r,h),se(o,d,h),s=!0,f||(i=[ke(e,"mouseenter",a),ke(e,"mouseleave",n[21])],f=!0)},p(d,h){var k;n=d,(!s||h[0]&64)&&l!==(l=n[33].toFixed(2)+"")&&Ve(t,l),(!s||h[0]&8)&&le(e,"highlight",n[32]===n[3]),(!s||h[0]&256)&&le(e,"sample_highlight",n[8]===n[32]),(!s||h[0]&512)&&le(e,"final_token_highlight",((k=n[9])==null?void 0:k.rank)===n[32]);const m={};h[0]&1088|h[1]&64&&(m.$$scope={dirty:h,ctx:n}),o.$set(m)},i(d){s||(F(o.$$.fragment,d),s=!0)},o(d){Z(o.$$.fragment,d),s=!1},d(d){d&&($(e),$(r)),ie(o,d),f=!1,je(i)}}}function Ko(n){let e=(n[33]*n[10]).toFixed(2)+"",l,t,r,o,s=n[33].toFixed(2)+"",f,i;return{c(){l=ae(e),t=ae(" ÷ "),r=ae(n[10]),o=ae(" = "),f=ae(s),i=U()},l(a){l=ce(a,e),t=ce(a," ÷ "),r=ce(a,n[10]),o=ce(a," = "),f=ce(a,s),i=W(a)},m(a,d){x(a,l,d),x(a,t,d),x(a,r,d),x(a,o,d),x(a,f,d),x(a,i,d)},p(a,d){d[0]&1088&&e!==(e=(a[33]*a[10]).toFixed(2)+"")&&Ve(l,e),d[0]&1024&&Ve(r,a[10]),d[0]&64&&s!==(s=a[33].toFixed(2)+"")&&Ve(f,s)},d(a){a&&($(l),$(t),$(r),$(o),$(f),$(i))}}}function Dl(n){let e,l,t=n[33]!==void 0&&Il(n);return{c(){t&&t.c(),e=nt()},l(r){t&&t.l(r),e=nt()},m(r,o){t&&t.m(r,o),x(r,e,o),l=!0},p(r,o){r[33]!==void 0?t?(t.p(r,o),o[0]&64&&F(t,1)):(t=Il(r),t.c(),F(t,1),t.m(e.parentNode,e)):t&&(Me(),Z(t,1,1,()=>{t=null}),Be())},i(r){l||(F(t),l=!0)},o(r){Z(t),l=!1},d(r){r&&$(e),t&&t.d(r)}}}function Qo(n){let e,l=n[6][n[32]].toFixed(2)+"",t,r,o=n[30].toFixed(2)+"",s,f;return{c(){e=ae("exp("),t=ae(l),r=ae(") = "),s=ae(o),f=U()},l(i){e=ce(i,"exp("),t=ce(i,l),r=ce(i,") = "),s=ce(i,o),f=W(i)},m(i,a){x(i,e,a),x(i,t,a),x(i,r,a),x(i,s,a),x(i,f,a)},p(i,a){a[0]&64&&l!==(l=i[6][i[32]].toFixed(2)+"")&&Ve(t,l),a[0]&32&&o!==(o=i[30].toFixed(2)+"")&&Ve(s,o)},d(i){i&&($(e),$(t),$(r),$(s),$(f))}}}function Cl(n){let e,l=n[30].toExponential(2)+"",t,r,o,s,f,i;function a(){return n[22](n[32])}return o=new xe({props:{class:"text-xs",placement:"left",type:"light",$$slots:{default:[Qo]},$$scope:{ctx:n}}}),{c(){e=z("div"),t=ae(l),r=U(),oe(o.$$.fragment),this.h()},l(d){e=P(d,"DIV",{role:!0,class:!0});var h=T(e);t=ce(h,l),h.forEach($),r=W(d),re(o.$$.fragment,d),this.h()},h(){var d;_(e,"role","group"),_(e,"class","text-box text-center svelte-oxhaat"),le(e,"highlight",n[32]===n[3]),le(e,"sample_highlight",n[8]===n[32]),le(e,"final_token_highlight",((d=n[9])==null?void 0:d.rank)===n[32])},m(d,h){x(d,e,h),D(e,t),x(d,r,h),se(o,d,h),s=!0,f||(i=[ke(e,"mouseenter",a),ke(e,"mouseleave",n[23])],f=!0)},p(d,h){var k;n=d,(!s||h[0]&32)&&l!==(l=n[30].toExponential(2)+"")&&Ve(t,l),(!s||h[0]&8)&&le(e,"highlight",n[32]===n[3]),(!s||h[0]&256)&&le(e,"sample_highlight",n[8]===n[32]),(!s||h[0]&512)&&le(e,"final_token_highlight",((k=n[9])==null?void 0:k.rank)===n[32]);const m={};h[0]&96|h[1]&64&&(m.$$scope={dirty:h,ctx:n}),o.$set(m)},i(d){s||(F(o.$$.fragment,d),s=!0)},o(d){Z(o.$$.fragment,d),s=!1},d(d){d&&($(e),$(r)),ie(o,d),f=!1,je(i)}}}function Jo(n){let e,l,t="<div>Probabilities</div>",r,o,s,f,i,a,d,h,m,k,V,H,R,X,q,S,B,O,M,L,c=ve(n[2]),p=[];for(let g=0;g<c.length;g+=1)p[g]=wl(kl(n,c,g));const v=g=>Z(p[g],1,1,()=>{p[g]=null});let w=n[1]&&yl(),I=n[1]&&El(n);function C(g){n[24](g)}let y={rowGap:n[13],rowHeight:n[12]};return n[3]!==void 0&&(y.hoveredIndex=n[3]),q=new Zo({props:y}),tt.push(()=>Dn(q,"hoveredIndex",C)),{c(){e=z("div"),l=z("div"),l.innerHTML=t,r=U(),o=z("div"),s=z("div"),f=U(),i=z("div"),a=z("div");for(let g=0;g<p.length;g+=1)p[g].c();d=U(),h=z("div"),m=U(),k=z("div"),w&&w.c(),V=U(),H=z("div"),R=z("div"),I&&I.c(),X=U(),oe(q.$$.fragment),this.h()},l(g){e=P(g,"DIV",{class:!0,role:!0,tabindex:!0});var u=T(e);l=P(u,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-11ugyn5"&&(l.innerHTML=t),r=W(u),o=P(u,"DIV",{class:!0,style:!0});var E=T(o);s=P(E,"DIV",{class:!0}),T(s).forEach($),f=W(E),i=P(E,"DIV",{class:!0});var b=T(i);a=P(b,"DIV",{class:!0});var N=T(a);for(let ue=0;ue<p.length;ue+=1)p[ue].l(N);N.forEach($),d=W(b),h=P(b,"DIV",{class:!0}),T(h).forEach($),b.forEach($),m=W(E),k=P(E,"DIV",{class:!0});var A=T(k);w&&w.l(A),V=W(A),H=P(A,"DIV",{class:!0});var j=T(H);R=P(j,"DIV",{class:!0});var K=T(R);I&&I.l(K),K.forEach($),X=W(j),re(q.$$.fragment,j),j.forEach($),A.forEach($),E.forEach($),u.forEach($),this.h()},h(){_(l,"class","title expandable"),_(l,"role","group"),_(s,"class","bounding softmax-bounding svelte-oxhaat"),le(s,"active",n[4]&&!n[1]),_(a,"class","content-box token-string svelte-oxhaat"),_(h,"class","vector vocab opacity-1 w-0"),_(i,"class","first-column relative flex justify-end"),_(R,"class","softmax-detail expandable flex gap-2 opacity-0"),_(H,"class","content-row flex gap-2"),_(k,"class","resize-watch second-column flex flex-col svelte-oxhaat"),_(o,"class","content relative svelte-oxhaat"),_(o,"style",`--softmax-row-height: ${n[12]}px;--softmax-row-gap: ${n[13]}px`),_(e,"class",B=he(fe("softmax",n[0]))+" svelte-oxhaat"),_(e,"role","button"),_(e,"tabindex","0")},m(g,u){x(g,e,u),D(e,l),D(e,r),D(e,o),D(o,s),D(o,f),D(o,i),D(i,a);for(let E=0;E<p.length;E+=1)p[E]&&p[E].m(a,null);D(i,d),D(i,h),D(o,m),D(o,k),w&&w.m(k,null),D(k,V),D(k,H),D(H,R),I&&I.m(R,null),D(H,X),se(q,H,null),O=!0,M||(L=[ke(l,"mouseenter",n[14]),ke(l,"mouseleave",n[15]),ke(e,"click",n[11]),ke(e,"keydown",n[11])],M=!0)},p(g,u){if((!O||u[0]&18)&&le(s,"active",g[4]&&!g[1]),u[0]&908){c=ve(g[2]);let b;for(b=0;b<c.length;b+=1){const N=kl(g,c,b);p[b]?(p[b].p(N,u),F(p[b],1)):(p[b]=wl(N),p[b].c(),F(p[b],1),p[b].m(a,null))}for(Me(),b=c.length;b<p.length;b+=1)v(b);Be()}g[1]?w||(w=yl(),w.c(),w.m(k,V)):w&&(w.d(1),w=null),g[1]?I?(I.p(g,u),u[0]&2&&F(I,1)):(I=El(g),I.c(),F(I,1),I.m(R,null)):I&&(Me(),Z(I,1,1,()=>{I=null}),Be());const E={};!S&&u[0]&8&&(S=!0,E.hoveredIndex=g[3],En(()=>S=!1)),q.$set(E),(!O||u[0]&1&&B!==(B=he(fe("softmax",g[0]))+" svelte-oxhaat"))&&_(e,"class",B)},i(g){if(!O){for(let u=0;u<c.length;u+=1)F(p[u]);F(I),F(q.$$.fragment,g),O=!0}},o(g){p=p.filter(Boolean);for(let u=0;u<p.length;u+=1)Z(p[u]);Z(I),Z(q.$$.fragment,g),O=!1},d(g){g&&$(e),Ne(p,g),w&&w.d(),I&&I.d(),ie(q),M=!1,je(L)}}}function er(n,e,l){let t,r,o,s,f,i,a,d,h;Ee(n,Et,u=>l(16,f=u)),Ee(n,Qe,u=>l(17,i=u)),Ee(n,qn,u=>l(8,a=u)),Ee(n,Mt,u=>l(9,d=u)),Ee(n,jt,u=>l(10,h=u));let{className:m=void 0}=e;ht(dt),At("block-id","softmax");const k=Nt("block-id");let V=!1;const H=()=>{V?(Qe.set({id:null}),q()):(Qe.set({id:k}),X())};let R;const X=async()=>{R=ut.Flip.getState(".softmax .softmax-detail.expandable"),l(1,V=!0),await gt();const u=document.getElementById("main");u.style.justifyContent="end",await gt(),ut.Flip.from(R,{duration:1,ease:"power2.inOut"}),mt.to(".softmax-detail",{opacity:1,duration:.5,delay:.5})},q=async()=>{R=ut.Flip.getState(".softmax .softmax-detail.expandable"),l(1,V=!1),await gt(),await ut.Flip.from(R,{duration:.5,ease:"power2.inOut"}),mt.to(".softmax-detail",{opacity:0,duration:.5}),await gt();const u=document.getElementById("main");u.style.justifyContent="start"};let S=_t*1.2,B=.5*_t,O=null,M=!1;function L(){l(4,M=!0)}function c(){l(4,M=!1)}const p=u=>l(3,O=u),v=()=>l(3,O=null),w=u=>l(3,O=u),I=()=>l(3,O=null),C=u=>l(3,O=u),y=()=>l(3,O=null);function g(u){O=u,l(3,O)}return n.$$set=u=>{"className"in u&&l(0,m=u.className)},n.$$.update=()=>{n.$$.dirty[0]&131074&&i.id!==k&&V&&(l(1,V=!1),q()),n.$$.dirty[0]&65536&&l(2,t=(f==null?void 0:f.prediction)||[]),n.$$.dirty[0]&4&&l(7,r=t==null?void 0:t.map(u=>u.tokenId)),n.$$.dirty[0]&4&&l(6,o=(t==null?void 0:t.map(u=>u.adjustedLogit))||[]),n.$$.dirty[0]&4&&l(5,s=(t==null?void 0:t.map(u=>u.adjustedExp))||[])},[m,V,t,O,M,s,o,r,a,d,h,H,S,B,L,c,f,i,p,v,w,I,C,y,g]}class tr extends Pe{constructor(e){super(),Te(this,e,er,Jo,ze,{className:0},null,[-1,-1])}}function lr(n){let e,l="Drop out is";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-ohkp45"&&(e.textContent=l),this.h()},h(){_(e,"class","dropout-content")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function nr(n){let e,l;return e=new Bt({props:{class:fe("popover dropout-popover text-sm",n[1]),title:"Drop out",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,$$slots:{default:[lr]},$$scope:{ctx:n}}}),{c(){oe(e.$$.fragment)},l(t){re(e.$$.fragment,t)},m(t,r){se(e,t,r),l=!0},p(t,[r]){const o={};r&2&&(o.class=fe("popover dropout-popover text-sm",t[1])),r&1&&(o.offset=t[0]),r&4&&(o.triggeredBy=t[2]),r&8&&(o.trigger=t[3]),r&16&&(o.placement=t[4]),r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function or(n,e,l){let{offset:t=void 0}=e,{className:r=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,r=i.className),"triggeredBy"in i&&l(2,o=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,r,o,s,f]}class rr extends Pe{constructor(e){super(),Te(this,e,or,nr,ze,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function sr(n){let e,l="Layer normalization is";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-qw3l61"&&(e.textContent=l),this.h()},h(){_(e,"class","ln-content")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function ir(n){let e,l;return e=new Bt({props:{class:fe("popover ln-popover text-sm",n[1]),title:"Layer Normalization",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,$$slots:{default:[sr]},$$scope:{ctx:n}}}),{c(){oe(e.$$.fragment)},l(t){re(e.$$.fragment,t)},m(t,r){se(e,t,r),l=!0},p(t,[r]){const o={};r&2&&(o.class=fe("popover ln-popover text-sm",t[1])),r&1&&(o.offset=t[0]),r&4&&(o.triggeredBy=t[2]),r&8&&(o.trigger=t[3]),r&16&&(o.placement=t[4]),r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function ar(n,e,l){let{offset:t=void 0}=e,{className:r=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,r=i.className),"triggeredBy"in i&&l(2,o=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,r,o,s,f]}class cr extends Pe{constructor(e){super(),Te(this,e,ar,ir,ze,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function fr(n){let e,l=`The GELU (Gaussian Error Linear Unit) activation function combines linear and non-linear
		behavior by scaling inputs using the Gaussian cumulative distribution function. It retains small
		negative values for smoother gradients and is effective in models like BERT.`;return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1ri460b"&&(e.textContent=l),this.h()},h(){_(e,"class","activation-content svelte-60plg2")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function ur(n){let e,l;return e=new Bt({props:{class:fe("popover activation-popover text-sm",n[1]),title:"GeLu Activation",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,$$slots:{default:[fr]},$$scope:{ctx:n}}}),{c(){oe(e.$$.fragment)},l(t){re(e.$$.fragment,t)},m(t,r){se(e,t,r),l=!0},p(t,[r]){const o={};r&2&&(o.class=fe("popover activation-popover text-sm",t[1])),r&1&&(o.offset=t[0]),r&4&&(o.triggeredBy=t[2]),r&8&&(o.trigger=t[3]),r&16&&(o.placement=t[4]),r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function hr(n,e,l){let{offset:t=void 0}=e,{className:r=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,r=i.className),"triggeredBy"in i&&l(2,o=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,r,o,s,f]}class dr extends Pe{constructor(e){super(),Te(this,e,hr,ur,ze,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function pr(n){let e,l="Residual out is";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-124ixs1"&&(e.textContent=l),this.h()},h(){_(e,"class","residual-content")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function gr(n){let e,l;return e=new Bt({props:{class:fe("popover residual-popover text-sm",n[1]),title:"Residual",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,$$slots:{default:[pr]},$$scope:{ctx:n}}}),{c(){oe(e.$$.fragment)},l(t){re(e.$$.fragment,t)},m(t,r){se(e,t,r),l=!0},p(t,[r]){const o={};r&2&&(o.class=fe("popover residual-popover text-sm",t[1])),r&1&&(o.offset=t[0]),r&4&&(o.triggeredBy=t[2]),r&8&&(o.trigger=t[3]),r&16&&(o.placement=t[4]),r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function mr(n,e,l){let{offset:t=void 0}=e,{className:r=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,r=i.className),"triggeredBy"in i&&l(2,o=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,r,o,s,f]}class vr extends Pe{constructor(e){super(),Te(this,e,mr,gr,ze,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function ql(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Sl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Vl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Nl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Al(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function _r(n){let e,l,t,r,o,s,f=ve(n[4]),i=[];for(let d=0;d<f.length;d+=1)i[d]=Ml(ql(n,f,d));const a=d=>Z(i[d],1,1,()=>{i[d]=null});return{c(){e=z("div");for(let d=0;d<i.length;d+=1)i[d].c();this.h()},l(d){e=P(d,"DIV",{id:!0,class:!0,role:!0});var h=T(e);for(let m=0;m<i.length;m+=1)i[m].l(h);h.forEach($),this.h()},h(){_(e,"id",l=`${n[0]}-end`),_(e,"class",t=he(fe("operation-col column residual",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(d,h){x(d,e,h);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(e,null);r=!0,o||(s=[ke(e,"mouseenter",n[5]),ke(e,"mouseleave",n[6])],o=!0)},p(d,h){if(h&27){f=ve(d[4]);let m;for(m=0;m<f.length;m+=1){const k=ql(d,f,m);i[m]?(i[m].p(k,h),F(i[m],1)):(i[m]=Ml(k),i[m].c(),F(i[m],1),i[m].m(e,null))}for(Me(),m=f.length;m<i.length;m+=1)a(m);Be()}(!r||h&1&&l!==(l=`${d[0]}-end`))&&_(e,"id",l),(!r||h&2&&t!==(t=he(fe("operation-col column residual",d[1]))+" svelte-1ipty16"))&&_(e,"class",t)},i(d){if(!r){for(let h=0;h<f.length;h+=1)F(i[h]);r=!0}},o(d){i=i.filter(Boolean);for(let h=0;h<i.length;h+=1)Z(i[h]);r=!1},d(d){d&&$(e),Ne(i,d),o=!1,je(s)}}}function br(n){let e,l,t,r,o,s,f,i,a=ve(n[4]),d=[];for(let m=0;m<a.length;m+=1)d[m]=Bl(Sl(n,a,m));const h=m=>Z(d[m],1,1,()=>{d[m]=null});return t=new vr({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=z("div");for(let m=0;m<d.length;m+=1)d[m].c();l=U(),oe(t.$$.fragment),this.h()},l(m){e=P(m,"DIV",{id:!0,class:!0,role:!0});var k=T(e);for(let V=0;V<d.length;V+=1)d[V].l(k);l=W(k),re(t.$$.fragment,k),k.forEach($),this.h()},h(){_(e,"id",r=`${n[0]}-start`),_(e,"class",o=he(fe("operation-col column residual",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(m,k){x(m,e,k);for(let V=0;V<d.length;V+=1)d[V]&&d[V].m(e,null);D(e,l),se(t,e,null),s=!0,f||(i=[ke(e,"mouseenter",n[5]),ke(e,"mouseleave",n[6])],f=!0)},p(m,k){if(k&27){a=ve(m[4]);let H;for(H=0;H<a.length;H+=1){const R=Sl(m,a,H);d[H]?(d[H].p(R,k),F(d[H],1)):(d[H]=Bl(R),d[H].c(),F(d[H],1),d[H].m(e,l))}for(Me(),H=a.length;H<d.length;H+=1)h(H);Be()}const V={};k&1&&(V.triggeredBy=`#${m[0]}`),t.$set(V),(!s||k&1&&r!==(r=`${m[0]}-start`))&&_(e,"id",r),(!s||k&2&&o!==(o=he(fe("operation-col column residual",m[1]))+" svelte-1ipty16"))&&_(e,"class",o)},i(m){if(!s){for(let k=0;k<a.length;k+=1)F(d[k]);F(t.$$.fragment,m),s=!0}},o(m){d=d.filter(Boolean);for(let k=0;k<d.length;k+=1)Z(d[k]);Z(t.$$.fragment,m),s=!1},d(m){m&&$(e),Ne(d,m),ie(t),f=!1,je(i)}}}function $r(n){let e,l,t,r,o,s,f,i=ve(n[4]),a=[];for(let h=0;h<i.length;h+=1)a[h]=Ll(Vl(n,i,h));const d=h=>Z(a[h],1,1,()=>{a[h]=null});return t=new cr({props:{triggeredBy:`#${n[0]}`}}),{c(){e=z("div");for(let h=0;h<a.length;h+=1)a[h].c();l=U(),oe(t.$$.fragment),this.h()},l(h){e=P(h,"DIV",{id:!0,class:!0,role:!0});var m=T(e);for(let k=0;k<a.length;k+=1)a[k].l(m);l=W(m),re(t.$$.fragment,m),m.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class",r=he(fe("operation-col column ln",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(h,m){x(h,e,m);for(let k=0;k<a.length;k+=1)a[k]&&a[k].m(e,null);D(e,l),se(t,e,null),o=!0,s||(f=[ke(e,"mouseenter",n[11]),ke(e,"mouseleave",n[12])],s=!0)},p(h,m){if(m&26){i=ve(h[4]);let V;for(V=0;V<i.length;V+=1){const H=Vl(h,i,V);a[V]?(a[V].p(H,m),F(a[V],1)):(a[V]=Ll(H),a[V].c(),F(a[V],1),a[V].m(e,l))}for(Me(),V=i.length;V<a.length;V+=1)d(V);Be()}const k={};m&1&&(k.triggeredBy=`#${h[0]}`),t.$set(k),(!o||m&1)&&_(e,"id",h[0]),(!o||m&2&&r!==(r=he(fe("operation-col column ln",h[1]))+" svelte-1ipty16"))&&_(e,"class",r)},i(h){if(!o){for(let m=0;m<i.length;m+=1)F(a[m]);F(t.$$.fragment,h),o=!0}},o(h){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)Z(a[m]);Z(t.$$.fragment,h),o=!1},d(h){h&&$(e),Ne(a,h),ie(t),s=!1,je(f)}}}function kr(n){let e,l,t,r,o,s,f,i=ve(n[4]),a=[];for(let h=0;h<i.length;h+=1)a[h]=zl(Nl(n,i,h));const d=h=>Z(a[h],1,1,()=>{a[h]=null});return t=new rr({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=z("div");for(let h=0;h<a.length;h+=1)a[h].c();l=U(),oe(t.$$.fragment),this.h()},l(h){e=P(h,"DIV",{id:!0,class:!0,role:!0});var m=T(e);for(let k=0;k<a.length;k+=1)a[k].l(m);l=W(m),re(t.$$.fragment,m),m.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class",r=he(fe("operation-col column dropout",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(h,m){x(h,e,m);for(let k=0;k<a.length;k+=1)a[k]&&a[k].m(e,null);D(e,l),se(t,e,null),o=!0,s||(f=[ke(e,"mouseenter",n[9]),ke(e,"mouseleave",n[10])],s=!0)},p(h,m){if(m&26){i=ve(h[4]);let V;for(V=0;V<i.length;V+=1){const H=Nl(h,i,V);a[V]?(a[V].p(H,m),F(a[V],1)):(a[V]=zl(H),a[V].c(),F(a[V],1),a[V].m(e,l))}for(Me(),V=i.length;V<a.length;V+=1)d(V);Be()}const k={};m&1&&(k.triggeredBy=`#${h[0]}`),t.$set(k),(!o||m&1)&&_(e,"id",h[0]),(!o||m&2&&r!==(r=he(fe("operation-col column dropout",h[1]))+" svelte-1ipty16"))&&_(e,"class",r)},i(h){if(!o){for(let m=0;m<i.length;m+=1)F(a[m]);F(t.$$.fragment,h),o=!0}},o(h){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)Z(a[m]);Z(t.$$.fragment,h),o=!1},d(h){h&&$(e),Ne(a,h),ie(t),s=!1,je(f)}}}function wr(n){let e,l,t,r,o,s,f,i=ve(n[4]),a=[];for(let h=0;h<i.length;h+=1)a[h]=Pl(Al(n,i,h));const d=h=>Z(a[h],1,1,()=>{a[h]=null});return t=new dr({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=z("div");for(let h=0;h<a.length;h+=1)a[h].c();l=U(),oe(t.$$.fragment),this.h()},l(h){e=P(h,"DIV",{id:!0,class:!0,role:!0});var m=T(e);for(let k=0;k<a.length;k+=1)a[k].l(m);l=W(m),re(t.$$.fragment,m),m.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class",r=he(fe("operation-col column activation",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(h,m){x(h,e,m);for(let k=0;k<a.length;k+=1)a[k]&&a[k].m(e,null);D(e,l),se(t,e,null),o=!0,s||(f=[ke(e,"mouseenter",n[7]),ke(e,"mouseleave",n[8])],s=!0)},p(h,m){if(m&26){i=ve(h[4]);let V;for(V=0;V<i.length;V+=1){const H=Al(h,i,V);a[V]?(a[V].p(H,m),F(a[V],1)):(a[V]=Pl(H),a[V].c(),F(a[V],1),a[V].m(e,l))}for(Me(),V=i.length;V<a.length;V+=1)d(V);Be()}const k={};m&1&&(k.triggeredBy=`#${h[0]}`),t.$set(k),(!o||m&1)&&_(e,"id",h[0]),(!o||m&2&&r!==(r=he(fe("operation-col column activation",h[1]))+" svelte-1ipty16"))&&_(e,"class",r)},i(h){if(!o){for(let m=0;m<i.length;m+=1)F(a[m]);F(t.$$.fragment,h),o=!0}},o(h){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)Z(a[m]);Z(t.$$.fragment,h),o=!1},d(h){h&&$(e),Ne(a,h),ie(t),s=!1,je(f)}}}function Ml(n){let e,l;return e=new It({props:{id:n[0],className:fe(n[1],{last:n[16]===n[4].length-1}),type:"residual-end",head:n[16]===0,active:n[3]}}),{c(){oe(e.$$.fragment)},l(t){re(e.$$.fragment,t)},m(t,r){se(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.id=t[0]),r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function Bl(n){let e,l;return e=new It({props:{id:n[0],className:fe(n[1],{last:n[16]===n[4].length-1}),type:"residual-start",head:n[16]===0,active:n[3]}}),{c(){oe(e.$$.fragment)},l(t){re(e.$$.fragment,t)},m(t,r){se(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.id=t[0]),r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function Ll(n){let e,l;return e=new It({props:{className:fe(n[1],{last:n[16]===n[4].length-1}),type:"ln",tail:n[16]===n[4].length-1,active:n[3]}}),{c(){oe(e.$$.fragment)},l(t){re(e.$$.fragment,t)},m(t,r){se(e,t,r),l=!0},p(t,r){const o={};r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&16&&(o.tail=t[16]===t[4].length-1),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function zl(n){let e,l;return e=new It({props:{className:fe(n[1],{last:n[16]===n[4].length-1}),type:"dropout",tail:n[16]===n[4].length-1,active:n[3]}}),{c(){oe(e.$$.fragment)},l(t){re(e.$$.fragment,t)},m(t,r){se(e,t,r),l=!0},p(t,r){const o={};r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&16&&(o.tail=t[16]===t[4].length-1),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function Pl(n){let e,l;return e=new It({props:{className:fe(n[1],{last:n[16]===n[4].length-1}),type:"activation",tail:n[16]===n[4].length-1,active:n[3]}}),{c(){oe(e.$$.fragment)},l(t){re(e.$$.fragment,t)},m(t,r){se(e,t,r),l=!0},p(t,r){const o={};r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&16&&(o.tail=t[16]===t[4].length-1),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function yr(n){let e,l,t,r;const o=[wr,kr,$r,br,_r],s=[];function f(i,a){return i[2]==="activation"?0:i[2]==="dropout"?1:i[2]==="ln"?2:i[2]==="residual-start"?3:i[2]==="residual-end"?4:-1}return~(e=f(n))&&(l=s[e]=o[e](n)),{c(){l&&l.c(),t=nt()},l(i){l&&l.l(i),t=nt()},m(i,a){~e&&s[e].m(i,a),x(i,t,a),r=!0},p(i,[a]){let d=e;e=f(i),e===d?~e&&s[e].p(i,a):(l&&(Me(),Z(s[d],1,1,()=>{s[d]=null}),Be()),~e?(l=s[e],l?l.p(i,a):(l=s[e]=o[e](i),l.c()),F(l,1),l.m(t.parentNode,t)):l=null)},i(i){r||(F(l),r=!0)},o(i){Z(l),r=!1},d(i){i&&$(t),~e&&s[e].d(i)}}}function Er(n,e,l){let t;Ee(n,st,X=>l(4,t=X));let{id:r}=e,{className:o=void 0}=e,{type:s=void 0}=e,f=!1;const i=()=>{l(3,f=!0);const X=document.querySelector(`#${r}-start`),q=document.querySelector(`#${r}-end`),S=Ue(`.residual-connector.${r}`);S.style("opacity",1),d(S),X==null||X.classList.add("active"),q==null||q.classList.add("active")},a=()=>{l(3,f=!1);const X=document.querySelector(`#${r}-start`),q=document.querySelector(`#${r}-end`);Ue(`.residual-connector.${r}`).style("opacity",0),X==null||X.classList.remove("active"),q==null||q.classList.remove("active")},d=X=>{const q=X.node().getTotalLength();X.attr("stroke-dasharray",q+" "+q).attr("stroke-dashoffset",q).transition().duration(300).attr("stroke-dashoffset",0)},h=()=>{l(3,f=!0)},m=()=>{l(3,f=!1)},k=()=>{l(3,f=!0)},V=()=>{l(3,f=!1)},H=()=>{l(3,f=!0)},R=()=>{l(3,f=!1)};return n.$$set=X=>{"id"in X&&l(0,r=X.id),"className"in X&&l(1,o=X.className),"type"in X&&l(2,s=X.type)},[r,o,s,f,t,i,a,h,m,k,V,H,R]}class et extends Pe{constructor(e){super(),Te(this,e,Er,yr,ze,{id:0,className:1,type:2})}}function Tl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Hl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Ol(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function jl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Gl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Rl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Fl(n){let e,l="Token";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-6k2z6t"&&(e.textContent=l),this.h()},h(){_(e,"class","subtitle embedding-detail svelte-1r50q6i")},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function xl(n){let e,l,t=n[21]+"",r;return{c(){e=z("div"),l=z("span"),r=ae(t),this.h()},l(o){e=P(o,"DIV",{class:!0});var s=T(e);l=P(s,"SPAN",{class:!0});var f=T(l);r=ce(f,t),f.forEach($),s.forEach($),this.h()},h(){_(l,"class","label svelte-1r50q6i"),_(e,"class","cell svelte-1r50q6i"),le(e,"last",n[23]===n[3].length-1)},m(o,s){x(o,e,s),D(e,l),D(l,r)},p(o,s){s&8&&t!==(t=o[21]+"")&&Ve(r,t),s&8&&le(e,"last",o[23]===o[3].length-1)},d(o){o&&$(e)}}}function Ul(n){let e,l,t,r,o,s="Token Embedding",f,i,a,d,h,m,k,V,H="Positional Embedding",R,X,q,S,B;e=new xe({props:{triggeredBy:".embedding .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Ir]},$$scope:{ctx:n}}}),f=new Xt({props:{id:"token-embedding",$$slots:{default:[Dr]},$$scope:{ctx:n}}});let O=ve(n[3]),M=[];for(let g=0;g<O.length;g+=1)M[g]=Wl(Gl(n,O,g));const L=g=>Z(M[g],1,1,()=>{M[g]=null});let c=ve(n[3]),p=[];for(let g=0;g<c.length;g+=1)p[g]=Xl(jl(n,c,g));R=new Xt({props:{id:"position-embedding",$$slots:{default:[Sr]},$$scope:{ctx:n}}});let v=ve(n[3]),w=[];for(let g=0;g<v.length;g+=1)w[g]=Zl(Ol(n,v,g));const I=g=>Z(w[g],1,1,()=>{w[g]=null});let C=ve(n[3]),y=[];for(let g=0;g<C.length;g+=1)y[g]=Yl(Hl(n,C,g));return{c(){oe(e.$$.fragment),l=U(),t=z("div"),r=z("div"),o=z("span"),o.textContent=s,oe(f.$$.fragment),i=U();for(let g=0;g<M.length;g+=1)M[g].c();a=U(),d=z("div");for(let g=0;g<p.length;g+=1)p[g].c();h=U(),m=z("div"),k=z("div"),V=z("span"),V.textContent=H,oe(R.$$.fragment),X=U();for(let g=0;g<w.length;g+=1)w[g].c();q=U(),S=z("div");for(let g=0;g<y.length;g+=1)y[g].c();this.h()},l(g){re(e.$$.fragment,g),l=W(g),t=P(g,"DIV",{class:!0});var u=T(t);r=P(u,"DIV",{class:!0});var E=T(r);o=P(E,"SPAN",{"data-svelte-h":!0}),Ce(o)!=="svelte-mkgxme"&&(o.textContent=s),re(f.$$.fragment,E),E.forEach($),i=W(u);for(let K=0;K<M.length;K+=1)M[K].l(u);u.forEach($),a=W(g),d=P(g,"DIV",{class:!0});var b=T(d);for(let K=0;K<p.length;K+=1)p[K].l(b);b.forEach($),h=W(g),m=P(g,"DIV",{class:!0});var N=T(m);k=P(N,"DIV",{class:!0});var A=T(k);V=P(A,"SPAN",{"data-svelte-h":!0}),Ce(V)!=="svelte-w2vnbx"&&(V.textContent=H),re(R.$$.fragment,A),A.forEach($),X=W(N);for(let K=0;K<w.length;K+=1)w[K].l(N);N.forEach($),q=W(g),S=P(g,"DIV",{class:!0});var j=T(S);for(let K=0;K<y.length;K+=1)y[K].l(j);j.forEach($),this.h()},h(){_(r,"class","subtitle flex items-center gap-1 svelte-1r50q6i"),_(t,"class","column token-embedding embedding-detail svelte-1r50q6i"),_(d,"class","column symbol embedding-detail svelte-1r50q6i"),_(k,"class","subtitle flex gap-1 svelte-1r50q6i"),_(m,"class","column embedding-detail position-embedding svelte-1r50q6i"),_(S,"class","column symbol embedding-d etail svelte-1r50q6i")},m(g,u){se(e,g,u),x(g,l,u),x(g,t,u),D(t,r),D(r,o),se(f,r,null),D(t,i);for(let E=0;E<M.length;E+=1)M[E]&&M[E].m(t,null);x(g,a,u),x(g,d,u);for(let E=0;E<p.length;E+=1)p[E]&&p[E].m(d,null);x(g,h,u),x(g,m,u),D(m,k),D(k,V),se(R,k,null),D(m,X);for(let E=0;E<w.length;E+=1)w[E]&&w[E].m(m,null);x(g,q,u),x(g,S,u);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(S,null);B=!0},p(g,u){const E={};u&536870928&&(E.$$scope={dirty:u,ctx:g}),e.$set(E);const b={};if(u&536870912&&(b.$$scope={dirty:u,ctx:g}),f.$set(b),u&8){O=ve(g[3]);let A;for(A=0;A<O.length;A+=1){const j=Gl(g,O,A);M[A]?(M[A].p(j,u),F(M[A],1)):(M[A]=Wl(j),M[A].c(),F(M[A],1),M[A].m(t,null))}for(Me(),A=O.length;A<M.length;A+=1)L(A);Be()}if(u&8){c=ve(g[3]);let A;for(A=0;A<c.length;A+=1){const j=jl(g,c,A);p[A]?p[A].p(j,u):(p[A]=Xl(),p[A].c(),p[A].m(d,null))}for(;A<p.length;A+=1)p[A].d(1);p.length=c.length}const N={};if(u&536870912&&(N.$$scope={dirty:u,ctx:g}),R.$set(N),u&40){v=ve(g[3]);let A;for(A=0;A<v.length;A+=1){const j=Ol(g,v,A);w[A]?(w[A].p(j,u),F(w[A],1)):(w[A]=Zl(j),w[A].c(),F(w[A],1),w[A].m(m,null))}for(Me(),A=v.length;A<w.length;A+=1)I(A);Be()}if(u&8){C=ve(g[3]);let A;for(A=0;A<C.length;A+=1){const j=Hl(g,C,A);y[A]?y[A].p(j,u):(y[A]=Yl(),y[A].c(),y[A].m(S,null))}for(;A<y.length;A+=1)y[A].d(1);y.length=C.length}},i(g){if(!B){F(e.$$.fragment,g),F(f.$$.fragment,g);for(let u=0;u<O.length;u+=1)F(M[u]);F(R.$$.fragment,g);for(let u=0;u<v.length;u+=1)F(w[u]);B=!0}},o(g){Z(e.$$.fragment,g),Z(f.$$.fragment,g),M=M.filter(Boolean);for(let u=0;u<M.length;u+=1)Z(M[u]);Z(R.$$.fragment,g),w=w.filter(Boolean);for(let u=0;u<w.length;u+=1)Z(w[u]);B=!1},d(g){g&&($(l),$(t),$(a),$(d),$(h),$(m),$(q),$(S)),ie(e,g),ie(f),Ne(M,g),Ne(p,g),ie(R),Ne(w,g),Ne(y,g)}}}function Ir(n){let e,l=n[4].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&16&&l!==(l=o[4].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Dr(n){let e;return{c(){e=ae("Token Embedding is")},l(l){e=ce(l,"Token Embedding is")},m(l,t){x(l,e,t)},d(l){l&&$(e)}}}function Cr(n){let e,l='<span>look up</span><svg class="h-3 w-3 text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="m21 21-3.5-3.5M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"></path></svg>';return{c(){e=z("div"),e.innerHTML=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-bcqwtg"&&(e.innerHTML=l),this.h()},h(){_(e,"class","look-up flex items-center gap-1")},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function qr(n){let e,l="id",t;return{c(){e=z("span"),e.textContent=l,t=z("br"),this.h()},l(r){e=P(r,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1e13gni"&&(e.textContent=l),t=P(r,"BR",{}),this.h()},h(){_(e,"class","label svelte-1r50q6i")},m(r,o){x(r,e,o),x(r,t,o)},d(r){r&&($(e),$(t))}}}function Wl(n){let e,l,t,r,o,s,f,i,a,d,h,m,k,V,H=(Math.random()*1e4).toFixed()+"",R,X,q,S=n[23]===0&&Cr();d=new lt({props:{active:!0}});let B=n[23]===0&&qr();return{c(){e=z("div"),l=z("div"),t=z("div"),S&&S.c(),r=U(),o=Ie("svg"),s=Ie("path"),f=U(),i=z("div"),a=z("div"),oe(d.$$.fragment),h=U(),m=z("span"),B&&B.c(),k=U(),V=z("span"),R=ae(H),X=U(),this.h()},l(O){e=P(O,"DIV",{class:!0});var M=T(e);l=P(M,"DIV",{class:!0});var L=T(l);t=P(L,"DIV",{class:!0});var c=T(t);S&&S.l(c),r=W(c),o=De(c,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var p=T(o);s=De(p,"path",{fill:!0,d:!0}),T(s).forEach($),p.forEach($),c.forEach($),L.forEach($),f=W(M),i=P(M,"DIV",{class:!0});var v=T(i);a=P(v,"DIV",{class:!0});var w=T(a);re(d.$$.fragment,w),w.forEach($),h=W(v),m=P(v,"SPAN",{class:!0});var I=T(m);B&&B.l(I),k=W(I),V=P(I,"SPAN",{class:!0});var C=T(V);R=ce(C,H),C.forEach($),I.forEach($),v.forEach($),X=W(M),M.forEach($),this.h()},h(){_(s,"fill","currentColor"),_(s,"d","M30.3886 4.74352C30.5839 4.54826 30.5839 4.23168 30.3886 4.03642L27.2067 0.854435C27.0114 0.659173 26.6948 0.659173 26.4996 0.854435C26.3043 1.0497 26.3043 1.36628 26.4996 1.56154L29.328 4.38997L26.4996 7.2184C26.3043 7.41366 26.3043 7.73024 26.4996 7.9255C26.6948 8.12076 27.0114 8.12076 27.2067 7.9255L30.3886 4.74352ZM0.31958 4.88997H30.0351V3.88997H0.31958V4.88997Z"),_(o,"xmlns","http://www.w3.org/2000/svg"),_(o,"viewBox","0 0 31 9"),_(o,"fill","none"),_(o,"class","w-10 text-gray-300"),_(t,"class","flex flex-col items-center"),_(l,"class","vocab-index ellipsis flex items-center text-right text-xs text-gray-400 svelte-1r50q6i"),_(a,"class",he(`vector ${Ft}`)+" svelte-1r50q6i"),_(V,"class","val svelte-1r50q6i"),_(m,"class","index-val text-xs svelte-1r50q6i"),_(i,"class","cell flex items-center svelte-1r50q6i"),_(e,"class","token-id flex items-center")},m(O,M){x(O,e,M),D(e,l),D(l,t),S&&S.m(t,null),D(t,r),D(t,o),D(o,s),D(e,f),D(e,i),D(i,a),se(d,a,null),D(i,h),D(i,m),B&&B.m(m,null),D(m,k),D(m,V),D(V,R),D(e,X),q=!0},p:Le,i(O){q||(F(d.$$.fragment,O),q=!0)},o(O){Z(d.$$.fragment,O),q=!1},d(O){O&&$(e),S&&S.d(),ie(d),B&&B.d()}}}function Xl(n){let e,l="+";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-124y0va"&&(e.textContent=l),this.h()},h(){_(e,"class","cell svelte-1r50q6i")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function Sr(n){let e;return{c(){e=ae("Positional Embedding is")},l(l){e=ce(l,"Positional Embedding is")},m(l,t){x(l,e,t)},d(l){l&&$(e)}}}function Vr(n){let e,l="poition",t;return{c(){e=z("span"),e.textContent=l,t=z("br"),this.h()},l(r){e=P(r,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1fb2ksh"&&(e.textContent=l),t=P(r,"BR",{}),this.h()},h(){_(e,"class","label svelte-1r50q6i")},m(r,o){x(r,e,o),x(r,t,o)},d(r){r&&($(e),$(t))}}}function Zl(n){let e,l,t,r,o,s,f,i,a,d;t=new lt({props:{active:!0,colorScale:n[10]}});let h=n[23]===0&&Vr();return{c(){e=z("div"),l=z("div"),oe(t.$$.fragment),r=U(),o=z("span"),h&&h.c(),s=U(),f=z("span"),i=ae(n[23]),a=U(),this.h()},l(m){e=P(m,"DIV",{class:!0});var k=T(e);l=P(k,"DIV",{class:!0});var V=T(l);re(t.$$.fragment,V),V.forEach($),r=W(k),o=P(k,"SPAN",{class:!0});var H=T(o);h&&h.l(H),s=W(H),f=P(H,"SPAN",{class:!0});var R=T(f);i=ce(R,n[23]),R.forEach($),H.forEach($),a=W(k),k.forEach($),this.h()},h(){_(l,"class",he(`vector ${Ft}`)+" svelte-1r50q6i"),_(f,"class","val svelte-1r50q6i"),_(o,"class","index-val text-xs svelte-1r50q6i"),_(e,"class","cell flex items-center svelte-1r50q6i")},m(m,k){x(m,e,k),D(e,l),se(t,l,null),D(e,r),D(e,o),h&&h.m(o,null),D(o,s),D(o,f),D(f,i),D(e,a),d=!0},p:Le,i(m){d||(F(t.$$.fragment,m),d=!0)},o(m){Z(t.$$.fragment,m),d=!1},d(m){m&&$(e),ie(t),h&&h.d()}}}function Yl(n){let e,l="=";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1btrmmo"&&(e.textContent=l),this.h()},h(){_(e,"class","cell svelte-1r50q6i")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function Nr(n){let e,l=n[4].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&16&&l!==(l=o[4].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Kl(n){let e,l,t,r;return l=new lt({props:{active:n[2]||n[1]}}),{c(){e=z("div"),oe(l.$$.fragment),t=U(),this.h()},l(o){e=P(o,"DIV",{class:!0});var s=T(e);re(l.$$.fragment,s),t=W(s),s.forEach($),this.h()},h(){_(e,"class",he(`vector ${Ft}`)+" svelte-1r50q6i"),le(e,"last",n[23]===n[3].length-1)},m(o,s){x(o,e,s),se(l,e,null),D(e,t),r=!0},p(o,s){const f={};s&6&&(f.active=o[2]||o[1]),l.$set(f),(!r||s&8)&&le(e,"last",o[23]===o[3].length-1)},i(o){r||(F(l.$$.fragment,o),r=!0)},o(o){Z(l.$$.fragment,o),r=!1},d(o){o&&$(e),ie(l)}}}function Ar(n){let e,l,t="<div>Embedding</div>",r,o,s,f,i,a,d,h,m,k,V,H,R,X,q,S,B,O,M,L,c,p,v,w=n[1]&&Fl(),I=ve(n[3]),C=[];for(let b=0;b<I.length;b+=1)C[b]=xl(Rl(n,I,b));let y=n[1]&&Ul(n);V=new xe({props:{triggeredBy:".embedding .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Nr]},$$scope:{ctx:n}}});let g=ve(n[3]),u=[];for(let b=0;b<g.length;b+=1)u[b]=Kl(Tl(n,g,b));const E=b=>Z(u[b],1,1,()=>{u[b]=null});return q=new et({props:{type:"dropout",id:"embedding-dropout"}}),B=new et({props:{type:"residual-start",id:"residual-first"}}),M=new et({props:{type:"ln",id:"embedding-ln"}}),{c(){e=z("div"),l=z("div"),l.innerHTML=t,r=U(),o=z("div"),s=z("div"),f=z("div"),w&&w.c(),i=U();for(let b=0;b<C.length;b+=1)C[b].c();a=U(),d=z("div"),h=U(),y&&y.c(),m=U(),k=z("div"),oe(V.$$.fragment),H=U(),R=z("div");for(let b=0;b<u.length;b+=1)u[b].c();X=U(),oe(q.$$.fragment),S=U(),oe(B.$$.fragment),O=U(),oe(M.$$.fragment),this.h()},l(b){e=P(b,"DIV",{class:!0,role:!0,tabindex:!0});var N=T(e);l=P(N,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-gfbk07"&&(l.innerHTML=t),r=W(N),o=P(N,"DIV",{class:!0});var A=T(o);s=P(A,"DIV",{class:!0});var j=T(s);f=P(j,"DIV",{class:!0});var K=T(f);w&&w.l(K),i=W(K);for(let G=0;G<C.length;G+=1)C[G].l(K);a=W(K),d=P(K,"DIV",{class:!0}),T(d).forEach($),K.forEach($),h=W(j),y&&y.l(j),j.forEach($),m=W(A),k=P(A,"DIV",{class:!0});var ue=T(k);re(V.$$.fragment,ue),H=W(ue),R=P(ue,"DIV",{class:!0});var Y=T(R);for(let G=0;G<u.length;G+=1)u[G].l(Y);Y.forEach($),X=W(ue),re(q.$$.fragment,ue),S=W(ue),re(B.$$.fragment,ue),O=W(ue),re(M.$$.fragment,ue),ue.forEach($),A.forEach($),N.forEach($),this.h()},h(){_(l,"class","title expandable svelte-1r50q6i"),_(l,"role","group"),_(d,"class","bounding embedding-bounding svelte-1r50q6i"),le(d,"active",n[2]&&!n[1]),_(f,"class","column token-string relative svelte-1r50q6i"),_(s,"class","token-column resizable resize-watch flex"),_(R,"class","column vectors svelte-1r50q6i"),_(k,"class","vector-column relative flex"),_(o,"class","content relative svelte-1r50q6i"),_(e,"class",L=he(fe("embedding",n[0]))+" svelte-1r50q6i"),_(e,"role","button"),_(e,"tabindex","0")},m(b,N){x(b,e,N),D(e,l),D(e,r),D(e,o),D(o,s),D(s,f),w&&w.m(f,null),D(f,i);for(let A=0;A<C.length;A+=1)C[A]&&C[A].m(f,null);D(f,a),D(f,d),D(s,h),y&&y.m(s,null),D(o,m),D(o,k),se(V,k,null),D(k,H),D(k,R);for(let A=0;A<u.length;A+=1)u[A]&&u[A].m(R,null);D(k,X),se(q,k,null),D(k,S),se(B,k,null),D(k,O),se(M,k,null),c=!0,p||(v=[ke(l,"mouseenter",n[7]),ke(l,"mouseleave",n[8]),ke(e,"click",n[6]),ke(e,"keydown",n[6])],p=!0)},p(b,[N]){if(b[1]?w||(w=Fl(),w.c(),w.m(f,i)):w&&(w.d(1),w=null),N&8){I=ve(b[3]);let j;for(j=0;j<I.length;j+=1){const K=Rl(b,I,j);C[j]?C[j].p(K,N):(C[j]=xl(K),C[j].c(),C[j].m(f,a))}for(;j<C.length;j+=1)C[j].d(1);C.length=I.length}(!c||N&6)&&le(d,"active",b[2]&&!b[1]),b[1]?y?(y.p(b,N),N&2&&F(y,1)):(y=Ul(b),y.c(),F(y,1),y.m(s,null)):y&&(Me(),Z(y,1,1,()=>{y=null}),Be());const A={};if(N&536870928&&(A.$$scope={dirty:N,ctx:b}),V.$set(A),N&14){g=ve(b[3]);let j;for(j=0;j<g.length;j+=1){const K=Tl(b,g,j);u[j]?(u[j].p(K,N),F(u[j],1)):(u[j]=Kl(K),u[j].c(),F(u[j],1),u[j].m(R,null))}for(Me(),j=g.length;j<u.length;j+=1)E(j);Be()}(!c||N&1&&L!==(L=he(fe("embedding",b[0]))+" svelte-1r50q6i"))&&_(e,"class",L)},i(b){if(!c){F(y),F(V.$$.fragment,b);for(let N=0;N<g.length;N+=1)F(u[N]);F(q.$$.fragment,b),F(B.$$.fragment,b),F(M.$$.fragment,b),c=!0}},o(b){Z(y),Z(V.$$.fragment,b),u=u.filter(Boolean);for(let N=0;N<u.length;N+=1)Z(u[N]);Z(q.$$.fragment,b),Z(B.$$.fragment,b),Z(M.$$.fragment,b),c=!1},d(b){b&&$(e),w&&w.d(),Ne(C,b),y&&y.d(),ie(V),Ne(u,b),ie(q),ie(B),ie(M),p=!1,je(v)}}}const Ft="bg-gray-300";function Mr(n,e,l){let t,r,o;Ee(n,Qe,q=>l(9,t=q)),Ee(n,st,q=>l(3,r=q)),Ee(n,$t,q=>l(4,o=q));const{theme:s}=ht(dt);let{className:f=void 0}=e;At("block-id","embedding");const i=Nt("block-id");let a=!1;const d=()=>{a?(Qe.set({id:null}),k()):(Qe.set({id:i}),m())};let h;const m=async()=>{h=ut.Flip.getState(".embedding .token-column"),l(1,a=!0),await gt(),ut.Flip.from(h,{duration:1,ease:"power2.inOut"}),mt.to(".embedding-detail",{opacity:1,duration:.5,delay:.5})},k=async()=>{h=ut.Flip.getState(".embedding .token-column"),l(1,a=!1),await gt(),ut.Flip.from(h,{duration:.5,ease:"power2.inOut"})};let V=!1;function H(){l(2,V=!0)}function R(){l(2,V=!1)}const X=(q,S)=>_n().domain([0,.5,1]).range([s.colors.red[400],"white",s.colors.blue[400]])(q);return n.$$set=q=>{"className"in q&&l(0,f=q.className)},n.$$.update=()=>{n.$$.dirty&514&&t.id!==i&&a&&(l(1,a=!1),k())},[f,a,V,r,o,s,d,H,R,t,X]}class Br extends Pe{constructor(e){super(),Te(this,e,Mr,Ar,ze,{className:0})}}function Ql(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function Jl(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function en(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function Lr(n){let e,l=n[3].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&8&&l!==(l=o[3].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function zr(n){let e,l=n[3].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&8&&l!==(l=o[3].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Pr(n){let e,l=n[3].dimension*4+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&8&&l!==(l=o[3].dimension*4+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function tn(n){let e,l,t=n[10]+"",r,o,s,f,i,a,d,h,m,k,V,H;f=new lt({props:{colorScale:"purple",active:n[2]===n[12]}});function R(){return n[8](n[12])}return{c(){e=z("div"),l=z("span"),r=ae(t),o=U(),s=z("div"),oe(f.$$.fragment),i=U(),a=z("div"),d=U(),h=z("div"),m=U(),this.h()},l(X){e=P(X,"DIV",{class:!0,role:!0});var q=T(e);l=P(q,"SPAN",{class:!0});var S=T(l);r=ce(S,t),S.forEach($),o=W(q),s=P(q,"DIV",{class:!0});var B=T(s);re(f.$$.fragment,B),i=W(B),a=P(B,"DIV",{class:!0}),T(a).forEach($),d=W(B),h=P(B,"DIV",{class:!0}),T(h).forEach($),B.forEach($),m=W(q),q.forEach($),this.h()},h(){_(l,"class","label float"),_(a,"class","sub-vector x1-12 head1"),_(h,"class","sub-vector head-rest grow"),_(s,"class",he(`vector flex flex-col  ${Hr}`)+" svelte-r5b4c7"),_(e,"class","cell"),_(e,"role","group"),le(e,"last",n[12]===n[5].length-1)},m(X,q){x(X,e,q),D(e,l),D(l,r),D(e,o),D(e,s),se(f,s,null),D(s,i),D(s,a),D(s,d),D(s,h),D(e,m),k=!0,V||(H=[ke(e,"mouseenter",R),ke(e,"mouseleave",n[9])],V=!0)},p(X,q){n=X,(!k||q&32)&&t!==(t=n[10]+"")&&Ve(r,t);const S={};q&4&&(S.active=n[2]===n[12]),f.$set(S),(!k||q&32)&&le(e,"last",n[12]===n[5].length-1)},i(X){k||(F(f.$$.fragment,X),k=!0)},o(X){Z(f.$$.fragment,X),k=!1},d(X){X&&$(e),ie(f),V=!1,je(H)}}}function ln(n){let e,l,t,r,o,s;return t=new lt({props:{colorScale:"indigo"}}),{c(){e=z("div"),l=z("div"),oe(t.$$.fragment),r=U(),this.h()},l(f){e=P(f,"DIV",{class:!0});var i=T(e);l=P(i,"DIV",{class:!0});var a=T(l);re(t.$$.fragment,a),a.forEach($),r=W(i),i.forEach($),this.h()},h(){_(l,"class",he(fe(`vector x4 ${Or} opacity-80`))+" svelte-r5b4c7"),_(e,"class",o=he(fe("cell x4",{small:n[12]!==0&&n[12]!==n[5].length-1}))+" svelte-r5b4c7"),le(e,"last",n[12]===n[5].length-1)},m(f,i){x(f,e,i),D(e,l),se(t,l,null),D(e,r),s=!0},p(f,i){(!s||i&32&&o!==(o=he(fe("cell x4",{small:f[12]!==0&&f[12]!==f[5].length-1}))+" svelte-r5b4c7"))&&_(e,"class",o),(!s||i&32)&&le(e,"last",f[12]===f[5].length-1)},i(f){s||(F(t.$$.fragment,f),s=!0)},o(f){Z(t.$$.fragment,f),s=!1},d(f){f&&$(e),ie(t)}}}function nn(n){let e,l,t,r,o;return t=new lt({props:{colorScale:"blue"}}),{c(){e=z("div"),l=z("div"),oe(t.$$.fragment),r=U(),this.h()},l(s){e=P(s,"DIV",{class:!0});var f=T(e);l=P(f,"DIV",{class:!0});var i=T(l);re(t.$$.fragment,i),i.forEach($),r=W(f),f.forEach($),this.h()},h(){_(l,"class",he(`vector ${jr}`)+" svelte-r5b4c7"),_(e,"class","cell"),le(e,"last",n[12]===n[5].length-1)},m(s,f){x(s,e,f),D(e,l),se(t,l,null),D(e,r),o=!0},p(s,f){(!o||f&32)&&le(e,"last",s[12]===s[5].length-1)},i(s){o||(F(t.$$.fragment,s),o=!0)},o(s){Z(t.$$.fragment,s),o=!1},d(s){s&&$(e),ie(t)}}}function Tr(n){let e,l,t="MLP",r,o,s,f,i,a,d,h,m,k,V,H,R,X,q,S,B,O,M,L,c,p,v,w,I,C,y,g,u,E,b,N,A,j,K,ue,Y,G,te;s=new xe({props:{triggeredBy:".mlp .first-layer .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Lr]},$$scope:{ctx:n}}}),i=new xe({props:{triggeredBy:".mlp .out .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[zr]},$$scope:{ctx:n}}}),d=new xe({props:{triggeredBy:".mlp .projections .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Pr]},$$scope:{ctx:n}}});let ne=ve(n[5]),Q=[];for(let J=0;J<ne.length;J+=1)Q[J]=tn(en(n,ne,J));const we=J=>Z(Q[J],1,1,()=>{Q[J]=null});S=new et({props:{type:"dropout",id:"mlp-first-dropout"}}),O=new et({props:{type:"residual-end",id:"residual-first"}}),L=new et({props:{type:"ln",id:"mlp-first-ln"}}),p=new et({props:{type:"residual-start",id:"residual-second"}});let qe=ve(n[5]),ge=[];for(let J=0;J<qe.length;J+=1)ge[J]=ln(Jl(n,qe,J));const He=J=>Z(ge[J],1,1,()=>{ge[J]=null});g=new et({props:{type:"activation",id:"mlp-activation",className:"x4"}}),b=new et({props:{type:"residual-end",id:"residual-second"}}),A=new et({props:{type:"ln",id:"mlp-second-ln"}});let Se=ve(n[5]),_e=[];for(let J=0;J<Se.length;J+=1)_e[J]=nn(Ql(n,Se,J));const be=J=>Z(_e[J],1,1,()=>{_e[J]=null});return{c(){e=z("div"),l=z("div"),l.textContent=t,r=U(),o=z("div"),oe(s.$$.fragment),f=U(),oe(i.$$.fragment),a=U(),oe(d.$$.fragment),h=U(),m=z("div"),k=U(),V=z("div"),H=U(),R=z("div"),X=z("div");for(let J=0;J<Q.length;J+=1)Q[J].c();q=U(),oe(S.$$.fragment),B=U(),oe(O.$$.fragment),M=U(),oe(L.$$.fragment),c=U(),oe(p.$$.fragment),v=U(),w=z("div"),I=z("div"),C=z("div");for(let J=0;J<ge.length;J+=1)ge[J].c();y=U(),oe(g.$$.fragment),u=U(),E=z("div"),oe(b.$$.fragment),N=U(),oe(A.$$.fragment),j=U(),K=z("div");for(let J=0;J<_e.length;J+=1)_e[J].c();this.h()},l(J){e=P(J,"DIV",{class:!0});var me=T(e);l=P(me,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-50ab67"&&(l.textContent=t),r=W(me),o=P(me,"DIV",{class:!0});var ye=T(o);re(s.$$.fragment,ye),f=W(ye),re(i.$$.fragment,ye),a=W(ye),re(d.$$.fragment,ye),h=W(ye),m=P(ye,"DIV",{class:!0}),T(m).forEach($),k=W(ye),V=P(ye,"DIV",{class:!0}),T(V).forEach($),H=W(ye),R=P(ye,"DIV",{class:!0});var Ge=T(R);X=P(Ge,"DIV",{class:!0});var it=T(X);for(let Ye=0;Ye<Q.length;Ye+=1)Q[Ye].l(it);it.forEach($),q=W(Ge),re(S.$$.fragment,Ge),B=W(Ge),re(O.$$.fragment,Ge),M=W(Ge),re(L.$$.fragment,Ge),c=W(Ge),re(p.$$.fragment,Ge),Ge.forEach($),v=W(ye),w=P(ye,"DIV",{class:!0});var pe=T(w);I=P(pe,"DIV",{class:!0});var Re=T(I);C=P(Re,"DIV",{class:!0});var kt=T(C);for(let Ye=0;Ye<ge.length;Ye+=1)ge[Ye].l(kt);kt.forEach($),y=W(Re),re(g.$$.fragment,Re),Re.forEach($),u=W(pe),E=P(pe,"DIV",{class:!0});var Je=T(E);re(b.$$.fragment,Je),N=W(Je),re(A.$$.fragment,Je),j=W(Je),K=P(Je,"DIV",{class:!0});var wt=T(K);for(let Ye=0;Ye<_e.length;Ye+=1)_e[Ye].l(wt);wt.forEach($),Je.forEach($),pe.forEach($),ye.forEach($),me.forEach($),this.h()},h(){_(l,"class","title"),_(l,"role","group"),_(m,"class","bounding transformer-bounding svelte-r5b4c7"),le(m,"active",n[4]),_(V,"class","bounding mlp-bounding svelte-r5b4c7"),le(V,"active",n[1]),_(X,"class","column initial"),_(R,"class","layer first-layer flex svelte-r5b4c7"),_(C,"class","column"),_(I,"class","projections flex"),_(K,"class","column out"),_(E,"class","ouputs flex"),_(w,"class","layer second-layer flex justify-between svelte-r5b4c7"),_(o,"class","content relative svelte-r5b4c7"),_(e,"class",ue=he(fe("mlp",n[0]))+" svelte-r5b4c7")},m(J,me){x(J,e,me),D(e,l),D(e,r),D(e,o),se(s,o,null),D(o,f),se(i,o,null),D(o,a),se(d,o,null),D(o,h),D(o,m),D(o,k),D(o,V),D(o,H),D(o,R),D(R,X);for(let ye=0;ye<Q.length;ye+=1)Q[ye]&&Q[ye].m(X,null);D(R,q),se(S,R,null),D(R,B),se(O,R,null),D(R,M),se(L,R,null),D(R,c),se(p,R,null),D(o,v),D(o,w),D(w,I),D(I,C);for(let ye=0;ye<ge.length;ye+=1)ge[ye]&&ge[ye].m(C,null);D(I,y),se(g,I,null),D(w,u),D(w,E),se(b,E,null),D(E,N),se(A,E,null),D(E,j),D(E,K);for(let ye=0;ye<_e.length;ye+=1)_e[ye]&&_e[ye].m(K,null);Y=!0,G||(te=[ke(l,"mouseenter",n[6]),ke(l,"mouseleave",n[7])],G=!0)},p(J,[me]){const ye={};me&32776&&(ye.$$scope={dirty:me,ctx:J}),s.$set(ye);const Ge={};me&32776&&(Ge.$$scope={dirty:me,ctx:J}),i.$set(Ge);const it={};if(me&32776&&(it.$$scope={dirty:me,ctx:J}),d.$set(it),(!Y||me&16)&&le(m,"active",J[4]),(!Y||me&2)&&le(V,"active",J[1]),me&36){ne=ve(J[5]);let pe;for(pe=0;pe<ne.length;pe+=1){const Re=en(J,ne,pe);Q[pe]?(Q[pe].p(Re,me),F(Q[pe],1)):(Q[pe]=tn(Re),Q[pe].c(),F(Q[pe],1),Q[pe].m(X,null))}for(Me(),pe=ne.length;pe<Q.length;pe+=1)we(pe);Be()}if(me&32){qe=ve(J[5]);let pe;for(pe=0;pe<qe.length;pe+=1){const Re=Jl(J,qe,pe);ge[pe]?(ge[pe].p(Re,me),F(ge[pe],1)):(ge[pe]=ln(Re),ge[pe].c(),F(ge[pe],1),ge[pe].m(C,null))}for(Me(),pe=qe.length;pe<ge.length;pe+=1)He(pe);Be()}if(me&32){Se=ve(J[5]);let pe;for(pe=0;pe<Se.length;pe+=1){const Re=Ql(J,Se,pe);_e[pe]?(_e[pe].p(Re,me),F(_e[pe],1)):(_e[pe]=nn(Re),_e[pe].c(),F(_e[pe],1),_e[pe].m(K,null))}for(Me(),pe=Se.length;pe<_e.length;pe+=1)be(pe);Be()}(!Y||me&1&&ue!==(ue=he(fe("mlp",J[0]))+" svelte-r5b4c7"))&&_(e,"class",ue)},i(J){if(!Y){F(s.$$.fragment,J),F(i.$$.fragment,J),F(d.$$.fragment,J);for(let me=0;me<ne.length;me+=1)F(Q[me]);F(S.$$.fragment,J),F(O.$$.fragment,J),F(L.$$.fragment,J),F(p.$$.fragment,J);for(let me=0;me<qe.length;me+=1)F(ge[me]);F(g.$$.fragment,J),F(b.$$.fragment,J),F(A.$$.fragment,J);for(let me=0;me<Se.length;me+=1)F(_e[me]);Y=!0}},o(J){Z(s.$$.fragment,J),Z(i.$$.fragment,J),Z(d.$$.fragment,J),Q=Q.filter(Boolean);for(let me=0;me<Q.length;me+=1)Z(Q[me]);Z(S.$$.fragment,J),Z(O.$$.fragment,J),Z(L.$$.fragment,J),Z(p.$$.fragment,J),ge=ge.filter(Boolean);for(let me=0;me<ge.length;me+=1)Z(ge[me]);Z(g.$$.fragment,J),Z(b.$$.fragment,J),Z(A.$$.fragment,J),_e=_e.filter(Boolean);for(let me=0;me<_e.length;me+=1)Z(_e[me]);Y=!1},d(J){J&&$(e),ie(s),ie(i),ie(d),Ne(Q,J),ie(S),ie(O),ie(L),ie(p),Ne(ge,J),ie(g),ie(b),ie(A),Ne(_e,J),G=!1,je(te)}}}const Hr="bg-purple-200",Or="bg-indigo-200",jr="bg-blue-200";function Gr(n,e,l){let t,r,o;Ee(n,$t,k=>l(3,t=k)),Ee(n,yt,k=>l(4,r=k)),Ee(n,st,k=>l(5,o=k));let{className:s=void 0}=e;At("block-id","mlp");let f=!1;function i(){l(1,f=!0)}function a(){l(1,f=!1)}let d=null;const h=k=>{l(2,d=k)},m=()=>{l(2,d=null)};return n.$$set=k=>{"className"in k&&l(0,s=k.className)},[s,f,d,t,r,o,i,a,h,m]}class Rr extends Pe{constructor(e){super(),Te(this,e,Gr,Tr,ze,{className:0})}}var Fr=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,zt=Math.ceil,Xe=Math.floor,Fe="[BigNumber Error] ",on=Fe+"Number primitive has more than 15 significant digits: ",Ke=1e14,$e=14,Pt=9007199254740991,Tt=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],ct=1e7,Oe=1e9;function wn(n){var e,l,t,r=q.prototype={constructor:q,toString:null,valueOf:null},o=new q(1),s=20,f=4,i=-7,a=21,d=-1e7,h=1e7,m=!1,k=1,V=0,H={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},R="0123456789abcdefghijklmnopqrstuvwxyz",X=!0;function q(c,p){var v,w,I,C,y,g,u,E,b=this;if(!(b instanceof q))return new q(c,p);if(p==null){if(c&&c._isBigNumber===!0){b.s=c.s,!c.c||c.e>h?b.c=b.e=null:c.e<d?b.c=[b.e=0]:(b.e=c.e,b.c=c.c.slice());return}if((g=typeof c=="number")&&c*0==0){if(b.s=1/c<0?(c=-c,-1):1,c===~~c){for(C=0,y=c;y>=10;y/=10,C++);C>h?b.c=b.e=null:(b.e=C,b.c=[c]);return}E=String(c)}else{if(!Fr.test(E=String(c)))return t(b,E,g);b.s=E.charCodeAt(0)==45?(E=E.slice(1),-1):1}(C=E.indexOf("."))>-1&&(E=E.replace(".","")),(y=E.search(/e/i))>0?(C<0&&(C=y),C+=+E.slice(y+1),E=E.substring(0,y)):C<0&&(C=E.length)}else{if(Ae(p,2,R.length,"Base"),p==10&&X)return b=new q(c),M(b,s+b.e+1,f);if(E=String(c),g=typeof c=="number"){if(c*0!=0)return t(b,E,g,p);if(b.s=1/c<0?(E=E.slice(1),-1):1,q.DEBUG&&E.replace(/^0\.0*|\./,"").length>15)throw Error(on+c)}else b.s=E.charCodeAt(0)===45?(E=E.slice(1),-1):1;for(v=R.slice(0,p),C=y=0,u=E.length;y<u;y++)if(v.indexOf(w=E.charAt(y))<0){if(w=="."){if(y>C){C=u;continue}}else if(!I&&(E==E.toUpperCase()&&(E=E.toLowerCase())||E==E.toLowerCase()&&(E=E.toUpperCase()))){I=!0,y=-1,C=0;continue}return t(b,String(c),g,p)}g=!1,E=l(E,p,10,b.s),(C=E.indexOf("."))>-1?E=E.replace(".",""):C=E.length}for(y=0;E.charCodeAt(y)===48;y++);for(u=E.length;E.charCodeAt(--u)===48;);if(E=E.slice(y,++u)){if(u-=y,g&&q.DEBUG&&u>15&&(c>Pt||c!==Xe(c)))throw Error(on+b.s*c);if((C=C-y-1)>h)b.c=b.e=null;else if(C<d)b.c=[b.e=0];else{if(b.e=C,b.c=[],y=(C+1)%$e,C<0&&(y+=$e),y<u){for(y&&b.c.push(+E.slice(0,y)),u-=$e;y<u;)b.c.push(+E.slice(y,y+=$e));y=$e-(E=E.slice(y)).length}else y-=u;for(;y--;E+="0");b.c.push(+E)}}else b.c=[b.e=0]}q.clone=wn,q.ROUND_UP=0,q.ROUND_DOWN=1,q.ROUND_CEIL=2,q.ROUND_FLOOR=3,q.ROUND_HALF_UP=4,q.ROUND_HALF_DOWN=5,q.ROUND_HALF_EVEN=6,q.ROUND_HALF_CEIL=7,q.ROUND_HALF_FLOOR=8,q.EUCLID=9,q.config=q.set=function(c){var p,v;if(c!=null)if(typeof c=="object"){if(c.hasOwnProperty(p="DECIMAL_PLACES")&&(v=c[p],Ae(v,0,Oe,p),s=v),c.hasOwnProperty(p="ROUNDING_MODE")&&(v=c[p],Ae(v,0,8,p),f=v),c.hasOwnProperty(p="EXPONENTIAL_AT")&&(v=c[p],v&&v.pop?(Ae(v[0],-Oe,0,p),Ae(v[1],0,Oe,p),i=v[0],a=v[1]):(Ae(v,-Oe,Oe,p),i=-(a=v<0?-v:v))),c.hasOwnProperty(p="RANGE"))if(v=c[p],v&&v.pop)Ae(v[0],-Oe,-1,p),Ae(v[1],1,Oe,p),d=v[0],h=v[1];else if(Ae(v,-Oe,Oe,p),v)d=-(h=v<0?-v:v);else throw Error(Fe+p+" cannot be zero: "+v);if(c.hasOwnProperty(p="CRYPTO"))if(v=c[p],v===!!v)if(v)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))m=v;else throw m=!v,Error(Fe+"crypto unavailable");else m=v;else throw Error(Fe+p+" not true or false: "+v);if(c.hasOwnProperty(p="MODULO_MODE")&&(v=c[p],Ae(v,0,9,p),k=v),c.hasOwnProperty(p="POW_PRECISION")&&(v=c[p],Ae(v,0,Oe,p),V=v),c.hasOwnProperty(p="FORMAT"))if(v=c[p],typeof v=="object")H=v;else throw Error(Fe+p+" not an object: "+v);if(c.hasOwnProperty(p="ALPHABET"))if(v=c[p],typeof v=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(v))X=v.slice(0,10)=="0123456789",R=v;else throw Error(Fe+p+" invalid: "+v)}else throw Error(Fe+"Object expected: "+c);return{DECIMAL_PLACES:s,ROUNDING_MODE:f,EXPONENTIAL_AT:[i,a],RANGE:[d,h],CRYPTO:m,MODULO_MODE:k,POW_PRECISION:V,FORMAT:H,ALPHABET:R}},q.isBigNumber=function(c){if(!c||c._isBigNumber!==!0)return!1;if(!q.DEBUG)return!0;var p,v,w=c.c,I=c.e,C=c.s;e:if({}.toString.call(w)=="[object Array]"){if((C===1||C===-1)&&I>=-Oe&&I<=Oe&&I===Xe(I)){if(w[0]===0){if(I===0&&w.length===1)return!0;break e}if(p=(I+1)%$e,p<1&&(p+=$e),String(w[0]).length==p){for(p=0;p<w.length;p++)if(v=w[p],v<0||v>=Ke||v!==Xe(v))break e;if(v!==0)return!0}}}else if(w===null&&I===null&&(C===null||C===1||C===-1))return!0;throw Error(Fe+"Invalid BigNumber: "+c)},q.maximum=q.max=function(){return B(arguments,-1)},q.minimum=q.min=function(){return B(arguments,1)},q.random=function(){var c=9007199254740992,p=Math.random()*c&2097151?function(){return Xe(Math.random()*c)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(v){var w,I,C,y,g,u=0,E=[],b=new q(o);if(v==null?v=s:Ae(v,0,Oe),y=zt(v/$e),m)if(crypto.getRandomValues){for(w=crypto.getRandomValues(new Uint32Array(y*=2));u<y;)g=w[u]*131072+(w[u+1]>>>11),g>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),w[u]=I[0],w[u+1]=I[1]):(E.push(g%1e14),u+=2);u=y/2}else if(crypto.randomBytes){for(w=crypto.randomBytes(y*=7);u<y;)g=(w[u]&31)*281474976710656+w[u+1]*1099511627776+w[u+2]*4294967296+w[u+3]*16777216+(w[u+4]<<16)+(w[u+5]<<8)+w[u+6],g>=9e15?crypto.randomBytes(7).copy(w,u):(E.push(g%1e14),u+=7);u=y/7}else throw m=!1,Error(Fe+"crypto unavailable");if(!m)for(;u<y;)g=p(),g<9e15&&(E[u++]=g%1e14);for(y=E[--u],v%=$e,y&&v&&(g=Tt[$e-v],E[u]=Xe(y/g)*g);E[u]===0;E.pop(),u--);if(u<0)E=[C=0];else{for(C=-1;E[0]===0;E.splice(0,1),C-=$e);for(u=1,g=E[0];g>=10;g/=10,u++);u<$e&&(C-=$e-u)}return b.e=C,b.c=E,b}}(),q.sum=function(){for(var c=1,p=arguments,v=new q(p[0]);c<p.length;)v=v.plus(p[c++]);return v},l=function(){var c="0123456789";function p(v,w,I,C){for(var y,g=[0],u,E=0,b=v.length;E<b;){for(u=g.length;u--;g[u]*=w);for(g[0]+=C.indexOf(v.charAt(E++)),y=0;y<g.length;y++)g[y]>I-1&&(g[y+1]==null&&(g[y+1]=0),g[y+1]+=g[y]/I|0,g[y]%=I)}return g.reverse()}return function(v,w,I,C,y){var g,u,E,b,N,A,j,K,ue=v.indexOf("."),Y=s,G=f;for(ue>=0&&(b=V,V=0,v=v.replace(".",""),K=new q(w),A=K.pow(v.length-ue),V=b,K.c=p(ot(We(A.c),A.e,"0"),10,I,c),K.e=K.c.length),j=p(v,w,I,y?(g=R,c):(g=c,R)),E=b=j.length;j[--b]==0;j.pop());if(!j[0])return g.charAt(0);if(ue<0?--E:(A.c=j,A.e=E,A.s=C,A=e(A,K,Y,G,I),j=A.c,N=A.r,E=A.e),u=E+Y+1,ue=j[u],b=I/2,N=N||u<0||j[u+1]!=null,N=G<4?(ue!=null||N)&&(G==0||G==(A.s<0?3:2)):ue>b||ue==b&&(G==4||N||G==6&&j[u-1]&1||G==(A.s<0?8:7)),u<1||!j[0])v=N?ot(g.charAt(1),-Y,g.charAt(0)):g.charAt(0);else{if(j.length=u,N)for(--I;++j[--u]>I;)j[u]=0,u||(++E,j=[1].concat(j));for(b=j.length;!j[--b];);for(ue=0,v="";ue<=b;v+=g.charAt(j[ue++]));v=ot(v,E,g.charAt(0))}return v}}(),e=function(){function c(w,I,C){var y,g,u,E,b=0,N=w.length,A=I%ct,j=I/ct|0;for(w=w.slice();N--;)u=w[N]%ct,E=w[N]/ct|0,y=j*u+E*A,g=A*u+y%ct*ct+b,b=(g/C|0)+(y/ct|0)+j*E,w[N]=g%C;return b&&(w=[b].concat(w)),w}function p(w,I,C,y){var g,u;if(C!=y)u=C>y?1:-1;else for(g=u=0;g<C;g++)if(w[g]!=I[g]){u=w[g]>I[g]?1:-1;break}return u}function v(w,I,C,y){for(var g=0;C--;)w[C]-=g,g=w[C]<I[C]?1:0,w[C]=g*y+w[C]-I[C];for(;!w[0]&&w.length>1;w.splice(0,1));}return function(w,I,C,y,g){var u,E,b,N,A,j,K,ue,Y,G,te,ne,Q,we,qe,ge,He,Se=w.s==I.s?1:-1,_e=w.c,be=I.c;if(!_e||!_e[0]||!be||!be[0])return new q(!w.s||!I.s||(_e?be&&_e[0]==be[0]:!be)?NaN:_e&&_e[0]==0||!be?Se*0:Se/0);for(ue=new q(Se),Y=ue.c=[],E=w.e-I.e,Se=C+E+1,g||(g=Ke,E=Ze(w.e/$e)-Ze(I.e/$e),Se=Se/$e|0),b=0;be[b]==(_e[b]||0);b++);if(be[b]>(_e[b]||0)&&E--,Se<0)Y.push(1),N=!0;else{for(we=_e.length,ge=be.length,b=0,Se+=2,A=Xe(g/(be[0]+1)),A>1&&(be=c(be,A,g),_e=c(_e,A,g),ge=be.length,we=_e.length),Q=ge,G=_e.slice(0,ge),te=G.length;te<ge;G[te++]=0);He=be.slice(),He=[0].concat(He),qe=be[0],be[1]>=g/2&&qe++;do{if(A=0,u=p(be,G,ge,te),u<0){if(ne=G[0],ge!=te&&(ne=ne*g+(G[1]||0)),A=Xe(ne/qe),A>1)for(A>=g&&(A=g-1),j=c(be,A,g),K=j.length,te=G.length;p(j,G,K,te)==1;)A--,v(j,ge<K?He:be,K,g),K=j.length,u=1;else A==0&&(u=A=1),j=be.slice(),K=j.length;if(K<te&&(j=[0].concat(j)),v(G,j,te,g),te=G.length,u==-1)for(;p(be,G,ge,te)<1;)A++,v(G,ge<te?He:be,te,g),te=G.length}else u===0&&(A++,G=[0]);Y[b++]=A,G[0]?G[te++]=_e[Q]||0:(G=[_e[Q]],te=1)}while((Q++<we||G[0]!=null)&&Se--);N=G[0]!=null,Y[0]||Y.splice(0,1)}if(g==Ke){for(b=1,Se=Y[0];Se>=10;Se/=10,b++);M(ue,C+(ue.e=b+E*$e-1)+1,y,N)}else ue.e=E,ue.r=+N;return ue}}();function S(c,p,v,w){var I,C,y,g,u;if(v==null?v=f:Ae(v,0,8),!c.c)return c.toString();if(I=c.c[0],y=c.e,p==null)u=We(c.c),u=w==1||w==2&&(y<=i||y>=a)?St(u,y):ot(u,y,"0");else if(c=M(new q(c),p,v),C=c.e,u=We(c.c),g=u.length,w==1||w==2&&(p<=C||C<=i)){for(;g<p;u+="0",g++);u=St(u,C)}else if(p-=y,u=ot(u,C,"0"),C+1>g){if(--p>0)for(u+=".";p--;u+="0");}else if(p+=C-g,p>0)for(C+1==g&&(u+=".");p--;u+="0");return c.s<0&&I?"-"+u:u}function B(c,p){for(var v,w,I=1,C=new q(c[0]);I<c.length;I++)w=new q(c[I]),(!w.s||(v=pt(C,w))===p||v===0&&C.s===p)&&(C=w);return C}function O(c,p,v){for(var w=1,I=p.length;!p[--I];p.pop());for(I=p[0];I>=10;I/=10,w++);return(v=w+v*$e-1)>h?c.c=c.e=null:v<d?c.c=[c.e=0]:(c.e=v,c.c=p),c}t=function(){var c=/^(-?)0([xbo])(?=\w[\w.]*$)/i,p=/^([^.]+)\.$/,v=/^\.([^.]+)$/,w=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(C,y,g,u){var E,b=g?y:y.replace(I,"");if(w.test(b))C.s=isNaN(b)?null:b<0?-1:1;else{if(!g&&(b=b.replace(c,function(N,A,j){return E=(j=j.toLowerCase())=="x"?16:j=="b"?2:8,!u||u==E?A:N}),u&&(E=u,b=b.replace(p,"$1").replace(v,"0.$1")),y!=b))return new q(b,E);if(q.DEBUG)throw Error(Fe+"Not a"+(u?" base "+u:"")+" number: "+y);C.s=null}C.c=C.e=null}}();function M(c,p,v,w){var I,C,y,g,u,E,b,N=c.c,A=Tt;if(N){e:{for(I=1,g=N[0];g>=10;g/=10,I++);if(C=p-I,C<0)C+=$e,y=p,u=N[E=0],b=Xe(u/A[I-y-1]%10);else if(E=zt((C+1)/$e),E>=N.length)if(w){for(;N.length<=E;N.push(0));u=b=0,I=1,C%=$e,y=C-$e+1}else break e;else{for(u=g=N[E],I=1;g>=10;g/=10,I++);C%=$e,y=C-$e+I,b=y<0?0:Xe(u/A[I-y-1]%10)}if(w=w||p<0||N[E+1]!=null||(y<0?u:u%A[I-y-1]),w=v<4?(b||w)&&(v==0||v==(c.s<0?3:2)):b>5||b==5&&(v==4||w||v==6&&(C>0?y>0?u/A[I-y]:0:N[E-1])%10&1||v==(c.s<0?8:7)),p<1||!N[0])return N.length=0,w?(p-=c.e+1,N[0]=A[($e-p%$e)%$e],c.e=-p||0):N[0]=c.e=0,c;if(C==0?(N.length=E,g=1,E--):(N.length=E+1,g=A[$e-C],N[E]=y>0?Xe(u/A[I-y]%A[y])*g:0),w)for(;;)if(E==0){for(C=1,y=N[0];y>=10;y/=10,C++);for(y=N[0]+=g,g=1;y>=10;y/=10,g++);C!=g&&(c.e++,N[0]==Ke&&(N[0]=1));break}else{if(N[E]+=g,N[E]!=Ke)break;N[E--]=0,g=1}for(C=N.length;N[--C]===0;N.pop());}c.e>h?c.c=c.e=null:c.e<d&&(c.c=[c.e=0])}return c}function L(c){var p,v=c.e;return v===null?c.toString():(p=We(c.c),p=v<=i||v>=a?St(p,v):ot(p,v,"0"),c.s<0?"-"+p:p)}return r.absoluteValue=r.abs=function(){var c=new q(this);return c.s<0&&(c.s=1),c},r.comparedTo=function(c,p){return pt(this,new q(c,p))},r.decimalPlaces=r.dp=function(c,p){var v,w,I,C=this;if(c!=null)return Ae(c,0,Oe),p==null?p=f:Ae(p,0,8),M(new q(C),c+C.e+1,p);if(!(v=C.c))return null;if(w=((I=v.length-1)-Ze(this.e/$e))*$e,I=v[I])for(;I%10==0;I/=10,w--);return w<0&&(w=0),w},r.dividedBy=r.div=function(c,p){return e(this,new q(c,p),s,f)},r.dividedToIntegerBy=r.idiv=function(c,p){return e(this,new q(c,p),0,1)},r.exponentiatedBy=r.pow=function(c,p){var v,w,I,C,y,g,u,E,b,N=this;if(c=new q(c),c.c&&!c.isInteger())throw Error(Fe+"Exponent not an integer: "+L(c));if(p!=null&&(p=new q(p)),g=c.e>14,!N.c||!N.c[0]||N.c[0]==1&&!N.e&&N.c.length==1||!c.c||!c.c[0])return b=new q(Math.pow(+L(N),g?c.s*(2-qt(c)):+L(c))),p?b.mod(p):b;if(u=c.s<0,p){if(p.c?!p.c[0]:!p.s)return new q(NaN);w=!u&&N.isInteger()&&p.isInteger(),w&&(N=N.mod(p))}else{if(c.e>9&&(N.e>0||N.e<-1||(N.e==0?N.c[0]>1||g&&N.c[1]>=24e7:N.c[0]<8e13||g&&N.c[0]<=9999975e7)))return C=N.s<0&&qt(c)?-0:0,N.e>-1&&(C=1/C),new q(u?1/C:C);V&&(C=zt(V/$e+2))}for(g?(v=new q(.5),u&&(c.s=1),E=qt(c)):(I=Math.abs(+L(c)),E=I%2),b=new q(o);;){if(E){if(b=b.times(N),!b.c)break;C?b.c.length>C&&(b.c.length=C):w&&(b=b.mod(p))}if(I){if(I=Xe(I/2),I===0)break;E=I%2}else if(c=c.times(v),M(c,c.e+1,1),c.e>14)E=qt(c);else{if(I=+L(c),I===0)break;E=I%2}N=N.times(N),C?N.c&&N.c.length>C&&(N.c.length=C):w&&(N=N.mod(p))}return w?b:(u&&(b=o.div(b)),p?b.mod(p):C?M(b,V,f,y):b)},r.integerValue=function(c){var p=new q(this);return c==null?c=f:Ae(c,0,8),M(p,p.e+1,c)},r.isEqualTo=r.eq=function(c,p){return pt(this,new q(c,p))===0},r.isFinite=function(){return!!this.c},r.isGreaterThan=r.gt=function(c,p){return pt(this,new q(c,p))>0},r.isGreaterThanOrEqualTo=r.gte=function(c,p){return(p=pt(this,new q(c,p)))===1||p===0},r.isInteger=function(){return!!this.c&&Ze(this.e/$e)>this.c.length-2},r.isLessThan=r.lt=function(c,p){return pt(this,new q(c,p))<0},r.isLessThanOrEqualTo=r.lte=function(c,p){return(p=pt(this,new q(c,p)))===-1||p===0},r.isNaN=function(){return!this.s},r.isNegative=function(){return this.s<0},r.isPositive=function(){return this.s>0},r.isZero=function(){return!!this.c&&this.c[0]==0},r.minus=function(c,p){var v,w,I,C,y=this,g=y.s;if(c=new q(c,p),p=c.s,!g||!p)return new q(NaN);if(g!=p)return c.s=-p,y.plus(c);var u=y.e/$e,E=c.e/$e,b=y.c,N=c.c;if(!u||!E){if(!b||!N)return b?(c.s=-p,c):new q(N?y:NaN);if(!b[0]||!N[0])return N[0]?(c.s=-p,c):new q(b[0]?y:f==3?-0:0)}if(u=Ze(u),E=Ze(E),b=b.slice(),g=u-E){for((C=g<0)?(g=-g,I=b):(E=u,I=N),I.reverse(),p=g;p--;I.push(0));I.reverse()}else for(w=(C=(g=b.length)<(p=N.length))?g:p,g=p=0;p<w;p++)if(b[p]!=N[p]){C=b[p]<N[p];break}if(C&&(I=b,b=N,N=I,c.s=-c.s),p=(w=N.length)-(v=b.length),p>0)for(;p--;b[v++]=0);for(p=Ke-1;w>g;){if(b[--w]<N[w]){for(v=w;v&&!b[--v];b[v]=p);--b[v],b[w]+=Ke}b[w]-=N[w]}for(;b[0]==0;b.splice(0,1),--E);return b[0]?O(c,b,E):(c.s=f==3?-1:1,c.c=[c.e=0],c)},r.modulo=r.mod=function(c,p){var v,w,I=this;return c=new q(c,p),!I.c||!c.s||c.c&&!c.c[0]?new q(NaN):!c.c||I.c&&!I.c[0]?new q(I):(k==9?(w=c.s,c.s=1,v=e(I,c,0,3),c.s=w,v.s*=w):v=e(I,c,0,k),c=I.minus(v.times(c)),!c.c[0]&&k==1&&(c.s=I.s),c)},r.multipliedBy=r.times=function(c,p){var v,w,I,C,y,g,u,E,b,N,A,j,K,ue,Y,G=this,te=G.c,ne=(c=new q(c,p)).c;if(!te||!ne||!te[0]||!ne[0])return!G.s||!c.s||te&&!te[0]&&!ne||ne&&!ne[0]&&!te?c.c=c.e=c.s=null:(c.s*=G.s,!te||!ne?c.c=c.e=null:(c.c=[0],c.e=0)),c;for(w=Ze(G.e/$e)+Ze(c.e/$e),c.s*=G.s,u=te.length,N=ne.length,u<N&&(K=te,te=ne,ne=K,I=u,u=N,N=I),I=u+N,K=[];I--;K.push(0));for(ue=Ke,Y=ct,I=N;--I>=0;){for(v=0,A=ne[I]%Y,j=ne[I]/Y|0,y=u,C=I+y;C>I;)E=te[--y]%Y,b=te[y]/Y|0,g=j*E+b*A,E=A*E+g%Y*Y+K[C]+v,v=(E/ue|0)+(g/Y|0)+j*b,K[C--]=E%ue;K[C]=v}return v?++w:K.splice(0,1),O(c,K,w)},r.negated=function(){var c=new q(this);return c.s=-c.s||null,c},r.plus=function(c,p){var v,w=this,I=w.s;if(c=new q(c,p),p=c.s,!I||!p)return new q(NaN);if(I!=p)return c.s=-p,w.minus(c);var C=w.e/$e,y=c.e/$e,g=w.c,u=c.c;if(!C||!y){if(!g||!u)return new q(I/0);if(!g[0]||!u[0])return u[0]?c:new q(g[0]?w:I*0)}if(C=Ze(C),y=Ze(y),g=g.slice(),I=C-y){for(I>0?(y=C,v=u):(I=-I,v=g),v.reverse();I--;v.push(0));v.reverse()}for(I=g.length,p=u.length,I-p<0&&(v=u,u=g,g=v,p=I),I=0;p;)I=(g[--p]=g[p]+u[p]+I)/Ke|0,g[p]=Ke===g[p]?0:g[p]%Ke;return I&&(g=[I].concat(g),++y),O(c,g,y)},r.precision=r.sd=function(c,p){var v,w,I,C=this;if(c!=null&&c!==!!c)return Ae(c,1,Oe),p==null?p=f:Ae(p,0,8),M(new q(C),c,p);if(!(v=C.c))return null;if(I=v.length-1,w=I*$e+1,I=v[I]){for(;I%10==0;I/=10,w--);for(I=v[0];I>=10;I/=10,w++);}return c&&C.e+1>w&&(w=C.e+1),w},r.shiftedBy=function(c){return Ae(c,-Pt,Pt),this.times("1e"+c)},r.squareRoot=r.sqrt=function(){var c,p,v,w,I,C=this,y=C.c,g=C.s,u=C.e,E=s+4,b=new q("0.5");if(g!==1||!y||!y[0])return new q(!g||g<0&&(!y||y[0])?NaN:y?C:1/0);if(g=Math.sqrt(+L(C)),g==0||g==1/0?(p=We(y),(p.length+u)%2==0&&(p+="0"),g=Math.sqrt(+p),u=Ze((u+1)/2)-(u<0||u%2),g==1/0?p="5e"+u:(p=g.toExponential(),p=p.slice(0,p.indexOf("e")+1)+u),v=new q(p)):v=new q(g+""),v.c[0]){for(u=v.e,g=u+E,g<3&&(g=0);;)if(I=v,v=b.times(I.plus(e(C,I,E,1))),We(I.c).slice(0,g)===(p=We(v.c)).slice(0,g))if(v.e<u&&--g,p=p.slice(g-3,g+1),p=="9999"||!w&&p=="4999"){if(!w&&(M(I,I.e+s+2,0),I.times(I).eq(C))){v=I;break}E+=4,g+=4,w=1}else{(!+p||!+p.slice(1)&&p.charAt(0)=="5")&&(M(v,v.e+s+2,1),c=!v.times(v).eq(C));break}}return M(v,v.e+s+1,f,c)},r.toExponential=function(c,p){return c!=null&&(Ae(c,0,Oe),c++),S(this,c,p,1)},r.toFixed=function(c,p){return c!=null&&(Ae(c,0,Oe),c=c+this.e+1),S(this,c,p)},r.toFormat=function(c,p,v){var w,I=this;if(v==null)c!=null&&p&&typeof p=="object"?(v=p,p=null):c&&typeof c=="object"?(v=c,c=p=null):v=H;else if(typeof v!="object")throw Error(Fe+"Argument not an object: "+v);if(w=I.toFixed(c,p),I.c){var C,y=w.split("."),g=+v.groupSize,u=+v.secondaryGroupSize,E=v.groupSeparator||"",b=y[0],N=y[1],A=I.s<0,j=A?b.slice(1):b,K=j.length;if(u&&(C=g,g=u,u=C,K-=C),g>0&&K>0){for(C=K%g||g,b=j.substr(0,C);C<K;C+=g)b+=E+j.substr(C,g);u>0&&(b+=E+j.slice(C)),A&&(b="-"+b)}w=N?b+(v.decimalSeparator||"")+((u=+v.fractionGroupSize)?N.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(v.fractionGroupSeparator||"")):N):b}return(v.prefix||"")+w+(v.suffix||"")},r.toFraction=function(c){var p,v,w,I,C,y,g,u,E,b,N,A,j=this,K=j.c;if(c!=null&&(g=new q(c),!g.isInteger()&&(g.c||g.s!==1)||g.lt(o)))throw Error(Fe+"Argument "+(g.isInteger()?"out of range: ":"not an integer: ")+L(g));if(!K)return new q(j);for(p=new q(o),E=v=new q(o),w=u=new q(o),A=We(K),C=p.e=A.length-j.e-1,p.c[0]=Tt[(y=C%$e)<0?$e+y:y],c=!c||g.comparedTo(p)>0?C>0?p:E:g,y=h,h=1/0,g=new q(A),u.c[0]=0;b=e(g,p,0,1),I=v.plus(b.times(w)),I.comparedTo(c)!=1;)v=w,w=I,E=u.plus(b.times(I=E)),u=I,p=g.minus(b.times(I=p)),g=I;return I=e(c.minus(v),w,0,1),u=u.plus(I.times(E)),v=v.plus(I.times(w)),u.s=E.s=j.s,C=C*2,N=e(E,w,C,f).minus(j).abs().comparedTo(e(u,v,C,f).minus(j).abs())<1?[E,w]:[u,v],h=y,N},r.toNumber=function(){return+L(this)},r.toPrecision=function(c,p){return c!=null&&Ae(c,1,Oe),S(this,c,p,2)},r.toString=function(c){var p,v=this,w=v.s,I=v.e;return I===null?w?(p="Infinity",w<0&&(p="-"+p)):p="NaN":(c==null?p=I<=i||I>=a?St(We(v.c),I):ot(We(v.c),I,"0"):c===10&&X?(v=M(new q(v),s+I+1,f),p=ot(We(v.c),v.e,"0")):(Ae(c,2,R.length,"Base"),p=l(ot(We(v.c),I,"0"),10,c,w,!0)),w<0&&v.c[0]&&(p="-"+p)),p},r.valueOf=r.toJSON=function(){return L(this)},r._isBigNumber=!0,r[Symbol.toStringTag]="BigNumber",r[Symbol.for("nodejs.util.inspect.custom")]=r.valueOf,n!=null&&q.set(n),q}function Ze(n){var e=n|0;return n>0||n===e?e:e-1}function We(n){for(var e,l,t=1,r=n.length,o=n[0]+"";t<r;){for(e=n[t++]+"",l=$e-e.length;l--;e="0"+e);o+=e}for(r=o.length;o.charCodeAt(--r)===48;);return o.slice(0,r+1||1)}function pt(n,e){var l,t,r=n.c,o=e.c,s=n.s,f=e.s,i=n.e,a=e.e;if(!s||!f)return null;if(l=r&&!r[0],t=o&&!o[0],l||t)return l?t?0:-f:s;if(s!=f)return s;if(l=s<0,t=i==a,!r||!o)return t?0:!r^l?1:-1;if(!t)return i>a^l?1:-1;for(f=(i=r.length)<(a=o.length)?i:a,s=0;s<f;s++)if(r[s]!=o[s])return r[s]>o[s]^l?1:-1;return i==a?0:i>a^l?1:-1}function Ae(n,e,l,t){if(n<e||n>l||n!==Xe(n))throw Error(Fe+(t||"Argument")+(typeof n=="number"?n<e||n>l?" out of range: ":" not an integer: ":" not a primitive number: ")+String(n))}function qt(n){var e=n.c.length-1;return Ze(n.e/$e)==e&&n.c[e]%2!=0}function St(n,e){return(n.length>1?n.charAt(0)+"."+n.slice(1):n)+(e<0?"e":"e+")+e}function ot(n,e,l){var t,r;if(e<0){for(r=l+".";++e;r+=l);n=r+n}else if(t=n.length,++e>t){for(r=l,e-=t;--e;r+=l);n+=r}else e<t&&(n=n.slice(0,e)+"."+n.slice(e));return n}wn();ht(dt);const rt=(n,e,l={})=>{const{color:t="rgba(255,255,255,0)",duration:r=.2,ease:o="power1.in",offset:s={from:"0%",to:"100%"},position:f="+=0",...i}=l,{from:a="0%",to:d="100%"}=s,h=Array.isArray(e)?e.map(m=>m.getAttribute("stop-color")):e.getAttribute("stop-color");n.fromTo(e,{attr:{offset:a,"stop-color":t}},{attr:{offset:d,"stop-color":t},duration:r,ease:o,...i},f).to(e,{attr:{offset:d,"stop-color":m=>Array.isArray(e)?h[m]:h},duration:r,ease:o,...i},"-=50%")},xr=async n=>new Promise(e=>{var te,ne,Q,we,qe,ge,He,Se,_e,be,J,me,ye,Ge,it,pe,Re,kt;const l=mt.timeline({onComplete:e}),t=.01,r=document.querySelectorAll(".embedding .content .last");l.fromTo(r,{opacity:0},{opacity:1,duration:t});const o=document.querySelectorAll(".sankey .embedding .last");l.set(o,{opacity:.6});const s=(te=document.querySelector("#gray-blue-last"))==null?void 0:te.querySelectorAll("stop")[1];rt(l,s,{duration:t*1.5});const f=document.querySelectorAll(".attention .column .vector.last");l.fromTo(f,{opacity:0},{opacity:1,duration:t});const i=document.querySelectorAll(".sankey-top .attention .last"),a=document.querySelectorAll(".sankey-back .attention .last"),d=document.querySelectorAll(".sankey-top .attention .to-attention-out");l.set(i,{opacity:1}),l.set([a,d],{opacity:.4});const h=(ne=document.querySelector("#blue-blue-last"))==null?void 0:ne.querySelectorAll("stop")[1],m=(Q=document.querySelector("#red-red-last"))==null?void 0:Q.querySelectorAll("stop")[1],k=(we=document.querySelector("#green-green-last"))==null?void 0:we.querySelectorAll("stop")[1],V=(qe=document.querySelector("#blue-blue2-last"))==null?void 0:qe.querySelectorAll("stop")[1],H=(ge=document.querySelector("#red-red2-last"))==null?void 0:ge.querySelectorAll("stop")[1],R=(He=document.querySelector("#green-green2-last"))==null?void 0:He.querySelectorAll("stop")[1];rt(l,[h,m,k,V,H,R],{});const X=document.querySelectorAll(".attention .head-block .qkv .column .last");l.fromTo(X,{opacity:0},{opacity:1,duration:t});const q=document.querySelectorAll(".sankey g.attention path.key-to-attention"),S=document.querySelectorAll(".sankey g.attention path.query-to-attention");document.querySelectorAll(".sankey g.attention path.to-attention-out");const B=document.querySelector(".attention .attention-result");[...q,...S].forEach(Je=>{const wt=Je.getTotalLength();Je.style.strokeDasharray=wt,Je.style.strokeDashoffset=wt});const O=.4,M=Number((O/n).toFixed(2));l.to(q,{strokeDashoffset:0,stagger:M,duration:O,ease:"power2.out"},"<+=50%").to(S,{strokeDashoffset:0,stagger:M,duration:O,ease:"power2.out"},"<").from(B.querySelectorAll("svg circle"),{scale:0,transformOrigin:"50% 50%",opacity:0,delay:O/n,stagger:Number((O/Math.pow(n,2)).toFixed(2)),ease:"power2.out",duration:O},"<");const L=(Se=document.querySelector("#green-purple"))==null?void 0:Se.querySelectorAll("stop")[1],c=(_e=document.querySelector("#transparent-purple2"))==null?void 0:_e.querySelectorAll("stop")[1];rt(l,[c,L],{});const p=document.querySelectorAll(".attention .head-block .head-out .column .last");l.fromTo(p,{opacity:0},{opacity:1,duration:t});const v=(be=document.querySelector("#purple-purple-last"))==null?void 0:be.querySelectorAll("stop")[1],w=(J=document.querySelector("#transparent-purple-last"))==null?void 0:J.querySelectorAll("stop")[1];rt(l,[v,w],{stagger:.2});const I=document.querySelectorAll(".mlp .first-layer .cell.last");l.fromTo(I,{opacity:0},{opacity:1,duration:t});const C=document.querySelectorAll(".sankey .mlp .last");l.set(C,{opacity:.4}),(me=document.querySelector("#purple-indigo"))==null||me.querySelectorAll("stop")[1];const y=(ye=document.querySelector("#purple-indigo-last"))==null?void 0:ye.querySelectorAll("stop")[1];rt(l,y,{});const g=document.querySelectorAll(".mlp .second-layer .projections .cell.last");l.fromTo(g,{opacity:0},{opacity:1,duration:t}),(Ge=document.querySelector("#indigo-blue"))==null||Ge.querySelectorAll("stop")[1];const u=(it=document.querySelector("#indigo-blue-last"))==null?void 0:it.querySelectorAll("stop")[1];rt(l,u,{});const E=document.querySelectorAll(".mlp .second-layer .ouputs .last");l.fromTo(E,{opacity:0},{opacity:1,duration:t});const b=document.querySelectorAll(".sankey .transformer-blocks .last");l.set(b,{opacity:.6});const N=(pe=document.querySelector("#blue-white-blue-last"))==null?void 0:pe.querySelectorAll("stop")[1],A=(Re=document.querySelector("#blue-white-blue-last"))==null?void 0:Re.querySelectorAll("stop")[3],j=mt.timeline({});rt(j,N,{duration:.3,offset:{to:"50%"},ease:"sine.inOut"}),rt(j,A,{duration:.3,offset:{from:"50%"},ease:"sine.inOut"}),l.add(j);const K=document.querySelectorAll(".transformer-blocks .cell.last");l.fromTo(K,{opacity:0},{opacity:1,duration:t});const ue=document.querySelectorAll(".sankey .linear-softmax .last");l.set(ue,{opacity:.6});const Y=(kt=document.querySelector("#blue-gray"))==null?void 0:kt.querySelectorAll("stop")[1];rt(l,Y,{});const G=document.querySelectorAll(".softmax .content");l.fromTo(G,{opacity:0},{opacity:1,duration:t})}),Ur=async()=>{};Sn.wasm.wasmPaths="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/";const Wr=async(n,e)=>{Wt.set(!0);const{token_ids:l,input_tokens:t}=await Yr(n);st.set(t),console.log(l);const{outputs:r,prediction:o}=await Qr(l),s=mn(o,e),f=vn(s);Et.set({outputs:r,prediction:s,sampled:f}),await xr(t.length),Mt.set(f),Wt.set(!1)},Xr=async(n,e)=>{const l=mn(n,e),t=vn(l);Et.update(r=>({...r,prediction:l})),await Ur(),Mt.set(t)},Zr=n=>{const e=Math.max(...n),l=n.map(r=>Math.exp(r-e)),t=l.reduce((r,o)=>r+o,0);return l.map(r=>r/t)},Yr=async n=>{const e=await pn.from_pretrained("Xenova/gpt2"),l=e.encode(n),t=l.map(r=>e.decode([r])).flat();return{token_ids:l,input_tokens:t}},Kr=(n,e,l,t)=>{const r=Array.from(n).map((o,s)=>({tokenId:s,logit:o,probability:e[s]}));return r.sort((o,s)=>s.probability-o.probability),r.slice(0,t).map((o,s)=>({...o,rank:s,token:l.decode([o.tokenId])}))},Qr=async n=>{try{const e=new Vn("int64",n,[1,n.length]),l=In(dn);if(!l)throw new Error("Model session is not initialized.");const t={input:e},r=await l.run(t),o=r.linear_output.data,s=Zr(o),f=await pn.from_pretrained("Xenova/gpt2"),a=Kr(o,s,f,100),d=Jr.reduce((h,m)=>{const k=r[m];return h[m]=k,h},{});return console.log(d),{outputs:d,prediction:a}}catch(e){throw console.error("Error during inference:",e.message),e}},Jr=["tok_emb","transformer_wpe_weight","pos_emb","input_emb","input_emb_dropout","block_0_ln_1_input_mean","block_0_ln_1_input_var","block_0_ln_1_input_normalized","block_0_ln_1_weight","block_0_ln_1_bias","block_0_ln_1_output","block_0_attn_head_0_q_weights","block_0_attn_head_0_k_weights","block_0_attn_head_0_v_weights","block_0_attn_head_0_q_bias","block_0_attn_head_0_k_bias","block_0_attn_head_0_v_bias","block_0_attn_head_0_q","block_0_attn_head_0_k","block_0_attn_head_0_v","block_0_attn_head_0_q_transposed","block_0_attn_head_0_k_transposed","block_0_attn_head_0_v_transposed","block_0_attn_head_0_attn","block_0_attn_head_0_attn_scaled","block_0_attn_head_0_attn_masked","block_0_attn_head_0_attn_softmax","block_0_attn_head_0_attn_dropout","block_0_attn_head_0_v_output","block_0_attn_v_output_combined","block_0_attn_proj_weights","block_0_attn_proj_bias","block_0_attn_attn_output","block_0_res_1","block_0_ln_2_input_mean","block_0_ln_2_input_var","block_0_ln_2_input_normalized","block_0_ln_2_weight","block_0_ln_2_bias","block_0_ln_2_output","block_0_mlp_linear_1_weight","block_0_mlp_linear_1_bias","block_0_mlp_linear_1_output","block_0_mlp_gelu_output","block_0_mlp_linear_2_weight","block_0_mlp_linear_2_bias","block_0_mlp_linear_2_output","block_0_mlp_output_after_dropout","block_0_res_2","ln_f_input_mean","ln_f_input_var","ln_f_input_normalized","ln_f_weight","ln_f_bias","ln_f_output","linear_weight","linear_output"];async function es(n){const e=await fetch(n);if(!e.ok)throw new Error(`Failed to fetch ${n}`);return e.arrayBuffer()}async function ts(n){const e=await Promise.all(n.map(o=>es(o))),l=e.reduce((o,s)=>o+s.byteLength,0),t=new Uint8Array(l);let r=0;for(const o of e)t.set(new Uint8Array(o),r),r+=o.byteLength;return t.buffer}function rn(n){let e,l,t,r,o,s,f;return l=new Tn({}),{c(){e=z("div"),oe(l.$$.fragment),this.h()},l(i){e=P(i,"DIV",{class:!0,style:!0,role:!0});var a=T(e);re(l.$$.fragment,a),a.forEach($),this.h()},h(){_(e,"class","qkv-weight-popover svelte-6mb5yb"),_(e,"style",t=`left:${n[0].left}px;top:${n[0].top}px;`),_(e,"role","group")},m(i,a){x(i,e,a),se(l,e,null),o=!0,s||(f=[ke(e,"mouseenter",n[3]),ke(e,"mouseleave",n[4])],s=!0)},p(i,a){(!o||a&1&&t!==(t=`left:${i[0].left}px;top:${i[0].top}px;`))&&_(e,"style",t)},i(i){o||(F(l.$$.fragment,i),i&&(r||Gt(()=>{r=Cn(e,Hn,{duration:300}),r.start()})),o=!0)},o(i){Z(l.$$.fragment,i),o=!1},d(i){i&&$(e),ie(l),s=!1,je(f)}}}function ls(n){let e,l,t=(n[2]==="embedding"||n[1])&&rn(n);return{c(){t&&t.c(),e=nt()},l(r){t&&t.l(r),e=nt()},m(r,o){t&&t.m(r,o),x(r,e,o),l=!0},p(r,[o]){r[2]==="embedding"||r[1]?t?(t.p(r,o),o&6&&F(t,1)):(t=rn(r),t.c(),F(t,1),t.m(e.parentNode,e)):t&&(Me(),Z(t,1,1,()=>{t=null}),Be())},i(r){l||(F(t),l=!0)},o(r){Z(t),l=!1},d(r){r&&$(e),t&&t.d(r)}}}function ns(n,e,l){let t;Ee(n,Ot,a=>l(2,t=a));let r,o={left:0,top:0},s=!1;return bt(()=>{const a=()=>{var H;const h=window.scrollX,m=(H=document.querySelector(".top-bar"))==null?void 0:H.offsetHeight,V=document.querySelector(".step.embedding .content").getBoundingClientRect();l(0,o={left:V.right+h,top:V.top-m})};return a(),r=new ResizeObserver(h=>{a()}),(document==null?void 0:document.querySelectorAll(".resize-watch")).forEach(h=>r.observe(h)),()=>{r.disconnect()}}),[o,s,t,()=>{l(1,s=!0)},()=>{l(1,s=!1)}]}class os extends Pe{constructor(e){super(),Te(this,e,ns,ls,ze,{})}}function rs(n){let e,l,t,r,o,s,f,i,a,d,h,m,k,V,H,R,X,q,S,B,O,M,L;return t=new so({}),f=new Br({props:{className:"step"}}),a=new Bo({props:{className:"step"}}),h=new Rr({props:{className:"step"}}),k=new xo({props:{className:"step"}}),H=new tr({props:{className:"step"}}),q=new os({}),{c(){e=z("div"),l=z("div"),oe(t.$$.fragment),r=U(),o=z("div"),s=z("div"),oe(f.$$.fragment),i=U(),oe(a.$$.fragment),d=U(),oe(h.$$.fragment),m=U(),oe(k.$$.fragment),V=U(),oe(H.$$.fragment),X=U(),oe(q.$$.fragment),S=U(),B=z("div"),this.h()},l(c){e=P(c,"DIV",{class:!0,style:!0});var p=T(e);l=P(p,"DIV",{class:!0});var v=T(l);re(t.$$.fragment,v),v.forEach($),r=W(p),o=P(p,"DIV",{class:!0});var w=T(o);s=P(w,"DIV",{class:!0});var I=T(s);re(f.$$.fragment,I),i=W(I),re(a.$$.fragment,I),d=W(I),re(h.$$.fragment,I),m=W(I),re(k.$$.fragment,I),V=W(I),re(H.$$.fragment,I),I.forEach($),X=W(w),re(q.$$.fragment,w),w.forEach($),S=W(p),B=P(p,"DIV",{class:!0}),T(B).forEach($),p.forEach($),this.h()},h(){_(l,"class","sankey opacity-1 svelte-t8edyo"),_(s,"class","steps svelte-t8edyo"),Gt(()=>n[6].call(s)),le(s,"expanded",n[2]),_(o,"class","nodes resize-watch svelte-t8edyo"),_(B,"class",O=he(fe("dim pointer-events-none",`${n[1].id||""}`,{active:!!n[1].id}))+" svelte-t8edyo"),_(e,"class","main-section h-full"),_(e,"style",M=`--vector-height: ${n[3]}px;--title-height: ${n[4]}px;`)},m(c,p){x(c,e,p),D(e,l),se(t,l,null),D(e,r),D(e,o),D(o,s),se(f,s,null),D(s,i),se(a,s,null),D(s,d),se(h,s,null),D(s,m),se(k,s,null),D(s,V),se(H,s,null),R=un(s,n[6].bind(s)),D(o,X),se(q,o,null),D(e,S),D(e,B),L=!0},p(c,[p]){(!L||p&4)&&le(s,"expanded",c[2]),(!L||p&2&&O!==(O=he(fe("dim pointer-events-none",`${c[1].id||""}`,{active:!!c[1].id}))+" svelte-t8edyo"))&&_(B,"class",O),(!L||p&8&&M!==(M=`--vector-height: ${c[3]}px;--title-height: ${c[4]}px;`))&&_(e,"style",M)},i(c){L||(F(t.$$.fragment,c),F(f.$$.fragment,c),F(a.$$.fragment,c),F(h.$$.fragment,c),F(k.$$.fragment,c),F(H.$$.fragment,c),F(q.$$.fragment,c),L=!0)},o(c){Z(t.$$.fragment,c),Z(f.$$.fragment,c),Z(a.$$.fragment,c),Z(h.$$.fragment,c),Z(k.$$.fragment,c),Z(H.$$.fragment,c),Z(q.$$.fragment,c),L=!1},d(c){c&&$(e),ie(t),ie(f),ie(a),ie(h),ie(k),ie(H),R(),ie(q)}}}function ss(n,e,l){let t,r,o,s,f;Ee(n,st,k=>l(5,t=k)),Ee(n,Et,k=>l(7,r=k)),Ee(n,jt,k=>l(8,o=k)),Ee(n,Qe,k=>l(1,s=k)),Ee(n,Vt,k=>l(3,f=k));let i=!1;bt(async()=>{const V=Array(10).fill(0).map((M,L)=>`${Xn}/gpt2-quant.onnx.part${L}`),H=await ts(V),R=new Blob([H],{type:"application/octet-stream"}),X=URL.createObjectURL(R),q=await Nn.create(X,{});dn.set(q);const S=An.subscribe(M=>{Wr(M,o)});let B=!0;const O=jt.subscribe(M=>{if(B){B=!1;return}Xr(r==null?void 0:r.prediction,M)});return()=>{S(),O()}});let a=0,d=_t*5;const h=()=>{const k=_t*.5*(t.length-1),V=Math.min(Math.max((a-d-k)/t.length/Mn,Bn),Ln);Vt.set(V),hn.set(t.length*V*3+k)};function m(){a=this.offsetHeight,l(0,a)}return n.$$.update=()=>{n.$$.dirty&2&&(s.id!==null?l(2,i=!0):l(2,i=!1)),n.$$.dirty&33&&(a||t.length)&&h()},[a,s,i,f,d,t,m]}class vs extends Pe{constructor(e){super(),Te(this,e,ss,rs,ze,{})}}export{vs as component,ms as universal};

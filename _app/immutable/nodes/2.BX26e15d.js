import{s as ze,G as Ot,D as Qt,H as Jt,I as Vn,J as gn,M as pn,N as mn,O as vn,a4 as Ie,a5 as De,d as T,g as $,p as _,j as x,n as Le,m as Ee,z as bt,C as pt,A as et,e as z,c as P,q as Ae,w as lt,b as U,h as W,k as D,o as Ce,af as he,P as Rt,ae as _n,v as we,r as je,a6 as At,u as le,E as Nt,t as ae,f as ce,l as Ve,a8 as An,ag as Nn}from"../chunks/scheduler.DwJgbGBW.js";import{S as Pe,i as Te,c as ne,a as oe,m as re,t as F,b as Z,d as se,g as Be,e as Me,h as Bn,j as Mn}from"../chunks/index.BqK3W3D7.js";import{r as ht,a as dt,t as st,m as $t,l as jt,e as ve,n as ft,o as Qe,v as Vt,q as kt,s as bn,p as Bt,u as Et,b as _t,h as Dt,w as Ln,d as Gt,Z as zn,f as el,M as Pn,x as $n,P as Tn,i as Hn,y as On,z as jn,A as Gn}from"../chunks/index.Czvmgksn.js";import{b as Ft,d as fe,f as Rn,e as Fn}from"../chunks/index.B6SuMdlM.js";import{s as Ct,a as We,M as vt,F as ut,Q as xn,f as Un}from"../chunks/QKVWeightPopover.BSyGmwO7.js";import{P as Wn,a as Mt,H as tl,A as wn}from"../chunks/image.BbYIOFIf.js";import{g as Xn,a as Zn,t as Yn,b as mt}from"../chunks/index.Bvv8kWA4.js";import{a as Kn,i as yn,b as Qn,c as Jn,l as eo}from"../chunks/linear.LCz6N8DR.js";import{b as to}from"../chunks/paths.KoexnSCr.js";function lo(n){let e;const l=n[4].default,t=gn(l,n,n[6],null);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,o){t&&t.m(r,o),e=!0},p(r,o){t&&t.p&&(!e||o&64)&&pn(t,l,r,r[6],e?vn(l,r[6],o,null):mn(r[6]),null)},i(r){e||(F(t,r),e=!0)},o(r){Z(t,r),e=!1},d(r){t&&t.d(r)}}}function no(n){let e,l;const t=[{rounded:!0},{shadow:!0},n[1],{class:n[0]}];let r={$$slots:{default:[lo]},$$scope:{ctx:n}};for(let o=0;o<t.length;o+=1)r=Ot(r,t[o]);return e=new Wn({props:r}),e.$on("show",n[5]),{c(){ne(e.$$.fragment)},l(o){oe(e.$$.fragment,o)},m(o,s){re(e,o,s),l=!0},p(o,[s]){const f=s&3?Xn(t,[t[0],t[1],s&2&&Zn(o[1]),s&1&&{class:o[0]}]):{};s&64&&(f.$$scope={dirty:s,ctx:o}),e.$set(f)},i(o){l||(F(e.$$.fragment,o),l=!0)},o(o){Z(e.$$.fragment,o),l=!1},d(o){se(e,o)}}}function oo(n,e,l){const t=["type","defaultClass"];let r=Qt(e,t),{$$slots:o={},$$scope:s}=e,{type:f="dark"}=e,{defaultClass:i="py-2 px-3 text-sm font-medium"}=e;const a={dark:"bg-gray-900 text-white dark:bg-gray-700",light:"border-gray-200 bg-white text-gray-900",auto:" bg-white text-gray-900 dark:bg-gray-700 dark:text-white border-gray-200 dark:border-gray-700",custom:""};let d;function h(m){Vn.call(this,n,m)}return n.$$set=m=>{l(8,e=Ot(Ot({},e),Jt(m))),l(1,r=Qt(e,t)),"type"in m&&l(2,f=m.type),"defaultClass"in m&&l(3,i=m.defaultClass),"$$scope"in m&&l(6,s=m.$$scope)},n.$$.update=()=>{r.color?l(2,f="custom"):l(1,r.color="none",r),["light","auto"].includes(f)&&l(1,r.border=!0,r),l(0,d=Yn("tooltip",i,a[f],e.class))},e=Jt(e),[d,r,f,i,o,h,s]}class Ue extends Pe{constructor(e){super(),Te(this,e,oo,no,ze,{type:2,defaultClass:3})}}function kn(n=[],e){const l=n.map(s=>s.logit/e),t=l.map(s=>Math.exp(s)),r=t.reduce((s,f)=>s+f,0);return n.map((s,f)=>({...s,adjustedLogit:l[f],adjustedProbability:t[f]/r,adjustedExp:t[f]}))}function En(n){const e=[];let l=0;for(const r of n)l+=r.probability,e.push(l);const t=Math.random();for(let r=0;r<e.length;r++)if(t<e[r])return n[r];return n[0]}const ro=!0,ks=Object.freeze(Object.defineProperty({__proto__:null,prerender:ro},Symbol.toStringTag,{value:"Module"}));function so(n,e){let l;if(e===void 0)for(const t of n)t!=null&&(l<t||l===void 0&&t>=t)&&(l=t);else{let t=-1;for(let r of n)(r=e(r,++t,n))!=null&&(l<r||l===void 0&&r>=r)&&(l=r)}return l}function io(n,e){e===void 0&&(e=n,n=Ft);for(var l=0,t=e.length-1,r=e[0],o=new Array(t<0?0:t);l<t;)o[l]=n(r,r=e[++l]);return function(s){var f=Math.max(0,Math.min(t-1,Math.floor(s*=t)));return o[f](s-f)}}function ao(n,e){return e.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function co(){var n=0,e=.5,l=1,t=1,r,o,s,f,i,a=yn,d,h=!1,m;function w(H){return isNaN(H=+H)?m:(H=.5+((H=+d(H))-o)*(t*H<t*o?f:i),a(h?Math.max(0,Math.min(1,H)):H))}w.domain=function(H){return arguments.length?([n,e,l]=H,r=d(n=+n),o=d(e=+e),s=d(l=+l),f=r===o?0:.5/(o-r),i=o===s?0:.5/(s-o),t=o<r?-1:1,w):[n,e,l]},w.clamp=function(H){return arguments.length?(h=!!H,w):h},w.interpolator=function(H){return arguments.length?(a=H,w):a};function V(H){return function(R){var X,q,S;return arguments.length?([X,q,S]=R,a=io(H,[X,q,S]),w):[a(0),a(.5),a(1)]}}return w.range=V(Ft),w.rangeRound=V(Jn),w.unknown=function(H){return arguments.length?(m=H,w):m},function(H){return d=H,r=H(n),o=H(e),s=H(l),f=r===o?0:.5/(o-r),i=o===s?0:.5/(s-o),t=o<r?-1:1,w}}function In(){var n=Kn(co()(yn));return n.copy=function(){return ao(n,In())},Qn.apply(n,arguments)}const{theme:ee}=ht(dt),de=200,ll={"gray-blue":{0:ee.colors.gray[de],100:ee.colors.blue[de]},"gray-blue-last":{0:ee.colors.gray[de],100:ee.colors.blue[de]},"purple-indigo":{0:ee.colors.purple[de],100:ee.colors.indigo[de]},"purple-indigo-last":{0:ee.colors.purple[de],100:ee.colors.indigo[de]},"indigo-blue":{0:ee.colors.indigo[de],100:ee.colors.blue[de]},"indigo-blue-last":{0:ee.colors.indigo[de],100:ee.colors.blue[de]},"blue-white":{0:ee.colors.blue[de],100:ee.colors.white},"red-white":{0:ee.colors.red[de],100:ee.colors.white},"green-white":{0:ee.colors.green[de],100:ee.colors.white},"red-purple":{0:ee.colors.red[de],100:ee.colors.purple[de]},"blue-purple":{90:ee.colors.blue[de],100:ee.colors.purple[de]},"green-purple":{0:ee.colors.green[de],100:ee.colors.purple[de]},"blue-gray":{0:ee.colors.blue[de],100:ee.colors.gray[de]},"blue-white-blue":{0:ee.colors.blue[de],40:ee.colors.white,60:ee.colors.white,100:ee.colors.blue[de]},"blue-white-blue-last":{0:ee.colors.blue[de],40:ee.colors.white,60:ee.colors.white,100:ee.colors.blue[de]},"transparent-purple":{0:{color:ee.colors.purple[100],opacity:0},100:{color:ee.colors.purple[100],opacity:1}},"transparent-purple2":{0:{color:ee.colors.purple[400],opacity:0},100:{color:ee.colors.purple[200],opacity:1}},"transparent-purple-last":{0:{color:ee.colors.purple[100],opacity:0},100:{color:ee.colors.purple[100],opacity:1}},"transparent-purple2-last":{0:{color:ee.colors.purple[400],opacity:0},100:{color:ee.colors.purple[200],opacity:1}},"blue-blue":{0:ee.colors.blue[de],100:ee.colors.blue[de]},"red-red":{0:ee.colors.red[de],100:ee.colors.red[de]},"green-green":{0:ee.colors.green[de],100:ee.colors.green[de]},"blue-blue2":{0:ee.colors.blue[de],100:ee.colors.blue[de]},"red-red2":{0:ee.colors.red[de],100:ee.colors.red[de]},"green-green2":{0:ee.colors.green[de],100:ee.colors.green[de]},"blue-blue-last":{0:ee.colors.blue[de],100:ee.colors.blue[de]},"red-red-last":{0:ee.colors.red[de],100:ee.colors.red[de]},"green-green-last":{0:ee.colors.green[de],100:ee.colors.green[de]},"blue-blue2-last":{0:ee.colors.blue[de],100:ee.colors.blue[de]},"red-red2-last":{0:ee.colors.red[de],100:ee.colors.red[de]},"green-green2-last":{0:ee.colors.green[de],100:ee.colors.green[de]},"gray-gray":{0:ee.colors.gray[de],100:ee.colors.gray[de]},"purple-purple":{0:ee.colors.purple[de],100:ee.colors.purple[de]},"purple-purple-last":{0:ee.colors.purple[de],100:ee.colors.purple[de]}};function fo(n){let e,l,t,r;return{c(){e=Ie("svg"),t=Ie("svg"),this.h()},l(o){e=De(o,"svg",{id:!0,class:!0,style:!0}),T(e).forEach($),t=De(o,"svg",{class:!0,style:!0}),T(t).forEach($),this.h()},h(){_(e,"id","back"),_(e,"class","sankey-back absolute left-0 top-0 h-full w-full"),_(e,"style",l=`z-index:${n[2].attention_head_num-1};`),_(t,"class","sankey-top absolute left-0 top-0 h-full w-full"),_(t,"style",r=`z-index:${n[2].attention_head_num};`)},m(o,s){x(o,e,s),n[4](e),x(o,t,s),n[5](t)},p(o,[s]){s&4&&l!==(l=`z-index:${o[2].attention_head_num-1};`)&&_(e,"style",l),s&4&&r!==(r=`z-index:${o[2].attention_head_num};`)&&_(t,"style",r)},i:Le,o:Le,d(o){o&&($(e),$(t)),n[4](null),n[5](null)}}}const uo=80;function ho(n,e,l){let t,r,o;Ee(n,st,S=>l(3,r=S)),Ee(n,$t,S=>l(2,o=S));const{theme:s}=ht(dt);let f,i,a;const d={attention:[{from:".attention .query .head-rest",to:".head-block .query .vector",gradientId:"blue-blue2",opacity:.4},{from:".attention .key .head-rest",to:".head-block .key .vector",gradientId:"red-red2",opacity:.4},{from:".attention .value .head-rest",to:".head-block .value .vector",gradientId:"green-green2",opacity:.4},{from:".attention .head-out .vector",to:".mlp .initial .vector .head-rest",gradientId:"transparent-purple",opacity:.4}]},h=()=>{const M=We(i).append("defs");Object.keys(ll).forEach(O=>{const B=ll[O],L=M.append("linearGradient").attr("id",O).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");Object.keys(B).forEach(c=>{let g,v;typeof B[c]!="string"?(g=B[c].color,v=B[c].opacity):(g=B[c],v=1),L.append("stop").attr("offset",`${c}%`).attr("stop-color",g).attr("stop-opacity",v)})})};let m=1,w;const V=async()=>{await pt();const S=We(i),M=We(f);[{dataMap:t,svg:S},{dataMap:d,svg:M}].forEach(({dataMap:O,svg:B})=>{B.selectAll("g.path-group").data(Object.keys(O)).join("g").attr("class",c=>`path-group ${c}`).on("mouseenter",(c,g)=>{clearTimeout(w),jt.set(g);const v=We(`g.${g}`).selectAll("path");m=v.nodes()[0].getAttribute("opacity"),v.transition().duration(300).style("opacity",Number(m)+.2)}).on("mouseleave",(c,g)=>{w=setTimeout(()=>{jt.set(null)},300),We(`g.${g}`).selectAll("path").transition().duration(300).style("opacity",m)}).selectAll("path.sankey-path").data(c=>O[c].map(v=>{const y=Ct(v.from).nodes(),I=Ct(v.to).nodes();return y.map((C,k)=>{const p=C.getBoundingClientRect(),u=I[k].getBoundingClientRect(),E=v.curve||uo,A=(v.pathGenerator||H)(p,u,E),N=I.length>1&&k===y.length-1;let j=v.gradientId;return N&&document.getElementById(v.gradientId+"-last")&&(j=v.gradientId+"-last"),{id:v.id,isLast:k===y.length-1,path:A,fill:v.type==="stroke"?"none":v.gradientId?`url(#${j})`:v.fill,opacity:v.opacity,stroke:v.type==="stroke"?v.gradientId?`url(#${v.gradientId})`:v.fill:"none"}})}).flat()).join("path").attr("class",c=>`sankey-path ${c.id||""} ${c.isLast?"last":""}`).attr("fill",c=>c.fill).attr("stroke",c=>c.stroke).attr("stroke-width",2).attr("opacity",c=>c.opacity||1).attr("d",c=>c.path)})},H=(S,M,O)=>{const B=window.scrollY,L=window.scrollX;return`
        M ${S.right+L},${S.top+B}
        C ${S.right+L+O},${S.top+B} ${M.left+L-O},${M.top+B} ${M.left+L},${M.top+B}
        L ${M.left+L},${M.bottom+B}
        C ${M.left+L-O},${M.bottom+B} ${S.right+L+O},${S.bottom+B} ${S.right+L},${S.bottom+B}
        Z
    `};bt(()=>(h(),a=new ResizeObserver(M=>{V(),R()}),(document==null?void 0:document.querySelectorAll(".resize-watch")).forEach(M=>a.observe(M)),()=>{a.disconnect()}));const R=()=>{const S=We(i),M=Ct(".residual-start path.head").nodes(),O=Ct(".residual-end path.head").nodes(),B=M.map((L,c)=>{const g=L.getBoundingClientRect(),v=O[c].getBoundingClientRect(),y=g.right,I=g.top,C=v.left,k=v.top;return{x1:y,y1:I,x2:C,y2:k,id:L.id}});S.selectAll("line.residual-connector").data(B).join("line").attr("class",L=>`residual-connector ${L.id}`).attr("x1",L=>L.x1).attr("y1",L=>L.y1).attr("x2",L=>L.x2).attr("y2",L=>L.y2).attr("stroke",s.colors.gray[400]).attr("stroke-width",1).style("opacity",0)};function X(S){et[S?"unshift":"push"](()=>{f=S,l(0,f)})}function q(S){et[S?"unshift":"push"](()=>{i=S,l(1,i)})}return n.$$.update=()=>{n.$$.dirty&8&&(t={embedding:[{from:".embedding .vector-column .column.vectors .vector",to:".attention .vector",gradientId:"gray-blue",opacity:.6,pathGenerator:(S,M,O)=>{const B=window.scrollY,L=window.scrollX,c=30;return`
					M ${S.right+L},${S.top+B}
					L ${S.right+c+L},${S.top+B}
					C ${S.right+c+L+O},${S.top+B} ${M.left+L-O},${M.top+B} ${M.left+L},${M.top+B}
					L ${M.left+L},${M.bottom+B}
					C ${M.left+L-O},${M.bottom+B} ${S.right+c+L+O},${S.bottom+B} ${S.right+c+L},${S.bottom+B}
					L ${S.right+L},${S.bottom+B}
					Z
				`}}],attention:[{from:".attention .query .sub-vector.head1",to:".head-block .query .vector",gradientId:"blue-blue"},{from:".attention .key .sub-vector.head1",to:".head-block .key .vector",gradientId:"red-red"},{from:".attention .value .sub-vector.head1",to:".head-block .value .vector",gradientId:"green-green"},{from:".attention .head-out .vector",to:".mlp .initial .head1",gradientId:"purple-purple"},{from:".head-block .key .vector",to:".attention-initial .main g.g-row",id:"key-to-attention",type:"stroke",gradientId:"red-purple",curve:30,pathGenerator:(S,M,O)=>{const B=window.scrollY,L=window.scrollX,c=S.top+B+S.height/2,g=M.top+B+M.height/2,v=S.right+L+O,y=M.left+L-O;return`
			    M ${S.right+L},${c}
			    C ${v},${c} ${y},${g} ${M.left+L},${g}
					L ${M.right+L},${g}
			`}},{from:".head-block .query .vector",to:`.attention-matrix.attention-initial .main g.g-row-${r.length-1} circle`,gradientId:"blue-purple",id:"query-to-attention",type:"stroke",curve:20,pathGenerator:(S,M,O)=>{const B=window.scrollY,L=window.scrollX,c=S.top+B+S.height/2,g=M.left+L+M.width/2;return`
			    M ${S.right+L},${c}
			    L ${g-O},${c}
			    A ${O},${O} 0 0 1 ${g},${c+O}
			    L ${g},${M.bottom+B}
			`}},{from:".attention-matrix.attention-out .main svg",to:".attention .head-out",gradientId:"transparent-purple2",id:"to-attention-out",opacity:.4,curve:20,pathGenerator:(S,M,O)=>{const B=window.scrollY,L=window.scrollX;return`
			    M ${S.right+L},${S.top+B}
			    C ${S.right+L+O},${S.top+B} ${M.left+L-O},${M.top+B} ${M.left+L},${M.top+B}
			    L ${M.left+L},${M.bottom+B}
			    C ${M.left+L-O},${M.bottom+B} ${S.right+L+O},${S.bottom+B} ${S.right+L},${S.bottom+B}
			    Z
			`}},{from:".head-block .value",to:".attention .head-out",gradientId:"green-purple",id:"to-attention-out",opacity:.4,curve:60,pathGenerator:(S,M,O)=>{const B=window.scrollY,L=window.scrollX;return`
        M ${S.right+L},${S.top+B} 
        C ${M.left-O},${S.top+B} ${M.left+L-O},${S.top+B} ${M.left+L},${M.top+B}
        L ${M.left+L},${M.bottom+B}
        C ${M.left+L-O},${S.bottom+B} ${M.left-O},${S.bottom+B} ${S.right+L},${S.bottom+B}
        Z
    `}}],mlp:[{from:".mlp .column.initial .vector",to:".mlp .projections .vector",gradientId:"purple-indigo",curve:50,opacity:.4,pathGenerator:(S,M,O)=>{const B=window.scrollY,L=window.scrollX,c=49;return`
					M ${S.right+L},${S.top+B}
					L ${S.right+c+L},${S.top+B}
					C ${S.right+c+L+O},${S.top+B} ${M.left+L-O},${M.top+B} ${M.left+L},${M.top+B}
					L ${M.left+L},${M.bottom+B}
					C ${M.left+L-O},${M.bottom+B} ${S.right+c+L+O},${S.bottom+B} ${S.right+c+L},${S.bottom+B}
					L ${S.right+L},${S.bottom+B}
					Z
				`}},{from:".mlp .projections .vector",to:".mlp .column.out .vector",gradientId:"indigo-blue",curve:50,opacity:.4,pathGenerator:(S,M,O)=>{const B=window.scrollY,L=window.scrollX,c=20;return`
					M ${S.right+L},${S.top+B}
					C ${S.right+L+O},${S.top+B} ${M.left-c+L-O},${M.top+B} ${M.left-c+L},${M.top+B}
					L ${M.left+L},${M.top+B}
					L ${M.left+L},${M.bottom+B}
					L ${M.left-c+L},${M.bottom+B}
					C ${M.left-c+L-O},${M.bottom+B} ${S.right+L+O},${S.bottom+B} ${S.right+L},${S.bottom+B}
					L ${S.right+L},${S.bottom+B}
					Z
				`}}],"transformer-blocks":[{from:".mlp .out .vector",to:".transformer-blocks .column.final .vector",gradientId:"blue-white-blue",opacity:.6,pathGenerator:(S,M,O)=>{const B=window.scrollY,L=window.scrollX;return`
        M ${S.right+L},${S.top+B}
        C ${S.right+L+O},${S.top+B} ${M.left+L-O},${M.top+B} ${M.left+L},${M.top+B}
        L ${M.left+L},${M.bottom+B}
        C ${M.left+L-O},${M.bottom+B} ${S.right+L+O},${S.bottom+B} ${S.right+L},${S.bottom+B}
        Z
    `}}],"linear-softmax":[{from:".transformer-blocks .final .vector.last-token ",to:".softmax .content .vector",gradientId:"blue-gray",opacity:.4}]}),n.$$.dirty&8&&typeof window<"u"&&r&&(V(),R())},[f,i,o,r,X,q]}class go extends Pe{constructor(e){super(),Te(this,e,ho,fo,ze,{})}}function nl(n,e,l){const t=n.slice();return t[6]=e[l],t[8]=l,t}function po(n){let e,l,t,r,o;return{c(){e=z("div"),l=z("div"),r=U(),this.h()},l(s){e=P(s,"DIV",{class:!0,style:!0});var f=T(e);l=P(f,"DIV",{class:!0,style:!0}),T(l).forEach($),r=W(f),f.forEach($),this.h()},h(){_(l,"class","card svelte-z5n2f7"),_(l,"style",t=`width: ${n[1].width}px; height: ${n[1].height}px;`),_(e,"class","rest absolute"),_(e,"style",o=`transform:translate(${n[8]*ft.x}px,${n[8]*ft.y}px) scale(${1-ft.scale*n[8]}); 
      z-index: ${n[2].attention_head_num-n[8]};opacity:${Math.max(.1,1-n[8]*rl)};`)},m(s,f){x(s,e,f),D(e,l),D(e,r)},p(s,f){f&2&&t!==(t=`width: ${s[1].width}px; height: ${s[1].height}px;`)&&_(l,"style",t),f&4&&o!==(o=`transform:translate(${s[8]*ft.x}px,${s[8]*ft.y}px) scale(${1-ft.scale*s[8]}); 
      z-index: ${s[2].attention_head_num-s[8]};opacity:${Math.max(.1,1-s[8]*rl)};`)&&_(e,"style",o)},i:Le,o:Le,d(s){s&&$(e)}}}function mo(n){let e,l,t;const r=n[4].default,o=gn(r,n,n[3],null);return{c(){e=z("div"),o&&o.c(),l=U(),this.h()},l(s){e=P(s,"DIV",{class:!0,style:!0});var f=T(e);o&&o.l(f),l=W(f),f.forEach($),this.h()},h(){_(e,"class","w-full"),_(e,"style","z-index: 200;")},m(s,f){x(s,e,f),o&&o.m(e,null),D(e,l),n[5](e),t=!0},p(s,f){o&&o.p&&(!t||f&8)&&pn(o,r,s,s[3],t?vn(r,s[3],f,null):mn(s[3]),null)},i(s){t||(F(o,s),t=!0)},o(s){Z(o,s),t=!1},d(s){s&&$(e),o&&o.d(s),n[5](null)}}}function ol(n){let e,l,t,r;const o=[mo,po],s=[];function f(i,a){return i[8]===0?0:1}return e=f(n),l=s[e]=o[e](n),{c(){l.c(),t=lt()},l(i){l.l(i),t=lt()},m(i,a){s[e].m(i,a),x(i,t,a),r=!0},p(i,a){l.p(i,a)},i(i){r||(F(l),r=!0)},o(i){Z(l),r=!1},d(i){i&&$(t),s[e].d(i)}}}function vo(n){let e,l,t=ve(Array(n[2].attention_head_num+1).fill(0)),r=[];for(let s=0;s<t.length;s+=1)r[s]=ol(nl(n,t,s));const o=s=>Z(r[s],1,1,()=>{r[s]=null});return{c(){e=z("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=P(s,"DIV",{class:!0});var f=T(e);for(let i=0;i<r.length;i+=1)r[i].l(f);f.forEach($),this.h()},h(){_(e,"class","multi-head flex w-full svelte-z5n2f7")},m(s,f){x(s,e,f);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null);l=!0},p(s,[f]){if(f&15){t=ve(Array(s[2].attention_head_num+1).fill(0));let i;for(i=0;i<t.length;i+=1){const a=nl(s,t,i);r[i]?(r[i].p(a,f),F(r[i],1)):(r[i]=ol(a),r[i].c(),F(r[i],1),r[i].m(e,null))}for(Be(),i=t.length;i<r.length;i+=1)o(i);Me()}},i(s){if(!l){for(let f=0;f<t.length;f+=1)F(r[f]);l=!0}},o(s){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)Z(r[f]);l=!1},d(s){s&&$(e),Ae(r,s)}}}let rl=.1;function _o(n,e,l){let t;Ee(n,$t,a=>l(2,t=a));let{$$slots:r={},$$scope:o}=e,s,f={width:0,height:0};bt(()=>{const a=new ResizeObserver(d=>{for(let h of d){const{width:m,height:w}=h.contentRect;l(1,f={width:m,height:w})}});return a.observe(s),()=>{a.unobserve(s)}});function i(a){et[a?"unshift":"push"](()=>{s=a,l(0,s)})}return n.$$set=a=>{"$$scope"in a&&l(3,o=a.$$scope)},[s,f,t,o,r,i]}class bo extends Pe{constructor(e){super(),Te(this,e,_o,vo,ze,{})}}const at=n=>n;function $o(n){let e,l,t,r,o,s,f="QK<sup>T</sup>",i,a,d,h,m,w,V,H,R,X="Mask",q,S,M,O,B,L,c,g,v="Softmax",y,I,C,k,p,u,E="Attention",b,A,N,j,K,ue;return r=new vt({props:{className:"main",data:n[0],showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),m=new vt({props:{className:"prev absolute top-0 left-0 pointer-events-none",data:n[0],showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),V=new vt({props:{className:"main opacity-0",data:at(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),O=new vt({props:{className:"prev absolute top-0 left-0  pointer-events-none",data:at(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),L=new vt({props:{className:"main opacity-0",data:at(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,showValue:!0,shape:"circle",colorScale:"purple"}}),k=new vt({props:{className:"main",data:at(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,showValue:!1,shape:"circle",colorScale:"purple"}}),{c(){e=z("div"),l=z("div"),t=z("div"),ne(r.$$.fragment),o=U(),s=z("div"),s.innerHTML=f,a=U(),d=z("div"),h=z("div"),ne(m.$$.fragment),w=U(),ne(V.$$.fragment),H=U(),R=z("div"),R.textContent=X,q=U(),S=z("div"),M=z("div"),ne(O.$$.fragment),B=U(),ne(L.$$.fragment),c=U(),g=z("div"),g.textContent=v,I=U(),C=z("div"),ne(k.$$.fragment),p=U(),u=z("div"),u.textContent=E,this.h()},l(Y){e=P(Y,"DIV",{class:!0});var G=T(e);l=P(G,"DIV",{role:!0,tabindex:!0,class:!0});var te=T(l);t=P(te,"DIV",{class:!0});var ie=T(t);oe(r.$$.fragment,ie),o=W(ie),s=P(ie,"DIV",{class:!0,"data-svelte-h":!0}),Ce(s)!=="svelte-1gw7aya"&&(s.innerHTML=f),ie.forEach($),a=W(te),d=P(te,"DIV",{class:!0});var Q=T(d);h=P(Q,"DIV",{});var ke=T(h);oe(m.$$.fragment,ke),w=W(ke),oe(V.$$.fragment,ke),ke.forEach($),H=W(Q),R=P(Q,"DIV",{class:!0,"data-svelte-h":!0}),Ce(R)!=="svelte-1kil1k9"&&(R.textContent=X),Q.forEach($),q=W(te),S=P(te,"DIV",{class:!0});var qe=T(S);M=P(qe,"DIV",{});var pe=T(M);oe(O.$$.fragment,pe),B=W(pe),oe(L.$$.fragment,pe),pe.forEach($),c=W(qe),g=P(qe,"DIV",{class:!0,"data-svelte-h":!0}),Ce(g)!=="svelte-1w9l1cd"&&(g.textContent=v),qe.forEach($),I=W(te),C=P(te,"DIV",{class:!0});var He=T(C);oe(k.$$.fragment,He),p=W(He),u=P(He,"DIV",{class:!0,"data-svelte-h":!0}),Ce(u)!=="svelte-1t0maa5"&&(u.textContent=E),He.forEach($),te.forEach($),G.forEach($),this.h()},h(){_(s,"class","text-gray-400"),_(t,"class",i=he(fe("attention-matrix attention-qk flex flex-col items-center",{"attention-initial":n[1]}))+" svelte-1lvbtg6"),_(R,"class","text-gray-400"),_(d,"class","attention-matrix attention-mask flex flex-col items-center svelte-1lvbtg6"),_(g,"class","text-gray-400"),_(S,"class",y=he(fe("attention-matrix attention-softmax flex flex-col items-center",{"attention-out":n[1]}))+" svelte-1lvbtg6"),_(u,"class","text-gray-400"),_(C,"class",b=he(fe("attention-matrix attention-result flex flex-col items-center",{"attention-initial":!n[1],"attention-out":!n[1]}))+" svelte-1lvbtg6"),Rt(()=>n[15].call(C)),_(l,"role","button"),_(l,"tabindex","0"),_(l,"class",N=he(fe("attention-matrix-container relative flex gap-3 p-3 pb-1",{active:n[1]}))+" svelte-1lvbtg6"),_(e,"class","flex items-center gap-8 px-10")},m(Y,G){x(Y,e,G),D(e,l),D(l,t),re(r,t,null),D(t,o),D(t,s),n[11](t),D(l,a),D(l,d),D(d,h),re(m,h,null),D(h,w),re(V,h,null),D(d,H),D(d,R),n[12](d),D(l,q),D(l,S),D(S,M),re(O,M,null),D(M,B),re(L,M,null),D(S,c),D(S,g),n[13](S),D(l,I),D(l,C),re(k,C,null),D(C,p),D(C,u),n[14](C),A=_n(C,n[15].bind(C)),j=!0,K||(ue=[we(l,"click",n[8]),we(l,"keydown",n[8])],K=!0)},p(Y,[G]){const te={};G&1&&(te.data=Y[0]),G&128&&(te.cellHeight=Y[7]),G&128&&(te.cellWidth=Y[7]),r.$set(te),(!j||G&2&&i!==(i=he(fe("attention-matrix attention-qk flex flex-col items-center",{"attention-initial":Y[1]}))+" svelte-1lvbtg6"))&&_(t,"class",i);const ie={};G&1&&(ie.data=Y[0]),G&128&&(ie.cellHeight=Y[7]),G&128&&(ie.cellWidth=Y[7]),m.$set(ie);const Q={};G&1&&(Q.data=at(Y[0])),G&128&&(Q.cellHeight=Y[7]),G&128&&(Q.cellWidth=Y[7]),V.$set(Q);const ke={};G&1&&(ke.data=at(Y[0])),G&128&&(ke.cellHeight=Y[7]),G&128&&(ke.cellWidth=Y[7]),O.$set(ke);const qe={};G&1&&(qe.data=at(Y[0])),G&128&&(qe.cellHeight=Y[7]),G&128&&(qe.cellWidth=Y[7]),L.$set(qe),(!j||G&2&&y!==(y=he(fe("attention-matrix attention-softmax flex flex-col items-center",{"attention-out":Y[1]}))+" svelte-1lvbtg6"))&&_(S,"class",y);const pe={};G&1&&(pe.data=at(Y[0])),G&128&&(pe.cellHeight=Y[7]),G&128&&(pe.cellWidth=Y[7]),k.$set(pe),(!j||G&2&&b!==(b=he(fe("attention-matrix attention-result flex flex-col items-center",{"attention-initial":!Y[1],"attention-out":!Y[1]}))+" svelte-1lvbtg6"))&&_(C,"class",b),(!j||G&2&&N!==(N=he(fe("attention-matrix-container relative flex gap-3 p-3 pb-1",{active:Y[1]}))+" svelte-1lvbtg6"))&&_(l,"class",N)},i(Y){j||(F(r.$$.fragment,Y),F(m.$$.fragment,Y),F(V.$$.fragment,Y),F(O.$$.fragment,Y),F(L.$$.fragment,Y),F(k.$$.fragment,Y),j=!0)},o(Y){Z(r.$$.fragment,Y),Z(m.$$.fragment,Y),Z(V.$$.fragment,Y),Z(O.$$.fragment,Y),Z(L.$$.fragment,Y),Z(k.$$.fragment,Y),j=!1},d(Y){Y&&$(e),se(r),n[11](null),se(m),se(V),n[12](null),se(O),se(L),n[13](null),se(k),n[14](null),A(),K=!1,je(ue)}}}let wo=16,yo=20,ko=10;function Eo(n,e,l){let t,r,o;Ee(n,st,c=>l(9,r=c)),Ee(n,Qe,c=>l(10,o=c)),ht(dt);let{data:s}=e,f,i,a,d,h=0,m=!1;const w=At("block-id"),V=()=>{l(1,m=!m),m?(Qe.set({id:w}),X()):(Qe.set({id:null}),q())};let H=mt.timeline(),R=mt.timeline();const X=()=>{R.progress(1);const c=document.querySelectorAll("div.sankey g.attention path.key-to-attention"),g=document.querySelectorAll("div.sankey g.attention path.query-to-attention"),v=document.querySelectorAll("div.sankey g.attention path.to-attention-out");[...c,...g].forEach(C=>{const k=C.getTotalLength();C.style.strokeDasharray=k,C.style.strokeDashoffset=k});const y=1.2,I=Number((y/r.length).toFixed(2));H.set([i.querySelector(".prev"),a.querySelector(".prev")],{opacity:1}).set([i.querySelector(".main"),a.querySelector(".main")],{opacity:0}),H.set(v,{opacity:0}),H.to(d,{opacity:0,display:"none",duration:.2}),H.set(f,{width:"auto",display:"flex",opacity:0}).to(f,{opacity:1,duration:.5}).to(c,{strokeDashoffset:0,stagger:I,duration:y,ease:"power2.out"}).to(g,{strokeDashoffset:0,stagger:I,duration:y,ease:"power2.out"},"<").from(f.querySelectorAll("svg circle"),{scale:0,transformOrigin:"50% 50%",opacity:0,delay:y/r.length,stagger:Number((y/Math.pow(r.length,2)).toFixed(2)),ease:"power2.out",duration:y},"<"),H.set(i,{width:0,x:h*-1,opacity:0}).to(i,{opacity:1,display:"flex",width:h,x:0,duration:.5}).to(i.querySelector(".prev"),{opacity:0,duration:1}).to(i.querySelector(".main"),{opacity:1,duration:1},"<"),H.set(a,{width:0,x:h*-1,opacity:0}).to(a,{opacity:1,display:"flex",width:h,x:0,duration:.4}).to(a.querySelector(".prev"),{opacity:0,duration:1}).to(a.querySelector(".main"),{opacity:1,duration:1},"<"),H.to(v,{opacity:.5})},q=()=>{H.progress(1),R.to([f,i,a],{opacity:0,display:"none",width:0,duration:.5}),R.to(d,{opacity:1,display:"flex",duration:.5},0)};function S(c){et[c?"unshift":"push"](()=>{f=c,l(2,f)})}function M(c){et[c?"unshift":"push"](()=>{i=c,l(3,i)})}function O(c){et[c?"unshift":"push"](()=>{a=c,l(4,a)})}function B(c){et[c?"unshift":"push"](()=>{d=c,l(5,d)})}function L(){h=this.offsetWidth,l(6,h)}return n.$$set=c=>{"data"in c&&l(0,s=c.data)},n.$$.update=()=>{n.$$.dirty&512&&l(7,t=Math.min(yo,Math.max(1/r.length*wo*6,ko))),n.$$.dirty&1026&&o.id!==w&&m&&(l(1,m=!1),q())},[s,m,f,i,a,d,h,t,V,r,o,S,M,O,B,L]}class Io extends Pe{constructor(e){super(),Te(this,e,Eo,$o,ze,{data:0})}}function Do(n){let e;return{c(){e=z("canvas"),this.h()},l(l){e=P(l,"CANVAS",{class:!0}),T(e).forEach($),this.h()},h(){_(e,"class","svelte-ex5m8"),le(e,"active",n[0])},m(l,t){x(l,e,t),n[4](e)},p(l,[t]){t&1&&le(e,"active",l[0])},i:Le,o:Le,d(l){l&&$(e),n[4](null)}}}let Co=100;const zt=1;function qo(n,e,l){const{theme:t}=ht(dt);let{active:r=!1}=e,{data:o=new Array(Co).fill(0).map(m=>Math.random())}=e,{colorScale:s=void 0}=e,f;const i=typeof s=="string"?s:"gray",a=typeof s=="function"?s:Ft(t.colors[i][100],t.colors[i][400]);function d(){const m=f.getContext("2d");if(!m)return;const w=f.parentElement.clientWidth,V=f.parentElement.clientHeight;m.clearRect(0,0,w,V);let H=4;l(1,f.width=w*H,f),l(1,f.height=V*H,f),l(1,f.style.width=`${w}px`,f),l(1,f.style.height=`${V}px`,f);for(let R=0;R<V/zt;R++){const X=o[R];m.fillStyle=a(X),m.fillRect(0,R*zt*H,w*H,zt*H)}}bt(()=>{const m=Vt.subscribe(d);return()=>{m()}});function h(m){et[m?"unshift":"push"](()=>{f=m,l(1,f)})}return n.$$set=m=>{"active"in m&&l(0,r=m.active),"data"in m&&l(2,o=m.data),"colorScale"in m&&l(3,s=m.colorScale)},n.$$.update=()=>{n.$$.dirty&6&&o&&f&&d()},[r,f,o,s,h]}class tt extends Pe{constructor(e){super(),Te(this,e,qo,Do,ze,{active:0,data:2,colorScale:3})}}function sl(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function il(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function al(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function cl(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function fl(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function So(n){let e,l=n[6].dimension*3+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension*3+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Vo(n){let e,l=n[6].dimension/n[6].attention_head_num+"",t,r;return{c(){e=ae("Head1 Query, size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"Head1 Query, size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension/o[6].attention_head_num+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Ao(n){let e,l=n[6].dimension/n[6].attention_head_num+"",t,r;return{c(){e=ae("Head1 Key, size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"Head1 Key, size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension/o[6].attention_head_num+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function No(n){let e,l=n[6].dimension/n[6].attention_head_num+"",t,r;return{c(){e=ae("Head1 Value size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"Head1 Value size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension/o[6].attention_head_num+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Bo(n){let e,l=n[6].dimension/n[6].attention_head_num+"",t,r;return{c(){e=ae("Head1 Attention Out, size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"Head1 Attention Out, size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&64&&l!==(l=o[6].dimension/o[6].attention_head_num+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function ul(n){let e,l="Q";return{c(){e=z("span"),e.textContent=l},l(t){e=P(t,"SPAN",{"data-svelte-h":!0}),Ce(e)!=="svelte-10ub4hf"&&(e.textContent=l)},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function hl(n){let e,l="K";return{c(){e=z("span"),e.textContent=l},l(t){e=P(t,"SPAN",{"data-svelte-h":!0}),Ce(e)!=="svelte-1c09r6x"&&(e.textContent=l)},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function dl(n){let e,l="V";return{c(){e=z("span"),e.textContent=l},l(t){e=P(t,"SPAN",{"data-svelte-h":!0}),Ce(e)!=="svelte-j40kxg"&&(e.textContent=l)},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function gl(n){let e,l,t,r,o,s,f,i,a,d,h,m,w,V,H,R,X,q,S,M,O,B,L,c,g;t=new tt({props:{colorScale:"blue",active:n[3]===n[17]}});let v=n[3]!==n[17]&&ul();d=new tt({props:{colorScale:"red",active:n[3]===n[17]}});let y=n[3]!==n[17]&&hl();X=new tt({props:{colorScale:"green",active:n[3]===n[17]}});let I=n[3]!==n[17]&&dl();function C(){return n[11](n[17])}return{c(){e=z("div"),l=z("div"),ne(t.$$.fragment),r=U(),o=z("div"),s=U(),f=z("div"),v&&v.c(),i=U(),a=z("div"),ne(d.$$.fragment),h=U(),m=z("div"),w=U(),V=z("div"),y&&y.c(),H=U(),R=z("div"),ne(X.$$.fragment),q=U(),S=z("div"),M=U(),O=z("div"),I&&I.c(),B=U(),this.h()},l(k){e=P(k,"DIV",{class:!0,role:!0});var p=T(e);l=P(p,"DIV",{class:!0});var u=T(l);oe(t.$$.fragment,u),r=W(u),o=P(u,"DIV",{class:!0}),T(o).forEach($),s=W(u),f=P(u,"DIV",{class:!0});var E=T(f);v&&v.l(E),E.forEach($),u.forEach($),i=W(p),a=P(p,"DIV",{class:!0});var b=T(a);oe(d.$$.fragment,b),h=W(b),m=P(b,"DIV",{class:!0}),T(m).forEach($),w=W(b),V=P(b,"DIV",{class:!0});var A=T(V);y&&y.l(A),A.forEach($),b.forEach($),H=W(p),R=P(p,"DIV",{class:!0});var N=T(R);oe(X.$$.fragment,N),q=W(N),S=P(N,"DIV",{class:!0}),T(S).forEach($),M=W(N),O=P(N,"DIV",{class:!0});var j=T(O);I&&I.l(j),j.forEach($),N.forEach($),B=W(p),p.forEach($),this.h()},h(){_(o,"class",he(`sub-vector x1-12 head1 ${Dn}`)+" svelte-1m1b7zh"),_(f,"class","sub-vector head-rest grow svelte-1m1b7zh"),_(l,"class",he(`sub-vector query relative flex grow flex-col ${zo}`)+" svelte-1m1b7zh"),_(m,"class",he(`sub-vector x1-12 head1 ${Cn}`)+" svelte-1m1b7zh"),_(V,"class","sub-vector head-rest grow svelte-1m1b7zh"),_(a,"class",he(`sub-vector key relative flex grow flex-col ${Po}`)+" svelte-1m1b7zh"),_(S,"class",he(`sub-vector x1-12 head1 ${qn}`)+" svelte-1m1b7zh"),_(O,"class","sub-vector head-rest grow svelte-1m1b7zh"),_(R,"class",he(`sub-vector value relative flex grow flex-col ${To}`)+" svelte-1m1b7zh"),_(e,"class","qkv-weighted vector x3 flex flex-col"),_(e,"role","group"),le(e,"last",n[17]===n[1].length-1)},m(k,p){x(k,e,p),D(e,l),re(t,l,null),D(l,r),D(l,o),D(l,s),D(l,f),v&&v.m(f,null),D(e,i),D(e,a),re(d,a,null),D(a,h),D(a,m),D(a,w),D(a,V),y&&y.m(V,null),D(e,H),D(e,R),re(X,R,null),D(R,q),D(R,S),D(R,M),D(R,O),I&&I.m(O,null),D(e,B),L=!0,c||(g=[we(e,"mouseenter",C),we(e,"mouseleave",n[12])],c=!0)},p(k,p){n=k;const u={};p&8&&(u.active=n[3]===n[17]),t.$set(u),n[3]!==n[17]?v||(v=ul(),v.c(),v.m(f,null)):v&&(v.d(1),v=null);const E={};p&8&&(E.active=n[3]===n[17]),d.$set(E),n[3]!==n[17]?y||(y=hl(),y.c(),y.m(V,null)):y&&(y.d(1),y=null);const b={};p&8&&(b.active=n[3]===n[17]),X.$set(b),n[3]!==n[17]?I||(I=dl(),I.c(),I.m(O,null)):I&&(I.d(1),I=null),(!L||p&2)&&le(e,"last",n[17]===n[1].length-1)},i(k){L||(F(t.$$.fragment,k),F(d.$$.fragment,k),F(X.$$.fragment,k),L=!0)},o(k){Z(t.$$.fragment,k),Z(d.$$.fragment,k),Z(X.$$.fragment,k),L=!1},d(k){k&&$(e),se(t),v&&v.d(),se(d),y&&y.d(),se(X),I&&I.d(),c=!1,je(g)}}}function pl(n){let e,l,t=n[15]+"",r,o,s,f;return{c(){e=z("div"),l=z("span"),r=ae(t),o=U(),s=z("div"),f=U(),this.h()},l(i){e=P(i,"DIV",{class:!0});var a=T(e);l=P(a,"SPAN",{class:!0});var d=T(l);r=ce(d,t),d.forEach($),o=W(a),s=P(a,"DIV",{class:!0}),T(s).forEach($),f=W(a),a.forEach($),this.h()},h(){_(l,"class","label float svelte-1m1b7zh"),_(s,"class",he(`vector x1-12  ${Dn}`)+" svelte-1m1b7zh"),_(e,"class","head1 cell x1-12 text-xs"),le(e,"last",n[17]===n[1].length-1)},m(i,a){x(i,e,a),D(e,l),D(l,r),D(e,o),D(e,s),D(e,f)},p(i,a){a&2&&t!==(t=i[15]+"")&&Ve(r,t),a&2&&le(e,"last",i[17]===i[1].length-1)},d(i){i&&$(e)}}}function ml(n){let e,l,t=n[15]+"",r,o,s,f,i;return{c(){e=z("div"),l=z("span"),r=ae(t),o=U(),s=z("div"),f=U(),this.h()},l(a){e=P(a,"DIV",{class:!0});var d=T(e);l=P(d,"SPAN",{class:!0});var h=T(l);r=ce(h,t),h.forEach($),o=W(d),s=P(d,"DIV",{class:!0}),T(s).forEach($),f=W(d),d.forEach($),this.h()},h(){_(l,"class","label float svelte-1m1b7zh"),_(s,"class",he(`vector x1-12 ${Cn}`)+" svelte-1m1b7zh"),_(e,"class",i="head1 cell x1-12 text-xs class:last="+(n[17]===n[1].length-1)+" svelte-1m1b7zh")},m(a,d){x(a,e,d),D(e,l),D(l,r),D(e,o),D(e,s),D(e,f)},p(a,d){d&2&&t!==(t=a[15]+"")&&Ve(r,t),d&2&&i!==(i="head1 cell x1-12 text-xs class:last="+(a[17]===a[1].length-1)+" svelte-1m1b7zh")&&_(e,"class",i)},d(a){a&&$(e)}}}function vl(n){let e,l,t=n[15]+"",r,o,s,f;return{c(){e=z("div"),l=z("span"),r=ae(t),o=U(),s=z("div"),f=U(),this.h()},l(i){e=P(i,"DIV",{class:!0});var a=T(e);l=P(a,"SPAN",{class:!0});var d=T(l);r=ce(d,t),d.forEach($),o=W(a),s=P(a,"DIV",{class:!0}),T(s).forEach($),f=W(a),a.forEach($),this.h()},h(){_(l,"class","label float svelte-1m1b7zh"),_(s,"class",he(`vector x1-12 ${qn}`)+" svelte-1m1b7zh"),_(e,"class","head1 cell x1-12 text-xs"),le(e,"last",n[17]===n[1].length-1)},m(i,a){x(i,e,a),D(e,l),D(l,r),D(e,o),D(e,s),D(e,f)},p(i,a){a&2&&t!==(t=i[15]+"")&&Ve(r,t),a&2&&le(e,"last",i[17]===i[1].length-1)},d(i){i&&$(e)}}}function _l(n){let e,l,t;return{c(){e=z("div"),l=z("div"),t=U(),this.h()},l(r){e=P(r,"DIV",{class:!0});var o=T(e);l=P(o,"DIV",{class:!0}),T(l).forEach($),t=W(o),o.forEach($),this.h()},h(){_(l,"class",he(`vector x1-12 ${Ho}`)+" svelte-1m1b7zh"),_(e,"class","head1 cell x1-12"),le(e,"last",n[17]===n[1].length-1)},m(r,o){x(r,e,o),D(e,l),D(e,t)},p(r,o){o&2&&le(e,"last",r[17]===r[1].length-1)},d(r){r&&$(e)}}}function Mo(n){let e,l,t,r,o="Query",s,f,i,a,d="Key",h,m,w,V,H="Value",R,X,q,S,M,O,B,L,c="Out",g,v,y,I,C=n[6].attention_head_num+"",k,p,u,E=ve(n[1]),b=[];for(let G=0;G<E.length;G+=1)b[G]=pl(cl(n,E,G));let A=ve(n[1]),N=[];for(let G=0;G<A.length;G+=1)N[G]=ml(al(n,A,G));let j=ve(n[1]),K=[];for(let G=0;G<j.length;G+=1)K[G]=vl(il(n,j,G));S=new Io({props:{data:n[4]}});let ue=ve(n[1]),Y=[];for(let G=0;G<ue.length;G+=1)Y[G]=_l(sl(n,ue,G));return{c(){e=z("div"),l=z("div"),t=z("div"),r=z("div"),r.textContent=o,s=U();for(let G=0;G<b.length;G+=1)b[G].c();f=U(),i=z("div"),a=z("div"),a.textContent=d,h=U();for(let G=0;G<N.length;G+=1)N[G].c();m=U(),w=z("div"),V=z("div"),V.textContent=H,R=U();for(let G=0;G<K.length;G+=1)K[G].c();X=U(),q=z("div"),ne(S.$$.fragment),M=U(),O=z("div"),B=z("div"),L=z("div"),L.textContent=c,g=U();for(let G=0;G<Y.length;G+=1)Y[G].c();v=U(),y=z("div"),I=ae("Head 1 of "),k=ae(C),this.h()},l(G){e=P(G,"DIV",{class:!0,style:!0});var te=T(e);l=P(te,"DIV",{class:!0});var ie=T(l);t=P(ie,"DIV",{class:!0});var Q=T(t);r=P(Q,"DIV",{class:!0,"data-svelte-h":!0}),Ce(r)!=="svelte-1a2739d"&&(r.textContent=o),s=W(Q);for(let be=0;be<b.length;be+=1)b[be].l(Q);Q.forEach($),f=W(ie),i=P(ie,"DIV",{class:!0});var ke=T(i);a=P(ke,"DIV",{class:!0,"data-svelte-h":!0}),Ce(a)!=="svelte-bmmhtu"&&(a.textContent=d),h=W(ke);for(let be=0;be<N.length;be+=1)N[be].l(ke);ke.forEach($),m=W(ie),w=P(ie,"DIV",{class:!0});var qe=T(w);V=P(qe,"DIV",{class:!0,"data-svelte-h":!0}),Ce(V)!=="svelte-17pe084"&&(V.textContent=H),R=W(qe);for(let be=0;be<K.length;be+=1)K[be].l(qe);qe.forEach($),ie.forEach($),X=W(te),q=P(te,"DIV",{class:!0});var pe=T(q);oe(S.$$.fragment,pe),pe.forEach($),M=W(te),O=P(te,"DIV",{class:!0});var He=T(O);B=P(He,"DIV",{class:!0});var Se=T(B);L=P(Se,"DIV",{class:!0,"data-svelte-h":!0}),Ce(L)!=="svelte-68unf9"&&(L.textContent=c),g=W(Se);for(let be=0;be<Y.length;be+=1)Y[be].l(Se);Se.forEach($),He.forEach($),v=W(te),y=P(te,"DIV",{class:!0});var _e=T(y);I=ce(_e,"Head 1 of "),k=ce(_e,C),_e.forEach($),te.forEach($),this.h()},h(){_(r,"class","title svelte-1m1b7zh"),_(t,"class","column query"),_(a,"class","title svelte-1m1b7zh"),_(i,"class","column key"),_(V,"class","title svelte-1m1b7zh"),_(w,"class","column value"),_(l,"class","qkv flex h-full flex-col justify-center gap-[5rem] pl-[6rem]"),_(q,"class","resize-watch attention-matrix flex"),_(L,"class","title svelte-1m1b7zh"),_(B,"class","column out"),_(O,"class","head-out mx-[2rem]"),_(y,"class","head-title absolute bottom-2 right-3 text-right text-gray-400"),_(e,"class","head-block flex w-full items-center justify-between px-2"),_(e,"style",p=`height:${n[7]}px;`)},m(G,te){x(G,e,te),D(e,l),D(l,t),D(t,r),D(t,s);for(let ie=0;ie<b.length;ie+=1)b[ie]&&b[ie].m(t,null);D(l,f),D(l,i),D(i,a),D(i,h);for(let ie=0;ie<N.length;ie+=1)N[ie]&&N[ie].m(i,null);D(l,m),D(l,w),D(w,V),D(w,R);for(let ie=0;ie<K.length;ie+=1)K[ie]&&K[ie].m(w,null);D(e,X),D(e,q),re(S,q,null),D(e,M),D(e,O),D(O,B),D(B,L),D(B,g);for(let ie=0;ie<Y.length;ie+=1)Y[ie]&&Y[ie].m(B,null);D(e,v),D(e,y),D(y,I),D(y,k),u=!0},p(G,te){if(te&2){E=ve(G[1]);let Q;for(Q=0;Q<E.length;Q+=1){const ke=cl(G,E,Q);b[Q]?b[Q].p(ke,te):(b[Q]=pl(ke),b[Q].c(),b[Q].m(t,null))}for(;Q<b.length;Q+=1)b[Q].d(1);b.length=E.length}if(te&2){A=ve(G[1]);let Q;for(Q=0;Q<A.length;Q+=1){const ke=al(G,A,Q);N[Q]?N[Q].p(ke,te):(N[Q]=ml(ke),N[Q].c(),N[Q].m(i,null))}for(;Q<N.length;Q+=1)N[Q].d(1);N.length=A.length}if(te&2){j=ve(G[1]);let Q;for(Q=0;Q<j.length;Q+=1){const ke=il(G,j,Q);K[Q]?K[Q].p(ke,te):(K[Q]=vl(ke),K[Q].c(),K[Q].m(w,null))}for(;Q<K.length;Q+=1)K[Q].d(1);K.length=j.length}const ie={};if(te&16&&(ie.data=G[4]),S.$set(ie),te&2){ue=ve(G[1]);let Q;for(Q=0;Q<ue.length;Q+=1){const ke=sl(G,ue,Q);Y[Q]?Y[Q].p(ke,te):(Y[Q]=_l(ke),Y[Q].c(),Y[Q].m(B,null))}for(;Q<Y.length;Q+=1)Y[Q].d(1);Y.length=ue.length}(!u||te&64)&&C!==(C=G[6].attention_head_num+"")&&Ve(k,C),(!u||te&128&&p!==(p=`height:${G[7]}px;`))&&_(e,"style",p)},i(G){u||(F(S.$$.fragment,G),u=!0)},o(G){Z(S.$$.fragment,G),u=!1},d(G){G&&$(e),Ae(b,G),Ae(N,G),Ae(K,G),se(S),Ae(Y,G)}}}function Lo(n){let e,l,t="<div>Multi-head Self Attention</div>",r,o,s,f,i,a,d,h,m,w,V,H,R,X,q,S,M,O,B,L,c,g,v,y,I;m=new Ue({props:{triggeredBy:".attention .qkv-weighted",placement:"right",class:"popover text-sm font-light",$$slots:{default:[So]},$$scope:{ctx:n}}}),V=new Ue({props:{triggeredBy:".attention .query .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Vo]},$$scope:{ctx:n}}}),R=new Ue({props:{triggeredBy:".attention .key .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Ao]},$$scope:{ctx:n}}}),q=new Ue({props:{triggeredBy:".attention .value .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[No]},$$scope:{ctx:n}}}),M=new Ue({props:{triggeredBy:".attention .out .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Bo]},$$scope:{ctx:n}}});let C=ve(n[1]),k=[];for(let u=0;u<C.length;u+=1)k[u]=gl(fl(n,C,u));const p=u=>Z(k[u],1,1,()=>{k[u]=null});return c=new bo({props:{$$slots:{default:[Mo]},$$scope:{ctx:n}}}),{c(){e=z("div"),l=z("div"),l.innerHTML=t,r=U(),o=z("div"),s=z("div"),f=U(),i=z("div"),d=U(),h=z("div"),ne(m.$$.fragment),w=U(),ne(V.$$.fragment),H=U(),ne(R.$$.fragment),X=U(),ne(q.$$.fragment),S=U(),ne(M.$$.fragment),O=U();for(let u=0;u<k.length;u+=1)k[u].c();B=U(),L=z("div"),ne(c.$$.fragment),this.h()},l(u){e=P(u,"DIV",{class:!0});var E=T(e);l=P(E,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-n6swon"&&(l.innerHTML=t),r=W(E),o=P(E,"DIV",{class:!0});var b=T(o);s=P(b,"DIV",{class:!0}),T(s).forEach($),f=W(b),i=P(b,"DIV",{class:!0,style:!0}),T(i).forEach($),d=W(b),h=P(b,"DIV",{class:!0});var A=T(h);oe(m.$$.fragment,A),w=W(A),oe(V.$$.fragment,A),H=W(A),oe(R.$$.fragment,A),X=W(A),oe(q.$$.fragment,A),S=W(A),oe(M.$$.fragment,A),O=W(A);for(let j=0;j<k.length;j+=1)k[j].l(A);A.forEach($),B=W(b),L=P(b,"DIV",{class:!0});var N=T(L);oe(c.$$.fragment,N),N.forEach($),b.forEach($),E.forEach($),this.h()},h(){_(l,"class","title svelte-1m1b7zh"),_(l,"role","group"),_(s,"class","bounding transformer-bounding svelte-1m1b7zh"),le(s,"active",n[5]),_(i,"class","bounding attention-bounding svelte-1m1b7zh"),_(i,"style",a=`padding-bottom:${n[6].attention_head_num*ft.y}px`),le(i,"active",n[2]&&!n[8]),_(h,"class","column"),_(L,"class","heads svelte-1m1b7zh"),_(o,"class","content relative svelte-1m1b7zh"),_(e,"class",g=he(fe("attention",n[0]))+" svelte-1m1b7zh")},m(u,E){x(u,e,E),D(e,l),D(e,r),D(e,o),D(o,s),D(o,f),D(o,i),D(o,d),D(o,h),re(m,h,null),D(h,w),re(V,h,null),D(h,H),re(R,h,null),D(h,X),re(q,h,null),D(h,S),re(M,h,null),D(h,O);for(let b=0;b<k.length;b+=1)k[b]&&k[b].m(h,null);D(o,B),D(o,L),re(c,L,null),v=!0,y||(I=[we(l,"mouseenter",n[9]),we(l,"mouseleave",n[10])],y=!0)},p(u,[E]){(!v||E&32)&&le(s,"active",u[5]),(!v||E&64&&a!==(a=`padding-bottom:${u[6].attention_head_num*ft.y}px`))&&_(i,"style",a),(!v||E&260)&&le(i,"active",u[2]&&!u[8]);const b={};E&4194368&&(b.$$scope={dirty:E,ctx:u}),m.$set(b);const A={};E&4194368&&(A.$$scope={dirty:E,ctx:u}),V.$set(A);const N={};E&4194368&&(N.$$scope={dirty:E,ctx:u}),R.$set(N);const j={};E&4194368&&(j.$$scope={dirty:E,ctx:u}),q.$set(j);const K={};if(E&4194368&&(K.$$scope={dirty:E,ctx:u}),M.$set(K),E&10){C=ve(u[1]);let Y;for(Y=0;Y<C.length;Y+=1){const G=fl(u,C,Y);k[Y]?(k[Y].p(G,E),F(k[Y],1)):(k[Y]=gl(G),k[Y].c(),F(k[Y],1),k[Y].m(h,null))}for(Be(),Y=C.length;Y<k.length;Y+=1)p(Y);Me()}const ue={};E&4194514&&(ue.$$scope={dirty:E,ctx:u}),c.$set(ue),(!v||E&1&&g!==(g=he(fe("attention",u[0]))+" svelte-1m1b7zh"))&&_(e,"class",g)},i(u){if(!v){F(m.$$.fragment,u),F(V.$$.fragment,u),F(R.$$.fragment,u),F(q.$$.fragment,u),F(M.$$.fragment,u);for(let E=0;E<C.length;E+=1)F(k[E]);F(c.$$.fragment,u),v=!0}},o(u){Z(m.$$.fragment,u),Z(V.$$.fragment,u),Z(R.$$.fragment,u),Z(q.$$.fragment,u),Z(M.$$.fragment,u),k=k.filter(Boolean);for(let E=0;E<k.length;E+=1)Z(k[E]);Z(c.$$.fragment,u),v=!1},d(u){u&&$(e),se(m),se(V),se(R),se(q),se(M),Ae(k,u),se(c),y=!1,je(I)}}}const zo="bg-blue-200",Po="bg-red-200",To="bg-green-200",Dn="bg-blue-300",Cn="bg-red-300",qn="bg-green-300",Ho="bg-purple-300";function Oo(n,e,l){let t,r,o,s,f,i;Ee(n,st,q=>l(1,r=q)),Ee(n,Qe,q=>l(13,o=q)),Ee(n,kt,q=>l(5,s=q)),Ee(n,$t,q=>l(6,f=q)),Ee(n,bn,q=>l(7,i=q));let{className:a=void 0}=e;Nt("block-id","attention");const d=At("block-id");let h=o.id===d,m=!1;function w(){l(2,m=!0)}function V(){l(2,m=!1)}let H=null;const R=q=>{l(3,H=q)},X=()=>{l(3,H=null)};return n.$$set=q=>{"className"in q&&l(0,a=q.className)},n.$$.update=()=>{n.$$.dirty&2&&l(4,t=Array(r.length).fill(0).map(q=>Array(r.length).fill(0).map(S=>Math.random())))},[a,r,m,H,t,s,f,i,h,w,V,R,X]}class jo extends Pe{constructor(e){super(),Te(this,e,Oo,Lo,ze,{className:0})}}function Go(n){let e,l,t,r,o,s,f,i=n[3]&&bl(n);return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),i&&i.c(),o=Ie("path"),this.h()},l(a){e=P(a,"DIV",{class:!0});var d=T(e);l=P(d,"DIV",{class:!0}),T(l).forEach($),t=W(d),r=De(d,"svg",{class:!0});var h=T(r);i&&i.l(h),o=De(h,"path",{d:!0,class:!0}),T(o).forEach($),h.forEach($),d.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"d",s=`M0,0 L0,${n[6]}`),_(o,"class","svelte-1jqlo12"),_(r,"class","main svelte-1jqlo12"),_(e,"class",f=he(fe("residual residual-end cell",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(a,d){x(a,e,d),D(e,l),D(e,t),D(e,r),i&&i.m(r,null),D(r,o)},p(a,d){a[3]?i?i.p(a,d):(i=bl(a),i.c(),i.m(r,o)):i&&(i.d(1),i=null),d&64&&s!==(s=`M0,0 L0,${a[6]}`)&&_(o,"d",s),d&2&&f!==(f=he(fe("residual residual-end cell",a[1]))+" svelte-1jqlo12")&&_(e,"class",f),d&34&&le(e,"active",a[5])},d(a){a&&$(e),i&&i.d()}}}function Ro(n){let e,l,t,r,o,s,f,i=n[3]&&$l(n);return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),i&&i.c(),o=Ie("path"),this.h()},l(a){e=P(a,"DIV",{class:!0});var d=T(e);l=P(d,"DIV",{class:!0}),T(l).forEach($),t=W(d),r=De(d,"svg",{class:!0});var h=T(r);i&&i.l(h),o=De(h,"path",{d:!0,class:!0}),T(o).forEach($),h.forEach($),d.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"d",s=`M0,0 L0,${n[6]}`),_(o,"class","svelte-1jqlo12"),_(r,"class","main svelte-1jqlo12"),_(e,"class",f=he(fe("residual residual-start cell",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(a,d){x(a,e,d),D(e,l),D(e,t),D(e,r),i&&i.m(r,null),D(r,o)},p(a,d){a[3]?i?i.p(a,d):(i=$l(a),i.c(),i.m(r,o)):i&&(i.d(1),i=null),d&64&&s!==(s=`M0,0 L0,${a[6]}`)&&_(o,"d",s),d&2&&f!==(f=he(fe("residual residual-start cell",a[1]))+" svelte-1jqlo12")&&_(e,"class",f),d&34&&le(e,"active",a[5])},d(a){a&&$(e),i&&i.d()}}}function Fo(n){let e,l,t,r,o,s,f,i,a,d=n[4]&&wl();return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),o=Ie("circle"),s=Ie("path"),i=U(),d&&d.c(),this.h()},l(h){e=P(h,"DIV",{class:!0});var m=T(e);l=P(m,"DIV",{class:!0}),T(l).forEach($),t=W(m),r=De(m,"svg",{class:!0});var w=T(r);o=De(w,"circle",{class:!0,cx:!0,cy:!0,r:!0}),T(o).forEach($),s=De(w,"path",{class:!0,d:!0}),T(s).forEach($),w.forEach($),i=W(m),d&&d.l(m),m.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"class","icon svelte-1jqlo12"),_(o,"cx","50%"),_(o,"cy","50%"),_(o,"r","3"),_(s,"class","line svelte-1jqlo12"),_(s,"d",f=`
     M 0 0
    C 0 ${n[6]*.25}, ${n[6]*.2} ${n[6]*.25}, ${n[6]*.2} ${n[6]*.5}
    C ${n[6]*.2} ${n[6]*.75}, 0 ${n[6]*.75}, 0 ${n[6]}
  `),_(r,"class","main svelte-1jqlo12"),_(e,"class",a=he(fe("cell ln",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(h,m){x(h,e,m),D(e,l),D(e,t),D(e,r),D(r,o),D(r,s),D(e,i),d&&d.m(e,null)},p(h,m){m&64&&f!==(f=`
     M 0 0
    C 0 ${h[6]*.25}, ${h[6]*.2} ${h[6]*.25}, ${h[6]*.2} ${h[6]*.5}
    C ${h[6]*.2} ${h[6]*.75}, 0 ${h[6]*.75}, 0 ${h[6]}
  `)&&_(s,"d",f),h[4]?d||(d=wl(),d.c(),d.m(e,null)):d&&(d.d(1),d=null),m&2&&a!==(a=he(fe("cell ln",h[1]))+" svelte-1jqlo12")&&_(e,"class",a),m&34&&le(e,"active",h[5])},d(h){h&&$(e),d&&d.d()}}}function xo(n){let e,l,t,r,o,s,f,i,a,d=n[4]&&yl();return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),o=Ie("path"),f=Ie("circle"),i=U(),d&&d.c(),this.h()},l(h){e=P(h,"DIV",{class:!0});var m=T(e);l=P(m,"DIV",{class:!0}),T(l).forEach($),t=W(m),r=De(m,"svg",{class:!0});var w=T(r);o=De(w,"path",{class:!0,d:!0}),T(o).forEach($),f=De(w,"circle",{class:!0,cx:!0,cy:!0,r:!0}),T(f).forEach($),w.forEach($),i=W(m),d&&d.l(m),m.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"class","line svelte-1jqlo12"),_(o,"d",s=`M0,0 L0,${n[6]}`),_(f,"class","icon svelte-1jqlo12"),_(f,"cx","50%"),_(f,"cy","50%"),_(f,"r","3"),_(r,"class","main svelte-1jqlo12"),_(e,"class",a=he(fe("cell dropout",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(h,m){x(h,e,m),D(e,l),D(e,t),D(e,r),D(r,o),D(r,f),D(e,i),d&&d.m(e,null)},p(h,m){m&64&&s!==(s=`M0,0 L0,${h[6]}`)&&_(o,"d",s),h[4]?d||(d=yl(),d.c(),d.m(e,null)):d&&(d.d(1),d=null),m&2&&a!==(a=he(fe("cell dropout",h[1]))+" svelte-1jqlo12")&&_(e,"class",a),m&34&&le(e,"active",h[5])},d(h){h&&$(e),d&&d.d()}}}function Uo(n){let e,l,t,r,o,s,f;return{c(){e=z("div"),l=z("div"),t=U(),r=Ie("svg"),o=Ie("path"),s=Ie("circle"),this.h()},l(i){e=P(i,"DIV",{class:!0});var a=T(e);l=P(a,"DIV",{class:!0}),T(l).forEach($),t=W(a),r=De(a,"svg",{class:!0});var d=T(r);o=De(d,"path",{class:!0,d:!0}),T(o).forEach($),s=De(d,"circle",{class:!0,cx:!0,cy:!0,r:!0}),T(s).forEach($),d.forEach($),a.forEach($),this.h()},h(){_(l,"class","cursor svelte-1jqlo12"),_(o,"class","line line1 svelte-1jqlo12"),_(o,"d","M0,0 L0,90%"),_(s,"class","icon svelte-1jqlo12"),_(s,"cx","50%"),_(s,"cy","50%"),_(s,"r","3"),_(r,"class","main svelte-1jqlo12"),_(e,"class",f=he(fe("cell activation",n[1]))+" svelte-1jqlo12"),le(e,"active",n[5])},m(i,a){x(i,e,a),D(e,l),D(e,t),D(e,r),D(r,o),D(r,s)},p(i,a){a&2&&f!==(f=he(fe("cell activation",i[1]))+" svelte-1jqlo12")&&_(e,"class",f),a&34&&le(e,"active",i[5])},d(i){i&&$(e)}}}function bl(n){let e;return{c(){e=Ie("path"),this.h()},l(l){e=De(l,"path",{id:!0,class:!0,d:!0}),T(e).forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class","head svelte-1jqlo12"),_(e,"d","M0,0 Q0,-16 -30,-16")},m(l,t){x(l,e,t)},p(l,t){t&1&&_(e,"id",l[0])},d(l){l&&$(e)}}}function $l(n){let e,l,t;return{c(){e=Ie("path"),l=Ie("text"),t=ae("Residual"),this.h()},l(r){e=De(r,"path",{id:!0,class:!0,d:!0}),T(e).forEach($),l=De(r,"text",{x:!0,y:!0,dy:!0,dx:!0,class:!0});var o=T(l);t=ce(o,"Residual"),o.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class","head svelte-1jqlo12"),_(e,"d","M0,0 Q0,-16 30,-16"),_(l,"x","30"),_(l,"y","-26"),_(l,"dy","4"),_(l,"dx","4"),_(l,"class","svelte-1jqlo12")},m(r,o){x(r,e,o),x(r,l,o),D(l,t)},p(r,o){o&1&&_(e,"id",r[0])},d(r){r&&($(e),$(l))}}}function wl(n){let e,l,t,r;return{c(){e=Ie("svg"),l=Ie("path"),t=Ie("text"),r=ae("Layer Normalization"),this.h()},l(o){e=De(o,"svg",{class:!0,width:!0});var s=T(e);l=De(s,"path",{d:!0,class:!0}),T(l).forEach($),t=De(s,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var f=T(t);r=ce(f,"Layer Normalization"),f.forEach($),s.forEach($),this.h()},h(){_(l,"d","M27.3536 4.35355C27.5488 4.15829 27.5488 3.84171 27.3536 3.64645L24.1716 0.46447C23.9763 0.269208 23.6597 0.269208 23.4645 0.464471C23.2692 0.659733 23.2692 0.976316 23.4645 1.17158L26.2929 4L23.4645 6.82843C23.2692 7.02369 23.2692 7.34028 23.4645 7.53554C23.6597 7.7308 23.9763 7.7308 24.1716 7.53554L27.3536 4.35355ZM27 3.5C20.3125 3.50001 15.2969 6.63952 11.5638 11.7944C7.84616 16.9278 5.39057 24.0677 3.75991 32.1346C0.498061 48.2711 0.5 68.3247 0.5 84H1.5C1.5 68.2984 1.50194 48.352 4.74009 32.3328C6.35943 24.3218 8.77884 17.3448 12.3737 12.3809C15.9531 7.4384 20.6875 4.50001 27 4.5V3.5Z"),_(l,"class","svelte-1jqlo12"),_(t,"x","4"),_(t,"y","95"),_(t,"text-anchor","middle"),_(t,"class","svelte-1jqlo12"),_(e,"class","guide svelte-1jqlo12"),_(e,"width","27px"),le(e,"active",!1)},m(o,s){x(o,e,s),D(e,l),D(e,t),D(t,r)},d(o){o&&$(e)}}}function yl(n){let e,l,t,r;return{c(){e=Ie("svg"),l=Ie("path"),t=Ie("text"),r=ae("Dropout"),this.h()},l(o){e=De(o,"svg",{class:!0,width:!0});var s=T(e);l=De(s,"path",{d:!0,class:!0}),T(l).forEach($),t=De(s,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var f=T(t);r=ce(f,"Dropout"),f.forEach($),s.forEach($),this.h()},h(){_(l,"d","M44.3186 4.46399C44.5314 4.28801 44.5613 3.97284 44.3853 3.76004L41.5175 0.292199C41.3416 0.0793953 41.0264 0.0495441 40.8136 0.225525C40.6008 0.401505 40.5709 0.716677 40.7469 0.929481L43.296 4.012L40.2135 6.56113C40.0007 6.73711 39.9709 7.05228 40.1468 7.26509C40.3228 7.47789 40.638 7.50774 40.8508 7.33176L44.3186 4.46399ZM44.0471 3.58091C38.7621 3.08034 27.8926 4.80481 18.3357 11.5838C8.74613 18.386 0.5 30.2626 0.5 50H1.5C1.5 30.5889 9.58721 19.0154 18.9143 12.3994C28.2741 5.76023 38.9045 4.0983 43.9529 4.57645L44.0471 3.58091Z"),_(l,"class","svelte-1jqlo12"),_(t,"x","4"),_(t,"y","60"),_(t,"text-anchor","middle"),_(t,"class","svelte-1jqlo12"),_(e,"class","guide svelte-1jqlo12"),_(e,"width","44px"),le(e,"active",!1)},m(o,s){x(o,e,s),D(e,l),D(e,t),D(t,r)},d(o){o&&$(e)}}}function Wo(n){let e;function l(o,s){if(o[2]==="activation")return Uo;if(o[2]==="dropout")return xo;if(o[2]==="ln")return Fo;if(o[2]==="residual-start")return Ro;if(o[2]==="residual-end")return Go}let t=l(n),r=t&&t(n);return{c(){r&&r.c(),e=lt()},l(o){r&&r.l(o),e=lt()},m(o,s){r&&r.m(o,s),x(o,e,s)},p(o,[s]){t===(t=l(o))&&r?r.p(o,s):(r&&r.d(1),r=t&&t(o),r&&(r.c(),r.m(e.parentNode,e)))},i:Le,o:Le,d(o){o&&$(e),r&&r.d(o)}}}function Xo(n,e,l){let t;Ee(n,Vt,d=>l(6,t=d));let{id:r=void 0}=e,{className:o=void 0}=e,{type:s=void 0}=e,{head:f=!1}=e,{tail:i=!1}=e,{active:a=!1}=e;return n.$$set=d=>{"id"in d&&l(0,r=d.id),"className"in d&&l(1,o=d.className),"type"in d&&l(2,s=d.type),"head"in d&&l(3,f=d.head),"tail"in d&&l(4,i=d.tail),"active"in d&&l(5,a=d.active)},[r,o,s,f,i,a,t]}class It extends Pe{constructor(e){super(),Te(this,e,Xo,Wo,ze,{id:0,className:1,type:2,head:3,tail:4,active:5})}}function kl(n,e,l){const t=n.slice();return t[6]=e[l],t[8]=l,t}function Zo(n){let e,l=n[1].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&2&&l!==(l=o[1].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function El(n){let e,l,t,r,o,s;return t=new tt({props:{colorScale:"blue"}}),{c(){e=z("div"),l=z("div"),ne(t.$$.fragment),o=U(),this.h()},l(f){e=P(f,"DIV",{class:!0});var i=T(e);l=P(i,"DIV",{class:!0});var a=T(l);oe(t.$$.fragment,a),a.forEach($),o=W(i),i.forEach($),this.h()},h(){_(l,"class",r=he(fe("vector shrink-0 bg-blue-200",{"last-token":n[8]===n[3].length-1}))+" svelte-nx91yw"),_(e,"class","cell svelte-nx91yw"),le(e,"last",n[8]===n[3].length-1)},m(f,i){x(f,e,i),D(e,l),re(t,l,null),D(e,o),s=!0},p(f,i){(!s||i&8&&r!==(r=he(fe("vector shrink-0 bg-blue-200",{"last-token":f[8]===f[3].length-1}))+" svelte-nx91yw"))&&_(l,"class",r),(!s||i&8)&&le(e,"last",f[8]===f[3].length-1)},i(f){s||(F(t.$$.fragment,f),s=!0)},o(f){Z(t.$$.fragment,f),s=!1},d(f){f&&$(e),se(t)}}}function Yo(n){let e,l,t,r,o,s,f,i,a,d,h,m,w=n[1].layer_num-1+"",V,H,R,X,q="Transformer<br/>Blocks",S,M,O,B,L,c="",g,v,y,I;o=new Ue({props:{triggeredBy:".transformer-blocks .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Zo]},$$scope:{ctx:n}}});let C=ve(n[3]),k=[];for(let u=0;u<C.length;u+=1)k[u]=El(kl(n,C,u));const p=u=>Z(k[u],1,1,()=>{k[u]=null});return{c(){e=z("div"),l=z("div"),t=U(),r=z("div"),ne(o.$$.fragment),s=U(),f=z("div"),i=z("div"),a=Ie("svg"),d=Ie("path"),h=U(),m=z("div"),V=ae(w),H=ae(" more"),R=z("br"),X=z("span"),X.innerHTML=q,S=z("br"),M=ae("go here."),O=U();for(let u=0;u<k.length;u+=1)k[u].c();B=U(),L=z("div"),L.innerHTML=c,this.h()},l(u){e=P(u,"DIV",{class:!0,role:!0});var E=T(e);l=P(E,"DIV",{class:!0}),T(l).forEach($),t=W(E),r=P(E,"DIV",{class:!0});var b=T(r);oe(o.$$.fragment,b),s=W(b),f=P(b,"DIV",{class:!0});var A=T(f);i=P(A,"DIV",{class:!0});var N=T(i);a=De(N,"svg",{class:!0,width:!0,height:!0,viewBox:!0,fill:!0});var j=T(a);d=De(j,"path",{d:!0,fill:!0}),T(d).forEach($),j.forEach($),h=W(N),m=P(N,"DIV",{class:!0});var K=T(m);V=ce(K,w),H=ce(K," more"),R=P(K,"BR",{}),X=P(K,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(X)!=="svelte-jj13a6"&&(X.innerHTML=q),S=P(K,"BR",{}),M=ce(K,"go here."),K.forEach($),N.forEach($),O=W(A);for(let ue=0;ue<k.length;ue+=1)k[ue].l(A);A.forEach($),B=W(b),L=P(b,"DIV",{class:!0,"data-svelte-h":!0}),Ce(L)!=="svelte-shkdve"&&(L.innerHTML=c),b.forEach($),E.forEach($),this.h()},h(){_(l,"class","title"),_(d,"d","M4.01159 29.4026C4.23396 29.5664 4.54695 29.5188 4.71068 29.2965L7.37882 25.6728C7.54255 25.4504 7.49501 25.1374 7.27264 24.9737C7.05028 24.81 6.73728 24.8575 6.57355 25.0799L4.20188 28.3009L0.980829 25.9292C0.758462 25.7655 0.445469 25.813 0.281739 26.0354C0.118009 26.2578 0.165543 26.5708 0.387911 26.7345L4.01159 29.4026ZM4.80238 28.9249C4.10481 24.3318 4.43981 17.4539 7.67418 11.7465C10.885 6.08071 16.9895 1.5 28 1.5V0.5C16.655 0.5 10.2048 5.25263 6.80417 11.2535C3.42706 17.2128 3.09382 24.3349 3.81372 29.0751L4.80238 28.9249Z"),_(d,"fill","#D1D5DB"),_(a,"class","arrow"),_(a,"width","28"),_(a,"height","30"),_(a,"viewBox","0 0 28 30"),_(a,"fill","none"),_(X,"class","highlight svelte-nx91yw"),_(m,"class","text svelte-nx91yw"),le(m,"active",n[2]),_(i,"class","guide flex items-end gap-1 svelte-nx91yw"),_(f,"class","column final relative svelte-nx91yw"),_(L,"class","second-column svelte-nx91yw"),_(r,"class","content svelte-nx91yw"),_(e,"class",g=he(fe("transformer-blocks",n[0]))+" svelte-nx91yw"),_(e,"role","group")},m(u,E){x(u,e,E),D(e,l),D(e,t),D(e,r),re(o,r,null),D(r,s),D(r,f),D(f,i),D(i,a),D(a,d),D(i,h),D(i,m),D(m,V),D(m,H),D(m,R),D(m,X),D(m,S),D(m,M),D(f,O);for(let b=0;b<k.length;b+=1)k[b]&&k[b].m(f,null);D(r,B),D(r,L),v=!0,y||(I=[we(e,"mouseenter",n[4]),we(e,"mouseleave",n[5])],y=!0)},p(u,[E]){const b={};if(E&514&&(b.$$scope={dirty:E,ctx:u}),o.$set(b),(!v||E&2)&&w!==(w=u[1].layer_num-1+"")&&Ve(V,w),(!v||E&4)&&le(m,"active",u[2]),E&8){C=ve(u[3]);let A;for(A=0;A<C.length;A+=1){const N=kl(u,C,A);k[A]?(k[A].p(N,E),F(k[A],1)):(k[A]=El(N),k[A].c(),F(k[A],1),k[A].m(f,null))}for(Be(),A=C.length;A<k.length;A+=1)p(A);Me()}(!v||E&1&&g!==(g=he(fe("transformer-blocks",u[0]))+" svelte-nx91yw"))&&_(e,"class",g)},i(u){if(!v){F(o.$$.fragment,u);for(let E=0;E<C.length;E+=1)F(k[E]);v=!0}},o(u){Z(o.$$.fragment,u),k=k.filter(Boolean);for(let E=0;E<k.length;E+=1)Z(k[E]);v=!1},d(u){u&&$(e),se(o),Ae(k,u),y=!1,je(I)}}}function Ko(n,e,l){let t,r,o;Ee(n,$t,a=>l(1,t=a)),Ee(n,kt,a=>l(2,r=a)),Ee(n,st,a=>l(3,o=a));let{className:s=void 0}=e;const f=()=>{kt.set(!0)},i=()=>{kt.set(!1)};return n.$$set=a=>{"className"in a&&l(0,s=a.className)},[s,t,r,o,f,i]}class Qo extends Pe{constructor(e){super(),Te(this,e,Ko,Yo,ze,{className:0})}}function Jo(n){let e,l,t,r;return{c(){e=z("div"),l=Ie("svg"),t=Ie("g"),r=Ie("g"),this.h()},l(o){e=P(o,"DIV",{class:!0});var s=T(e);l=De(s,"svg",{class:!0});var f=T(l);t=De(f,"g",{class:!0}),T(t).forEach($),r=De(f,"g",{class:!0}),T(r).forEach($),f.forEach($),s.forEach($),this.h()},h(){_(t,"class","bars"),_(r,"class","bar-labels"),_(l,"class","h-full w-full"),_(e,"class","content-box probability grow svelte-8s3yoj")},m(o,s){x(o,e,s),D(e,l),D(l,t),D(l,r),n[5](l)},p:Le,i:Le,o:Le,d(o){o&&$(e),n[5](null)}}}const Il=4;let er=1;function tr(n,e,l){let t,r;Ee(n,Bt,H=>l(6,t=H)),Ee(n,Et,H=>l(4,r=H));const{theme:o}=ht(dt);let{rowHeight:s}=e,{rowGap:f}=e,{hoveredIndex:i=null}=e,a,d=o.colors.gray[300],h=o.colors.blue[500],m=()=>{const H=r==null?void 0:r.prediction,R=r==null?void 0:r.sampled,X=We(a);let q=eo().domain([0,so(H,S=>S.adjustedProbability)]).range([0,(a==null?void 0:a.clientWidth)-_t*3]);X.select("g.bars").selectAll("rect").data(H).join("rect").attr("x",0).attr("y",(S,M)=>M*s+M*f+s/2-Il/2).attr("height",Il).attr("width",S=>q(S.adjustedProbability)).attr("rx",1).attr("ry",1).attr("fill",(S,M)=>M===i?h:(R==null?void 0:R.rank)===M?Dt:d).on("mouseenter",function(S,M){l(1,i=M.rank),We(this).style("cursor","pointer")}).on("mouseleave",()=>l(1,i=null)).transition().ease(Rn).duration(500).attr("width",S=>q(S.adjustedProbability)),X.select("g.bar-labels").selectAll("text").data(H).join("text").attr("fill",(S,M)=>M===i?h:(R==null?void 0:R.rank)===M?Dt:d).on("mouseenter",function(S,M){l(1,i=M.rank),We(this).style("cursor","pointer")}).on("mouseleave",()=>{l(1,i=null)}).attr("x",S=>.4*_t+q(S.adjustedProbability)).attr("y",(S,M)=>M*s+M*f).attr("dy",s/2+3).attr("text-anchor","start").style("font-size","0.75rem").transition().duration(500).tween("text",function(S){const M=We(this),O=Fn(M.text().replace("%",""),S.adjustedProbability*100);return function(B){M.text(O(B).toFixed(er)+"%")}})};bt(()=>{m()});const w=()=>{if(!a)return;const H=We(a);H.selectAll("g.bars rect").attr("fill",(R,X)=>X===i?h:(t==null?void 0:t.rank)===X?Dt:d),H.selectAll("g.bar-labels text").attr("fill",(R,X)=>X===i?h:(t==null?void 0:t.rank)===X?Dt:d)};function V(H){et[H?"unshift":"push"](()=>{a=H,l(0,a)})}return n.$$set=H=>{"rowHeight"in H&&l(2,s=H.rowHeight),"rowGap"in H&&l(3,f=H.rowGap),"hoveredIndex"in H&&l(1,i=H.hoveredIndex)},n.$$.update=()=>{n.$$.dirty&17&&r&&a&&m(),n.$$.dirty&2&&i!==void 0&&w()},[a,i,s,f,r,V]}class lr extends Pe{constructor(e){super(),Te(this,e,tr,Jo,ze,{rowHeight:2,rowGap:3,hoveredIndex:1})}}function Dl(n,e,l){const t=n.slice();return t[30]=e[l],t[32]=l,t}function Cl(n,e,l){const t=n.slice();return t[33]=e[l],t[32]=l,t}function ql(n,e,l){const t=n.slice();return t[35]=e[l],t[32]=l,t}function nr(n){let e,l=n[7][n[32]]+"",t,r;return{c(){e=ae("Token ID: "),t=ae(l),r=U()},l(o){e=ce(o,"Token ID: "),t=ce(o,l),r=W(o)},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s[0]&128&&l!==(l=o[7][o[32]]+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Sl(n){let e,l=n[35].token+"",t,r,o,s,f,i;function a(){return n[18](n[32])}return o=new Ue({props:{class:"text-xs",placement:"left",type:"light",$$slots:{default:[nr]},$$scope:{ctx:n}}}),{c(){e=z("div"),t=ae(l),r=U(),ne(o.$$.fragment),this.h()},l(d){e=P(d,"DIV",{role:!0,class:!0});var h=T(e);t=ce(h,l),h.forEach($),r=W(d),oe(o.$$.fragment,d),this.h()},h(){var d;_(e,"role","group"),_(e,"class","text-box svelte-oxhaat"),le(e,"highlight",n[32]===n[3]),le(e,"sample_highlight",n[8]===n[32]),le(e,"final_token_highlight",((d=n[9])==null?void 0:d.rank)===n[32])},m(d,h){x(d,e,h),D(e,t),x(d,r,h),re(o,d,h),s=!0,f||(i=[we(e,"mouseenter",a),we(e,"mouseleave",n[19])],f=!0)},p(d,h){var w;n=d,(!s||h[0]&4)&&l!==(l=n[35].token+"")&&Ve(t,l),(!s||h[0]&8)&&le(e,"highlight",n[32]===n[3]),(!s||h[0]&256)&&le(e,"sample_highlight",n[8]===n[32]),(!s||h[0]&512)&&le(e,"final_token_highlight",((w=n[9])==null?void 0:w.rank)===n[32]);const m={};h[0]&128|h[1]&64&&(m.$$scope={dirty:h,ctx:n}),o.$set(m)},i(d){s||(F(o.$$.fragment,d),s=!0)},o(d){Z(o.$$.fragment,d),s=!1},d(d){d&&($(e),$(r)),se(o,d),f=!1,je(i)}}}function Vl(n){let e,l='<div class="title-box token-string !justify-end svelte-oxhaat"><div class="title-text svelte-oxhaat">Tokens</div></div> <div class="title-box logits svelte-oxhaat"><div class="title-text svelte-oxhaat">Logits</div></div> <div class="title-box exponents svelte-oxhaat"><div class="title-text svelte-oxhaat">Exponents</div></div> <div class="title-box probability svelte-oxhaat"><div class="title-text svelte-oxhaat">Probability</div></div>';return{c(){e=z("div"),e.innerHTML=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-16l107t"&&(e.innerHTML=l),this.h()},h(){_(e,"class","softmax-subtitle softmax-detail flex text-center text-xs opacity-0 svelte-oxhaat")},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function Al(n){let e,l,t,r,o=ve(n[6]),s=[];for(let h=0;h<o.length;h+=1)s[h]=Bl(Cl(n,o,h));const f=h=>Z(s[h],1,1,()=>{s[h]=null});let i=ve(n[5]),a=[];for(let h=0;h<i.length;h+=1)a[h]=Ml(Dl(n,i,h));const d=h=>Z(a[h],1,1,()=>{a[h]=null});return{c(){e=z("div");for(let h=0;h<s.length;h+=1)s[h].c();l=U(),t=z("div");for(let h=0;h<a.length;h+=1)a[h].c();this.h()},l(h){e=P(h,"DIV",{class:!0});var m=T(e);for(let V=0;V<s.length;V+=1)s[V].l(m);m.forEach($),l=W(h),t=P(h,"DIV",{class:!0});var w=T(t);for(let V=0;V<a.length;V+=1)a[V].l(w);w.forEach($),this.h()},h(){_(e,"class","content-box vector-box logits ml-2 svelte-oxhaat"),_(t,"class","content-box vector-box exponents svelte-oxhaat")},m(h,m){x(h,e,m);for(let w=0;w<s.length;w+=1)s[w]&&s[w].m(e,null);x(h,l,m),x(h,t,m);for(let w=0;w<a.length;w+=1)a[w]&&a[w].m(t,null);r=!0},p(h,m){if(m[0]&1864){o=ve(h[6]);let w;for(w=0;w<o.length;w+=1){const V=Cl(h,o,w);s[w]?(s[w].p(V,m),F(s[w],1)):(s[w]=Bl(V),s[w].c(),F(s[w],1),s[w].m(e,null))}for(Be(),w=o.length;w<s.length;w+=1)f(w);Me()}if(m[0]&872){i=ve(h[5]);let w;for(w=0;w<i.length;w+=1){const V=Dl(h,i,w);a[w]?(a[w].p(V,m),F(a[w],1)):(a[w]=Ml(V),a[w].c(),F(a[w],1),a[w].m(t,null))}for(Be(),w=i.length;w<a.length;w+=1)d(w);Me()}},i(h){if(!r){for(let m=0;m<o.length;m+=1)F(s[m]);for(let m=0;m<i.length;m+=1)F(a[m]);r=!0}},o(h){s=s.filter(Boolean);for(let m=0;m<s.length;m+=1)Z(s[m]);a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)Z(a[m]);r=!1},d(h){h&&($(e),$(l),$(t)),Ae(s,h),Ae(a,h)}}}function Nl(n){let e,l=n[33].toFixed(2)+"",t,r,o,s,f,i;function a(){return n[20](n[32])}return o=new Ue({props:{class:"text-xs",placement:"left",type:"light",$$slots:{default:[or]},$$scope:{ctx:n}}}),{c(){e=z("div"),t=ae(l),r=U(),ne(o.$$.fragment),this.h()},l(d){e=P(d,"DIV",{role:!0,class:!0});var h=T(e);t=ce(h,l),h.forEach($),r=W(d),oe(o.$$.fragment,d),this.h()},h(){var d;_(e,"role","group"),_(e,"class","text-box text-center svelte-oxhaat"),le(e,"highlight",n[32]===n[3]),le(e,"sample_highlight",n[8]===n[32]),le(e,"final_token_highlight",((d=n[9])==null?void 0:d.rank)===n[32])},m(d,h){x(d,e,h),D(e,t),x(d,r,h),re(o,d,h),s=!0,f||(i=[we(e,"mouseenter",a),we(e,"mouseleave",n[21])],f=!0)},p(d,h){var w;n=d,(!s||h[0]&64)&&l!==(l=n[33].toFixed(2)+"")&&Ve(t,l),(!s||h[0]&8)&&le(e,"highlight",n[32]===n[3]),(!s||h[0]&256)&&le(e,"sample_highlight",n[8]===n[32]),(!s||h[0]&512)&&le(e,"final_token_highlight",((w=n[9])==null?void 0:w.rank)===n[32]);const m={};h[0]&1088|h[1]&64&&(m.$$scope={dirty:h,ctx:n}),o.$set(m)},i(d){s||(F(o.$$.fragment,d),s=!0)},o(d){Z(o.$$.fragment,d),s=!1},d(d){d&&($(e),$(r)),se(o,d),f=!1,je(i)}}}function or(n){let e=(n[33]*n[10]).toFixed(2)+"",l,t,r,o,s=n[33].toFixed(2)+"",f,i;return{c(){l=ae(e),t=ae(" ÷ "),r=ae(n[10]),o=ae(" = "),f=ae(s),i=U()},l(a){l=ce(a,e),t=ce(a," ÷ "),r=ce(a,n[10]),o=ce(a," = "),f=ce(a,s),i=W(a)},m(a,d){x(a,l,d),x(a,t,d),x(a,r,d),x(a,o,d),x(a,f,d),x(a,i,d)},p(a,d){d[0]&1088&&e!==(e=(a[33]*a[10]).toFixed(2)+"")&&Ve(l,e),d[0]&1024&&Ve(r,a[10]),d[0]&64&&s!==(s=a[33].toFixed(2)+"")&&Ve(f,s)},d(a){a&&($(l),$(t),$(r),$(o),$(f),$(i))}}}function Bl(n){let e,l,t=n[33]!==void 0&&Nl(n);return{c(){t&&t.c(),e=lt()},l(r){t&&t.l(r),e=lt()},m(r,o){t&&t.m(r,o),x(r,e,o),l=!0},p(r,o){r[33]!==void 0?t?(t.p(r,o),o[0]&64&&F(t,1)):(t=Nl(r),t.c(),F(t,1),t.m(e.parentNode,e)):t&&(Be(),Z(t,1,1,()=>{t=null}),Me())},i(r){l||(F(t),l=!0)},o(r){Z(t),l=!1},d(r){r&&$(e),t&&t.d(r)}}}function rr(n){let e,l=n[6][n[32]].toFixed(2)+"",t,r,o=n[30].toFixed(2)+"",s,f;return{c(){e=ae("exp("),t=ae(l),r=ae(") = "),s=ae(o),f=U()},l(i){e=ce(i,"exp("),t=ce(i,l),r=ce(i,") = "),s=ce(i,o),f=W(i)},m(i,a){x(i,e,a),x(i,t,a),x(i,r,a),x(i,s,a),x(i,f,a)},p(i,a){a[0]&64&&l!==(l=i[6][i[32]].toFixed(2)+"")&&Ve(t,l),a[0]&32&&o!==(o=i[30].toFixed(2)+"")&&Ve(s,o)},d(i){i&&($(e),$(t),$(r),$(s),$(f))}}}function Ml(n){let e,l=n[30].toExponential(2)+"",t,r,o,s,f,i;function a(){return n[22](n[32])}return o=new Ue({props:{class:"text-xs",placement:"left",type:"light",$$slots:{default:[rr]},$$scope:{ctx:n}}}),{c(){e=z("div"),t=ae(l),r=U(),ne(o.$$.fragment),this.h()},l(d){e=P(d,"DIV",{role:!0,class:!0});var h=T(e);t=ce(h,l),h.forEach($),r=W(d),oe(o.$$.fragment,d),this.h()},h(){var d;_(e,"role","group"),_(e,"class","text-box text-center svelte-oxhaat"),le(e,"highlight",n[32]===n[3]),le(e,"sample_highlight",n[8]===n[32]),le(e,"final_token_highlight",((d=n[9])==null?void 0:d.rank)===n[32])},m(d,h){x(d,e,h),D(e,t),x(d,r,h),re(o,d,h),s=!0,f||(i=[we(e,"mouseenter",a),we(e,"mouseleave",n[23])],f=!0)},p(d,h){var w;n=d,(!s||h[0]&32)&&l!==(l=n[30].toExponential(2)+"")&&Ve(t,l),(!s||h[0]&8)&&le(e,"highlight",n[32]===n[3]),(!s||h[0]&256)&&le(e,"sample_highlight",n[8]===n[32]),(!s||h[0]&512)&&le(e,"final_token_highlight",((w=n[9])==null?void 0:w.rank)===n[32]);const m={};h[0]&96|h[1]&64&&(m.$$scope={dirty:h,ctx:n}),o.$set(m)},i(d){s||(F(o.$$.fragment,d),s=!0)},o(d){Z(o.$$.fragment,d),s=!1},d(d){d&&($(e),$(r)),se(o,d),f=!1,je(i)}}}function sr(n){let e,l,t="<div>Probabilities</div>",r,o,s,f,i,a,d,h,m,w,V,H,R,X,q,S,M,O,B,L,c=ve(n[2]),g=[];for(let p=0;p<c.length;p+=1)g[p]=Sl(ql(n,c,p));const v=p=>Z(g[p],1,1,()=>{g[p]=null});let y=n[1]&&Vl(),I=n[1]&&Al(n);function C(p){n[24](p)}let k={rowGap:n[13],rowHeight:n[12]};return n[3]!==void 0&&(k.hoveredIndex=n[3]),q=new lr({props:k}),et.push(()=>Bn(q,"hoveredIndex",C)),{c(){e=z("div"),l=z("div"),l.innerHTML=t,r=U(),o=z("div"),s=z("div"),f=U(),i=z("div"),a=z("div");for(let p=0;p<g.length;p+=1)g[p].c();d=U(),h=z("div"),m=U(),w=z("div"),y&&y.c(),V=U(),H=z("div"),R=z("div"),I&&I.c(),X=U(),ne(q.$$.fragment),this.h()},l(p){e=P(p,"DIV",{class:!0,role:!0,tabindex:!0});var u=T(e);l=P(u,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-11ugyn5"&&(l.innerHTML=t),r=W(u),o=P(u,"DIV",{class:!0,style:!0});var E=T(o);s=P(E,"DIV",{class:!0}),T(s).forEach($),f=W(E),i=P(E,"DIV",{class:!0});var b=T(i);a=P(b,"DIV",{class:!0});var A=T(a);for(let ue=0;ue<g.length;ue+=1)g[ue].l(A);A.forEach($),d=W(b),h=P(b,"DIV",{class:!0}),T(h).forEach($),b.forEach($),m=W(E),w=P(E,"DIV",{class:!0});var N=T(w);y&&y.l(N),V=W(N),H=P(N,"DIV",{class:!0});var j=T(H);R=P(j,"DIV",{class:!0});var K=T(R);I&&I.l(K),K.forEach($),X=W(j),oe(q.$$.fragment,j),j.forEach($),N.forEach($),E.forEach($),u.forEach($),this.h()},h(){_(l,"class","title expandable"),_(l,"role","group"),_(s,"class","bounding softmax-bounding svelte-oxhaat"),le(s,"active",n[4]&&!n[1]),_(a,"class","content-box token-string svelte-oxhaat"),_(h,"class","vector vocab opacity-1 w-0"),_(i,"class","first-column relative flex justify-end"),_(R,"class","softmax-detail expandable flex gap-2 opacity-0"),_(H,"class","content-row flex gap-2"),_(w,"class","resize-watch second-column flex flex-col svelte-oxhaat"),_(o,"class","content relative svelte-oxhaat"),_(o,"style",`--softmax-row-height: ${n[12]}px;--softmax-row-gap: ${n[13]}px`),_(e,"class",M=he(fe("softmax",n[0]))+" svelte-oxhaat"),_(e,"role","button"),_(e,"tabindex","0")},m(p,u){x(p,e,u),D(e,l),D(e,r),D(e,o),D(o,s),D(o,f),D(o,i),D(i,a);for(let E=0;E<g.length;E+=1)g[E]&&g[E].m(a,null);D(i,d),D(i,h),D(o,m),D(o,w),y&&y.m(w,null),D(w,V),D(w,H),D(H,R),I&&I.m(R,null),D(H,X),re(q,H,null),O=!0,B||(L=[we(l,"mouseenter",n[14]),we(l,"mouseleave",n[15]),we(e,"click",n[11]),we(e,"keydown",n[11])],B=!0)},p(p,u){if((!O||u[0]&18)&&le(s,"active",p[4]&&!p[1]),u[0]&908){c=ve(p[2]);let b;for(b=0;b<c.length;b+=1){const A=ql(p,c,b);g[b]?(g[b].p(A,u),F(g[b],1)):(g[b]=Sl(A),g[b].c(),F(g[b],1),g[b].m(a,null))}for(Be(),b=c.length;b<g.length;b+=1)v(b);Me()}p[1]?y||(y=Vl(),y.c(),y.m(w,V)):y&&(y.d(1),y=null),p[1]?I?(I.p(p,u),u[0]&2&&F(I,1)):(I=Al(p),I.c(),F(I,1),I.m(R,null)):I&&(Be(),Z(I,1,1,()=>{I=null}),Me());const E={};!S&&u[0]&8&&(S=!0,E.hoveredIndex=p[3],An(()=>S=!1)),q.$set(E),(!O||u[0]&1&&M!==(M=he(fe("softmax",p[0]))+" svelte-oxhaat"))&&_(e,"class",M)},i(p){if(!O){for(let u=0;u<c.length;u+=1)F(g[u]);F(I),F(q.$$.fragment,p),O=!0}},o(p){g=g.filter(Boolean);for(let u=0;u<g.length;u+=1)Z(g[u]);Z(I),Z(q.$$.fragment,p),O=!1},d(p){p&&$(e),Ae(g,p),y&&y.d(),I&&I.d(),se(q),B=!1,je(L)}}}function ir(n,e,l){let t,r,o,s,f,i,a,d,h;Ee(n,Et,u=>l(16,f=u)),Ee(n,Qe,u=>l(17,i=u)),Ee(n,Ln,u=>l(8,a=u)),Ee(n,Bt,u=>l(9,d=u)),Ee(n,Gt,u=>l(10,h=u));let{className:m=void 0}=e;ht(dt),Nt("block-id","softmax");const w=At("block-id");let V=!1;const H=()=>{V?(Qe.set({id:null}),q()):(Qe.set({id:w}),X())};let R;const X=async()=>{R=ut.Flip.getState(".softmax .softmax-detail.expandable"),l(1,V=!0),await pt();const u=document.getElementById("main");u.style.justifyContent="end",await pt(),ut.Flip.from(R,{duration:1,ease:"power2.inOut"}),mt.to(".softmax-detail",{opacity:1,duration:.5,delay:.5})},q=async()=>{R=ut.Flip.getState(".softmax .softmax-detail.expandable"),l(1,V=!1),await pt(),await ut.Flip.from(R,{duration:.5,ease:"power2.inOut"}),mt.to(".softmax-detail",{opacity:0,duration:.5}),await pt();const u=document.getElementById("main");u.style.justifyContent="start"};let S=_t*1.2,M=.5*_t,O=null,B=!1;function L(){l(4,B=!0)}function c(){l(4,B=!1)}const g=u=>l(3,O=u),v=()=>l(3,O=null),y=u=>l(3,O=u),I=()=>l(3,O=null),C=u=>l(3,O=u),k=()=>l(3,O=null);function p(u){O=u,l(3,O)}return n.$$set=u=>{"className"in u&&l(0,m=u.className)},n.$$.update=()=>{n.$$.dirty[0]&131074&&i.id!==w&&V&&(l(1,V=!1),q()),n.$$.dirty[0]&65536&&l(2,t=(f==null?void 0:f.prediction)||[]),n.$$.dirty[0]&4&&l(7,r=t==null?void 0:t.map(u=>u.tokenId)),n.$$.dirty[0]&4&&l(6,o=(t==null?void 0:t.map(u=>u.adjustedLogit))||[]),n.$$.dirty[0]&4&&l(5,s=(t==null?void 0:t.map(u=>u.adjustedExp))||[])},[m,V,t,O,B,s,o,r,a,d,h,H,S,M,L,c,f,i,g,v,y,I,C,k,p]}class ar extends Pe{constructor(e){super(),Te(this,e,ir,sr,ze,{className:0},null,[-1,-1])}}function cr(n){let e,l="Drop out is";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-ohkp45"&&(e.textContent=l),this.h()},h(){_(e,"class","dropout-content")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function fr(n){let e,l;return e=new Mt({props:{class:fe("popover dropout-popover text-sm",n[1]),title:"Drop out",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,$$slots:{default:[cr]},$$scope:{ctx:n}}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){re(e,t,r),l=!0},p(t,[r]){const o={};r&2&&(o.class=fe("popover dropout-popover text-sm",t[1])),r&1&&(o.offset=t[0]),r&4&&(o.triggeredBy=t[2]),r&8&&(o.trigger=t[3]),r&16&&(o.placement=t[4]),r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){se(e,t)}}}function ur(n,e,l){let{offset:t=void 0}=e,{className:r=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,r=i.className),"triggeredBy"in i&&l(2,o=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,r,o,s,f]}class hr extends Pe{constructor(e){super(),Te(this,e,ur,fr,ze,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function dr(n){let e,l="Layer normalization is";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-qw3l61"&&(e.textContent=l),this.h()},h(){_(e,"class","ln-content")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function gr(n){let e,l;return e=new Mt({props:{class:fe("popover ln-popover text-sm",n[1]),title:"Layer Normalization",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,$$slots:{default:[dr]},$$scope:{ctx:n}}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){re(e,t,r),l=!0},p(t,[r]){const o={};r&2&&(o.class=fe("popover ln-popover text-sm",t[1])),r&1&&(o.offset=t[0]),r&4&&(o.triggeredBy=t[2]),r&8&&(o.trigger=t[3]),r&16&&(o.placement=t[4]),r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){se(e,t)}}}function pr(n,e,l){let{offset:t=void 0}=e,{className:r=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,r=i.className),"triggeredBy"in i&&l(2,o=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,r,o,s,f]}class mr extends Pe{constructor(e){super(),Te(this,e,pr,gr,ze,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function vr(n){let e,l=`The GELU (Gaussian Error Linear Unit) activation function combines linear and non-linear
		behavior by scaling inputs using the Gaussian cumulative distribution function. It retains small
		negative values for smoother gradients and is effective in models like BERT.`;return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1ri460b"&&(e.textContent=l),this.h()},h(){_(e,"class","activation-content svelte-60plg2")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function _r(n){let e,l;return e=new Mt({props:{class:fe("popover activation-popover text-sm",n[1]),title:"GeLu Activation",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,$$slots:{default:[vr]},$$scope:{ctx:n}}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){re(e,t,r),l=!0},p(t,[r]){const o={};r&2&&(o.class=fe("popover activation-popover text-sm",t[1])),r&1&&(o.offset=t[0]),r&4&&(o.triggeredBy=t[2]),r&8&&(o.trigger=t[3]),r&16&&(o.placement=t[4]),r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){se(e,t)}}}function br(n,e,l){let{offset:t=void 0}=e,{className:r=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,r=i.className),"triggeredBy"in i&&l(2,o=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,r,o,s,f]}class $r extends Pe{constructor(e){super(),Te(this,e,br,_r,ze,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function wr(n){let e,l="Residual out is";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-124ixs1"&&(e.textContent=l),this.h()},h(){_(e,"class","residual-content")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function yr(n){let e,l;return e=new Mt({props:{class:fe("popover residual-popover text-sm",n[1]),title:"Residual",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,$$slots:{default:[wr]},$$scope:{ctx:n}}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){re(e,t,r),l=!0},p(t,[r]){const o={};r&2&&(o.class=fe("popover residual-popover text-sm",t[1])),r&1&&(o.offset=t[0]),r&4&&(o.triggeredBy=t[2]),r&8&&(o.trigger=t[3]),r&16&&(o.placement=t[4]),r&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){se(e,t)}}}function kr(n,e,l){let{offset:t=void 0}=e,{className:r=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,r=i.className),"triggeredBy"in i&&l(2,o=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,r,o,s,f]}class Er extends Pe{constructor(e){super(),Te(this,e,kr,yr,ze,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function Ll(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function zl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Pl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Tl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Hl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Ir(n){let e,l,t,r,o,s,f=ve(n[4]),i=[];for(let d=0;d<f.length;d+=1)i[d]=Ol(Ll(n,f,d));const a=d=>Z(i[d],1,1,()=>{i[d]=null});return{c(){e=z("div");for(let d=0;d<i.length;d+=1)i[d].c();this.h()},l(d){e=P(d,"DIV",{id:!0,class:!0,role:!0});var h=T(e);for(let m=0;m<i.length;m+=1)i[m].l(h);h.forEach($),this.h()},h(){_(e,"id",l=`${n[0]}-end`),_(e,"class",t=he(fe("operation-col column residual",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(d,h){x(d,e,h);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(e,null);r=!0,o||(s=[we(e,"mouseenter",n[5]),we(e,"mouseleave",n[6])],o=!0)},p(d,h){if(h&27){f=ve(d[4]);let m;for(m=0;m<f.length;m+=1){const w=Ll(d,f,m);i[m]?(i[m].p(w,h),F(i[m],1)):(i[m]=Ol(w),i[m].c(),F(i[m],1),i[m].m(e,null))}for(Be(),m=f.length;m<i.length;m+=1)a(m);Me()}(!r||h&1&&l!==(l=`${d[0]}-end`))&&_(e,"id",l),(!r||h&2&&t!==(t=he(fe("operation-col column residual",d[1]))+" svelte-1ipty16"))&&_(e,"class",t)},i(d){if(!r){for(let h=0;h<f.length;h+=1)F(i[h]);r=!0}},o(d){i=i.filter(Boolean);for(let h=0;h<i.length;h+=1)Z(i[h]);r=!1},d(d){d&&$(e),Ae(i,d),o=!1,je(s)}}}function Dr(n){let e,l,t,r,o,s,f,i,a=ve(n[4]),d=[];for(let m=0;m<a.length;m+=1)d[m]=jl(zl(n,a,m));const h=m=>Z(d[m],1,1,()=>{d[m]=null});return t=new Er({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=z("div");for(let m=0;m<d.length;m+=1)d[m].c();l=U(),ne(t.$$.fragment),this.h()},l(m){e=P(m,"DIV",{id:!0,class:!0,role:!0});var w=T(e);for(let V=0;V<d.length;V+=1)d[V].l(w);l=W(w),oe(t.$$.fragment,w),w.forEach($),this.h()},h(){_(e,"id",r=`${n[0]}-start`),_(e,"class",o=he(fe("operation-col column residual",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(m,w){x(m,e,w);for(let V=0;V<d.length;V+=1)d[V]&&d[V].m(e,null);D(e,l),re(t,e,null),s=!0,f||(i=[we(e,"mouseenter",n[5]),we(e,"mouseleave",n[6])],f=!0)},p(m,w){if(w&27){a=ve(m[4]);let H;for(H=0;H<a.length;H+=1){const R=zl(m,a,H);d[H]?(d[H].p(R,w),F(d[H],1)):(d[H]=jl(R),d[H].c(),F(d[H],1),d[H].m(e,l))}for(Be(),H=a.length;H<d.length;H+=1)h(H);Me()}const V={};w&1&&(V.triggeredBy=`#${m[0]}`),t.$set(V),(!s||w&1&&r!==(r=`${m[0]}-start`))&&_(e,"id",r),(!s||w&2&&o!==(o=he(fe("operation-col column residual",m[1]))+" svelte-1ipty16"))&&_(e,"class",o)},i(m){if(!s){for(let w=0;w<a.length;w+=1)F(d[w]);F(t.$$.fragment,m),s=!0}},o(m){d=d.filter(Boolean);for(let w=0;w<d.length;w+=1)Z(d[w]);Z(t.$$.fragment,m),s=!1},d(m){m&&$(e),Ae(d,m),se(t),f=!1,je(i)}}}function Cr(n){let e,l,t,r,o,s,f,i=ve(n[4]),a=[];for(let h=0;h<i.length;h+=1)a[h]=Gl(Pl(n,i,h));const d=h=>Z(a[h],1,1,()=>{a[h]=null});return t=new mr({props:{triggeredBy:`#${n[0]}`}}),{c(){e=z("div");for(let h=0;h<a.length;h+=1)a[h].c();l=U(),ne(t.$$.fragment),this.h()},l(h){e=P(h,"DIV",{id:!0,class:!0,role:!0});var m=T(e);for(let w=0;w<a.length;w+=1)a[w].l(m);l=W(m),oe(t.$$.fragment,m),m.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class",r=he(fe("operation-col column ln",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(h,m){x(h,e,m);for(let w=0;w<a.length;w+=1)a[w]&&a[w].m(e,null);D(e,l),re(t,e,null),o=!0,s||(f=[we(e,"mouseenter",n[11]),we(e,"mouseleave",n[12])],s=!0)},p(h,m){if(m&26){i=ve(h[4]);let V;for(V=0;V<i.length;V+=1){const H=Pl(h,i,V);a[V]?(a[V].p(H,m),F(a[V],1)):(a[V]=Gl(H),a[V].c(),F(a[V],1),a[V].m(e,l))}for(Be(),V=i.length;V<a.length;V+=1)d(V);Me()}const w={};m&1&&(w.triggeredBy=`#${h[0]}`),t.$set(w),(!o||m&1)&&_(e,"id",h[0]),(!o||m&2&&r!==(r=he(fe("operation-col column ln",h[1]))+" svelte-1ipty16"))&&_(e,"class",r)},i(h){if(!o){for(let m=0;m<i.length;m+=1)F(a[m]);F(t.$$.fragment,h),o=!0}},o(h){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)Z(a[m]);Z(t.$$.fragment,h),o=!1},d(h){h&&$(e),Ae(a,h),se(t),s=!1,je(f)}}}function qr(n){let e,l,t,r,o,s,f,i=ve(n[4]),a=[];for(let h=0;h<i.length;h+=1)a[h]=Rl(Tl(n,i,h));const d=h=>Z(a[h],1,1,()=>{a[h]=null});return t=new hr({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=z("div");for(let h=0;h<a.length;h+=1)a[h].c();l=U(),ne(t.$$.fragment),this.h()},l(h){e=P(h,"DIV",{id:!0,class:!0,role:!0});var m=T(e);for(let w=0;w<a.length;w+=1)a[w].l(m);l=W(m),oe(t.$$.fragment,m),m.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class",r=he(fe("operation-col column dropout",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(h,m){x(h,e,m);for(let w=0;w<a.length;w+=1)a[w]&&a[w].m(e,null);D(e,l),re(t,e,null),o=!0,s||(f=[we(e,"mouseenter",n[9]),we(e,"mouseleave",n[10])],s=!0)},p(h,m){if(m&26){i=ve(h[4]);let V;for(V=0;V<i.length;V+=1){const H=Tl(h,i,V);a[V]?(a[V].p(H,m),F(a[V],1)):(a[V]=Rl(H),a[V].c(),F(a[V],1),a[V].m(e,l))}for(Be(),V=i.length;V<a.length;V+=1)d(V);Me()}const w={};m&1&&(w.triggeredBy=`#${h[0]}`),t.$set(w),(!o||m&1)&&_(e,"id",h[0]),(!o||m&2&&r!==(r=he(fe("operation-col column dropout",h[1]))+" svelte-1ipty16"))&&_(e,"class",r)},i(h){if(!o){for(let m=0;m<i.length;m+=1)F(a[m]);F(t.$$.fragment,h),o=!0}},o(h){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)Z(a[m]);Z(t.$$.fragment,h),o=!1},d(h){h&&$(e),Ae(a,h),se(t),s=!1,je(f)}}}function Sr(n){let e,l,t,r,o,s,f,i=ve(n[4]),a=[];for(let h=0;h<i.length;h+=1)a[h]=Fl(Hl(n,i,h));const d=h=>Z(a[h],1,1,()=>{a[h]=null});return t=new $r({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=z("div");for(let h=0;h<a.length;h+=1)a[h].c();l=U(),ne(t.$$.fragment),this.h()},l(h){e=P(h,"DIV",{id:!0,class:!0,role:!0});var m=T(e);for(let w=0;w<a.length;w+=1)a[w].l(m);l=W(m),oe(t.$$.fragment,m),m.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class",r=he(fe("operation-col column activation",n[1]))+" svelte-1ipty16"),_(e,"role","group")},m(h,m){x(h,e,m);for(let w=0;w<a.length;w+=1)a[w]&&a[w].m(e,null);D(e,l),re(t,e,null),o=!0,s||(f=[we(e,"mouseenter",n[7]),we(e,"mouseleave",n[8])],s=!0)},p(h,m){if(m&26){i=ve(h[4]);let V;for(V=0;V<i.length;V+=1){const H=Hl(h,i,V);a[V]?(a[V].p(H,m),F(a[V],1)):(a[V]=Fl(H),a[V].c(),F(a[V],1),a[V].m(e,l))}for(Be(),V=i.length;V<a.length;V+=1)d(V);Me()}const w={};m&1&&(w.triggeredBy=`#${h[0]}`),t.$set(w),(!o||m&1)&&_(e,"id",h[0]),(!o||m&2&&r!==(r=he(fe("operation-col column activation",h[1]))+" svelte-1ipty16"))&&_(e,"class",r)},i(h){if(!o){for(let m=0;m<i.length;m+=1)F(a[m]);F(t.$$.fragment,h),o=!0}},o(h){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)Z(a[m]);Z(t.$$.fragment,h),o=!1},d(h){h&&$(e),Ae(a,h),se(t),s=!1,je(f)}}}function Ol(n){let e,l;return e=new It({props:{id:n[0],className:fe(n[1],{last:n[16]===n[4].length-1}),type:"residual-end",head:n[16]===0,active:n[3]}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){re(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.id=t[0]),r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){se(e,t)}}}function jl(n){let e,l;return e=new It({props:{id:n[0],className:fe(n[1],{last:n[16]===n[4].length-1}),type:"residual-start",head:n[16]===0,active:n[3]}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){re(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.id=t[0]),r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){se(e,t)}}}function Gl(n){let e,l;return e=new It({props:{className:fe(n[1],{last:n[16]===n[4].length-1}),type:"ln",tail:n[16]===n[4].length-1,active:n[3]}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){re(e,t,r),l=!0},p(t,r){const o={};r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&16&&(o.tail=t[16]===t[4].length-1),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){se(e,t)}}}function Rl(n){let e,l;return e=new It({props:{className:fe(n[1],{last:n[16]===n[4].length-1}),type:"dropout",tail:n[16]===n[4].length-1,active:n[3]}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){re(e,t,r),l=!0},p(t,r){const o={};r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&16&&(o.tail=t[16]===t[4].length-1),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){se(e,t)}}}function Fl(n){let e,l;return e=new It({props:{className:fe(n[1],{last:n[16]===n[4].length-1}),type:"activation",tail:n[16]===n[4].length-1,active:n[3]}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){re(e,t,r),l=!0},p(t,r){const o={};r&18&&(o.className=fe(t[1],{last:t[16]===t[4].length-1})),r&16&&(o.tail=t[16]===t[4].length-1),r&8&&(o.active=t[3]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Z(e.$$.fragment,t),l=!1},d(t){se(e,t)}}}function Vr(n){let e,l,t,r;const o=[Sr,qr,Cr,Dr,Ir],s=[];function f(i,a){return i[2]==="activation"?0:i[2]==="dropout"?1:i[2]==="ln"?2:i[2]==="residual-start"?3:i[2]==="residual-end"?4:-1}return~(e=f(n))&&(l=s[e]=o[e](n)),{c(){l&&l.c(),t=lt()},l(i){l&&l.l(i),t=lt()},m(i,a){~e&&s[e].m(i,a),x(i,t,a),r=!0},p(i,[a]){let d=e;e=f(i),e===d?~e&&s[e].p(i,a):(l&&(Be(),Z(s[d],1,1,()=>{s[d]=null}),Me()),~e?(l=s[e],l?l.p(i,a):(l=s[e]=o[e](i),l.c()),F(l,1),l.m(t.parentNode,t)):l=null)},i(i){r||(F(l),r=!0)},o(i){Z(l),r=!1},d(i){i&&$(t),~e&&s[e].d(i)}}}function Ar(n,e,l){let t;Ee(n,st,X=>l(4,t=X));let{id:r}=e,{className:o=void 0}=e,{type:s=void 0}=e,f=!1;const i=()=>{l(3,f=!0);const X=document.querySelector(`#${r}-start`),q=document.querySelector(`#${r}-end`),S=We(`.residual-connector.${r}`);S.style("opacity",1),d(S),X==null||X.classList.add("active"),q==null||q.classList.add("active")},a=()=>{l(3,f=!1);const X=document.querySelector(`#${r}-start`),q=document.querySelector(`#${r}-end`);We(`.residual-connector.${r}`).style("opacity",0),X==null||X.classList.remove("active"),q==null||q.classList.remove("active")},d=X=>{const q=X.node().getTotalLength();X.attr("stroke-dasharray",q+" "+q).attr("stroke-dashoffset",q).transition().duration(300).attr("stroke-dashoffset",0)},h=()=>{l(3,f=!0)},m=()=>{l(3,f=!1)},w=()=>{l(3,f=!0)},V=()=>{l(3,f=!1)},H=()=>{l(3,f=!0)},R=()=>{l(3,f=!1)};return n.$$set=X=>{"id"in X&&l(0,r=X.id),"className"in X&&l(1,o=X.className),"type"in X&&l(2,s=X.type)},[r,o,s,f,t,i,a,h,m,w,V,H,R]}class Je extends Pe{constructor(e){super(),Te(this,e,Ar,Vr,ze,{id:0,className:1,type:2})}}function xl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Ul(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Wl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Xl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Zl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Yl(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Kl(n){let e,l="Token";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-6k2z6t"&&(e.textContent=l),this.h()},h(){_(e,"class","subtitle embedding-detail svelte-1r50q6i")},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function Ql(n){let e,l,t=n[21]+"",r;return{c(){e=z("div"),l=z("span"),r=ae(t),this.h()},l(o){e=P(o,"DIV",{class:!0});var s=T(e);l=P(s,"SPAN",{class:!0});var f=T(l);r=ce(f,t),f.forEach($),s.forEach($),this.h()},h(){_(l,"class","label svelte-1r50q6i"),_(e,"class","cell svelte-1r50q6i"),le(e,"last",n[23]===n[3].length-1)},m(o,s){x(o,e,s),D(e,l),D(l,r)},p(o,s){s&8&&t!==(t=o[21]+"")&&Ve(r,t),s&8&&le(e,"last",o[23]===o[3].length-1)},d(o){o&&$(e)}}}function Jl(n){let e,l,t,r,o,s="Token Embedding",f,i,a,d,h,m,w,V,H="Positional Embedding",R,X,q,S,M;e=new Ue({props:{triggeredBy:".embedding .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Nr]},$$scope:{ctx:n}}}),f=new tl({props:{id:"token-embedding",$$slots:{default:[Br]},$$scope:{ctx:n}}});let O=ve(n[3]),B=[];for(let p=0;p<O.length;p+=1)B[p]=en(Zl(n,O,p));const L=p=>Z(B[p],1,1,()=>{B[p]=null});let c=ve(n[3]),g=[];for(let p=0;p<c.length;p+=1)g[p]=tn(Xl(n,c,p));R=new tl({props:{id:"position-embedding",$$slots:{default:[zr]},$$scope:{ctx:n}}});let v=ve(n[3]),y=[];for(let p=0;p<v.length;p+=1)y[p]=ln(Wl(n,v,p));const I=p=>Z(y[p],1,1,()=>{y[p]=null});let C=ve(n[3]),k=[];for(let p=0;p<C.length;p+=1)k[p]=nn(Ul(n,C,p));return{c(){ne(e.$$.fragment),l=U(),t=z("div"),r=z("div"),o=z("span"),o.textContent=s,ne(f.$$.fragment),i=U();for(let p=0;p<B.length;p+=1)B[p].c();a=U(),d=z("div");for(let p=0;p<g.length;p+=1)g[p].c();h=U(),m=z("div"),w=z("div"),V=z("span"),V.textContent=H,ne(R.$$.fragment),X=U();for(let p=0;p<y.length;p+=1)y[p].c();q=U(),S=z("div");for(let p=0;p<k.length;p+=1)k[p].c();this.h()},l(p){oe(e.$$.fragment,p),l=W(p),t=P(p,"DIV",{class:!0});var u=T(t);r=P(u,"DIV",{class:!0});var E=T(r);o=P(E,"SPAN",{"data-svelte-h":!0}),Ce(o)!=="svelte-mkgxme"&&(o.textContent=s),oe(f.$$.fragment,E),E.forEach($),i=W(u);for(let K=0;K<B.length;K+=1)B[K].l(u);u.forEach($),a=W(p),d=P(p,"DIV",{class:!0});var b=T(d);for(let K=0;K<g.length;K+=1)g[K].l(b);b.forEach($),h=W(p),m=P(p,"DIV",{class:!0});var A=T(m);w=P(A,"DIV",{class:!0});var N=T(w);V=P(N,"SPAN",{"data-svelte-h":!0}),Ce(V)!=="svelte-w2vnbx"&&(V.textContent=H),oe(R.$$.fragment,N),N.forEach($),X=W(A);for(let K=0;K<y.length;K+=1)y[K].l(A);A.forEach($),q=W(p),S=P(p,"DIV",{class:!0});var j=T(S);for(let K=0;K<k.length;K+=1)k[K].l(j);j.forEach($),this.h()},h(){_(r,"class","subtitle flex items-center gap-1 svelte-1r50q6i"),_(t,"class","column token-embedding embedding-detail svelte-1r50q6i"),_(d,"class","column symbol embedding-detail svelte-1r50q6i"),_(w,"class","subtitle flex gap-1 svelte-1r50q6i"),_(m,"class","column embedding-detail position-embedding svelte-1r50q6i"),_(S,"class","column symbol embedding-d etail svelte-1r50q6i")},m(p,u){re(e,p,u),x(p,l,u),x(p,t,u),D(t,r),D(r,o),re(f,r,null),D(t,i);for(let E=0;E<B.length;E+=1)B[E]&&B[E].m(t,null);x(p,a,u),x(p,d,u);for(let E=0;E<g.length;E+=1)g[E]&&g[E].m(d,null);x(p,h,u),x(p,m,u),D(m,w),D(w,V),re(R,w,null),D(m,X);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(m,null);x(p,q,u),x(p,S,u);for(let E=0;E<k.length;E+=1)k[E]&&k[E].m(S,null);M=!0},p(p,u){const E={};u&536870928&&(E.$$scope={dirty:u,ctx:p}),e.$set(E);const b={};if(u&536870912&&(b.$$scope={dirty:u,ctx:p}),f.$set(b),u&8){O=ve(p[3]);let N;for(N=0;N<O.length;N+=1){const j=Zl(p,O,N);B[N]?(B[N].p(j,u),F(B[N],1)):(B[N]=en(j),B[N].c(),F(B[N],1),B[N].m(t,null))}for(Be(),N=O.length;N<B.length;N+=1)L(N);Me()}if(u&8){c=ve(p[3]);let N;for(N=0;N<c.length;N+=1){const j=Xl(p,c,N);g[N]?g[N].p(j,u):(g[N]=tn(),g[N].c(),g[N].m(d,null))}for(;N<g.length;N+=1)g[N].d(1);g.length=c.length}const A={};if(u&536870912&&(A.$$scope={dirty:u,ctx:p}),R.$set(A),u&40){v=ve(p[3]);let N;for(N=0;N<v.length;N+=1){const j=Wl(p,v,N);y[N]?(y[N].p(j,u),F(y[N],1)):(y[N]=ln(j),y[N].c(),F(y[N],1),y[N].m(m,null))}for(Be(),N=v.length;N<y.length;N+=1)I(N);Me()}if(u&8){C=ve(p[3]);let N;for(N=0;N<C.length;N+=1){const j=Ul(p,C,N);k[N]?k[N].p(j,u):(k[N]=nn(),k[N].c(),k[N].m(S,null))}for(;N<k.length;N+=1)k[N].d(1);k.length=C.length}},i(p){if(!M){F(e.$$.fragment,p),F(f.$$.fragment,p);for(let u=0;u<O.length;u+=1)F(B[u]);F(R.$$.fragment,p);for(let u=0;u<v.length;u+=1)F(y[u]);M=!0}},o(p){Z(e.$$.fragment,p),Z(f.$$.fragment,p),B=B.filter(Boolean);for(let u=0;u<B.length;u+=1)Z(B[u]);Z(R.$$.fragment,p),y=y.filter(Boolean);for(let u=0;u<y.length;u+=1)Z(y[u]);M=!1},d(p){p&&($(l),$(t),$(a),$(d),$(h),$(m),$(q),$(S)),se(e,p),se(f),Ae(B,p),Ae(g,p),se(R),Ae(y,p),Ae(k,p)}}}function Nr(n){let e,l=n[4].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&16&&l!==(l=o[4].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Br(n){let e;return{c(){e=ae("Token Embedding is")},l(l){e=ce(l,"Token Embedding is")},m(l,t){x(l,e,t)},d(l){l&&$(e)}}}function Mr(n){let e,l='<span>look up</span><svg class="h-3 w-3 text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="m21 21-3.5-3.5M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"></path></svg>';return{c(){e=z("div"),e.innerHTML=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-bcqwtg"&&(e.innerHTML=l),this.h()},h(){_(e,"class","look-up flex items-center gap-1")},m(t,r){x(t,e,r)},d(t){t&&$(e)}}}function Lr(n){let e,l="id",t;return{c(){e=z("span"),e.textContent=l,t=z("br"),this.h()},l(r){e=P(r,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1e13gni"&&(e.textContent=l),t=P(r,"BR",{}),this.h()},h(){_(e,"class","label svelte-1r50q6i")},m(r,o){x(r,e,o),x(r,t,o)},d(r){r&&($(e),$(t))}}}function en(n){let e,l,t,r,o,s,f,i,a,d,h,m,w,V,H=(Math.random()*1e4).toFixed()+"",R,X,q,S=n[23]===0&&Mr();d=new tt({props:{active:!0}});let M=n[23]===0&&Lr();return{c(){e=z("div"),l=z("div"),t=z("div"),S&&S.c(),r=U(),o=Ie("svg"),s=Ie("path"),f=U(),i=z("div"),a=z("div"),ne(d.$$.fragment),h=U(),m=z("span"),M&&M.c(),w=U(),V=z("span"),R=ae(H),X=U(),this.h()},l(O){e=P(O,"DIV",{class:!0});var B=T(e);l=P(B,"DIV",{class:!0});var L=T(l);t=P(L,"DIV",{class:!0});var c=T(t);S&&S.l(c),r=W(c),o=De(c,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var g=T(o);s=De(g,"path",{fill:!0,d:!0}),T(s).forEach($),g.forEach($),c.forEach($),L.forEach($),f=W(B),i=P(B,"DIV",{class:!0});var v=T(i);a=P(v,"DIV",{class:!0});var y=T(a);oe(d.$$.fragment,y),y.forEach($),h=W(v),m=P(v,"SPAN",{class:!0});var I=T(m);M&&M.l(I),w=W(I),V=P(I,"SPAN",{class:!0});var C=T(V);R=ce(C,H),C.forEach($),I.forEach($),v.forEach($),X=W(B),B.forEach($),this.h()},h(){_(s,"fill","currentColor"),_(s,"d","M30.3886 4.74352C30.5839 4.54826 30.5839 4.23168 30.3886 4.03642L27.2067 0.854435C27.0114 0.659173 26.6948 0.659173 26.4996 0.854435C26.3043 1.0497 26.3043 1.36628 26.4996 1.56154L29.328 4.38997L26.4996 7.2184C26.3043 7.41366 26.3043 7.73024 26.4996 7.9255C26.6948 8.12076 27.0114 8.12076 27.2067 7.9255L30.3886 4.74352ZM0.31958 4.88997H30.0351V3.88997H0.31958V4.88997Z"),_(o,"xmlns","http://www.w3.org/2000/svg"),_(o,"viewBox","0 0 31 9"),_(o,"fill","none"),_(o,"class","w-10 text-gray-300"),_(t,"class","flex flex-col items-center"),_(l,"class","vocab-index ellipsis flex items-center text-right text-xs text-gray-400 svelte-1r50q6i"),_(a,"class",he(`vector ${xt}`)+" svelte-1r50q6i"),_(V,"class","val svelte-1r50q6i"),_(m,"class","index-val text-xs svelte-1r50q6i"),_(i,"class","cell flex items-center svelte-1r50q6i"),_(e,"class","token-id flex items-center")},m(O,B){x(O,e,B),D(e,l),D(l,t),S&&S.m(t,null),D(t,r),D(t,o),D(o,s),D(e,f),D(e,i),D(i,a),re(d,a,null),D(i,h),D(i,m),M&&M.m(m,null),D(m,w),D(m,V),D(V,R),D(e,X),q=!0},p:Le,i(O){q||(F(d.$$.fragment,O),q=!0)},o(O){Z(d.$$.fragment,O),q=!1},d(O){O&&$(e),S&&S.d(),se(d),M&&M.d()}}}function tn(n){let e,l="+";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-124y0va"&&(e.textContent=l),this.h()},h(){_(e,"class","cell svelte-1r50q6i")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function zr(n){let e;return{c(){e=ae("Positional Embedding is")},l(l){e=ce(l,"Positional Embedding is")},m(l,t){x(l,e,t)},d(l){l&&$(e)}}}function Pr(n){let e,l="poition",t;return{c(){e=z("span"),e.textContent=l,t=z("br"),this.h()},l(r){e=P(r,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1fb2ksh"&&(e.textContent=l),t=P(r,"BR",{}),this.h()},h(){_(e,"class","label svelte-1r50q6i")},m(r,o){x(r,e,o),x(r,t,o)},d(r){r&&($(e),$(t))}}}function ln(n){let e,l,t,r,o,s,f,i,a,d;t=new tt({props:{active:!0,colorScale:n[10]}});let h=n[23]===0&&Pr();return{c(){e=z("div"),l=z("div"),ne(t.$$.fragment),r=U(),o=z("span"),h&&h.c(),s=U(),f=z("span"),i=ae(n[23]),a=U(),this.h()},l(m){e=P(m,"DIV",{class:!0});var w=T(e);l=P(w,"DIV",{class:!0});var V=T(l);oe(t.$$.fragment,V),V.forEach($),r=W(w),o=P(w,"SPAN",{class:!0});var H=T(o);h&&h.l(H),s=W(H),f=P(H,"SPAN",{class:!0});var R=T(f);i=ce(R,n[23]),R.forEach($),H.forEach($),a=W(w),w.forEach($),this.h()},h(){_(l,"class",he(`vector ${xt}`)+" svelte-1r50q6i"),_(f,"class","val svelte-1r50q6i"),_(o,"class","index-val text-xs svelte-1r50q6i"),_(e,"class","cell flex items-center svelte-1r50q6i")},m(m,w){x(m,e,w),D(e,l),re(t,l,null),D(e,r),D(e,o),h&&h.m(o,null),D(o,s),D(o,f),D(f,i),D(e,a),d=!0},p:Le,i(m){d||(F(t.$$.fragment,m),d=!0)},o(m){Z(t.$$.fragment,m),d=!1},d(m){m&&$(e),se(t),h&&h.d()}}}function nn(n){let e,l="=";return{c(){e=z("div"),e.textContent=l,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1btrmmo"&&(e.textContent=l),this.h()},h(){_(e,"class","cell svelte-1r50q6i")},m(t,r){x(t,e,r)},p:Le,d(t){t&&$(e)}}}function Tr(n){let e,l=n[4].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&16&&l!==(l=o[4].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function on(n){let e,l,t,r;return l=new tt({props:{active:n[2]||n[1]}}),{c(){e=z("div"),ne(l.$$.fragment),t=U(),this.h()},l(o){e=P(o,"DIV",{class:!0});var s=T(e);oe(l.$$.fragment,s),t=W(s),s.forEach($),this.h()},h(){_(e,"class",he(`vector ${xt}`)+" svelte-1r50q6i"),le(e,"last",n[23]===n[3].length-1)},m(o,s){x(o,e,s),re(l,e,null),D(e,t),r=!0},p(o,s){const f={};s&6&&(f.active=o[2]||o[1]),l.$set(f),(!r||s&8)&&le(e,"last",o[23]===o[3].length-1)},i(o){r||(F(l.$$.fragment,o),r=!0)},o(o){Z(l.$$.fragment,o),r=!1},d(o){o&&$(e),se(l)}}}function Hr(n){let e,l,t="<div>Embedding</div>",r,o,s,f,i,a,d,h,m,w,V,H,R,X,q,S,M,O,B,L,c,g,v,y=n[1]&&Kl(),I=ve(n[3]),C=[];for(let b=0;b<I.length;b+=1)C[b]=Ql(Yl(n,I,b));let k=n[1]&&Jl(n);V=new Ue({props:{triggeredBy:".embedding .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Tr]},$$scope:{ctx:n}}});let p=ve(n[3]),u=[];for(let b=0;b<p.length;b+=1)u[b]=on(xl(n,p,b));const E=b=>Z(u[b],1,1,()=>{u[b]=null});return q=new Je({props:{type:"dropout",id:"embedding-dropout"}}),M=new Je({props:{type:"residual-start",id:"residual-first"}}),B=new Je({props:{type:"ln",id:"embedding-ln"}}),{c(){e=z("div"),l=z("div"),l.innerHTML=t,r=U(),o=z("div"),s=z("div"),f=z("div"),y&&y.c(),i=U();for(let b=0;b<C.length;b+=1)C[b].c();a=U(),d=z("div"),h=U(),k&&k.c(),m=U(),w=z("div"),ne(V.$$.fragment),H=U(),R=z("div");for(let b=0;b<u.length;b+=1)u[b].c();X=U(),ne(q.$$.fragment),S=U(),ne(M.$$.fragment),O=U(),ne(B.$$.fragment),this.h()},l(b){e=P(b,"DIV",{class:!0,role:!0,tabindex:!0});var A=T(e);l=P(A,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-gfbk07"&&(l.innerHTML=t),r=W(A),o=P(A,"DIV",{class:!0});var N=T(o);s=P(N,"DIV",{class:!0});var j=T(s);f=P(j,"DIV",{class:!0});var K=T(f);y&&y.l(K),i=W(K);for(let G=0;G<C.length;G+=1)C[G].l(K);a=W(K),d=P(K,"DIV",{class:!0}),T(d).forEach($),K.forEach($),h=W(j),k&&k.l(j),j.forEach($),m=W(N),w=P(N,"DIV",{class:!0});var ue=T(w);oe(V.$$.fragment,ue),H=W(ue),R=P(ue,"DIV",{class:!0});var Y=T(R);for(let G=0;G<u.length;G+=1)u[G].l(Y);Y.forEach($),X=W(ue),oe(q.$$.fragment,ue),S=W(ue),oe(M.$$.fragment,ue),O=W(ue),oe(B.$$.fragment,ue),ue.forEach($),N.forEach($),A.forEach($),this.h()},h(){_(l,"class","title expandable svelte-1r50q6i"),_(l,"role","group"),_(d,"class","bounding embedding-bounding svelte-1r50q6i"),le(d,"active",n[2]&&!n[1]),_(f,"class","column token-string relative svelte-1r50q6i"),_(s,"class","token-column resizable resize-watch flex"),_(R,"class","column vectors svelte-1r50q6i"),_(w,"class","vector-column relative flex"),_(o,"class","content relative svelte-1r50q6i"),_(e,"class",L=he(fe("embedding",n[0]))+" svelte-1r50q6i"),_(e,"role","button"),_(e,"tabindex","0")},m(b,A){x(b,e,A),D(e,l),D(e,r),D(e,o),D(o,s),D(s,f),y&&y.m(f,null),D(f,i);for(let N=0;N<C.length;N+=1)C[N]&&C[N].m(f,null);D(f,a),D(f,d),D(s,h),k&&k.m(s,null),D(o,m),D(o,w),re(V,w,null),D(w,H),D(w,R);for(let N=0;N<u.length;N+=1)u[N]&&u[N].m(R,null);D(w,X),re(q,w,null),D(w,S),re(M,w,null),D(w,O),re(B,w,null),c=!0,g||(v=[we(l,"mouseenter",n[7]),we(l,"mouseleave",n[8]),we(e,"click",n[6]),we(e,"keydown",n[6])],g=!0)},p(b,[A]){if(b[1]?y||(y=Kl(),y.c(),y.m(f,i)):y&&(y.d(1),y=null),A&8){I=ve(b[3]);let j;for(j=0;j<I.length;j+=1){const K=Yl(b,I,j);C[j]?C[j].p(K,A):(C[j]=Ql(K),C[j].c(),C[j].m(f,a))}for(;j<C.length;j+=1)C[j].d(1);C.length=I.length}(!c||A&6)&&le(d,"active",b[2]&&!b[1]),b[1]?k?(k.p(b,A),A&2&&F(k,1)):(k=Jl(b),k.c(),F(k,1),k.m(s,null)):k&&(Be(),Z(k,1,1,()=>{k=null}),Me());const N={};if(A&536870928&&(N.$$scope={dirty:A,ctx:b}),V.$set(N),A&14){p=ve(b[3]);let j;for(j=0;j<p.length;j+=1){const K=xl(b,p,j);u[j]?(u[j].p(K,A),F(u[j],1)):(u[j]=on(K),u[j].c(),F(u[j],1),u[j].m(R,null))}for(Be(),j=p.length;j<u.length;j+=1)E(j);Me()}(!c||A&1&&L!==(L=he(fe("embedding",b[0]))+" svelte-1r50q6i"))&&_(e,"class",L)},i(b){if(!c){F(k),F(V.$$.fragment,b);for(let A=0;A<p.length;A+=1)F(u[A]);F(q.$$.fragment,b),F(M.$$.fragment,b),F(B.$$.fragment,b),c=!0}},o(b){Z(k),Z(V.$$.fragment,b),u=u.filter(Boolean);for(let A=0;A<u.length;A+=1)Z(u[A]);Z(q.$$.fragment,b),Z(M.$$.fragment,b),Z(B.$$.fragment,b),c=!1},d(b){b&&$(e),y&&y.d(),Ae(C,b),k&&k.d(),se(V),Ae(u,b),se(q),se(M),se(B),g=!1,je(v)}}}const xt="bg-gray-300";function Or(n,e,l){let t,r,o;Ee(n,Qe,q=>l(9,t=q)),Ee(n,st,q=>l(3,r=q)),Ee(n,$t,q=>l(4,o=q));const{theme:s}=ht(dt);let{className:f=void 0}=e;Nt("block-id","embedding");const i=At("block-id");let a=!1;const d=()=>{a?(Qe.set({id:null}),w()):(Qe.set({id:i}),m())};let h;const m=async()=>{h=ut.Flip.getState(".embedding .token-column"),l(1,a=!0),await pt(),ut.Flip.from(h,{duration:1,ease:"power2.inOut"}),mt.to(".embedding-detail",{opacity:1,duration:.5,delay:.5})},w=async()=>{h=ut.Flip.getState(".embedding .token-column"),l(1,a=!1),await pt(),ut.Flip.from(h,{duration:.5,ease:"power2.inOut"})};let V=!1;function H(){l(2,V=!0)}function R(){l(2,V=!1)}const X=(q,S)=>In().domain([0,.5,1]).range([s.colors.red[400],"white",s.colors.blue[400]])(q);return n.$$set=q=>{"className"in q&&l(0,f=q.className)},n.$$.update=()=>{n.$$.dirty&514&&t.id!==i&&a&&(l(1,a=!1),w())},[f,a,V,r,o,s,d,H,R,t,X]}class jr extends Pe{constructor(e){super(),Te(this,e,Or,Hr,ze,{className:0})}}function rn(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function sn(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function an(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function Gr(n){let e,l=n[3].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&8&&l!==(l=o[3].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Rr(n){let e,l=n[3].dimension+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&8&&l!==(l=o[3].dimension+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function Fr(n){let e,l=n[3].dimension*4+"",t,r;return{c(){e=ae("size(1, "),t=ae(l),r=ae(")")},l(o){e=ce(o,"size(1, "),t=ce(o,l),r=ce(o,")")},m(o,s){x(o,e,s),x(o,t,s),x(o,r,s)},p(o,s){s&8&&l!==(l=o[3].dimension*4+"")&&Ve(t,l)},d(o){o&&($(e),$(t),$(r))}}}function cn(n){let e,l,t=n[10]+"",r,o,s,f,i,a,d,h,m,w,V,H;f=new tt({props:{colorScale:"purple",active:n[2]===n[12]}});function R(){return n[8](n[12])}return{c(){e=z("div"),l=z("span"),r=ae(t),o=U(),s=z("div"),ne(f.$$.fragment),i=U(),a=z("div"),d=U(),h=z("div"),m=U(),this.h()},l(X){e=P(X,"DIV",{class:!0,role:!0});var q=T(e);l=P(q,"SPAN",{class:!0});var S=T(l);r=ce(S,t),S.forEach($),o=W(q),s=P(q,"DIV",{class:!0});var M=T(s);oe(f.$$.fragment,M),i=W(M),a=P(M,"DIV",{class:!0}),T(a).forEach($),d=W(M),h=P(M,"DIV",{class:!0}),T(h).forEach($),M.forEach($),m=W(q),q.forEach($),this.h()},h(){_(l,"class","label float"),_(a,"class","sub-vector x1-12 head1"),_(h,"class","sub-vector head-rest grow"),_(s,"class",he(`vector flex flex-col  ${Ur}`)+" svelte-r5b4c7"),_(e,"class","cell"),_(e,"role","group"),le(e,"last",n[12]===n[5].length-1)},m(X,q){x(X,e,q),D(e,l),D(l,r),D(e,o),D(e,s),re(f,s,null),D(s,i),D(s,a),D(s,d),D(s,h),D(e,m),w=!0,V||(H=[we(e,"mouseenter",R),we(e,"mouseleave",n[9])],V=!0)},p(X,q){n=X,(!w||q&32)&&t!==(t=n[10]+"")&&Ve(r,t);const S={};q&4&&(S.active=n[2]===n[12]),f.$set(S),(!w||q&32)&&le(e,"last",n[12]===n[5].length-1)},i(X){w||(F(f.$$.fragment,X),w=!0)},o(X){Z(f.$$.fragment,X),w=!1},d(X){X&&$(e),se(f),V=!1,je(H)}}}function fn(n){let e,l,t,r,o,s;return t=new tt({props:{colorScale:"indigo"}}),{c(){e=z("div"),l=z("div"),ne(t.$$.fragment),r=U(),this.h()},l(f){e=P(f,"DIV",{class:!0});var i=T(e);l=P(i,"DIV",{class:!0});var a=T(l);oe(t.$$.fragment,a),a.forEach($),r=W(i),i.forEach($),this.h()},h(){_(l,"class",he(fe(`vector x4 ${Wr} opacity-80`))+" svelte-r5b4c7"),_(e,"class",o=he(fe("cell x4",{small:n[12]!==0&&n[12]!==n[5].length-1}))+" svelte-r5b4c7"),le(e,"last",n[12]===n[5].length-1)},m(f,i){x(f,e,i),D(e,l),re(t,l,null),D(e,r),s=!0},p(f,i){(!s||i&32&&o!==(o=he(fe("cell x4",{small:f[12]!==0&&f[12]!==f[5].length-1}))+" svelte-r5b4c7"))&&_(e,"class",o),(!s||i&32)&&le(e,"last",f[12]===f[5].length-1)},i(f){s||(F(t.$$.fragment,f),s=!0)},o(f){Z(t.$$.fragment,f),s=!1},d(f){f&&$(e),se(t)}}}function un(n){let e,l,t,r,o;return t=new tt({props:{colorScale:"blue"}}),{c(){e=z("div"),l=z("div"),ne(t.$$.fragment),r=U(),this.h()},l(s){e=P(s,"DIV",{class:!0});var f=T(e);l=P(f,"DIV",{class:!0});var i=T(l);oe(t.$$.fragment,i),i.forEach($),r=W(f),f.forEach($),this.h()},h(){_(l,"class",he(`vector ${Xr}`)+" svelte-r5b4c7"),_(e,"class","cell"),le(e,"last",n[12]===n[5].length-1)},m(s,f){x(s,e,f),D(e,l),re(t,l,null),D(e,r),o=!0},p(s,f){(!o||f&32)&&le(e,"last",s[12]===s[5].length-1)},i(s){o||(F(t.$$.fragment,s),o=!0)},o(s){Z(t.$$.fragment,s),o=!1},d(s){s&&$(e),se(t)}}}function xr(n){let e,l,t="MLP",r,o,s,f,i,a,d,h,m,w,V,H,R,X,q,S,M,O,B,L,c,g,v,y,I,C,k,p,u,E,b,A,N,j,K,ue,Y,G,te;s=new Ue({props:{triggeredBy:".mlp .first-layer .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Gr]},$$scope:{ctx:n}}}),i=new Ue({props:{triggeredBy:".mlp .out .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Rr]},$$scope:{ctx:n}}}),d=new Ue({props:{triggeredBy:".mlp .projections .vector",placement:"right",class:"popover text-sm font-light",$$slots:{default:[Fr]},$$scope:{ctx:n}}});let ie=ve(n[5]),Q=[];for(let J=0;J<ie.length;J+=1)Q[J]=cn(an(n,ie,J));const ke=J=>Z(Q[J],1,1,()=>{Q[J]=null});S=new Je({props:{type:"dropout",id:"mlp-first-dropout"}}),O=new Je({props:{type:"residual-end",id:"residual-first"}}),L=new Je({props:{type:"ln",id:"mlp-first-ln"}}),g=new Je({props:{type:"residual-start",id:"residual-second"}});let qe=ve(n[5]),pe=[];for(let J=0;J<qe.length;J+=1)pe[J]=fn(sn(n,qe,J));const He=J=>Z(pe[J],1,1,()=>{pe[J]=null});p=new Je({props:{type:"activation",id:"mlp-activation",className:"x4"}}),b=new Je({props:{type:"residual-end",id:"residual-second"}}),N=new Je({props:{type:"ln",id:"mlp-second-ln"}});let Se=ve(n[5]),_e=[];for(let J=0;J<Se.length;J+=1)_e[J]=un(rn(n,Se,J));const be=J=>Z(_e[J],1,1,()=>{_e[J]=null});return{c(){e=z("div"),l=z("div"),l.textContent=t,r=U(),o=z("div"),ne(s.$$.fragment),f=U(),ne(i.$$.fragment),a=U(),ne(d.$$.fragment),h=U(),m=z("div"),w=U(),V=z("div"),H=U(),R=z("div"),X=z("div");for(let J=0;J<Q.length;J+=1)Q[J].c();q=U(),ne(S.$$.fragment),M=U(),ne(O.$$.fragment),B=U(),ne(L.$$.fragment),c=U(),ne(g.$$.fragment),v=U(),y=z("div"),I=z("div"),C=z("div");for(let J=0;J<pe.length;J+=1)pe[J].c();k=U(),ne(p.$$.fragment),u=U(),E=z("div"),ne(b.$$.fragment),A=U(),ne(N.$$.fragment),j=U(),K=z("div");for(let J=0;J<_e.length;J+=1)_e[J].c();this.h()},l(J){e=P(J,"DIV",{class:!0});var me=T(e);l=P(me,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-50ab67"&&(l.textContent=t),r=W(me),o=P(me,"DIV",{class:!0});var ye=T(o);oe(s.$$.fragment,ye),f=W(ye),oe(i.$$.fragment,ye),a=W(ye),oe(d.$$.fragment,ye),h=W(ye),m=P(ye,"DIV",{class:!0}),T(m).forEach($),w=W(ye),V=P(ye,"DIV",{class:!0}),T(V).forEach($),H=W(ye),R=P(ye,"DIV",{class:!0});var Ge=T(R);X=P(Ge,"DIV",{class:!0});var it=T(X);for(let Fe=0;Fe<Q.length;Fe+=1)Q[Fe].l(it);it.forEach($),q=W(Ge),oe(S.$$.fragment,Ge),M=W(Ge),oe(O.$$.fragment,Ge),B=W(Ge),oe(L.$$.fragment,Ge),c=W(Ge),oe(g.$$.fragment,Ge),Ge.forEach($),v=W(ye),y=P(ye,"DIV",{class:!0});var ge=T(y);I=P(ge,"DIV",{class:!0});var Re=T(I);C=P(Re,"DIV",{class:!0});var wt=T(C);for(let Fe=0;Fe<pe.length;Fe+=1)pe[Fe].l(wt);wt.forEach($),k=W(Re),oe(p.$$.fragment,Re),Re.forEach($),u=W(ge),E=P(ge,"DIV",{class:!0});var nt=T(E);oe(b.$$.fragment,nt),A=W(nt),oe(N.$$.fragment,nt),j=W(nt),K=P(nt,"DIV",{class:!0});var yt=T(K);for(let Fe=0;Fe<_e.length;Fe+=1)_e[Fe].l(yt);yt.forEach($),nt.forEach($),ge.forEach($),ye.forEach($),me.forEach($),this.h()},h(){_(l,"class","title"),_(l,"role","group"),_(m,"class","bounding transformer-bounding svelte-r5b4c7"),le(m,"active",n[4]),_(V,"class","bounding mlp-bounding svelte-r5b4c7"),le(V,"active",n[1]),_(X,"class","column initial"),_(R,"class","layer first-layer flex svelte-r5b4c7"),_(C,"class","column"),_(I,"class","projections flex"),_(K,"class","column out"),_(E,"class","ouputs flex"),_(y,"class","layer second-layer flex justify-between svelte-r5b4c7"),_(o,"class","content relative svelte-r5b4c7"),_(e,"class",ue=he(fe("mlp",n[0]))+" svelte-r5b4c7")},m(J,me){x(J,e,me),D(e,l),D(e,r),D(e,o),re(s,o,null),D(o,f),re(i,o,null),D(o,a),re(d,o,null),D(o,h),D(o,m),D(o,w),D(o,V),D(o,H),D(o,R),D(R,X);for(let ye=0;ye<Q.length;ye+=1)Q[ye]&&Q[ye].m(X,null);D(R,q),re(S,R,null),D(R,M),re(O,R,null),D(R,B),re(L,R,null),D(R,c),re(g,R,null),D(o,v),D(o,y),D(y,I),D(I,C);for(let ye=0;ye<pe.length;ye+=1)pe[ye]&&pe[ye].m(C,null);D(I,k),re(p,I,null),D(y,u),D(y,E),re(b,E,null),D(E,A),re(N,E,null),D(E,j),D(E,K);for(let ye=0;ye<_e.length;ye+=1)_e[ye]&&_e[ye].m(K,null);Y=!0,G||(te=[we(l,"mouseenter",n[6]),we(l,"mouseleave",n[7])],G=!0)},p(J,[me]){const ye={};me&32776&&(ye.$$scope={dirty:me,ctx:J}),s.$set(ye);const Ge={};me&32776&&(Ge.$$scope={dirty:me,ctx:J}),i.$set(Ge);const it={};if(me&32776&&(it.$$scope={dirty:me,ctx:J}),d.$set(it),(!Y||me&16)&&le(m,"active",J[4]),(!Y||me&2)&&le(V,"active",J[1]),me&36){ie=ve(J[5]);let ge;for(ge=0;ge<ie.length;ge+=1){const Re=an(J,ie,ge);Q[ge]?(Q[ge].p(Re,me),F(Q[ge],1)):(Q[ge]=cn(Re),Q[ge].c(),F(Q[ge],1),Q[ge].m(X,null))}for(Be(),ge=ie.length;ge<Q.length;ge+=1)ke(ge);Me()}if(me&32){qe=ve(J[5]);let ge;for(ge=0;ge<qe.length;ge+=1){const Re=sn(J,qe,ge);pe[ge]?(pe[ge].p(Re,me),F(pe[ge],1)):(pe[ge]=fn(Re),pe[ge].c(),F(pe[ge],1),pe[ge].m(C,null))}for(Be(),ge=qe.length;ge<pe.length;ge+=1)He(ge);Me()}if(me&32){Se=ve(J[5]);let ge;for(ge=0;ge<Se.length;ge+=1){const Re=rn(J,Se,ge);_e[ge]?(_e[ge].p(Re,me),F(_e[ge],1)):(_e[ge]=un(Re),_e[ge].c(),F(_e[ge],1),_e[ge].m(K,null))}for(Be(),ge=Se.length;ge<_e.length;ge+=1)be(ge);Me()}(!Y||me&1&&ue!==(ue=he(fe("mlp",J[0]))+" svelte-r5b4c7"))&&_(e,"class",ue)},i(J){if(!Y){F(s.$$.fragment,J),F(i.$$.fragment,J),F(d.$$.fragment,J);for(let me=0;me<ie.length;me+=1)F(Q[me]);F(S.$$.fragment,J),F(O.$$.fragment,J),F(L.$$.fragment,J),F(g.$$.fragment,J);for(let me=0;me<qe.length;me+=1)F(pe[me]);F(p.$$.fragment,J),F(b.$$.fragment,J),F(N.$$.fragment,J);for(let me=0;me<Se.length;me+=1)F(_e[me]);Y=!0}},o(J){Z(s.$$.fragment,J),Z(i.$$.fragment,J),Z(d.$$.fragment,J),Q=Q.filter(Boolean);for(let me=0;me<Q.length;me+=1)Z(Q[me]);Z(S.$$.fragment,J),Z(O.$$.fragment,J),Z(L.$$.fragment,J),Z(g.$$.fragment,J),pe=pe.filter(Boolean);for(let me=0;me<pe.length;me+=1)Z(pe[me]);Z(p.$$.fragment,J),Z(b.$$.fragment,J),Z(N.$$.fragment,J),_e=_e.filter(Boolean);for(let me=0;me<_e.length;me+=1)Z(_e[me]);Y=!1},d(J){J&&$(e),se(s),se(i),se(d),Ae(Q,J),se(S),se(O),se(L),se(g),Ae(pe,J),se(p),se(b),se(N),Ae(_e,J),G=!1,je(te)}}}const Ur="bg-purple-200",Wr="bg-indigo-200",Xr="bg-blue-200";function Zr(n,e,l){let t,r,o;Ee(n,$t,w=>l(3,t=w)),Ee(n,kt,w=>l(4,r=w)),Ee(n,st,w=>l(5,o=w));let{className:s=void 0}=e;Nt("block-id","mlp");let f=!1;function i(){l(1,f=!0)}function a(){l(1,f=!1)}let d=null;const h=w=>{l(2,d=w)},m=()=>{l(2,d=null)};return n.$$set=w=>{"className"in w&&l(0,s=w.className)},[s,f,d,t,r,o,i,a,h,m]}class Yr extends Pe{constructor(e){super(),Te(this,e,Zr,xr,ze,{className:0})}}var Kr=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Pt=Math.ceil,Ze=Math.floor,xe="[BigNumber Error] ",hn=xe+"Number primitive has more than 15 significant digits: ",Ke=1e14,$e=14,Tt=9007199254740991,Ht=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],ct=1e7,Oe=1e9;function Sn(n){var e,l,t,r=q.prototype={constructor:q,toString:null,valueOf:null},o=new q(1),s=20,f=4,i=-7,a=21,d=-1e7,h=1e7,m=!1,w=1,V=0,H={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},R="0123456789abcdefghijklmnopqrstuvwxyz",X=!0;function q(c,g){var v,y,I,C,k,p,u,E,b=this;if(!(b instanceof q))return new q(c,g);if(g==null){if(c&&c._isBigNumber===!0){b.s=c.s,!c.c||c.e>h?b.c=b.e=null:c.e<d?b.c=[b.e=0]:(b.e=c.e,b.c=c.c.slice());return}if((p=typeof c=="number")&&c*0==0){if(b.s=1/c<0?(c=-c,-1):1,c===~~c){for(C=0,k=c;k>=10;k/=10,C++);C>h?b.c=b.e=null:(b.e=C,b.c=[c]);return}E=String(c)}else{if(!Kr.test(E=String(c)))return t(b,E,p);b.s=E.charCodeAt(0)==45?(E=E.slice(1),-1):1}(C=E.indexOf("."))>-1&&(E=E.replace(".","")),(k=E.search(/e/i))>0?(C<0&&(C=k),C+=+E.slice(k+1),E=E.substring(0,k)):C<0&&(C=E.length)}else{if(Ne(g,2,R.length,"Base"),g==10&&X)return b=new q(c),B(b,s+b.e+1,f);if(E=String(c),p=typeof c=="number"){if(c*0!=0)return t(b,E,p,g);if(b.s=1/c<0?(E=E.slice(1),-1):1,q.DEBUG&&E.replace(/^0\.0*|\./,"").length>15)throw Error(hn+c)}else b.s=E.charCodeAt(0)===45?(E=E.slice(1),-1):1;for(v=R.slice(0,g),C=k=0,u=E.length;k<u;k++)if(v.indexOf(y=E.charAt(k))<0){if(y=="."){if(k>C){C=u;continue}}else if(!I&&(E==E.toUpperCase()&&(E=E.toLowerCase())||E==E.toLowerCase()&&(E=E.toUpperCase()))){I=!0,k=-1,C=0;continue}return t(b,String(c),p,g)}p=!1,E=l(E,g,10,b.s),(C=E.indexOf("."))>-1?E=E.replace(".",""):C=E.length}for(k=0;E.charCodeAt(k)===48;k++);for(u=E.length;E.charCodeAt(--u)===48;);if(E=E.slice(k,++u)){if(u-=k,p&&q.DEBUG&&u>15&&(c>Tt||c!==Ze(c)))throw Error(hn+b.s*c);if((C=C-k-1)>h)b.c=b.e=null;else if(C<d)b.c=[b.e=0];else{if(b.e=C,b.c=[],k=(C+1)%$e,C<0&&(k+=$e),k<u){for(k&&b.c.push(+E.slice(0,k)),u-=$e;k<u;)b.c.push(+E.slice(k,k+=$e));k=$e-(E=E.slice(k)).length}else k-=u;for(;k--;E+="0");b.c.push(+E)}}else b.c=[b.e=0]}q.clone=Sn,q.ROUND_UP=0,q.ROUND_DOWN=1,q.ROUND_CEIL=2,q.ROUND_FLOOR=3,q.ROUND_HALF_UP=4,q.ROUND_HALF_DOWN=5,q.ROUND_HALF_EVEN=6,q.ROUND_HALF_CEIL=7,q.ROUND_HALF_FLOOR=8,q.EUCLID=9,q.config=q.set=function(c){var g,v;if(c!=null)if(typeof c=="object"){if(c.hasOwnProperty(g="DECIMAL_PLACES")&&(v=c[g],Ne(v,0,Oe,g),s=v),c.hasOwnProperty(g="ROUNDING_MODE")&&(v=c[g],Ne(v,0,8,g),f=v),c.hasOwnProperty(g="EXPONENTIAL_AT")&&(v=c[g],v&&v.pop?(Ne(v[0],-Oe,0,g),Ne(v[1],0,Oe,g),i=v[0],a=v[1]):(Ne(v,-Oe,Oe,g),i=-(a=v<0?-v:v))),c.hasOwnProperty(g="RANGE"))if(v=c[g],v&&v.pop)Ne(v[0],-Oe,-1,g),Ne(v[1],1,Oe,g),d=v[0],h=v[1];else if(Ne(v,-Oe,Oe,g),v)d=-(h=v<0?-v:v);else throw Error(xe+g+" cannot be zero: "+v);if(c.hasOwnProperty(g="CRYPTO"))if(v=c[g],v===!!v)if(v)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))m=v;else throw m=!v,Error(xe+"crypto unavailable");else m=v;else throw Error(xe+g+" not true or false: "+v);if(c.hasOwnProperty(g="MODULO_MODE")&&(v=c[g],Ne(v,0,9,g),w=v),c.hasOwnProperty(g="POW_PRECISION")&&(v=c[g],Ne(v,0,Oe,g),V=v),c.hasOwnProperty(g="FORMAT"))if(v=c[g],typeof v=="object")H=v;else throw Error(xe+g+" not an object: "+v);if(c.hasOwnProperty(g="ALPHABET"))if(v=c[g],typeof v=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(v))X=v.slice(0,10)=="0123456789",R=v;else throw Error(xe+g+" invalid: "+v)}else throw Error(xe+"Object expected: "+c);return{DECIMAL_PLACES:s,ROUNDING_MODE:f,EXPONENTIAL_AT:[i,a],RANGE:[d,h],CRYPTO:m,MODULO_MODE:w,POW_PRECISION:V,FORMAT:H,ALPHABET:R}},q.isBigNumber=function(c){if(!c||c._isBigNumber!==!0)return!1;if(!q.DEBUG)return!0;var g,v,y=c.c,I=c.e,C=c.s;e:if({}.toString.call(y)=="[object Array]"){if((C===1||C===-1)&&I>=-Oe&&I<=Oe&&I===Ze(I)){if(y[0]===0){if(I===0&&y.length===1)return!0;break e}if(g=(I+1)%$e,g<1&&(g+=$e),String(y[0]).length==g){for(g=0;g<y.length;g++)if(v=y[g],v<0||v>=Ke||v!==Ze(v))break e;if(v!==0)return!0}}}else if(y===null&&I===null&&(C===null||C===1||C===-1))return!0;throw Error(xe+"Invalid BigNumber: "+c)},q.maximum=q.max=function(){return M(arguments,-1)},q.minimum=q.min=function(){return M(arguments,1)},q.random=function(){var c=9007199254740992,g=Math.random()*c&2097151?function(){return Ze(Math.random()*c)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(v){var y,I,C,k,p,u=0,E=[],b=new q(o);if(v==null?v=s:Ne(v,0,Oe),k=Pt(v/$e),m)if(crypto.getRandomValues){for(y=crypto.getRandomValues(new Uint32Array(k*=2));u<k;)p=y[u]*131072+(y[u+1]>>>11),p>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),y[u]=I[0],y[u+1]=I[1]):(E.push(p%1e14),u+=2);u=k/2}else if(crypto.randomBytes){for(y=crypto.randomBytes(k*=7);u<k;)p=(y[u]&31)*281474976710656+y[u+1]*1099511627776+y[u+2]*4294967296+y[u+3]*16777216+(y[u+4]<<16)+(y[u+5]<<8)+y[u+6],p>=9e15?crypto.randomBytes(7).copy(y,u):(E.push(p%1e14),u+=7);u=k/7}else throw m=!1,Error(xe+"crypto unavailable");if(!m)for(;u<k;)p=g(),p<9e15&&(E[u++]=p%1e14);for(k=E[--u],v%=$e,k&&v&&(p=Ht[$e-v],E[u]=Ze(k/p)*p);E[u]===0;E.pop(),u--);if(u<0)E=[C=0];else{for(C=-1;E[0]===0;E.splice(0,1),C-=$e);for(u=1,p=E[0];p>=10;p/=10,u++);u<$e&&(C-=$e-u)}return b.e=C,b.c=E,b}}(),q.sum=function(){for(var c=1,g=arguments,v=new q(g[0]);c<g.length;)v=v.plus(g[c++]);return v},l=function(){var c="0123456789";function g(v,y,I,C){for(var k,p=[0],u,E=0,b=v.length;E<b;){for(u=p.length;u--;p[u]*=y);for(p[0]+=C.indexOf(v.charAt(E++)),k=0;k<p.length;k++)p[k]>I-1&&(p[k+1]==null&&(p[k+1]=0),p[k+1]+=p[k]/I|0,p[k]%=I)}return p.reverse()}return function(v,y,I,C,k){var p,u,E,b,A,N,j,K,ue=v.indexOf("."),Y=s,G=f;for(ue>=0&&(b=V,V=0,v=v.replace(".",""),K=new q(y),N=K.pow(v.length-ue),V=b,K.c=g(ot(Xe(N.c),N.e,"0"),10,I,c),K.e=K.c.length),j=g(v,y,I,k?(p=R,c):(p=c,R)),E=b=j.length;j[--b]==0;j.pop());if(!j[0])return p.charAt(0);if(ue<0?--E:(N.c=j,N.e=E,N.s=C,N=e(N,K,Y,G,I),j=N.c,A=N.r,E=N.e),u=E+Y+1,ue=j[u],b=I/2,A=A||u<0||j[u+1]!=null,A=G<4?(ue!=null||A)&&(G==0||G==(N.s<0?3:2)):ue>b||ue==b&&(G==4||A||G==6&&j[u-1]&1||G==(N.s<0?8:7)),u<1||!j[0])v=A?ot(p.charAt(1),-Y,p.charAt(0)):p.charAt(0);else{if(j.length=u,A)for(--I;++j[--u]>I;)j[u]=0,u||(++E,j=[1].concat(j));for(b=j.length;!j[--b];);for(ue=0,v="";ue<=b;v+=p.charAt(j[ue++]));v=ot(v,E,p.charAt(0))}return v}}(),e=function(){function c(y,I,C){var k,p,u,E,b=0,A=y.length,N=I%ct,j=I/ct|0;for(y=y.slice();A--;)u=y[A]%ct,E=y[A]/ct|0,k=j*u+E*N,p=N*u+k%ct*ct+b,b=(p/C|0)+(k/ct|0)+j*E,y[A]=p%C;return b&&(y=[b].concat(y)),y}function g(y,I,C,k){var p,u;if(C!=k)u=C>k?1:-1;else for(p=u=0;p<C;p++)if(y[p]!=I[p]){u=y[p]>I[p]?1:-1;break}return u}function v(y,I,C,k){for(var p=0;C--;)y[C]-=p,p=y[C]<I[C]?1:0,y[C]=p*k+y[C]-I[C];for(;!y[0]&&y.length>1;y.splice(0,1));}return function(y,I,C,k,p){var u,E,b,A,N,j,K,ue,Y,G,te,ie,Q,ke,qe,pe,He,Se=y.s==I.s?1:-1,_e=y.c,be=I.c;if(!_e||!_e[0]||!be||!be[0])return new q(!y.s||!I.s||(_e?be&&_e[0]==be[0]:!be)?NaN:_e&&_e[0]==0||!be?Se*0:Se/0);for(ue=new q(Se),Y=ue.c=[],E=y.e-I.e,Se=C+E+1,p||(p=Ke,E=Ye(y.e/$e)-Ye(I.e/$e),Se=Se/$e|0),b=0;be[b]==(_e[b]||0);b++);if(be[b]>(_e[b]||0)&&E--,Se<0)Y.push(1),A=!0;else{for(ke=_e.length,pe=be.length,b=0,Se+=2,N=Ze(p/(be[0]+1)),N>1&&(be=c(be,N,p),_e=c(_e,N,p),pe=be.length,ke=_e.length),Q=pe,G=_e.slice(0,pe),te=G.length;te<pe;G[te++]=0);He=be.slice(),He=[0].concat(He),qe=be[0],be[1]>=p/2&&qe++;do{if(N=0,u=g(be,G,pe,te),u<0){if(ie=G[0],pe!=te&&(ie=ie*p+(G[1]||0)),N=Ze(ie/qe),N>1)for(N>=p&&(N=p-1),j=c(be,N,p),K=j.length,te=G.length;g(j,G,K,te)==1;)N--,v(j,pe<K?He:be,K,p),K=j.length,u=1;else N==0&&(u=N=1),j=be.slice(),K=j.length;if(K<te&&(j=[0].concat(j)),v(G,j,te,p),te=G.length,u==-1)for(;g(be,G,pe,te)<1;)N++,v(G,pe<te?He:be,te,p),te=G.length}else u===0&&(N++,G=[0]);Y[b++]=N,G[0]?G[te++]=_e[Q]||0:(G=[_e[Q]],te=1)}while((Q++<ke||G[0]!=null)&&Se--);A=G[0]!=null,Y[0]||Y.splice(0,1)}if(p==Ke){for(b=1,Se=Y[0];Se>=10;Se/=10,b++);B(ue,C+(ue.e=b+E*$e-1)+1,k,A)}else ue.e=E,ue.r=+A;return ue}}();function S(c,g,v,y){var I,C,k,p,u;if(v==null?v=f:Ne(v,0,8),!c.c)return c.toString();if(I=c.c[0],k=c.e,g==null)u=Xe(c.c),u=y==1||y==2&&(k<=i||k>=a)?St(u,k):ot(u,k,"0");else if(c=B(new q(c),g,v),C=c.e,u=Xe(c.c),p=u.length,y==1||y==2&&(g<=C||C<=i)){for(;p<g;u+="0",p++);u=St(u,C)}else if(g-=k,u=ot(u,C,"0"),C+1>p){if(--g>0)for(u+=".";g--;u+="0");}else if(g+=C-p,g>0)for(C+1==p&&(u+=".");g--;u+="0");return c.s<0&&I?"-"+u:u}function M(c,g){for(var v,y,I=1,C=new q(c[0]);I<c.length;I++)y=new q(c[I]),(!y.s||(v=gt(C,y))===g||v===0&&C.s===g)&&(C=y);return C}function O(c,g,v){for(var y=1,I=g.length;!g[--I];g.pop());for(I=g[0];I>=10;I/=10,y++);return(v=y+v*$e-1)>h?c.c=c.e=null:v<d?c.c=[c.e=0]:(c.e=v,c.c=g),c}t=function(){var c=/^(-?)0([xbo])(?=\w[\w.]*$)/i,g=/^([^.]+)\.$/,v=/^\.([^.]+)$/,y=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(C,k,p,u){var E,b=p?k:k.replace(I,"");if(y.test(b))C.s=isNaN(b)?null:b<0?-1:1;else{if(!p&&(b=b.replace(c,function(A,N,j){return E=(j=j.toLowerCase())=="x"?16:j=="b"?2:8,!u||u==E?N:A}),u&&(E=u,b=b.replace(g,"$1").replace(v,"0.$1")),k!=b))return new q(b,E);if(q.DEBUG)throw Error(xe+"Not a"+(u?" base "+u:"")+" number: "+k);C.s=null}C.c=C.e=null}}();function B(c,g,v,y){var I,C,k,p,u,E,b,A=c.c,N=Ht;if(A){e:{for(I=1,p=A[0];p>=10;p/=10,I++);if(C=g-I,C<0)C+=$e,k=g,u=A[E=0],b=Ze(u/N[I-k-1]%10);else if(E=Pt((C+1)/$e),E>=A.length)if(y){for(;A.length<=E;A.push(0));u=b=0,I=1,C%=$e,k=C-$e+1}else break e;else{for(u=p=A[E],I=1;p>=10;p/=10,I++);C%=$e,k=C-$e+I,b=k<0?0:Ze(u/N[I-k-1]%10)}if(y=y||g<0||A[E+1]!=null||(k<0?u:u%N[I-k-1]),y=v<4?(b||y)&&(v==0||v==(c.s<0?3:2)):b>5||b==5&&(v==4||y||v==6&&(C>0?k>0?u/N[I-k]:0:A[E-1])%10&1||v==(c.s<0?8:7)),g<1||!A[0])return A.length=0,y?(g-=c.e+1,A[0]=N[($e-g%$e)%$e],c.e=-g||0):A[0]=c.e=0,c;if(C==0?(A.length=E,p=1,E--):(A.length=E+1,p=N[$e-C],A[E]=k>0?Ze(u/N[I-k]%N[k])*p:0),y)for(;;)if(E==0){for(C=1,k=A[0];k>=10;k/=10,C++);for(k=A[0]+=p,p=1;k>=10;k/=10,p++);C!=p&&(c.e++,A[0]==Ke&&(A[0]=1));break}else{if(A[E]+=p,A[E]!=Ke)break;A[E--]=0,p=1}for(C=A.length;A[--C]===0;A.pop());}c.e>h?c.c=c.e=null:c.e<d&&(c.c=[c.e=0])}return c}function L(c){var g,v=c.e;return v===null?c.toString():(g=Xe(c.c),g=v<=i||v>=a?St(g,v):ot(g,v,"0"),c.s<0?"-"+g:g)}return r.absoluteValue=r.abs=function(){var c=new q(this);return c.s<0&&(c.s=1),c},r.comparedTo=function(c,g){return gt(this,new q(c,g))},r.decimalPlaces=r.dp=function(c,g){var v,y,I,C=this;if(c!=null)return Ne(c,0,Oe),g==null?g=f:Ne(g,0,8),B(new q(C),c+C.e+1,g);if(!(v=C.c))return null;if(y=((I=v.length-1)-Ye(this.e/$e))*$e,I=v[I])for(;I%10==0;I/=10,y--);return y<0&&(y=0),y},r.dividedBy=r.div=function(c,g){return e(this,new q(c,g),s,f)},r.dividedToIntegerBy=r.idiv=function(c,g){return e(this,new q(c,g),0,1)},r.exponentiatedBy=r.pow=function(c,g){var v,y,I,C,k,p,u,E,b,A=this;if(c=new q(c),c.c&&!c.isInteger())throw Error(xe+"Exponent not an integer: "+L(c));if(g!=null&&(g=new q(g)),p=c.e>14,!A.c||!A.c[0]||A.c[0]==1&&!A.e&&A.c.length==1||!c.c||!c.c[0])return b=new q(Math.pow(+L(A),p?c.s*(2-qt(c)):+L(c))),g?b.mod(g):b;if(u=c.s<0,g){if(g.c?!g.c[0]:!g.s)return new q(NaN);y=!u&&A.isInteger()&&g.isInteger(),y&&(A=A.mod(g))}else{if(c.e>9&&(A.e>0||A.e<-1||(A.e==0?A.c[0]>1||p&&A.c[1]>=24e7:A.c[0]<8e13||p&&A.c[0]<=9999975e7)))return C=A.s<0&&qt(c)?-0:0,A.e>-1&&(C=1/C),new q(u?1/C:C);V&&(C=Pt(V/$e+2))}for(p?(v=new q(.5),u&&(c.s=1),E=qt(c)):(I=Math.abs(+L(c)),E=I%2),b=new q(o);;){if(E){if(b=b.times(A),!b.c)break;C?b.c.length>C&&(b.c.length=C):y&&(b=b.mod(g))}if(I){if(I=Ze(I/2),I===0)break;E=I%2}else if(c=c.times(v),B(c,c.e+1,1),c.e>14)E=qt(c);else{if(I=+L(c),I===0)break;E=I%2}A=A.times(A),C?A.c&&A.c.length>C&&(A.c.length=C):y&&(A=A.mod(g))}return y?b:(u&&(b=o.div(b)),g?b.mod(g):C?B(b,V,f,k):b)},r.integerValue=function(c){var g=new q(this);return c==null?c=f:Ne(c,0,8),B(g,g.e+1,c)},r.isEqualTo=r.eq=function(c,g){return gt(this,new q(c,g))===0},r.isFinite=function(){return!!this.c},r.isGreaterThan=r.gt=function(c,g){return gt(this,new q(c,g))>0},r.isGreaterThanOrEqualTo=r.gte=function(c,g){return(g=gt(this,new q(c,g)))===1||g===0},r.isInteger=function(){return!!this.c&&Ye(this.e/$e)>this.c.length-2},r.isLessThan=r.lt=function(c,g){return gt(this,new q(c,g))<0},r.isLessThanOrEqualTo=r.lte=function(c,g){return(g=gt(this,new q(c,g)))===-1||g===0},r.isNaN=function(){return!this.s},r.isNegative=function(){return this.s<0},r.isPositive=function(){return this.s>0},r.isZero=function(){return!!this.c&&this.c[0]==0},r.minus=function(c,g){var v,y,I,C,k=this,p=k.s;if(c=new q(c,g),g=c.s,!p||!g)return new q(NaN);if(p!=g)return c.s=-g,k.plus(c);var u=k.e/$e,E=c.e/$e,b=k.c,A=c.c;if(!u||!E){if(!b||!A)return b?(c.s=-g,c):new q(A?k:NaN);if(!b[0]||!A[0])return A[0]?(c.s=-g,c):new q(b[0]?k:f==3?-0:0)}if(u=Ye(u),E=Ye(E),b=b.slice(),p=u-E){for((C=p<0)?(p=-p,I=b):(E=u,I=A),I.reverse(),g=p;g--;I.push(0));I.reverse()}else for(y=(C=(p=b.length)<(g=A.length))?p:g,p=g=0;g<y;g++)if(b[g]!=A[g]){C=b[g]<A[g];break}if(C&&(I=b,b=A,A=I,c.s=-c.s),g=(y=A.length)-(v=b.length),g>0)for(;g--;b[v++]=0);for(g=Ke-1;y>p;){if(b[--y]<A[y]){for(v=y;v&&!b[--v];b[v]=g);--b[v],b[y]+=Ke}b[y]-=A[y]}for(;b[0]==0;b.splice(0,1),--E);return b[0]?O(c,b,E):(c.s=f==3?-1:1,c.c=[c.e=0],c)},r.modulo=r.mod=function(c,g){var v,y,I=this;return c=new q(c,g),!I.c||!c.s||c.c&&!c.c[0]?new q(NaN):!c.c||I.c&&!I.c[0]?new q(I):(w==9?(y=c.s,c.s=1,v=e(I,c,0,3),c.s=y,v.s*=y):v=e(I,c,0,w),c=I.minus(v.times(c)),!c.c[0]&&w==1&&(c.s=I.s),c)},r.multipliedBy=r.times=function(c,g){var v,y,I,C,k,p,u,E,b,A,N,j,K,ue,Y,G=this,te=G.c,ie=(c=new q(c,g)).c;if(!te||!ie||!te[0]||!ie[0])return!G.s||!c.s||te&&!te[0]&&!ie||ie&&!ie[0]&&!te?c.c=c.e=c.s=null:(c.s*=G.s,!te||!ie?c.c=c.e=null:(c.c=[0],c.e=0)),c;for(y=Ye(G.e/$e)+Ye(c.e/$e),c.s*=G.s,u=te.length,A=ie.length,u<A&&(K=te,te=ie,ie=K,I=u,u=A,A=I),I=u+A,K=[];I--;K.push(0));for(ue=Ke,Y=ct,I=A;--I>=0;){for(v=0,N=ie[I]%Y,j=ie[I]/Y|0,k=u,C=I+k;C>I;)E=te[--k]%Y,b=te[k]/Y|0,p=j*E+b*N,E=N*E+p%Y*Y+K[C]+v,v=(E/ue|0)+(p/Y|0)+j*b,K[C--]=E%ue;K[C]=v}return v?++y:K.splice(0,1),O(c,K,y)},r.negated=function(){var c=new q(this);return c.s=-c.s||null,c},r.plus=function(c,g){var v,y=this,I=y.s;if(c=new q(c,g),g=c.s,!I||!g)return new q(NaN);if(I!=g)return c.s=-g,y.minus(c);var C=y.e/$e,k=c.e/$e,p=y.c,u=c.c;if(!C||!k){if(!p||!u)return new q(I/0);if(!p[0]||!u[0])return u[0]?c:new q(p[0]?y:I*0)}if(C=Ye(C),k=Ye(k),p=p.slice(),I=C-k){for(I>0?(k=C,v=u):(I=-I,v=p),v.reverse();I--;v.push(0));v.reverse()}for(I=p.length,g=u.length,I-g<0&&(v=u,u=p,p=v,g=I),I=0;g;)I=(p[--g]=p[g]+u[g]+I)/Ke|0,p[g]=Ke===p[g]?0:p[g]%Ke;return I&&(p=[I].concat(p),++k),O(c,p,k)},r.precision=r.sd=function(c,g){var v,y,I,C=this;if(c!=null&&c!==!!c)return Ne(c,1,Oe),g==null?g=f:Ne(g,0,8),B(new q(C),c,g);if(!(v=C.c))return null;if(I=v.length-1,y=I*$e+1,I=v[I]){for(;I%10==0;I/=10,y--);for(I=v[0];I>=10;I/=10,y++);}return c&&C.e+1>y&&(y=C.e+1),y},r.shiftedBy=function(c){return Ne(c,-Tt,Tt),this.times("1e"+c)},r.squareRoot=r.sqrt=function(){var c,g,v,y,I,C=this,k=C.c,p=C.s,u=C.e,E=s+4,b=new q("0.5");if(p!==1||!k||!k[0])return new q(!p||p<0&&(!k||k[0])?NaN:k?C:1/0);if(p=Math.sqrt(+L(C)),p==0||p==1/0?(g=Xe(k),(g.length+u)%2==0&&(g+="0"),p=Math.sqrt(+g),u=Ye((u+1)/2)-(u<0||u%2),p==1/0?g="5e"+u:(g=p.toExponential(),g=g.slice(0,g.indexOf("e")+1)+u),v=new q(g)):v=new q(p+""),v.c[0]){for(u=v.e,p=u+E,p<3&&(p=0);;)if(I=v,v=b.times(I.plus(e(C,I,E,1))),Xe(I.c).slice(0,p)===(g=Xe(v.c)).slice(0,p))if(v.e<u&&--p,g=g.slice(p-3,p+1),g=="9999"||!y&&g=="4999"){if(!y&&(B(I,I.e+s+2,0),I.times(I).eq(C))){v=I;break}E+=4,p+=4,y=1}else{(!+g||!+g.slice(1)&&g.charAt(0)=="5")&&(B(v,v.e+s+2,1),c=!v.times(v).eq(C));break}}return B(v,v.e+s+1,f,c)},r.toExponential=function(c,g){return c!=null&&(Ne(c,0,Oe),c++),S(this,c,g,1)},r.toFixed=function(c,g){return c!=null&&(Ne(c,0,Oe),c=c+this.e+1),S(this,c,g)},r.toFormat=function(c,g,v){var y,I=this;if(v==null)c!=null&&g&&typeof g=="object"?(v=g,g=null):c&&typeof c=="object"?(v=c,c=g=null):v=H;else if(typeof v!="object")throw Error(xe+"Argument not an object: "+v);if(y=I.toFixed(c,g),I.c){var C,k=y.split("."),p=+v.groupSize,u=+v.secondaryGroupSize,E=v.groupSeparator||"",b=k[0],A=k[1],N=I.s<0,j=N?b.slice(1):b,K=j.length;if(u&&(C=p,p=u,u=C,K-=C),p>0&&K>0){for(C=K%p||p,b=j.substr(0,C);C<K;C+=p)b+=E+j.substr(C,p);u>0&&(b+=E+j.slice(C)),N&&(b="-"+b)}y=A?b+(v.decimalSeparator||"")+((u=+v.fractionGroupSize)?A.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(v.fractionGroupSeparator||"")):A):b}return(v.prefix||"")+y+(v.suffix||"")},r.toFraction=function(c){var g,v,y,I,C,k,p,u,E,b,A,N,j=this,K=j.c;if(c!=null&&(p=new q(c),!p.isInteger()&&(p.c||p.s!==1)||p.lt(o)))throw Error(xe+"Argument "+(p.isInteger()?"out of range: ":"not an integer: ")+L(p));if(!K)return new q(j);for(g=new q(o),E=v=new q(o),y=u=new q(o),N=Xe(K),C=g.e=N.length-j.e-1,g.c[0]=Ht[(k=C%$e)<0?$e+k:k],c=!c||p.comparedTo(g)>0?C>0?g:E:p,k=h,h=1/0,p=new q(N),u.c[0]=0;b=e(p,g,0,1),I=v.plus(b.times(y)),I.comparedTo(c)!=1;)v=y,y=I,E=u.plus(b.times(I=E)),u=I,g=p.minus(b.times(I=g)),p=I;return I=e(c.minus(v),y,0,1),u=u.plus(I.times(E)),v=v.plus(I.times(y)),u.s=E.s=j.s,C=C*2,A=e(E,y,C,f).minus(j).abs().comparedTo(e(u,v,C,f).minus(j).abs())<1?[E,y]:[u,v],h=k,A},r.toNumber=function(){return+L(this)},r.toPrecision=function(c,g){return c!=null&&Ne(c,1,Oe),S(this,c,g,2)},r.toString=function(c){var g,v=this,y=v.s,I=v.e;return I===null?y?(g="Infinity",y<0&&(g="-"+g)):g="NaN":(c==null?g=I<=i||I>=a?St(Xe(v.c),I):ot(Xe(v.c),I,"0"):c===10&&X?(v=B(new q(v),s+I+1,f),g=ot(Xe(v.c),v.e,"0")):(Ne(c,2,R.length,"Base"),g=l(ot(Xe(v.c),I,"0"),10,c,y,!0)),y<0&&v.c[0]&&(g="-"+g)),g},r.valueOf=r.toJSON=function(){return L(this)},r._isBigNumber=!0,r[Symbol.toStringTag]="BigNumber",r[Symbol.for("nodejs.util.inspect.custom")]=r.valueOf,n!=null&&q.set(n),q}function Ye(n){var e=n|0;return n>0||n===e?e:e-1}function Xe(n){for(var e,l,t=1,r=n.length,o=n[0]+"";t<r;){for(e=n[t++]+"",l=$e-e.length;l--;e="0"+e);o+=e}for(r=o.length;o.charCodeAt(--r)===48;);return o.slice(0,r+1||1)}function gt(n,e){var l,t,r=n.c,o=e.c,s=n.s,f=e.s,i=n.e,a=e.e;if(!s||!f)return null;if(l=r&&!r[0],t=o&&!o[0],l||t)return l?t?0:-f:s;if(s!=f)return s;if(l=s<0,t=i==a,!r||!o)return t?0:!r^l?1:-1;if(!t)return i>a^l?1:-1;for(f=(i=r.length)<(a=o.length)?i:a,s=0;s<f;s++)if(r[s]!=o[s])return r[s]>o[s]^l?1:-1;return i==a?0:i>a^l?1:-1}function Ne(n,e,l,t){if(n<e||n>l||n!==Ze(n))throw Error(xe+(t||"Argument")+(typeof n=="number"?n<e||n>l?" out of range: ":" not an integer: ":" not a primitive number: ")+String(n))}function qt(n){var e=n.c.length-1;return Ye(n.e/$e)==e&&n.c[e]%2!=0}function St(n,e){return(n.length>1?n.charAt(0)+"."+n.slice(1):n)+(e<0?"e":"e+")+e}function ot(n,e,l){var t,r;if(e<0){for(r=l+".";++e;r+=l);n=r+n}else if(t=n.length,++e>t){for(r=l,e-=t;--e;r+=l);n+=r}else e<t&&(n=n.slice(0,e)+"."+n.slice(e));return n}Sn();ht(dt);const rt=(n,e,l={})=>{const{color:t="rgba(255,255,255,0)",duration:r=.2,ease:o="power1.in",offset:s={from:"0%",to:"100%"},position:f="+=0",...i}=l,{from:a="0%",to:d="100%"}=s,h=Array.isArray(e)?e.map(m=>m.getAttribute("stop-color")):e.getAttribute("stop-color");n.fromTo(e,{attr:{offset:a,"stop-color":t}},{attr:{offset:d,"stop-color":t},duration:r,ease:o,...i},f).to(e,{attr:{offset:d,"stop-color":m=>Array.isArray(e)?h[m]:h},duration:r,ease:o,...i},"-=50%")},Qr=async n=>new Promise(e=>{var qe,pe,He,Se,_e,be,J,me,ye,Ge,it,ge,Re,wt,nt,yt,Fe,Ut,Wt,Xt,Zt,Yt;const l=mt.timeline({onComplete:e}),t=.01,r=document.querySelectorAll(".embedding .content .last");l.fromTo(r,{opacity:0},{opacity:1,duration:t});const o=document.querySelectorAll(".sankey .embedding .last");l.set(o,{opacity:.6});const s=(qe=document.querySelector("#gray-blue-last"))==null?void 0:qe.querySelectorAll("stop")[1];rt(l,s,{duration:t*1.5});const f=document.querySelectorAll(".attention .column .vector.last");l.fromTo(f,{opacity:0},{opacity:1,duration:t});const i=document.querySelectorAll(".sankey-top .attention .last"),a=document.querySelectorAll(".sankey-back .attention .last"),d=document.querySelectorAll(".sankey-top .attention .to-attention-out");l.set(i,{opacity:1}),l.set([a,d],{opacity:.4});const h=(pe=document.querySelector("#blue-blue-last"))==null?void 0:pe.querySelectorAll("stop")[1],m=(He=document.querySelector("#red-red-last"))==null?void 0:He.querySelectorAll("stop")[1],w=(Se=document.querySelector("#green-green-last"))==null?void 0:Se.querySelectorAll("stop")[1],V=(_e=document.querySelector("#blue-blue2-last"))==null?void 0:_e.querySelectorAll("stop")[1],H=(be=document.querySelector("#red-red2-last"))==null?void 0:be.querySelectorAll("stop")[1],R=(J=document.querySelector("#green-green2-last"))==null?void 0:J.querySelectorAll("stop")[1];rt(l,[h,m,w,V,H,R],{});const X=document.querySelectorAll(".attention .head-block .qkv .column .last");l.fromTo(X,{opacity:0},{opacity:1,duration:t});const q=document.querySelectorAll(".sankey g.attention path.key-to-attention"),S=document.querySelectorAll(".sankey g.attention path.query-to-attention");document.querySelectorAll(".sankey g.attention path.to-attention-out");const M=document.querySelector(".attention .attention-result");[...q,...S].forEach(Lt=>{const Kt=Lt.getTotalLength();Lt.style.strokeDasharray=Kt,Lt.style.strokeDashoffset=Kt});const O=.4,B=Number((O/n).toFixed(2));l.to(q,{strokeDashoffset:0,stagger:B,duration:O,ease:"power2.out"},"<+=50%").to(S,{strokeDashoffset:0,stagger:B,duration:O,ease:"power2.out"},"<").from(M.querySelectorAll("svg circle"),{scale:0,transformOrigin:"50% 50%",opacity:0,delay:O/n,stagger:Number((O/Math.pow(n,2)).toFixed(2)),ease:"power2.out",duration:O},"<");const L=(me=document.querySelector("#green-purple"))==null?void 0:me.querySelectorAll("stop")[1],c=(ye=document.querySelector("#transparent-purple2"))==null?void 0:ye.querySelectorAll("stop")[1];rt(l,[c,L],{});const g=document.querySelectorAll(".attention .head-block .head-out .column ");l.fromTo(g,{opacity:0},{opacity:1,duration:t});const v=(Ge=document.querySelector("#purple-purple"))==null?void 0:Ge.querySelectorAll("stop")[1],y=(it=document.querySelector("#transparent-purple"))==null?void 0:it.querySelectorAll("stop")[1];(ge=document.querySelector("#purple-purple-last"))==null||ge.querySelectorAll("stop")[1],(Re=document.querySelector("#transparent-purple-last"))==null||Re.querySelectorAll("stop")[1],rt(l,[v,y],{stagger:.2});const I=document.querySelectorAll(".mlp .first-layer .cell");l.fromTo(I,{opacity:0},{opacity:1,duration:t});const C=document.querySelectorAll(".sankey .mlp .last");l.set(C,{opacity:.4});const k=(wt=document.querySelector("#purple-indigo"))==null?void 0:wt.querySelectorAll("stop")[1],p=(nt=document.querySelector("#purple-indigo-last"))==null?void 0:nt.querySelectorAll("stop")[1];rt(l,[k,p],{});const u=document.querySelectorAll(".mlp .second-layer .projections .cell");l.fromTo(u,{opacity:0},{opacity:1,duration:t});const E=(yt=document.querySelector("#indigo-blue"))==null?void 0:yt.querySelectorAll("stop")[1],b=(Fe=document.querySelector("#indigo-blue-last"))==null?void 0:Fe.querySelectorAll("stop")[1];rt(l,[E,b],{});const A=document.querySelectorAll(".mlp .second-layer .ouputs .cell");l.fromTo(A,{opacity:0},{opacity:1,duration:t});const N=document.querySelectorAll(".sankey .transformer-blocks .last");l.set(N,{opacity:.6});const j=(Ut=document.querySelector("#blue-white-blue"))==null?void 0:Ut.querySelectorAll("stop")[1],K=(Wt=document.querySelector("#blue-white-blue"))==null?void 0:Wt.querySelectorAll("stop")[3],ue=(Xt=document.querySelector("#blue-white-blue-last"))==null?void 0:Xt.querySelectorAll("stop")[1],Y=(Zt=document.querySelector("#blue-white-blue-last"))==null?void 0:Zt.querySelectorAll("stop")[3],G=mt.timeline({});rt(G,[j,ue],{duration:.3,offset:{to:"50%"},ease:"sine.inOut"}),rt(G,[K,Y],{duration:.3,offset:{from:"50%"},ease:"sine.inOut"}),l.add(G);const te=document.querySelectorAll(".transformer-blocks .cell");l.fromTo(te,{opacity:0},{opacity:1,duration:t});const ie=document.querySelectorAll(".sankey .linear-softmax .last");l.set(ie,{opacity:.6});const Q=(Yt=document.querySelector("#blue-gray"))==null?void 0:Yt.querySelectorAll("stop")[1];rt(l,Q,{});const ke=document.querySelectorAll(".softmax .content");l.fromTo(ke,{opacity:0},{opacity:1,duration:t})}),Jr=async()=>{};zn.wasm.wasmPaths="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/";const es=async(n,e)=>{el.set(!0);const{token_ids:l,input_tokens:t}=await ns(n);st.set(t),console.log(l);const{outputs:r,prediction:o}=await rs(l),s=kn(o,e),f=En(s);Et.set({outputs:r,prediction:s,sampled:f}),await Qr(t.length),Bt.set(f),el.set(!1)},ts=async(n,e)=>{const l=kn(n,e),t=En(l);Et.update(r=>({...r,prediction:l})),await Jr(),Bt.set(t)},ls=n=>{const e=Math.max(...n),l=n.map(r=>Math.exp(r-e)),t=l.reduce((r,o)=>r+o,0);return l.map(r=>r/t)},ns=async n=>{const e=await wn.from_pretrained("Xenova/gpt2"),l=e.encode(n),t=l.map(r=>e.decode([r])).flat();return{token_ids:l,input_tokens:t}},os=(n,e,l,t)=>{const r=Array.from(n).map((o,s)=>({tokenId:s,logit:o,probability:e[s]}));return r.sort((o,s)=>s.probability-o.probability),r.slice(0,t).map((o,s)=>({...o,rank:s,token:l.decode([o.tokenId])}))},rs=async n=>{try{const e=new Pn("int64",n,[1,n.length]),l=Nn($n);if(!l)throw new Error("Model session is not initialized.");const t={input:e},r=await l.run(t),o=r.linear_output.data,s=ls(o),f=await wn.from_pretrained("Xenova/gpt2"),a=os(o,s,f,100),d=ss.reduce((h,m)=>{const w=r[m];return h[m]=w,h},{});return console.log(d),{outputs:d,prediction:a}}catch(e){throw console.error("Error during inference:",e.message),e}},ss=["block_0_attn_head_0_attn","block_0_attn_head_0_attn_scaled","block_0_attn_head_0_attn_masked","block_0_attn_head_0_attn_softmax","block_0_attn_head_0_attn_dropout","linear_output"];async function is(n){const e=await fetch(n);if(!e.ok)throw new Error(`Failed to fetch ${n}`);return e.arrayBuffer()}async function as(n){const e=await Promise.all(n.map(o=>is(o))),l=e.reduce((o,s)=>o+s.byteLength,0),t=new Uint8Array(l);let r=0;for(const o of e)t.set(new Uint8Array(o),r),r+=o.byteLength;return t.buffer}function dn(n){let e,l,t,r,o,s,f;return l=new xn({}),{c(){e=z("div"),ne(l.$$.fragment),this.h()},l(i){e=P(i,"DIV",{class:!0,style:!0,role:!0});var a=T(e);oe(l.$$.fragment,a),a.forEach($),this.h()},h(){_(e,"class","qkv-weight-popover svelte-6mb5yb"),_(e,"style",t=`left:${n[0].left}px;top:${n[0].top}px;`),_(e,"role","group")},m(i,a){x(i,e,a),re(l,e,null),o=!0,s||(f=[we(e,"mouseenter",n[3]),we(e,"mouseleave",n[4])],s=!0)},p(i,a){(!o||a&1&&t!==(t=`left:${i[0].left}px;top:${i[0].top}px;`))&&_(e,"style",t)},i(i){o||(F(l.$$.fragment,i),i&&(r||Rt(()=>{r=Mn(e,Un,{duration:300}),r.start()})),o=!0)},o(i){Z(l.$$.fragment,i),o=!1},d(i){i&&$(e),se(l),s=!1,je(f)}}}function cs(n){let e,l,t=(n[2]==="embedding"||n[1])&&dn(n);return{c(){t&&t.c(),e=lt()},l(r){t&&t.l(r),e=lt()},m(r,o){t&&t.m(r,o),x(r,e,o),l=!0},p(r,[o]){r[2]==="embedding"||r[1]?t?(t.p(r,o),o&6&&F(t,1)):(t=dn(r),t.c(),F(t,1),t.m(e.parentNode,e)):t&&(Be(),Z(t,1,1,()=>{t=null}),Me())},i(r){l||(F(t),l=!0)},o(r){Z(t),l=!1},d(r){r&&$(e),t&&t.d(r)}}}function fs(n,e,l){let t;Ee(n,jt,a=>l(2,t=a));let r,o={left:0,top:0},s=!1;return bt(()=>{const a=()=>{var H;const h=window.scrollX,m=(H=document.querySelector(".top-bar"))==null?void 0:H.offsetHeight,V=document.querySelector(".step.embedding .content").getBoundingClientRect();l(0,o={left:V.right+h,top:V.top-m})};return a(),r=new ResizeObserver(h=>{a()}),(document==null?void 0:document.querySelectorAll(".resize-watch")).forEach(h=>r.observe(h)),()=>{r.disconnect()}}),[o,s,t,()=>{l(1,s=!0)},()=>{l(1,s=!1)}]}class us extends Pe{constructor(e){super(),Te(this,e,fs,cs,ze,{})}}function hs(n){let e,l,t,r,o,s,f,i,a,d,h,m,w,V,H,R,X,q,S,M,O,B,L;return t=new go({}),f=new jr({props:{className:"step"}}),a=new jo({props:{className:"step"}}),h=new Yr({props:{className:"step"}}),w=new Qo({props:{className:"step"}}),H=new ar({props:{className:"step"}}),q=new us({}),{c(){e=z("div"),l=z("div"),ne(t.$$.fragment),r=U(),o=z("div"),s=z("div"),ne(f.$$.fragment),i=U(),ne(a.$$.fragment),d=U(),ne(h.$$.fragment),m=U(),ne(w.$$.fragment),V=U(),ne(H.$$.fragment),X=U(),ne(q.$$.fragment),S=U(),M=z("div"),this.h()},l(c){e=P(c,"DIV",{class:!0,style:!0});var g=T(e);l=P(g,"DIV",{class:!0});var v=T(l);oe(t.$$.fragment,v),v.forEach($),r=W(g),o=P(g,"DIV",{class:!0});var y=T(o);s=P(y,"DIV",{class:!0});var I=T(s);oe(f.$$.fragment,I),i=W(I),oe(a.$$.fragment,I),d=W(I),oe(h.$$.fragment,I),m=W(I),oe(w.$$.fragment,I),V=W(I),oe(H.$$.fragment,I),I.forEach($),X=W(y),oe(q.$$.fragment,y),y.forEach($),S=W(g),M=P(g,"DIV",{class:!0}),T(M).forEach($),g.forEach($),this.h()},h(){_(l,"class","sankey opacity-1 svelte-t8edyo"),_(s,"class","steps svelte-t8edyo"),Rt(()=>n[6].call(s)),le(s,"expanded",n[2]),_(o,"class","nodes resize-watch svelte-t8edyo"),_(M,"class",O=he(fe("dim pointer-events-none",`${n[1].id||""}`,{active:!!n[1].id}))+" svelte-t8edyo"),_(e,"class","main-section h-full"),_(e,"style",B=`--vector-height: ${n[3]}px;--title-height: ${n[4]}px;`)},m(c,g){x(c,e,g),D(e,l),re(t,l,null),D(e,r),D(e,o),D(o,s),re(f,s,null),D(s,i),re(a,s,null),D(s,d),re(h,s,null),D(s,m),re(w,s,null),D(s,V),re(H,s,null),R=_n(s,n[6].bind(s)),D(o,X),re(q,o,null),D(e,S),D(e,M),L=!0},p(c,[g]){(!L||g&4)&&le(s,"expanded",c[2]),(!L||g&2&&O!==(O=he(fe("dim pointer-events-none",`${c[1].id||""}`,{active:!!c[1].id}))+" svelte-t8edyo"))&&_(M,"class",O),(!L||g&8&&B!==(B=`--vector-height: ${c[3]}px;--title-height: ${c[4]}px;`))&&_(e,"style",B)},i(c){L||(F(t.$$.fragment,c),F(f.$$.fragment,c),F(a.$$.fragment,c),F(h.$$.fragment,c),F(w.$$.fragment,c),F(H.$$.fragment,c),F(q.$$.fragment,c),L=!0)},o(c){Z(t.$$.fragment,c),Z(f.$$.fragment,c),Z(a.$$.fragment,c),Z(h.$$.fragment,c),Z(w.$$.fragment,c),Z(H.$$.fragment,c),Z(q.$$.fragment,c),L=!1},d(c){c&&$(e),se(t),se(f),se(a),se(h),se(w),se(H),R(),se(q)}}}function ds(n,e,l){let t,r,o,s,f;Ee(n,st,w=>l(5,t=w)),Ee(n,Et,w=>l(7,r=w)),Ee(n,Gt,w=>l(8,o=w)),Ee(n,Qe,w=>l(1,s=w)),Ee(n,Vt,w=>l(3,f=w));let i=!1;bt(async()=>{const V=Array(40).fill(0).map((B,L)=>`${to}/gpt2-medium-quant.onnx.part${L}`),H=await as(V),R=new Blob([H],{type:"application/octet-stream"}),X=URL.createObjectURL(R),q=await Tn.create(X,{});$n.set(q);const S=Hn.subscribe(B=>{es(B,o)});let M=!0;const O=Gt.subscribe(B=>{if(M){M=!1;return}ts(r==null?void 0:r.prediction,B)});return()=>{S(),O()}});let a=0,d=_t*5;const h=()=>{const w=_t*.5*(t.length-1),V=Math.min(Math.max((a-d-w)/t.length/On,jn),Gn);Vt.set(V),bn.set(t.length*V*3+w)};function m(){a=this.offsetHeight,l(0,a)}return n.$$.update=()=>{n.$$.dirty&2&&(s.id!==null?l(2,i=!0):l(2,i=!1)),n.$$.dirty&33&&(a||t.length)&&h()},[a,s,i,f,d,t,m]}class Es extends Pe{constructor(e){super(),Te(this,e,ds,hs,ze,{})}}export{Es as component,ks as universal};

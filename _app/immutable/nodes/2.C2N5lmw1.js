import{s as Oe,G as cl,D as gl,H as _l,I as oo,J as Hn,M as On,N as jn,O as Gn,a4 as De,j as U,a5 as qe,a as P,d as _,k as x,p as g,i as G,n as He,m as Ee,z as _t,C as Ut,A as Je,e as B,c as T,q as Be,w as mt,u as oe,f as I,ah as ve,t as ue,o as Ce,b as de,P as Bt,ai as Rn,v as ye,l as Ve,r as Ue,ad as tl,E as ll,ab as bl,aj as ro}from"../chunks/scheduler.DvgnvtHA.js";import{S as je,i as Ge,c as ie,a as ae,m as ce,t as O,b as W,d as fe,g as Ne,e as Le,h as $l,j as so,f as Vt}from"../chunks/index.DUhmag0b.js";import{r as Dt,a as qt,t as bt,m as Pt,s as fl,e as $e,u as kt,b as pe,g as We,v as Ht,w as el,x as Ft,y as zn,p as xt,d as Tt,n as Kt,z as io,f as ul,Z as ao,i as wl,M as co,A as Fn,P as fo,j as uo,k as ho,B as po,C as vo,D as mo}from"../chunks/index.DFmbbhqy.js";import{b as nl,d as go,c as _o}from"../chunks/transform.yYZBLT4W.js";import{s as Yt,a as nt,M as Nt,F as It,f as at,Q as bo}from"../chunks/QKVWeightPopover.DR0NCwMi.js";import{a as $o,i as Un,b as wo,c as yo,l as dl}from"../chunks/linear.D3KXbiNi.js";import{g as ko,a as Eo,t as Io,b as ct}from"../chunks/index.lruJjzEY.js";import{P as Do,a as ol,H as yl,A as xn}from"../chunks/image.Bx4i_JL-.js";import{b as qo}from"../chunks/paths.CFDGyk9I.js";function Co(n){let e;const l=n[4].default,t=Hn(l,n,n[6],null);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,r){t&&t.m(o,r),e=!0},p(o,r){t&&t.p&&(!e||r&64)&&On(t,l,o,o[6],e?Gn(l,o[6],r,null):jn(o[6]),null)},i(o){e||(O(t,o),e=!0)},o(o){W(t,o),e=!1},d(o){t&&t.d(o)}}}function So(n){let e,l;const t=[{rounded:!0},{shadow:!0},n[1],{class:n[0]}];let o={$$slots:{default:[Co]},$$scope:{ctx:n}};for(let r=0;r<t.length;r+=1)o=cl(o,t[r]);return e=new Do({props:o}),e.$on("show",n[5]),{c(){ie(e.$$.fragment)},l(r){ae(e.$$.fragment,r)},m(r,s){ce(e,r,s),l=!0},p(r,[s]){const f=s&3?ko(t,[t[0],t[1],s&2&&Eo(r[1]),s&1&&{class:r[0]}]):{};s&64&&(f.$$scope={dirty:s,ctx:r}),e.$set(f)},i(r){l||(O(e.$$.fragment,r),l=!0)},o(r){W(e.$$.fragment,r),l=!1},d(r){fe(e,r)}}}function Ao(n,e,l){const t=["type","defaultClass"];let o=gl(e,t),{$$slots:r={},$$scope:s}=e,{type:f="dark"}=e,{defaultClass:i="py-2 px-3 text-sm font-medium"}=e;const a={dark:"bg-gray-900 text-white dark:bg-gray-700",light:"border-gray-200 bg-white text-gray-900",auto:" bg-white text-gray-900 dark:bg-gray-700 dark:text-white border-gray-200 dark:border-gray-700",custom:""};let u;function h(p){oo.call(this,n,p)}return n.$$set=p=>{l(8,e=cl(cl({},e),_l(p))),l(1,o=gl(e,t)),"type"in p&&l(2,f=p.type),"defaultClass"in p&&l(3,i=p.defaultClass),"$$scope"in p&&l(6,s=p.$$scope)},n.$$.update=()=>{o.color?l(2,f="custom"):l(1,o.color="none",o),["light","auto"].includes(f)&&l(1,o.border=!0,o),l(0,u=Io("tooltip",i,a[f],e.class))},e=_l(e),[u,o,f,i,r,h,s]}class et extends je{constructor(e){super(),Ge(this,e,Ao,So,Oe,{type:2,defaultClass:3})}}function Wn(n=[],e){const l=n.map(s=>s.logit/e),t=l.map(s=>Math.exp(s)),o=t.reduce((s,f)=>s+f,0);return n.map((s,f)=>({...s,adjustedLogit:l[f],adjustedProbability:t[f]/o,adjustedExp:t[f]}))}function Xn(n,e){const l=n.slice(0,e),t=[];let o=0;for(const s of l)o+=s.probability,t.push(o);const r=Math.random();for(let s=0;s<t.length;s++)if(r<t[s])return l[s];return l[0]}const Vo=!0,Ks=Object.freeze(Object.defineProperty({__proto__:null,prerender:Vo},Symbol.toStringTag,{value:"Module"}));function No(n,e){let l,t;for(const o of n)o!=null&&(l===void 0?o>=o&&(l=t=o):(l>o&&(l=o),t<o&&(t=o)));return[l,t]}function Lo(n,e){let l;if(e===void 0)for(const t of n)t!=null&&(l<t||l===void 0&&t>=t)&&(l=t);else{let t=-1;for(let o of n)(o=e(o,++t,n))!=null&&(l<o||l===void 0&&o>=o)&&(l=o)}return l}function Mo(n,e){e===void 0&&(e=n,n=nl);for(var l=0,t=e.length-1,o=e[0],r=new Array(t<0?0:t);l<t;)r[l]=n(o,o=e[++l]);return function(s){var f=Math.max(0,Math.min(t-1,Math.floor(s*=t)));return r[f](s-f)}}function Bo(n,e){return e.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function To(){var n=0,e=.5,l=1,t=1,o,r,s,f,i,a=Un,u,h=!1,p;function b(H){return isNaN(H=+H)?p:(H=.5+((H=+u(H))-r)*(t*H<t*r?f:i),a(h?Math.max(0,Math.min(1,H)):H))}b.domain=function(H){return arguments.length?([n,e,l]=H,o=u(n=+n),r=u(e=+e),s=u(l=+l),f=o===r?0:.5/(r-o),i=r===s?0:.5/(s-r),t=r<o?-1:1,b):[n,e,l]},b.clamp=function(H){return arguments.length?(h=!!H,b):h},b.interpolator=function(H){return arguments.length?(a=H,b):a};function N(H){return function(R){var F,A,z;return arguments.length?([F,A,z]=R,a=Mo(H,[F,A,z]),b):[a(0),a(.5),a(1)]}}return b.range=N(nl),b.rangeRound=N(yo),b.unknown=function(H){return arguments.length?(p=H,b):p},function(H){return u=H,o=H(n),r=H(e),s=H(l),f=o===r?0:.5/(r-o),i=r===s?0:.5/(s-r),t=r<o?-1:1,b}}function Zn(){var n=$o(To()(Un));return n.copy=function(){return Bo(n,Zn())},wo.apply(n,arguments)}const{theme:re}=Dt(qt),ge=200,kl={"gray-blue":{0:re.colors.gray[ge],100:re.colors.blue[ge]},"gray-blue-last":{0:re.colors.gray[ge],100:re.colors.blue[ge]},"purple-indigo":{0:re.colors.purple[ge],100:re.colors.indigo[ge]},"purple-indigo-last":{0:re.colors.purple[ge],100:re.colors.indigo[ge]},"indigo-blue":{0:re.colors.indigo[ge],100:re.colors.blue[ge]},"indigo-blue-last":{0:re.colors.indigo[ge],100:re.colors.blue[ge]},"blue-white":{0:re.colors.blue[ge],100:re.colors.white},"red-white":{0:re.colors.red[ge],100:re.colors.white},"green-white":{0:re.colors.green[ge],100:re.colors.white},"red-purple":{0:re.colors.red[ge],100:re.colors.purple[ge]},"blue-purple":{90:re.colors.blue[ge],100:re.colors.purple[ge]},"green-purple":{0:re.colors.green[ge],100:re.colors.purple[ge]},"blue-gray":{0:re.colors.blue[ge],50:re.colors.gray[ge]},"blue-white-blue":{0:re.colors.blue[ge],40:re.colors.white,60:re.colors.white,100:re.colors.blue[ge]},"blue-white-blue-last":{0:re.colors.blue[ge],40:re.colors.white,60:re.colors.white,100:re.colors.blue[ge]},"transparent-purple":{0:{color:re.colors.purple[100],opacity:0},100:{color:re.colors.purple[200],opacity:1}},"transparent-purple2":{0:{color:re.colors.purple[400],opacity:0},100:{color:re.colors.purple[200],opacity:1}},"transparent-purple-last":{0:{color:re.colors.purple[100],opacity:0},100:{color:re.colors.purple[200],opacity:1}},"transparent-purple2-last":{0:{color:re.colors.purple[400],opacity:0},100:{color:re.colors.purple[200],opacity:1}},"blue-blue":{0:re.colors.blue[ge],100:re.colors.blue[ge]},"red-red":{0:re.colors.red[ge],100:re.colors.red[ge]},"green-green":{0:re.colors.green[ge],100:re.colors.green[ge]},"blue-blue2":{0:re.colors.blue[ge],100:re.colors.blue[ge]},"red-red2":{0:re.colors.red[ge],100:re.colors.red[ge]},"green-green2":{0:re.colors.green[ge],100:re.colors.green[ge]},"blue-blue-last":{0:re.colors.blue[ge],100:re.colors.blue[ge]},"red-red-last":{0:re.colors.red[ge],100:re.colors.red[ge]},"green-green-last":{0:re.colors.green[ge],100:re.colors.green[ge]},"blue-blue2-last":{0:re.colors.blue[ge],100:re.colors.blue[ge]},"red-red2-last":{0:re.colors.red[ge],100:re.colors.red[ge]},"green-green2-last":{0:re.colors.green[ge],100:re.colors.green[ge]},"gray-gray":{0:re.colors.gray[ge],100:re.colors.gray[ge]},"purple-purple":{0:re.colors.purple[ge],100:re.colors.purple[ge]},"purple-purple-last":{0:re.colors.purple[ge],100:re.colors.purple[ge]}},Mt=.5,Kn=.8,Et=1,hl=.5,pl=.4,Yn=.8,Qn=.5;function Po(n){let e,l,t,o,r;return{c(){e=De("svg"),t=U(),o=De("svg"),this.h()},l(s){e=qe(s,"svg",{id:!0,class:!0,style:!0}),P(e).forEach(_),t=x(s),o=qe(s,"svg",{class:!0,style:!0}),P(o).forEach(_),this.h()},h(){g(e,"id","back"),g(e,"class","sankey-back absolute left-0 top-0 h-full w-full"),g(e,"style",l=`z-index:${n[2].attention_head_num-1};`),g(o,"class","sankey-top absolute left-0 top-0 h-full w-full"),g(o,"style",r=`z-index:${n[2].attention_head_num};`)},m(s,f){G(s,e,f),n[4](e),G(s,t,f),G(s,o,f),n[5](o)},p(s,[f]){f&4&&l!==(l=`z-index:${s[2].attention_head_num-1};`)&&g(e,"style",l),f&4&&r!==(r=`z-index:${s[2].attention_head_num};`)&&g(o,"style",r)},i:He,o:He,d(s){s&&(_(e),_(t),_(o)),n[4](null),n[5](null)}}}const Ho=80;function Oo(n,e,l){let t,o,r;Ee(n,bt,C=>l(3,o=C)),Ee(n,Pt,C=>l(2,r=C));const{theme:s}=Dt(qt);let f,i,a;const u={attention:[{from:".attention .query .head-rest",to:".head-block .query .vector",gradientId:"blue-blue2",opacity:Mt},{from:".attention .key .head-rest",to:".head-block .key .vector",gradientId:"red-red2",opacity:Mt},{from:".attention .value .head-rest",to:".head-block .value .vector",gradientId:"green-green2",opacity:Mt},{from:".attention .head-out .vector",to:".mlp .initial .vector .head-rest",gradientId:"transparent-purple",opacity:Mt}]},h=()=>{const q=nt(i).append("defs");Object.keys(kl).forEach(M=>{const c=kl[M],d=q.append("linearGradient").attr("id",M).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");Object.keys(c).forEach(m=>{let w,y;typeof c[m]!="string"?(w=c[m].color,y=c[m].opacity):(w=c[m],y=1),d.append("stop").attr("offset",`${m}%`).attr("stop-color",w).attr("stop-opacity",y)})})};let p=1,b;const N=(C,q)=>{var M,c;if(clearTimeout(b),fl.set(q),(c=(M=t[q])==null?void 0:M[0])!=null&&c.hoverable){const d=nt(`g.${q}`).selectAll("path");p=d.nodes()[0].getAttribute("opacity"),d.transition().duration(200).style("opacity",Number(p)+.3)}},H=(C,q)=>{var M,c;b=setTimeout(()=>{fl.set(null)},300),(c=(M=t[q])==null?void 0:M[0])!=null&&c.hoverable&&nt(`g.${q}`).selectAll("path").transition().duration(200).style("opacity",p)},R=async()=>{await Ut();const C=nt(i),q=nt(f);[{dataMap:t,svg:C},{dataMap:u,svg:q}].forEach(({dataMap:M,svg:c})=>{c.selectAll("g.path-group").data(Object.keys(M)).join("g").attr("class",m=>`path-group ${m}`).on("mouseenter",N).on("mouseleave",H).selectAll("path.sankey-path").data(m=>M[m].map(y=>{const k=Yt(y.from).nodes(),V=Yt(y.to).nodes();return k.map((v,E)=>{const $=v.getBoundingClientRect(),D=V[E].getBoundingClientRect(),L=y.curve||Ho,j=(y.pathGenerator||F)($,D,L),X=V.length>1&&E===k.length-1;let he=y.gradientId;return X&&!y.unique&&document.getElementById(y.gradientId+"-last")&&(he=y.gradientId+"-last"),{id:y.id,isLast:E===k.length-1,path:j,fill:y.type==="stroke"?"none":y.gradientId?`url(#${he})`:y.fill,opacity:y.opacity,stroke:y.type==="stroke"?y.gradientId?`url(#${y.gradientId})`:y.fill:"none"}})}).flat()).join("path").attr("class",m=>`sankey-path ${m.id||""} ${m.isLast?"last":""}`).attr("fill",m=>m.fill).attr("stroke",m=>m.stroke).attr("stroke-width",2).attr("opacity",m=>m.opacity||1).attr("d",m=>m.path)})},F=(C,q,M)=>{const c=window.scrollY,d=window.scrollX;return`
        M ${C.right+d},${C.top+c}
        C ${C.right+d+M},${C.top+c} ${q.left+d-M},${q.top+c} ${q.left+d},${q.top+c}
        L ${q.left+d},${q.bottom+c}
        C ${q.left+d-M},${q.bottom+c} ${C.right+d+M},${C.bottom+c} ${C.right+d},${C.bottom+c}
        Z
    `};_t(()=>(h(),a=new ResizeObserver(q=>{R(),A()}),(document==null?void 0:document.querySelectorAll(".resize-watch")).forEach(q=>a.observe(q)),()=>{a.disconnect()}));const A=()=>{const C=nt(i),q=Yt(".residual-start path.head").nodes(),M=Yt(".residual-end path.head").nodes(),c=q.map((d,m)=>{const w=d.getBoundingClientRect(),y=M[m].getBoundingClientRect(),k=w.right,V=w.top,v=y.left,E=y.top;return{x1:k,y1:V,x2:v,y2:E,id:d.id}});C.selectAll("line.residual-connector").data(c).join("line").attr("class",d=>`residual-connector ${d.id}`).attr("x1",d=>d.x1).attr("y1",d=>d.y1).attr("x2",d=>d.x2).attr("y2",d=>d.y2).attr("stroke",s.colors.gray[400]).attr("stroke-width",1).attr("stroke-dasharray","8,4").style("opacity",0)};function z(C){Je[C?"unshift":"push"](()=>{f=C,l(0,f)})}function ee(C){Je[C?"unshift":"push"](()=>{i=C,l(1,i)})}return n.$$.update=()=>{n.$$.dirty&8&&(t={embedding:[{hoverable:!0,from:".embedding .vector-column .column.vectors .vector",to:".attention .vector",gradientId:"gray-blue",opacity:Kn,pathGenerator:(C,q,M)=>{const c=window.scrollY,d=window.scrollX,m=30;return`
					M ${C.right+d},${C.top+c}
					L ${C.right+m+d},${C.top+c}
					C ${C.right+m+d+M},${C.top+c} ${q.left+d-M},${q.top+c} ${q.left+d},${q.top+c}
					L ${q.left+d},${q.bottom+c}
					C ${q.left+d-M},${q.bottom+c} ${C.right+m+d+M},${C.bottom+c} ${C.right+m+d},${C.bottom+c}
					L ${C.right+d},${C.bottom+c}
					Z
				`}}],attention:[{from:".attention .query .sub-vector.head1",to:".head-block .query .vector",gradientId:"blue-blue",opacity:Et},{from:".attention .key .sub-vector.head1",to:".head-block .key .vector",gradientId:"red-red",opacity:Et},{from:".attention .value .sub-vector.head1",to:".head-block .value .vector",gradientId:"green-green",opacity:Et},{from:".attention .head-out .vector",to:".mlp .initial .head1",gradientId:"purple-purple",opacity:Et},{from:".head-block .key .vector",to:".attention-initial .main g.g-row",id:"key-to-attention",type:"stroke",gradientId:"red-purple",opacity:Et,unique:!0,curve:30,pathGenerator:(C,q,M)=>{const c=window.scrollY,d=window.scrollX,m=C.top+c+C.height/2,w=q.top+c+q.height/2,y=C.right+d+M,k=q.left+d-M;return`
			    M ${C.right+d},${m}
			    C ${y},${m} ${k},${w} ${q.left+d},${w}
					L ${q.right+d},${w}
			`}},{from:".head-block .query .vector",to:`.attention-matrix.attention-initial .main g.g-row-${o.length-1} circle`,gradientId:"blue-purple",id:"query-to-attention",unique:!0,type:"stroke",opacity:Et,curve:20,pathGenerator:(C,q,M)=>{const c=window.scrollY,d=window.scrollX,m=C.top+c+C.height/2,w=q.left+d+q.width/2;return`
			    M ${C.right+d},${m}
			    L ${w-M},${m}
			    A ${M},${M} 0 0 1 ${w},${m+M}
			    L ${w},${q.bottom+c}
			`}},{from:".attention-matrix.attention-out .main svg",to:".attention .head-out",gradientId:"transparent-purple2",id:"to-attention-out",unique:!0,opacity:hl,curve:20,pathGenerator:(C,q,M)=>{const c=window.scrollY,d=window.scrollX;return`
			    M ${C.right+d},${C.top+c}
			    C ${C.right+d+M},${C.top+c} ${q.left+d-M},${q.top+c} ${q.left+d},${q.top+c}
			    L ${q.left+d},${q.bottom+c}
			    C ${q.left+d-M},${q.bottom+c} ${C.right+d+M},${C.bottom+c} ${C.right+d},${C.bottom+c}
			    Z
			`}},{from:".head-block .value",to:".attention .head-out",gradientId:"green-purple",id:"to-attention-out",unique:!0,opacity:hl,curve:60,pathGenerator:(C,q,M)=>{const c=window.scrollY,d=window.scrollX;return`
        M ${C.right+d},${C.top+c} 
        C ${q.left-M},${C.top+c} ${q.left+d-M},${C.top+c} ${q.left+d},${q.top+c}
        L ${q.left+d},${q.bottom+c}
        C ${q.left+d-M},${C.bottom+c} ${q.left-M},${C.bottom+c} ${C.right+d},${C.bottom+c}
        Z
    `}}],mlp:[{from:".mlp .column.initial .vector",to:".mlp .projections .vector",gradientId:"purple-indigo",curve:50,opacity:pl,pathGenerator:(C,q,M)=>{const c=window.scrollY,d=window.scrollX,m=49;return`
					M ${C.right+d},${C.top+c}
					L ${C.right+m+d},${C.top+c}
					C ${C.right+m+d+M},${C.top+c} ${q.left+d-M},${q.top+c} ${q.left+d},${q.top+c}
					L ${q.left+d},${q.bottom+c}
					C ${q.left+d-M},${q.bottom+c} ${C.right+m+d+M},${C.bottom+c} ${C.right+m+d},${C.bottom+c}
					L ${C.right+d},${C.bottom+c}
					Z
				`}},{from:".mlp .projections .vector",to:".mlp .column.out .vector",gradientId:"indigo-blue",curve:50,opacity:pl,pathGenerator:(C,q,M)=>{const c=window.scrollY,d=window.scrollX,m=20;return`
					M ${C.right+d},${C.top+c}
					C ${C.right+d+M},${C.top+c} ${q.left-m+d-M},${q.top+c} ${q.left-m+d},${q.top+c}
					L ${q.left+d},${q.top+c}
					L ${q.left+d},${q.bottom+c}
					L ${q.left-m+d},${q.bottom+c}
					C ${q.left-m+d-M},${q.bottom+c} ${C.right+d+M},${C.bottom+c} ${C.right+d},${C.bottom+c}
					L ${C.right+d},${C.bottom+c}
					Z
				`}}],"transformer-blocks":[{from:".mlp .out .vector",to:".transformer-blocks .column.final .vector",gradientId:"blue-white-blue",opacity:Yn,pathGenerator:(C,q,M)=>{const c=window.scrollY,d=window.scrollX;return`
        M ${C.right+d},${C.top+c}
        C ${C.right+d+M},${C.top+c} ${q.left+d-M},${q.top+c} ${q.left+d},${q.top+c}
        L ${q.left+d},${q.bottom+c}
        C ${q.left+d-M},${q.bottom+c} ${C.right+d+M},${C.bottom+c} ${C.right+d},${C.bottom+c}
        Z
    `}}],"linear-softmax":[{from:".transformer-blocks .final .vector.last-token ",to:".softmax .content .vector",gradientId:"blue-gray",opacity:Qn,unique:!0}]}),n.$$.dirty&8&&typeof window<"u"&&o&&(R(),A())},[f,i,r,o,z,ee]}class jo extends je{constructor(e){super(),Ge(this,e,Oo,Po,Oe,{})}}function El(n,e,l){const t=n.slice();return t[6]=e[l],t[8]=l,t}function Go(n){let e,l,t,o,r;return{c(){e=B("div"),l=B("div"),o=U(),this.h()},l(s){e=T(s,"DIV",{class:!0,style:!0});var f=P(e);l=T(f,"DIV",{class:!0,style:!0}),P(l).forEach(_),o=x(f),f.forEach(_),this.h()},h(){g(l,"class","card svelte-1k8s99h"),g(l,"style",t=`width: ${n[1].width}px; height: ${n[1].height}px;`),g(e,"class","rest absolute"),g(e,"style",r=`transform:translate(${n[8]*kt.x}px,${n[8]*kt.y}px) scale(${1-kt.scale*n[8]}); 
      z-index: ${n[2].attention_head_num-n[8]};opacity:${Math.max(.1,1-n[8]*Dl)};`),oe(e,"first",n[8]===1)},m(s,f){G(s,e,f),I(e,l),I(e,o)},p(s,f){f&2&&t!==(t=`width: ${s[1].width}px; height: ${s[1].height}px;`)&&g(l,"style",t),f&4&&r!==(r=`transform:translate(${s[8]*kt.x}px,${s[8]*kt.y}px) scale(${1-kt.scale*s[8]}); 
      z-index: ${s[2].attention_head_num-s[8]};opacity:${Math.max(.1,1-s[8]*Dl)};`)&&g(e,"style",r)},i:He,o:He,d(s){s&&_(e)}}}function Ro(n){let e,l,t;const o=n[4].default,r=Hn(o,n,n[3],null);return{c(){e=B("div"),r&&r.c(),l=U(),this.h()},l(s){e=T(s,"DIV",{class:!0});var f=P(e);r&&r.l(f),l=x(f),f.forEach(_),this.h()},h(){g(e,"class",ve("first-head-content")+" svelte-1k8s99h")},m(s,f){G(s,e,f),r&&r.m(e,null),I(e,l),n[5](e),t=!0},p(s,f){r&&r.p&&(!t||f&8)&&On(r,o,s,s[3],t?Gn(o,s[3],f,null):jn(s[3]),null)},i(s){t||(O(r,s),t=!0)},o(s){W(r,s),t=!1},d(s){s&&_(e),r&&r.d(s),n[5](null)}}}function Il(n){let e,l,t,o;const r=[Ro,Go],s=[];function f(i,a){return i[8]===0?0:1}return e=f(n),l=s[e]=r[e](n),{c(){l.c(),t=mt()},l(i){l.l(i),t=mt()},m(i,a){s[e].m(i,a),G(i,t,a),o=!0},p(i,a){l.p(i,a)},i(i){o||(O(l),o=!0)},o(i){W(l),o=!1},d(i){i&&_(t),s[e].d(i)}}}function zo(n){let e,l,t=$e(Array(n[2].attention_head_num+1).fill(0)),o=[];for(let s=0;s<t.length;s+=1)o[s]=Il(El(n,t,s));const r=s=>W(o[s],1,1,()=>{o[s]=null});return{c(){e=B("div");for(let s=0;s<o.length;s+=1)o[s].c();this.h()},l(s){e=T(s,"DIV",{class:!0});var f=P(e);for(let i=0;i<o.length;i+=1)o[i].l(f);f.forEach(_),this.h()},h(){g(e,"class","multi-head flex w-full svelte-1k8s99h")},m(s,f){G(s,e,f);for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(e,null);l=!0},p(s,[f]){if(f&15){t=$e(Array(s[2].attention_head_num+1).fill(0));let i;for(i=0;i<t.length;i+=1){const a=El(s,t,i);o[i]?(o[i].p(a,f),O(o[i],1)):(o[i]=Il(a),o[i].c(),O(o[i],1),o[i].m(e,null))}for(Ne(),i=t.length;i<o.length;i+=1)r(i);Le()}},i(s){if(!l){for(let f=0;f<t.length;f+=1)O(o[f]);l=!0}},o(s){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)W(o[f]);l=!1},d(s){s&&_(e),Be(o,s)}}}let Dl=.1;function Fo(n,e,l){let t;Ee(n,Pt,a=>l(2,t=a));let{$$slots:o={},$$scope:r}=e,s,f={width:0,height:0};_t(()=>{const a=new ResizeObserver(u=>{for(let h of u){const{width:p,height:b}=h.contentRect;l(1,f={width:p,height:b})}});return a.observe(s),()=>{a.unobserve(s)}});function i(a){Je[a?"unshift":"push"](()=>{s=a,l(0,s)})}return n.$$set=a=>{"$$scope"in a&&l(3,r=a.$$scope)},[s,f,t,r,o,i]}class Uo extends je{constructor(e){super(),Ge(this,e,Fo,zo,Oe,{})}}const xo=(n,e)=>{const l=e.filter(o=>o!==1),t=(o,r)=>{if(r.length===1)return o.splice(0,r[0]);const s=r[0],f=r.slice(1);return Array.from({length:s},()=>t(o,f))};return t(n,l)},wt=n=>n.map((e,l)=>{let t=new Array(e.length).fill(-1/0);for(let o=0;o<=l&&o<e.length;o++)t[o]=e[o];return t});function Wo(n){var jt,Gt;let e,l,t,o,r,s,f="QK<sup>T</sup>",i,a,u,h=((jt=n[1][0])==null?void 0:jt.toFixed(1))+"",p,b,N,H,R,F=((Gt=n[1][1])==null?void 0:Gt.toFixed(1))+"",A,z,ee,C,q,M,c,d,m,w,y,k,V,v="Scaling · Mask",E,$,D='<span class="val svelte-govu7o">-3.0</span> <div class="bar svelte-govu7o"></div> <span class="val svelte-govu7o">3.0</span>',L,S,j,X,he,Q,se,_e,le,Re,J,te="Softmax · Dropout",Z,me,Me='<span class="val svelte-govu7o">-1.0</span> <div class="bar svelte-govu7o"></div> <span class="val svelte-govu7o">1.0</span>',K,ne,Y,ke,tt,Se,ft="Attention",ut,Ze,dt,ht,Ae,At,Ot;return o=new Nt({props:{className:"main",data:n[2],showSize:!1,cellHeight:n[10],cellWidth:n[10],rowGap:3,colGap:3,shape:"circle",colorScale:n[9]}}),m=new Nt({props:{className:"prev absolute top-0 left-0 pointer-events-none",data:n[2],showSize:!1,cellHeight:n[10],cellWidth:n[10],rowGap:3,colGap:3,shape:"circle",colorScale:n[9]}}),y=new Nt({props:{className:"main opacity-0",data:wt(n[12]),showSize:!1,cellHeight:n[10],cellWidth:n[10],rowGap:3,colGap:3,shape:"circle",colorScale:n[14]}}),se=new Nt({props:{className:"prev absolute top-0 left-0  pointer-events-none",data:wt(n[12]),showSize:!1,cellHeight:n[10],cellWidth:n[10],rowGap:3,colGap:3,shape:"circle",colorScale:n[14]}}),le=new Nt({props:{className:"main opacity-0",data:wt(n[11]),showSize:!1,cellHeight:n[10],cellWidth:n[10],rowGap:3,colGap:3,shape:"circle",colorScale:n[15]}}),ke=new Nt({props:{className:"main",data:wt(n[11]),showSize:!1,cellHeight:n[10],cellWidth:n[10],rowGap:3,colGap:3,shape:"circle",colorScale:n[15]}}),{c(){e=B("div"),l=B("div"),t=B("div"),ie(o.$$.fragment),r=U(),s=B("div"),s.innerHTML=f,i=U(),a=B("div"),u=B("span"),p=ue(h),b=U(),N=B("div"),H=U(),R=B("span"),A=ue(F),ee=U(),C=B("div"),q=De("svg"),M=De("path"),c=U(),d=B("div"),ie(m.$$.fragment),w=U(),ie(y.$$.fragment),k=U(),V=B("div"),V.textContent=v,E=U(),$=B("div"),$.innerHTML=D,L=U(),S=B("div"),j=De("svg"),X=De("path"),he=U(),Q=B("div"),ie(se.$$.fragment),_e=U(),ie(le.$$.fragment),Re=U(),J=B("div"),J.textContent=te,Z=U(),me=B("div"),me.innerHTML=Me,ne=U(),Y=B("div"),ie(ke.$$.fragment),tt=U(),Se=B("div"),Se.textContent=ft,this.h()},l(be){e=T(be,"DIV",{class:!0,style:!0});var Ie=P(e);l=T(Ie,"DIV",{role:!0,class:!0});var Fe=P(l);t=T(Fe,"DIV",{class:!0});var Xe=P(t);ae(o.$$.fragment,Xe),r=x(Xe),s=T(Xe,"DIV",{class:!0,"data-svelte-h":!0}),Ce(s)!=="svelte-1uhcjv4"&&(s.innerHTML=f),i=x(Xe),a=T(Xe,"DIV",{class:!0});var Ke=P(a);u=T(Ke,"SPAN",{class:!0});var xe=P(u);p=de(xe,h),xe.forEach(_),b=x(Ke),N=T(Ke,"DIV",{class:!0}),P(N).forEach(_),H=x(Ke),R=T(Ke,"SPAN",{class:!0});var Pe=P(R);A=de(Pe,F),Pe.forEach(_),Ke.forEach(_),Xe.forEach(_),ee=x(Fe),C=T(Fe,"DIV",{class:!0});var lt=P(C);q=qe(lt,"svg",{class:!0,"aria-hidden":!0,xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var Rt=P(q);M=qe(Rt,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),P(M).forEach(_),Rt.forEach(_),c=x(lt),d=T(lt,"DIV",{});var Ct=P(d);ae(m.$$.fragment,Ct),w=x(Ct),ae(y.$$.fragment,Ct),Ct.forEach(_),k=x(lt),V=T(lt,"DIV",{class:!0,"data-svelte-h":!0}),Ce(V)!=="svelte-15vmxu9"&&(V.textContent=v),E=x(lt),$=T(lt,"DIV",{class:!0,"data-svelte-h":!0}),Ce($)!=="svelte-bz6asq"&&($.innerHTML=D),lt.forEach(_),L=x(Fe),S=T(Fe,"DIV",{class:!0});var $t=P(S);j=qe($t,"svg",{class:!0,"aria-hidden":!0,xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var ml=P(j);X=qe(ml,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),P(X).forEach(_),ml.forEach(_),he=x($t),Q=T($t,"DIV",{});var Xt=P(Q);ae(se.$$.fragment,Xt),_e=x(Xt),ae(le.$$.fragment,Xt),Xt.forEach(_),Re=x($t),J=T($t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(J)!=="svelte-1fyrzav"&&(J.textContent=te),Z=x($t),me=T($t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(me)!=="svelte-1lh8vbm"&&(me.innerHTML=Me),$t.forEach(_),ne=x(Fe),Y=T(Fe,"DIV",{class:!0});var Zt=P(Y);ae(ke.$$.fragment,Zt),tt=x(Zt),Se=T(Zt,"DIV",{class:!0,"data-svelte-h":!0}),Ce(Se)!=="svelte-10aghm9"&&(Se.textContent=ft),Zt.forEach(_),Fe.forEach(_),Ie.forEach(_),this.h()},h(){g(s,"class","matrix-label svelte-govu7o"),g(u,"class","val svelte-govu7o"),g(N,"class","bar svelte-govu7o"),g(R,"class","val svelte-govu7o"),g(a,"class","color-scale svelte-govu7o"),g(t,"class",z=ve(pe("attention-matrix attention-qk flex flex-col items-center",{"attention-initial":n[0]}))+" svelte-govu7o"),g(M,"stroke","currentColor"),g(M,"stroke-linecap","round"),g(M,"stroke-linejoin","round"),g(M,"stroke-width","2"),g(M,"d","M19 12H5m14 0-4 4m4-4-4-4"),g(q,"class","arrow svelte-govu7o"),g(q,"aria-hidden","true"),g(q,"xmlns","http://www.w3.org/2000/svg"),g(q,"width","24"),g(q,"height","24"),g(q,"fill","none"),g(q,"viewBox","0 0 24 24"),g(V,"class","matrix-label svelte-govu7o"),g($,"class","color-scale svelte-govu7o"),g(C,"class","attention-matrix attention-mask flex flex-col items-center svelte-govu7o"),g(X,"stroke","currentColor"),g(X,"stroke-linecap","round"),g(X,"stroke-linejoin","round"),g(X,"stroke-width","2"),g(X,"d","M19 12H5m14 0-4 4m4-4-4-4"),g(j,"class","arrow svelte-govu7o"),g(j,"aria-hidden","true"),g(j,"xmlns","http://www.w3.org/2000/svg"),g(j,"width","24"),g(j,"height","24"),g(j,"fill","none"),g(j,"viewBox","0 0 24 24"),g(J,"class","matrix-label svelte-govu7o"),g(me,"class","color-scale svelte-govu7o"),g(S,"class",K=ve(pe("attention-matrix attention-softmax flex flex-col items-center",{"attention-out":n[0]}))+" svelte-govu7o"),g(Se,"class","matrix-label svelte-govu7o"),g(Y,"class",ut=ve(pe("attention-matrix attention-result flex flex-col items-center",{"attention-initial":!n[0],"attention-out":!n[0]}))+" svelte-govu7o"),Bt(()=>n[24].call(Y)),g(l,"role","none"),g(l,"class",dt=ve(pe("attention-matrix-container relative flex",{active:n[0]}))+" svelte-govu7o"),g(e,"class","flex items-center gap-8 px-5"),g(e,"style",ht=`--attention-matrix-width: ${n[7]}px;`)},m(be,Ie){G(be,e,Ie),I(e,l),I(l,t),ce(o,t,null),I(t,r),I(t,s),I(t,i),I(t,a),I(a,u),I(u,p),I(a,b),I(a,N),I(a,H),I(a,R),I(R,A),n[20](t),I(l,ee),I(l,C),I(C,q),I(q,M),I(C,c),I(C,d),ce(m,d,null),I(d,w),ce(y,d,null),I(C,k),I(C,V),I(C,E),I(C,$),n[21](C),I(l,L),I(l,S),I(S,j),I(j,X),I(S,he),I(S,Q),ce(se,Q,null),I(Q,_e),ce(le,Q,null),I(S,Re),I(S,J),I(S,Z),I(S,me),n[22](S),I(l,ne),I(l,Y),ce(ke,Y,null),I(Y,tt),I(Y,Se),n[23](Y),Ze=Rn(Y,n[24].bind(Y)),n[25](l),Ae=!0,At||(Ot=[ye(l,"click",n[13]),ye(l,"keydown",n[13])],At=!0)},p(be,Ie){var Rt,Ct;const Fe={};Ie[0]&4&&(Fe.data=be[2]),Ie[0]&1024&&(Fe.cellHeight=be[10]),Ie[0]&1024&&(Fe.cellWidth=be[10]),Ie[0]&512&&(Fe.colorScale=be[9]),o.$set(Fe),(!Ae||Ie[0]&2)&&h!==(h=((Rt=be[1][0])==null?void 0:Rt.toFixed(1))+"")&&Ve(p,h),(!Ae||Ie[0]&2)&&F!==(F=((Ct=be[1][1])==null?void 0:Ct.toFixed(1))+"")&&Ve(A,F),(!Ae||Ie[0]&1&&z!==(z=ve(pe("attention-matrix attention-qk flex flex-col items-center",{"attention-initial":be[0]}))+" svelte-govu7o"))&&g(t,"class",z);const Xe={};Ie[0]&4&&(Xe.data=be[2]),Ie[0]&1024&&(Xe.cellHeight=be[10]),Ie[0]&1024&&(Xe.cellWidth=be[10]),Ie[0]&512&&(Xe.colorScale=be[9]),m.$set(Xe);const Ke={};Ie[0]&4096&&(Ke.data=wt(be[12])),Ie[0]&1024&&(Ke.cellHeight=be[10]),Ie[0]&1024&&(Ke.cellWidth=be[10]),y.$set(Ke);const xe={};Ie[0]&4096&&(xe.data=wt(be[12])),Ie[0]&1024&&(xe.cellHeight=be[10]),Ie[0]&1024&&(xe.cellWidth=be[10]),se.$set(xe);const Pe={};Ie[0]&2048&&(Pe.data=wt(be[11])),Ie[0]&1024&&(Pe.cellHeight=be[10]),Ie[0]&1024&&(Pe.cellWidth=be[10]),le.$set(Pe),(!Ae||Ie[0]&1&&K!==(K=ve(pe("attention-matrix attention-softmax flex flex-col items-center",{"attention-out":be[0]}))+" svelte-govu7o"))&&g(S,"class",K);const lt={};Ie[0]&2048&&(lt.data=wt(be[11])),Ie[0]&1024&&(lt.cellHeight=be[10]),Ie[0]&1024&&(lt.cellWidth=be[10]),ke.$set(lt),(!Ae||Ie[0]&1&&ut!==(ut=ve(pe("attention-matrix attention-result flex flex-col items-center",{"attention-initial":!be[0],"attention-out":!be[0]}))+" svelte-govu7o"))&&g(Y,"class",ut),(!Ae||Ie[0]&1&&dt!==(dt=ve(pe("attention-matrix-container relative flex",{active:be[0]}))+" svelte-govu7o"))&&g(l,"class",dt),(!Ae||Ie[0]&128&&ht!==(ht=`--attention-matrix-width: ${be[7]}px;`))&&g(e,"style",ht)},i(be){Ae||(O(o.$$.fragment,be),O(m.$$.fragment,be),O(y.$$.fragment,be),O(se.$$.fragment,be),O(le.$$.fragment,be),O(ke.$$.fragment,be),Ae=!0)},o(be){W(o.$$.fragment,be),W(m.$$.fragment,be),W(y.$$.fragment,be),W(se.$$.fragment,be),W(le.$$.fragment,be),W(ke.$$.fragment,be),Ae=!1},d(be){be&&_(e),fe(o),n[20](null),fe(m),fe(y),n[21](null),fe(se),fe(le),n[22](null),fe(ke),n[23](null),Ze(),n[25](null),At=!1,Ue(Ot)}}}let Xo=16,Zo=20,Ko=10;function Yo(n,e,l){let t,o,r,s,f,i,a,u,h,p;Ee(n,bt,S=>l(17,u=S)),Ee(n,We,S=>l(18,h=S)),Ee(n,Ht,S=>l(19,p=S));const{theme:b}=Dt(qt);let N,H,R,F,A=0,z=!1;const ee=tl("block-id"),C=()=>{z||(We.set({id:ee}),m())};let q;function M(S){z&&!q.contains(S.target)&&We.set({id:null})}_t(()=>(document.body.addEventListener("click",M),()=>{document.body.removeEventListener("click",M)}));let c=ct.timeline(),d=ct.timeline();const m=()=>{l(0,z=!0),d.progress(1);const S=document.querySelectorAll("div.sankey g.attention path.key-to-attention"),j=document.querySelectorAll("div.sankey g.attention path.query-to-attention"),X=document.querySelectorAll("div.sankey g.attention path.to-attention-out");[...S,...j].forEach(se=>{const _e=se.getTotalLength();se.style.strokeDasharray=_e,se.style.strokeDashoffset=_e});const he=1.2,Q=Number((he/u.length).toFixed(2));c.set([H.querySelector(".prev"),R.querySelector(".prev")],{opacity:1}).set([H.querySelector(".main"),R.querySelector(".main")],{opacity:0}),c.set(X,{opacity:0}),c.to(F,{opacity:0,display:"none",duration:.2}),c.set(N,{width:"auto",display:"flex",opacity:0}).to(N,{opacity:1,duration:.5}).to(S,{strokeDashoffset:0,stagger:Q,duration:he,ease:"power2.out"}).to(j,{strokeDashoffset:0,stagger:Q,duration:he,ease:"power2.out"},"<").from(N.querySelectorAll("svg circle"),{scale:0,transformOrigin:"50% 50%",opacity:0,delay:he/u.length,stagger:Number((he/Math.pow(u.length,2)).toFixed(2)),ease:"power2.out",duration:he},"<"),c.set(H,{width:0,x:A*-1,opacity:0}).to(H,{opacity:1,display:"flex",width:A,x:0,duration:.5}).to(H.querySelector(".prev"),{opacity:0,duration:1}).to(H.querySelector(".main"),{opacity:1,duration:1},"<"),c.set(R,{width:0,x:A*-1,opacity:0}).to(R,{opacity:1,display:"flex",width:A,x:0,duration:.4}).to(R.querySelector(".prev"),{opacity:0,duration:1}).to(R.querySelector(".main"),{opacity:1,duration:1},"<"),c.to(X,{opacity:.4})},w=()=>{l(0,z=!1),c.progress(1),d.to([N,H,R],{opacity:0,display:"none",width:0,duration:.5}),d.to(F,{opacity:1,display:"flex",duration:.5},0)},y=(S,j)=>dl().domain([-3,3]).range(["white",b.colors.purple[700]])(S),k=(S,j)=>nl("white",b.colors.purple[700])(S);function V(S){Je[S?"unshift":"push"](()=>{N=S,l(3,N)})}function v(S){Je[S?"unshift":"push"](()=>{H=S,l(4,H)})}function E(S){Je[S?"unshift":"push"](()=>{R=S,l(5,R)})}function $(S){Je[S?"unshift":"push"](()=>{F=S,l(6,F)})}function D(){A=this.offsetWidth,l(7,A)}function L(S){Je[S?"unshift":"push"](()=>{q=S,l(8,q)})}return n.$$.update=()=>{var S,j,X,he,Q,se;n.$$.dirty[0]&131072&&l(16,t=Array(u.length).fill(0).map(_e=>Array(u.length).fill(-1/0))),n.$$.dirty[0]&589824&&l(2,o=((j=(S=p==null?void 0:p.outputs)==null?void 0:S.block_0_attn_head_0_attn)==null?void 0:j.data)||t),n.$$.dirty[0]&589824&&l(12,r=((he=(X=p==null?void 0:p.outputs)==null?void 0:X.block_0_attn_head_0_attn_masked)==null?void 0:he.data)||t),n.$$.dirty[0]&589824&&l(11,s=((se=(Q=p==null?void 0:p.outputs)==null?void 0:Q.block_0_attn_head_0_attn_dropout)==null?void 0:se.data)||t),n.$$.dirty[0]&131072&&l(10,f=Math.min(Zo,Math.max(1/u.length*Xo*6,Ko))),n.$$.dirty[0]&262145&&h.id!==ee&&z&&(l(0,z=!1),w()),n.$$.dirty[0]&4&&l(1,i=No(o.flat())),n.$$.dirty[0]&2&&l(9,a=(_e,le)=>dl().domain(i).range(["white",b.colors.purple[700]])(_e))},[z,i,o,N,H,R,F,A,q,a,f,s,r,C,y,k,t,u,h,p,V,v,E,$,D,L]}class Qo extends je{constructor(e){super(),Ge(this,e,Yo,Wo,Oe,{},null,[-1,-1])}}function Jo(n){let e;return{c(){e=B("canvas"),this.h()},l(l){e=T(l,"CANVAS",{class:!0}),P(e).forEach(_),this.h()},h(){g(e,"class","svelte-ex5m8"),oe(e,"active",n[0])},m(l,t){G(l,e,t),n[4](e)},p(l,[t]){t&1&&oe(e,"active",l[0])},i:He,o:He,d(l){l&&_(e),n[4](null)}}}let er=100;const rl=1;function tr(n,e,l){const{theme:t}=Dt(qt);let{active:o=!1}=e,{data:r=new Array(er).fill(0).map(p=>Math.random())}=e,{colorScale:s=void 0}=e,f;const i=typeof s=="string"?s:"gray",a=typeof s=="function"?s:nl(t.colors[i][100],t.colors[i][400]);function u(){const p=f.getContext("2d");if(!p)return;const b=f.parentElement.clientWidth,N=f.parentElement.clientHeight;p.clearRect(0,0,b,N);let H=4;l(1,f.width=b*H,f),l(1,f.height=N*H,f),l(1,f.style.width=`${b}px`,f),l(1,f.style.height=`${N}px`,f);for(let R=0;R<N/rl;R++){const F=r[R];p.fillStyle=a(F),p.fillRect(0,R*rl*H,b*H,rl*H)}}_t(()=>{const p=el.subscribe(u);return()=>{p()}});function h(p){Je[p?"unshift":"push"](()=>{f=p,l(1,f)})}return n.$$set=p=>{"active"in p&&l(0,o=p.active),"data"in p&&l(2,r=p.data),"colorScale"in p&&l(3,s=p.colorScale)},n.$$.update=()=>{n.$$.dirty&6&&r&&f&&u()},[o,f,r,s,h]}class vt extends je{constructor(e){super(),Ge(this,e,tr,Jo,Oe,{active:0,data:2,colorScale:3})}}function ql(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Cl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Sl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Al(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Vl(n,e,l){const t=n.slice();return t[14]=e[l],t[16]=l,t}function Nl(n){let e,l="Q";return{c(){e=B("span"),e.textContent=l},l(t){e=T(t,"SPAN",{"data-svelte-h":!0}),Ce(e)!=="svelte-10ub4hf"&&(e.textContent=l)},m(t,o){G(t,e,o)},d(t){t&&_(e)}}}function Ll(n){let e,l="K";return{c(){e=B("span"),e.textContent=l},l(t){e=T(t,"SPAN",{"data-svelte-h":!0}),Ce(e)!=="svelte-1c09r6x"&&(e.textContent=l)},m(t,o){G(t,e,o)},d(t){t&&_(e)}}}function Ml(n){let e,l="V";return{c(){e=B("span"),e.textContent=l},l(t){e=T(t,"SPAN",{"data-svelte-h":!0}),Ce(e)!=="svelte-j40kxg"&&(e.textContent=l)},m(t,o){G(t,e,o)},d(t){t&&_(e)}}}function lr(n){let e,l=n[5].dimension*3+"",t,o;return{c(){e=ue("vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension*3+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Bl(n){let e,l,t,o,r,s,f,i,a,u,h,p,b,N,H,R,F,A,z,ee,C,q,M,c,d,m;t=new vt({props:{colorScale:"blue",active:n[2]===n[16]}});let w=n[2]!==n[16]&&Nl();u=new vt({props:{colorScale:"red",active:n[2]===n[16]}});let y=n[2]!==n[16]&&Ll();F=new vt({props:{colorScale:"green",active:n[2]===n[16]}});let k=n[2]!==n[16]&&Ml();function V(){return n[11](n[16])}return M=new et({props:{placement:"right",class:"popover",$$slots:{default:[lr]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("div"),ie(t.$$.fragment),o=U(),r=B("div"),s=U(),f=B("div"),w&&w.c(),i=U(),a=B("div"),ie(u.$$.fragment),h=U(),p=B("div"),b=U(),N=B("div"),y&&y.c(),H=U(),R=B("div"),ie(F.$$.fragment),A=U(),z=B("div"),ee=U(),C=B("div"),k&&k.c(),q=U(),ie(M.$$.fragment),this.h()},l(v){e=T(v,"DIV",{class:!0,role:!0});var E=P(e);l=T(E,"DIV",{class:!0});var $=P(l);ae(t.$$.fragment,$),o=x($),r=T($,"DIV",{class:!0}),P(r).forEach(_),s=x($),f=T($,"DIV",{class:!0});var D=P(f);w&&w.l(D),D.forEach(_),$.forEach(_),i=x(E),a=T(E,"DIV",{class:!0});var L=P(a);ae(u.$$.fragment,L),h=x(L),p=T(L,"DIV",{class:!0}),P(p).forEach(_),b=x(L),N=T(L,"DIV",{class:!0});var S=P(N);y&&y.l(S),S.forEach(_),L.forEach(_),H=x(E),R=T(E,"DIV",{class:!0});var j=P(R);ae(F.$$.fragment,j),A=x(j),z=T(j,"DIV",{class:!0}),P(z).forEach(_),ee=x(j),C=T(j,"DIV",{class:!0});var X=P(C);k&&k.l(X),X.forEach(_),j.forEach(_),E.forEach(_),q=x(v),ae(M.$$.fragment,v),this.h()},h(){g(r,"class",ve(`sub-vector x1-12 head1 ${Jn}`)+" svelte-1hsibq9"),g(f,"class","sub-vector head-rest grow svelte-1hsibq9"),g(l,"class",ve(`sub-vector query relative flex grow flex-col ${cr}`)+" svelte-1hsibq9"),g(p,"class",ve(`sub-vector x1-12 head1 ${eo}`)+" svelte-1hsibq9"),g(N,"class","sub-vector head-rest grow svelte-1hsibq9"),g(a,"class",ve(`sub-vector key relative flex grow flex-col ${fr}`)+" svelte-1hsibq9"),g(z,"class",ve(`sub-vector x1-12 head1 ${to}`)+" svelte-1hsibq9"),g(C,"class","sub-vector head-rest grow svelte-1hsibq9"),g(R,"class",ve(`sub-vector value relative flex grow flex-col ${ur}`)+" svelte-1hsibq9"),g(e,"class","qkv-weighted vector x3 flex flex-col"),g(e,"role","group"),oe(e,"last",n[16]===n[6].length-1)},m(v,E){G(v,e,E),I(e,l),ce(t,l,null),I(l,o),I(l,r),I(l,s),I(l,f),w&&w.m(f,null),I(e,i),I(e,a),ce(u,a,null),I(a,h),I(a,p),I(a,b),I(a,N),y&&y.m(N,null),I(e,H),I(e,R),ce(F,R,null),I(R,A),I(R,z),I(R,ee),I(R,C),k&&k.m(C,null),G(v,q,E),ce(M,v,E),c=!0,d||(m=[ye(e,"mouseenter",V),ye(e,"mouseleave",n[12])],d=!0)},p(v,E){n=v;const $={};E&4&&($.active=n[2]===n[16]),t.$set($),n[2]!==n[16]?w||(w=Nl(),w.c(),w.m(f,null)):w&&(w.d(1),w=null);const D={};E&4&&(D.active=n[2]===n[16]),u.$set(D),n[2]!==n[16]?y||(y=Ll(),y.c(),y.m(N,null)):y&&(y.d(1),y=null);const L={};E&4&&(L.active=n[2]===n[16]),F.$set(L),n[2]!==n[16]?k||(k=Ml(),k.c(),k.m(C,null)):k&&(k.d(1),k=null),(!c||E&64)&&oe(e,"last",n[16]===n[6].length-1);const S={};E&2097184&&(S.$$scope={dirty:E,ctx:n}),M.$set(S)},i(v){c||(O(t.$$.fragment,v),O(u.$$.fragment,v),O(F.$$.fragment,v),O(M.$$.fragment,v),c=!0)},o(v){W(t.$$.fragment,v),W(u.$$.fragment,v),W(F.$$.fragment,v),W(M.$$.fragment,v),c=!1},d(v){v&&(_(e),_(q)),fe(t),w&&w.d(),fe(u),y&&y.d(),fe(F),k&&k.d(),fe(M,v),d=!1,Ue(m)}}}function nr(n){let e,l=n[5].dimension/n[5].attention_head_num+"",t,o;return{c(){e=ue("Query, Head 1, vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"Query, Head 1, vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension/r[5].attention_head_num+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Tl(n){let e,l,t=n[14]+"",o,r,s,f,i,a;return i=new et({props:{placement:"right",class:"popover",$$slots:{default:[nr]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("span"),o=ue(t),r=U(),s=B("div"),f=U(),ie(i.$$.fragment),this.h()},l(u){e=T(u,"DIV",{class:!0});var h=P(e);l=T(h,"SPAN",{class:!0});var p=P(l);o=de(p,t),p.forEach(_),r=x(h),s=T(h,"DIV",{class:!0}),P(s).forEach(_),h.forEach(_),f=x(u),ae(i.$$.fragment,u),this.h()},h(){g(l,"class","label float svelte-1hsibq9"),g(s,"class",ve(`vector x1-12  ${Jn}`)+" svelte-1hsibq9"),g(e,"class","head1 cell x1-12 text-xs"),oe(e,"last",n[16]===n[6].length-1)},m(u,h){G(u,e,h),I(e,l),I(l,o),I(e,r),I(e,s),G(u,f,h),ce(i,u,h),a=!0},p(u,h){(!a||h&64)&&t!==(t=u[14]+"")&&Ve(o,t),(!a||h&64)&&oe(e,"last",u[16]===u[6].length-1);const p={};h&2097184&&(p.$$scope={dirty:h,ctx:u}),i.$set(p)},i(u){a||(O(i.$$.fragment,u),a=!0)},o(u){W(i.$$.fragment,u),a=!1},d(u){u&&(_(e),_(f)),fe(i,u)}}}function or(n){let e,l=n[5].dimension/n[5].attention_head_num+"",t,o;return{c(){e=ue("Key, Head 1, vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"Key, Head 1, vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension/r[5].attention_head_num+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Pl(n){let e,l,t=n[14]+"",o,r,s,f,i,a,u;return a=new et({props:{placement:"right",class:"popover",$$slots:{default:[or]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("span"),o=ue(t),r=U(),s=B("div"),i=U(),ie(a.$$.fragment),this.h()},l(h){e=T(h,"DIV",{class:!0});var p=P(e);l=T(p,"SPAN",{class:!0});var b=P(l);o=de(b,t),b.forEach(_),r=x(p),s=T(p,"DIV",{class:!0}),P(s).forEach(_),p.forEach(_),i=x(h),ae(a.$$.fragment,h),this.h()},h(){g(l,"class","label float svelte-1hsibq9"),g(s,"class",ve(`vector x1-12 ${eo}`)+" svelte-1hsibq9"),g(e,"class",f="head1 cell x1-12 text-xs class:last="+(n[16]===n[6].length-1)+" svelte-1hsibq9")},m(h,p){G(h,e,p),I(e,l),I(l,o),I(e,r),I(e,s),G(h,i,p),ce(a,h,p),u=!0},p(h,p){(!u||p&64)&&t!==(t=h[14]+"")&&Ve(o,t),(!u||p&64&&f!==(f="head1 cell x1-12 text-xs class:last="+(h[16]===h[6].length-1)+" svelte-1hsibq9"))&&g(e,"class",f);const b={};p&2097184&&(b.$$scope={dirty:p,ctx:h}),a.$set(b)},i(h){u||(O(a.$$.fragment,h),u=!0)},o(h){W(a.$$.fragment,h),u=!1},d(h){h&&(_(e),_(i)),fe(a,h)}}}function rr(n){let e,l=n[5].dimension/n[5].attention_head_num+"",t,o;return{c(){e=ue("Value, Head 1, vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"Value, Head 1, vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension/r[5].attention_head_num+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Hl(n){let e,l,t=n[14]+"",o,r,s,f,i,a;return i=new et({props:{placement:"right",class:"popover",$$slots:{default:[rr]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("span"),o=ue(t),r=U(),s=B("div"),f=U(),ie(i.$$.fragment),this.h()},l(u){e=T(u,"DIV",{class:!0});var h=P(e);l=T(h,"SPAN",{class:!0});var p=P(l);o=de(p,t),p.forEach(_),r=x(h),s=T(h,"DIV",{class:!0}),P(s).forEach(_),h.forEach(_),f=x(u),ae(i.$$.fragment,u),this.h()},h(){g(l,"class","label float svelte-1hsibq9"),g(s,"class",ve(`vector x1-12 ${to}`)+" svelte-1hsibq9"),g(e,"class","head1 cell x1-12 text-xs"),oe(e,"last",n[16]===n[6].length-1)},m(u,h){G(u,e,h),I(e,l),I(l,o),I(e,r),I(e,s),G(u,f,h),ce(i,u,h),a=!0},p(u,h){(!a||h&64)&&t!==(t=u[14]+"")&&Ve(o,t),(!a||h&64)&&oe(e,"last",u[16]===u[6].length-1);const p={};h&2097184&&(p.$$scope={dirty:h,ctx:u}),i.$set(p)},i(u){a||(O(i.$$.fragment,u),a=!0)},o(u){W(i.$$.fragment,u),a=!1},d(u){u&&(_(e),_(f)),fe(i,u)}}}function sr(n){let e,l=n[5].dimension/n[5].attention_head_num+"",t,o;return{c(){e=ue("Attention Out, Head 1, vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"Attention Out, Head 1, vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension/r[5].attention_head_num+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Ol(n){let e,l,t,o,r;return o=new et({props:{placement:"right",class:"popover",$$slots:{default:[sr]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("div"),t=U(),ie(o.$$.fragment),this.h()},l(s){e=T(s,"DIV",{class:!0});var f=P(e);l=T(f,"DIV",{class:!0}),P(l).forEach(_),f.forEach(_),t=x(s),ae(o.$$.fragment,s),this.h()},h(){g(l,"class",ve(`vector x1-12 ${dr}`)+" svelte-1hsibq9"),g(e,"class","head1 cell x1-12"),oe(e,"last",n[16]===n[6].length-1)},m(s,f){G(s,e,f),I(e,l),G(s,t,f),ce(o,s,f),r=!0},p(s,f){(!r||f&64)&&oe(e,"last",s[16]===s[6].length-1);const i={};f&2097184&&(i.$$scope={dirty:f,ctx:s}),o.$set(i)},i(s){r||(O(o.$$.fragment,s),r=!0)},o(s){W(o.$$.fragment,s),r=!1},d(s){s&&(_(e),_(t)),fe(o,s)}}}function ir(n){let e,l,t,o,r="Query",s,f,i,a,u="Key",h,p,b,N,H="Value",R,F,A,z,ee,C,q,M,c="Out",d,m,w,y,k=n[5].attention_head_num+"",V,v,E,$=$e(n[6]),D=[];for(let J=0;J<$.length;J+=1)D[J]=Tl(Al(n,$,J));const L=J=>W(D[J],1,1,()=>{D[J]=null});let S=$e(n[6]),j=[];for(let J=0;J<S.length;J+=1)j[J]=Pl(Sl(n,S,J));const X=J=>W(j[J],1,1,()=>{j[J]=null});let he=$e(n[6]),Q=[];for(let J=0;J<he.length;J+=1)Q[J]=Hl(Cl(n,he,J));const se=J=>W(Q[J],1,1,()=>{Q[J]=null});z=new Qo({});let _e=$e(n[6]),le=[];for(let J=0;J<_e.length;J+=1)le[J]=Ol(ql(n,_e,J));const Re=J=>W(le[J],1,1,()=>{le[J]=null});return{c(){e=B("div"),l=B("div"),t=B("div"),o=B("div"),o.textContent=r,s=U();for(let J=0;J<D.length;J+=1)D[J].c();f=U(),i=B("div"),a=B("div"),a.textContent=u,h=U();for(let J=0;J<j.length;J+=1)j[J].c();p=U(),b=B("div"),N=B("div"),N.textContent=H,R=U();for(let J=0;J<Q.length;J+=1)Q[J].c();F=U(),A=B("div"),ie(z.$$.fragment),ee=U(),C=B("div"),q=B("div"),M=B("div"),M.textContent=c,d=U();for(let J=0;J<le.length;J+=1)le[J].c();m=U(),w=B("div"),y=ue("Head 1 of "),V=ue(k),this.h()},l(J){e=T(J,"DIV",{class:!0,style:!0});var te=P(e);l=T(te,"DIV",{class:!0});var Z=P(l);t=T(Z,"DIV",{class:!0});var me=P(t);o=T(me,"DIV",{class:!0,"data-svelte-h":!0}),Ce(o)!=="svelte-1a2739d"&&(o.textContent=r),s=x(me);for(let Se=0;Se<D.length;Se+=1)D[Se].l(me);me.forEach(_),f=x(Z),i=T(Z,"DIV",{class:!0});var Me=P(i);a=T(Me,"DIV",{class:!0,"data-svelte-h":!0}),Ce(a)!=="svelte-bmmhtu"&&(a.textContent=u),h=x(Me);for(let Se=0;Se<j.length;Se+=1)j[Se].l(Me);Me.forEach(_),p=x(Z),b=T(Z,"DIV",{class:!0});var K=P(b);N=T(K,"DIV",{class:!0,"data-svelte-h":!0}),Ce(N)!=="svelte-17pe084"&&(N.textContent=H),R=x(K);for(let Se=0;Se<Q.length;Se+=1)Q[Se].l(K);K.forEach(_),Z.forEach(_),F=x(te),A=T(te,"DIV",{class:!0});var ne=P(A);ae(z.$$.fragment,ne),ne.forEach(_),ee=x(te),C=T(te,"DIV",{class:!0});var Y=P(C);q=T(Y,"DIV",{class:!0});var ke=P(q);M=T(ke,"DIV",{class:!0,"data-svelte-h":!0}),Ce(M)!=="svelte-68unf9"&&(M.textContent=c),d=x(ke);for(let Se=0;Se<le.length;Se+=1)le[Se].l(ke);ke.forEach(_),Y.forEach(_),m=x(te),w=T(te,"DIV",{class:!0});var tt=P(w);y=de(tt,"Head 1 of "),V=de(tt,k),tt.forEach(_),te.forEach(_),this.h()},h(){g(o,"class","title svelte-1hsibq9"),g(t,"class","column query"),g(a,"class","title svelte-1hsibq9"),g(i,"class","column key"),g(N,"class","title svelte-1hsibq9"),g(b,"class","column value"),g(l,"class","qkv flex h-full flex-col justify-center gap-[5rem] pl-[6rem]"),g(A,"class","resize-watch attention-matrix flex"),g(M,"class","title svelte-1hsibq9"),g(q,"class","column out"),g(C,"class","head-out mx-[2rem]"),g(w,"class","head-title absolute bottom-2 right-3 text-right text-gray-400"),g(e,"class","head-block flex w-full items-center justify-between px-2"),g(e,"style",v=`height:${n[7]}px;`)},m(J,te){G(J,e,te),I(e,l),I(l,t),I(t,o),I(t,s);for(let Z=0;Z<D.length;Z+=1)D[Z]&&D[Z].m(t,null);I(l,f),I(l,i),I(i,a),I(i,h);for(let Z=0;Z<j.length;Z+=1)j[Z]&&j[Z].m(i,null);I(l,p),I(l,b),I(b,N),I(b,R);for(let Z=0;Z<Q.length;Z+=1)Q[Z]&&Q[Z].m(b,null);I(e,F),I(e,A),ce(z,A,null),I(e,ee),I(e,C),I(C,q),I(q,M),I(q,d);for(let Z=0;Z<le.length;Z+=1)le[Z]&&le[Z].m(q,null);I(e,m),I(e,w),I(w,y),I(w,V),E=!0},p(J,te){if(te&96){$=$e(J[6]);let Z;for(Z=0;Z<$.length;Z+=1){const me=Al(J,$,Z);D[Z]?(D[Z].p(me,te),O(D[Z],1)):(D[Z]=Tl(me),D[Z].c(),O(D[Z],1),D[Z].m(t,null))}for(Ne(),Z=$.length;Z<D.length;Z+=1)L(Z);Le()}if(te&96){S=$e(J[6]);let Z;for(Z=0;Z<S.length;Z+=1){const me=Sl(J,S,Z);j[Z]?(j[Z].p(me,te),O(j[Z],1)):(j[Z]=Pl(me),j[Z].c(),O(j[Z],1),j[Z].m(i,null))}for(Ne(),Z=S.length;Z<j.length;Z+=1)X(Z);Le()}if(te&96){he=$e(J[6]);let Z;for(Z=0;Z<he.length;Z+=1){const me=Cl(J,he,Z);Q[Z]?(Q[Z].p(me,te),O(Q[Z],1)):(Q[Z]=Hl(me),Q[Z].c(),O(Q[Z],1),Q[Z].m(b,null))}for(Ne(),Z=he.length;Z<Q.length;Z+=1)se(Z);Le()}if(te&96){_e=$e(J[6]);let Z;for(Z=0;Z<_e.length;Z+=1){const me=ql(J,_e,Z);le[Z]?(le[Z].p(me,te),O(le[Z],1)):(le[Z]=Ol(me),le[Z].c(),O(le[Z],1),le[Z].m(q,null))}for(Ne(),Z=_e.length;Z<le.length;Z+=1)Re(Z);Le()}(!E||te&32)&&k!==(k=J[5].attention_head_num+"")&&Ve(V,k),(!E||te&128&&v!==(v=`height:${J[7]}px;`))&&g(e,"style",v)},i(J){if(!E){for(let te=0;te<$.length;te+=1)O(D[te]);for(let te=0;te<S.length;te+=1)O(j[te]);for(let te=0;te<he.length;te+=1)O(Q[te]);O(z.$$.fragment,J);for(let te=0;te<_e.length;te+=1)O(le[te]);E=!0}},o(J){D=D.filter(Boolean);for(let te=0;te<D.length;te+=1)W(D[te]);j=j.filter(Boolean);for(let te=0;te<j.length;te+=1)W(j[te]);Q=Q.filter(Boolean);for(let te=0;te<Q.length;te+=1)W(Q[te]);W(z.$$.fragment,J),le=le.filter(Boolean);for(let te=0;te<le.length;te+=1)W(le[te]);E=!1},d(J){J&&_(e),Be(D,J),Be(j,J),Be(Q,J),fe(z),Be(le,J)}}}function ar(n){let e,l,t="<div>Multi-head Self Attention</div>",o,r,s,f='<div class="bounding-title svelte-1hsibq9">Transformer Block 1</div>',i,a,u,h,p,b,N,H,R,F,A,z,ee=$e(n[6]),C=[];for(let M=0;M<ee.length;M+=1)C[M]=Bl(Vl(n,ee,M));const q=M=>W(C[M],1,1,()=>{C[M]=null});return H=new Uo({props:{$$slots:{default:[ir]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("div"),l.innerHTML=t,o=U(),r=B("div"),s=B("div"),s.innerHTML=f,i=U(),a=B("div"),h=U(),p=B("div");for(let M=0;M<C.length;M+=1)C[M].c();b=U(),N=B("div"),ie(H.$$.fragment),this.h()},l(M){e=T(M,"DIV",{class:!0});var c=P(e);l=T(c,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-n6swon"&&(l.innerHTML=t),o=x(c),r=T(c,"DIV",{class:!0});var d=P(r);s=T(d,"DIV",{class:!0,"data-svelte-h":!0}),Ce(s)!=="svelte-vte4ua"&&(s.innerHTML=f),i=x(d),a=T(d,"DIV",{class:!0,style:!0}),P(a).forEach(_),h=x(d),p=T(d,"DIV",{class:!0});var m=P(p);for(let y=0;y<C.length;y+=1)C[y].l(m);m.forEach(_),b=x(d),N=T(d,"DIV",{class:!0});var w=P(N);ae(H.$$.fragment,w),w.forEach(_),d.forEach(_),c.forEach(_),this.h()},h(){g(l,"class","title svelte-1hsibq9"),g(l,"role","group"),g(s,"class","bounding transformer-bounding svelte-1hsibq9"),oe(s,"active",n[4]),g(a,"class","bounding attention-bounding svelte-1hsibq9"),g(a,"style",u=`padding-bottom:${n[5].attention_head_num*kt.y}px`),oe(a,"active",n[1]&&!n[3]),g(p,"class","column"),g(N,"class","heads svelte-1hsibq9"),g(r,"class","content relative svelte-1hsibq9"),g(e,"class",R=ve(pe("attention",n[0],{expanded:n[3]}))+" svelte-1hsibq9")},m(M,c){G(M,e,c),I(e,l),I(e,o),I(e,r),I(r,s),I(r,i),I(r,a),I(r,h),I(r,p);for(let d=0;d<C.length;d+=1)C[d]&&C[d].m(p,null);I(r,b),I(r,N),ce(H,N,null),F=!0,A||(z=[ye(l,"mouseenter",n[8]),ye(l,"mouseleave",n[9])],A=!0)},p(M,[c]){if((!F||c&16)&&oe(s,"active",M[4]),(!F||c&32&&u!==(u=`padding-bottom:${M[5].attention_head_num*kt.y}px`))&&g(a,"style",u),(!F||c&10)&&oe(a,"active",M[1]&&!M[3]),c&100){ee=$e(M[6]);let m;for(m=0;m<ee.length;m+=1){const w=Vl(M,ee,m);C[m]?(C[m].p(w,c),O(C[m],1)):(C[m]=Bl(w),C[m].c(),O(C[m],1),C[m].m(p,null))}for(Ne(),m=ee.length;m<C.length;m+=1)q(m);Le()}const d={};c&2097376&&(d.$$scope={dirty:c,ctx:M}),H.$set(d),(!F||c&9&&R!==(R=ve(pe("attention",M[0],{expanded:M[3]}))+" svelte-1hsibq9"))&&g(e,"class",R)},i(M){if(!F){for(let c=0;c<ee.length;c+=1)O(C[c]);O(H.$$.fragment,M),F=!0}},o(M){C=C.filter(Boolean);for(let c=0;c<C.length;c+=1)W(C[c]);W(H.$$.fragment,M),F=!1},d(M){M&&_(e),Be(C,M),fe(H),A=!1,Ue(z)}}}const cr="bg-blue-200",fr="bg-red-200",ur="bg-green-200",Jn="bg-blue-300",eo="bg-red-300",to="bg-green-300",dr="bg-purple-300";function hr(n,e,l){let t,o,r,s,f,i;Ee(n,We,F=>l(10,o=F)),Ee(n,Ft,F=>l(4,r=F)),Ee(n,Pt,F=>l(5,s=F)),Ee(n,bt,F=>l(6,f=F)),Ee(n,zn,F=>l(7,i=F));let{className:a=void 0}=e;ll("block-id","attention");const u=tl("block-id");let h=!1;function p(){l(1,h=!0)}function b(){l(1,h=!1)}let N=null;const H=F=>{l(2,N=F)},R=()=>{l(2,N=null)};return n.$$set=F=>{"className"in F&&l(0,a=F.className)},n.$$.update=()=>{n.$$.dirty&1024&&l(3,t=o.id===u)},[a,h,N,t,r,s,f,i,p,b,o,H,R]}class pr extends je{constructor(e){super(),Ge(this,e,hr,ar,Oe,{className:0})}}function vr(n){let e,l,t,o,r,s,f,i=n[3]&&jl(n);return{c(){e=B("div"),l=B("div"),t=U(),o=De("svg"),i&&i.c(),r=De("path"),this.h()},l(a){e=T(a,"DIV",{class:!0});var u=P(e);l=T(u,"DIV",{class:!0}),P(l).forEach(_),t=x(u),o=qe(u,"svg",{class:!0});var h=P(o);i&&i.l(h),r=qe(h,"path",{d:!0,class:!0}),P(r).forEach(_),h.forEach(_),u.forEach(_),this.h()},h(){g(l,"class","cursor svelte-1jqlo12"),g(r,"d",s=`M0,0 L0,${n[6]}`),g(r,"class","svelte-1jqlo12"),g(o,"class","main svelte-1jqlo12"),g(e,"class",f=ve(pe("residual residual-end cell",n[1]))+" svelte-1jqlo12"),oe(e,"active",n[5])},m(a,u){G(a,e,u),I(e,l),I(e,t),I(e,o),i&&i.m(o,null),I(o,r)},p(a,u){a[3]?i?i.p(a,u):(i=jl(a),i.c(),i.m(o,r)):i&&(i.d(1),i=null),u&64&&s!==(s=`M0,0 L0,${a[6]}`)&&g(r,"d",s),u&2&&f!==(f=ve(pe("residual residual-end cell",a[1]))+" svelte-1jqlo12")&&g(e,"class",f),u&34&&oe(e,"active",a[5])},d(a){a&&_(e),i&&i.d()}}}function mr(n){let e,l,t,o,r,s,f,i=n[3]&&Gl(n);return{c(){e=B("div"),l=B("div"),t=U(),o=De("svg"),i&&i.c(),r=De("path"),this.h()},l(a){e=T(a,"DIV",{class:!0});var u=P(e);l=T(u,"DIV",{class:!0}),P(l).forEach(_),t=x(u),o=qe(u,"svg",{class:!0});var h=P(o);i&&i.l(h),r=qe(h,"path",{d:!0,class:!0}),P(r).forEach(_),h.forEach(_),u.forEach(_),this.h()},h(){g(l,"class","cursor svelte-1jqlo12"),g(r,"d",s=`M0,0 L0,${n[6]}`),g(r,"class","svelte-1jqlo12"),g(o,"class","main svelte-1jqlo12"),g(e,"class",f=ve(pe("residual residual-start cell",n[1]))+" svelte-1jqlo12"),oe(e,"active",n[5])},m(a,u){G(a,e,u),I(e,l),I(e,t),I(e,o),i&&i.m(o,null),I(o,r)},p(a,u){a[3]?i?i.p(a,u):(i=Gl(a),i.c(),i.m(o,r)):i&&(i.d(1),i=null),u&64&&s!==(s=`M0,0 L0,${a[6]}`)&&g(r,"d",s),u&2&&f!==(f=ve(pe("residual residual-start cell",a[1]))+" svelte-1jqlo12")&&g(e,"class",f),u&34&&oe(e,"active",a[5])},d(a){a&&_(e),i&&i.d()}}}function gr(n){let e,l,t,o,r,s,f,i,a,u=n[4]&&Rl();return{c(){e=B("div"),l=B("div"),t=U(),o=De("svg"),r=De("circle"),s=De("path"),i=U(),u&&u.c(),this.h()},l(h){e=T(h,"DIV",{class:!0});var p=P(e);l=T(p,"DIV",{class:!0}),P(l).forEach(_),t=x(p),o=qe(p,"svg",{class:!0});var b=P(o);r=qe(b,"circle",{class:!0,cx:!0,cy:!0,r:!0}),P(r).forEach(_),s=qe(b,"path",{class:!0,d:!0}),P(s).forEach(_),b.forEach(_),i=x(p),u&&u.l(p),p.forEach(_),this.h()},h(){g(l,"class","cursor svelte-1jqlo12"),g(r,"class","icon svelte-1jqlo12"),g(r,"cx","50%"),g(r,"cy","50%"),g(r,"r","3"),g(s,"class","line svelte-1jqlo12"),g(s,"d",f=`
     M 0 0
    C 0 ${n[6]*.25}, ${n[6]*.2} ${n[6]*.25}, ${n[6]*.2} ${n[6]*.5}
    C ${n[6]*.2} ${n[6]*.75}, 0 ${n[6]*.75}, 0 ${n[6]}
  `),g(o,"class","main svelte-1jqlo12"),g(e,"class",a=ve(pe("cell ln",n[1]))+" svelte-1jqlo12"),oe(e,"active",n[5])},m(h,p){G(h,e,p),I(e,l),I(e,t),I(e,o),I(o,r),I(o,s),I(e,i),u&&u.m(e,null)},p(h,p){p&64&&f!==(f=`
     M 0 0
    C 0 ${h[6]*.25}, ${h[6]*.2} ${h[6]*.25}, ${h[6]*.2} ${h[6]*.5}
    C ${h[6]*.2} ${h[6]*.75}, 0 ${h[6]*.75}, 0 ${h[6]}
  `)&&g(s,"d",f),h[4]?u||(u=Rl(),u.c(),u.m(e,null)):u&&(u.d(1),u=null),p&2&&a!==(a=ve(pe("cell ln",h[1]))+" svelte-1jqlo12")&&g(e,"class",a),p&34&&oe(e,"active",h[5])},d(h){h&&_(e),u&&u.d()}}}function _r(n){let e,l,t,o,r,s,f,i,a,u=n[4]&&zl();return{c(){e=B("div"),l=B("div"),t=U(),o=De("svg"),r=De("path"),f=De("circle"),i=U(),u&&u.c(),this.h()},l(h){e=T(h,"DIV",{class:!0});var p=P(e);l=T(p,"DIV",{class:!0}),P(l).forEach(_),t=x(p),o=qe(p,"svg",{class:!0});var b=P(o);r=qe(b,"path",{class:!0,d:!0}),P(r).forEach(_),f=qe(b,"circle",{class:!0,cx:!0,cy:!0,r:!0}),P(f).forEach(_),b.forEach(_),i=x(p),u&&u.l(p),p.forEach(_),this.h()},h(){g(l,"class","cursor svelte-1jqlo12"),g(r,"class","line svelte-1jqlo12"),g(r,"d",s=`M0,0 L0,${n[6]}`),g(f,"class","icon svelte-1jqlo12"),g(f,"cx","50%"),g(f,"cy","50%"),g(f,"r","3"),g(o,"class","main svelte-1jqlo12"),g(e,"class",a=ve(pe("cell dropout",n[1]))+" svelte-1jqlo12"),oe(e,"active",n[5])},m(h,p){G(h,e,p),I(e,l),I(e,t),I(e,o),I(o,r),I(o,f),I(e,i),u&&u.m(e,null)},p(h,p){p&64&&s!==(s=`M0,0 L0,${h[6]}`)&&g(r,"d",s),h[4]?u||(u=zl(),u.c(),u.m(e,null)):u&&(u.d(1),u=null),p&2&&a!==(a=ve(pe("cell dropout",h[1]))+" svelte-1jqlo12")&&g(e,"class",a),p&34&&oe(e,"active",h[5])},d(h){h&&_(e),u&&u.d()}}}function br(n){let e,l,t,o,r,s,f;return{c(){e=B("div"),l=B("div"),t=U(),o=De("svg"),r=De("path"),s=De("circle"),this.h()},l(i){e=T(i,"DIV",{class:!0});var a=P(e);l=T(a,"DIV",{class:!0}),P(l).forEach(_),t=x(a),o=qe(a,"svg",{class:!0});var u=P(o);r=qe(u,"path",{class:!0,d:!0}),P(r).forEach(_),s=qe(u,"circle",{class:!0,cx:!0,cy:!0,r:!0}),P(s).forEach(_),u.forEach(_),a.forEach(_),this.h()},h(){g(l,"class","cursor svelte-1jqlo12"),g(r,"class","line line1 svelte-1jqlo12"),g(r,"d","M0,0 L0,90%"),g(s,"class","icon svelte-1jqlo12"),g(s,"cx","50%"),g(s,"cy","50%"),g(s,"r","3"),g(o,"class","main svelte-1jqlo12"),g(e,"class",f=ve(pe("cell activation",n[1]))+" svelte-1jqlo12"),oe(e,"active",n[5])},m(i,a){G(i,e,a),I(e,l),I(e,t),I(e,o),I(o,r),I(o,s)},p(i,a){a&2&&f!==(f=ve(pe("cell activation",i[1]))+" svelte-1jqlo12")&&g(e,"class",f),a&34&&oe(e,"active",i[5])},d(i){i&&_(e)}}}function jl(n){let e;return{c(){e=De("path"),this.h()},l(l){e=qe(l,"path",{id:!0,class:!0,d:!0}),P(e).forEach(_),this.h()},h(){g(e,"id",n[0]),g(e,"class","head svelte-1jqlo12"),g(e,"d","M0,0 Q0,-16 -30,-16")},m(l,t){G(l,e,t)},p(l,t){t&1&&g(e,"id",l[0])},d(l){l&&_(e)}}}function Gl(n){let e,l,t;return{c(){e=De("path"),l=De("text"),t=ue("Residual"),this.h()},l(o){e=qe(o,"path",{id:!0,class:!0,d:!0}),P(e).forEach(_),l=qe(o,"text",{x:!0,y:!0,dy:!0,dx:!0,class:!0});var r=P(l);t=de(r,"Residual"),r.forEach(_),this.h()},h(){g(e,"id",n[0]),g(e,"class","head svelte-1jqlo12"),g(e,"d","M0,0 Q0,-16 30,-16"),g(l,"x","30"),g(l,"y","-26"),g(l,"dy","4"),g(l,"dx","4"),g(l,"class","svelte-1jqlo12")},m(o,r){G(o,e,r),G(o,l,r),I(l,t)},p(o,r){r&1&&g(e,"id",o[0])},d(o){o&&(_(e),_(l))}}}function Rl(n){let e,l,t,o;return{c(){e=De("svg"),l=De("path"),t=De("text"),o=ue("Layer Normalization"),this.h()},l(r){e=qe(r,"svg",{class:!0,width:!0});var s=P(e);l=qe(s,"path",{d:!0,class:!0}),P(l).forEach(_),t=qe(s,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var f=P(t);o=de(f,"Layer Normalization"),f.forEach(_),s.forEach(_),this.h()},h(){g(l,"d","M27.3536 4.35355C27.5488 4.15829 27.5488 3.84171 27.3536 3.64645L24.1716 0.46447C23.9763 0.269208 23.6597 0.269208 23.4645 0.464471C23.2692 0.659733 23.2692 0.976316 23.4645 1.17158L26.2929 4L23.4645 6.82843C23.2692 7.02369 23.2692 7.34028 23.4645 7.53554C23.6597 7.7308 23.9763 7.7308 24.1716 7.53554L27.3536 4.35355ZM27 3.5C20.3125 3.50001 15.2969 6.63952 11.5638 11.7944C7.84616 16.9278 5.39057 24.0677 3.75991 32.1346C0.498061 48.2711 0.5 68.3247 0.5 84H1.5C1.5 68.2984 1.50194 48.352 4.74009 32.3328C6.35943 24.3218 8.77884 17.3448 12.3737 12.3809C15.9531 7.4384 20.6875 4.50001 27 4.5V3.5Z"),g(l,"class","svelte-1jqlo12"),g(t,"x","4"),g(t,"y","95"),g(t,"text-anchor","middle"),g(t,"class","svelte-1jqlo12"),g(e,"class","guide svelte-1jqlo12"),g(e,"width","27px"),oe(e,"active",!1)},m(r,s){G(r,e,s),I(e,l),I(e,t),I(t,o)},d(r){r&&_(e)}}}function zl(n){let e,l,t,o;return{c(){e=De("svg"),l=De("path"),t=De("text"),o=ue("Dropout"),this.h()},l(r){e=qe(r,"svg",{class:!0,width:!0});var s=P(e);l=qe(s,"path",{d:!0,class:!0}),P(l).forEach(_),t=qe(s,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var f=P(t);o=de(f,"Dropout"),f.forEach(_),s.forEach(_),this.h()},h(){g(l,"d","M44.3186 4.46399C44.5314 4.28801 44.5613 3.97284 44.3853 3.76004L41.5175 0.292199C41.3416 0.0793953 41.0264 0.0495441 40.8136 0.225525C40.6008 0.401505 40.5709 0.716677 40.7469 0.929481L43.296 4.012L40.2135 6.56113C40.0007 6.73711 39.9709 7.05228 40.1468 7.26509C40.3228 7.47789 40.638 7.50774 40.8508 7.33176L44.3186 4.46399ZM44.0471 3.58091C38.7621 3.08034 27.8926 4.80481 18.3357 11.5838C8.74613 18.386 0.5 30.2626 0.5 50H1.5C1.5 30.5889 9.58721 19.0154 18.9143 12.3994C28.2741 5.76023 38.9045 4.0983 43.9529 4.57645L44.0471 3.58091Z"),g(l,"class","svelte-1jqlo12"),g(t,"x","4"),g(t,"y","60"),g(t,"text-anchor","middle"),g(t,"class","svelte-1jqlo12"),g(e,"class","guide svelte-1jqlo12"),g(e,"width","44px"),oe(e,"active",!1)},m(r,s){G(r,e,s),I(e,l),I(e,t),I(t,o)},d(r){r&&_(e)}}}function $r(n){let e;function l(r,s){if(r[2]==="activation")return br;if(r[2]==="dropout")return _r;if(r[2]==="ln")return gr;if(r[2]==="residual-start")return mr;if(r[2]==="residual-end")return vr}let t=l(n),o=t&&t(n);return{c(){o&&o.c(),e=mt()},l(r){o&&o.l(r),e=mt()},m(r,s){o&&o.m(r,s),G(r,e,s)},p(r,[s]){t===(t=l(r))&&o?o.p(r,s):(o&&o.d(1),o=t&&t(r),o&&(o.c(),o.m(e.parentNode,e)))},i:He,o:He,d(r){r&&_(e),o&&o.d(r)}}}function wr(n,e,l){let t;Ee(n,el,u=>l(6,t=u));let{id:o=void 0}=e,{className:r=void 0}=e,{type:s=void 0}=e,{head:f=!1}=e,{tail:i=!1}=e,{active:a=!1}=e;return n.$$set=u=>{"id"in u&&l(0,o=u.id),"className"in u&&l(1,r=u.className),"type"in u&&l(2,s=u.type),"head"in u&&l(3,f=u.head),"tail"in u&&l(4,i=u.tail),"active"in u&&l(5,a=u.active)},[o,r,s,f,i,a,t]}class Wt extends je{constructor(e){super(),Ge(this,e,wr,$r,Oe,{id:0,className:1,type:2,head:3,tail:4,active:5})}}function Fl(n,e,l){const t=n.slice();return t[7]=e[l],t[9]=l,t}function yr(n){let e,l=n[3].dimension+"",t,o;return{c(){e=ue("vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&8&&l!==(l=r[3].dimension+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Ul(n){let e,l,t,o,r,s,f,i;return t=new vt({props:{colorScale:"blue"}}),s=new et({props:{placement:"right",class:"popover",$$slots:{default:[yr]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("div"),ie(t.$$.fragment),r=U(),ie(s.$$.fragment),f=U(),this.h()},l(a){e=T(a,"DIV",{class:!0});var u=P(e);l=T(u,"DIV",{class:!0});var h=P(l);ae(t.$$.fragment,h),h.forEach(_),r=x(u),ae(s.$$.fragment,u),f=x(u),u.forEach(_),this.h()},h(){g(l,"class",o=ve(pe("vector shrink-0 bg-blue-200",{"last-token":n[9]===n[4].length-1}))+" svelte-1jtwro5"),g(e,"class","cell svelte-1jtwro5"),oe(e,"last",n[9]===n[4].length-1)},m(a,u){G(a,e,u),I(e,l),ce(t,l,null),I(e,r),ce(s,e,null),I(e,f),i=!0},p(a,u){(!i||u&16&&o!==(o=ve(pe("vector shrink-0 bg-blue-200",{"last-token":a[9]===a[4].length-1}))+" svelte-1jtwro5"))&&g(l,"class",o);const h={};u&1032&&(h.$$scope={dirty:u,ctx:a}),s.$set(h),(!i||u&16)&&oe(e,"last",a[9]===a[4].length-1)},i(a){i||(O(t.$$.fragment,a),O(s.$$.fragment,a),i=!0)},o(a){W(t.$$.fragment,a),W(s.$$.fragment,a),i=!1},d(a){a&&_(e),fe(t),fe(s)}}}function kr(n){let e,l,t,o,r,s,f,i=n[3].layer_num-1+"",a,u,h,p,b="Transformer<br/>Blocks",N,H,R,F,A,z,ee,C,q,M,c,d,m=$e(n[4]),w=[];for(let k=0;k<m.length;k+=1)w[k]=Ul(Fl(n,m,k));const y=k=>W(w[k],1,1,()=>{w[k]=null});return{c(){e=B("div"),l=B("div"),t=U(),o=B("div"),r=B("div"),s=B("div"),f=B("div"),a=ue(i),u=ue(" more identical"),h=B("br"),p=B("span"),p.innerHTML=b,N=ue("."),H=U(),R=De("svg"),F=De("path"),A=U();for(let k=0;k<w.length;k+=1)w[k].c();z=U(),ee=B("div"),C=B("div"),this.h()},l(k){e=T(k,"DIV",{class:!0,role:!0});var V=P(e);l=T(V,"DIV",{class:!0}),P(l).forEach(_),t=x(V),o=T(V,"DIV",{class:!0});var v=P(o);r=T(v,"DIV",{class:!0});var E=P(r);s=T(E,"DIV",{class:!0});var $=P(s);f=T($,"DIV",{class:!0});var D=P(f);a=de(D,i),u=de(D," more identical"),h=T(D,"BR",{}),p=T(D,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(p)!=="svelte-m89yhc"&&(p.innerHTML=b),N=de(D,"."),D.forEach(_),H=x($),R=qe($,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var L=P(R);F=qe(L,"path",{d:!0,fill:!0}),P(F).forEach(_),L.forEach(_),$.forEach(_),A=x(E);for(let j=0;j<w.length;j+=1)w[j].l(E);E.forEach(_),z=x(v),ee=T(v,"DIV",{class:!0});var S=P(ee);C=T(S,"DIV",{class:!0}),P(C).forEach(_),S.forEach(_),v.forEach(_),V.forEach(_),this.h()},h(){g(l,"class","title"),g(p,"class","highlight svelte-1jtwro5"),g(f,"class","text svelte-1jtwro5"),oe(f,"active",n[2]),g(F,"d","M1.18221 4.58047C1.23103 4.62928 1.31017 4.62928 1.35899 4.58047L2.15448 3.78497C2.2033 3.73616 2.2033 3.65701 2.15448 3.6082C2.10567 3.55938 2.02652 3.55938 1.97771 3.6082L1.2706 4.3153L0.563493 3.6082C0.514677 3.55938 0.435531 3.55938 0.386716 3.6082C0.3379 3.65701 0.3379 3.73616 0.386716 3.78497L1.18221 4.58047ZM1.1456 0.285461V4.49208H1.3956V0.285461H1.1456Z"),g(F,"fill","currentColor"),g(R,"xmlns","http://www.w3.org/2000/svg"),g(R,"class","h-6 w-6 text-gray-300"),g(R,"viewBox","0 0 3 5"),g(R,"fill","none"),g(s,"class","guide flex flex-col items-start gap-1 svelte-1jtwro5"),g(r,"class","column final relative svelte-1jtwro5"),g(C,"class","prob-dim svelte-1jtwro5"),oe(C,"expanded",n[1].id==="softmax"),g(ee,"class","second-column svelte-1jtwro5"),g(o,"class","content svelte-1jtwro5"),g(e,"class",q=ve(pe("transformer-blocks",n[0],{expanded:n[1].id!==null}))+" svelte-1jtwro5"),g(e,"role","group")},m(k,V){G(k,e,V),I(e,l),I(e,t),I(e,o),I(o,r),I(r,s),I(s,f),I(f,a),I(f,u),I(f,h),I(f,p),I(f,N),I(s,H),I(s,R),I(R,F),I(r,A);for(let v=0;v<w.length;v+=1)w[v]&&w[v].m(r,null);I(o,z),I(o,ee),I(ee,C),M=!0,c||(d=[ye(e,"mouseenter",n[5]),ye(e,"mouseleave",n[6])],c=!0)},p(k,[V]){if((!M||V&8)&&i!==(i=k[3].layer_num-1+"")&&Ve(a,i),(!M||V&4)&&oe(f,"active",k[2]),V&24){m=$e(k[4]);let v;for(v=0;v<m.length;v+=1){const E=Fl(k,m,v);w[v]?(w[v].p(E,V),O(w[v],1)):(w[v]=Ul(E),w[v].c(),O(w[v],1),w[v].m(r,null))}for(Ne(),v=m.length;v<w.length;v+=1)y(v);Le()}(!M||V&2)&&oe(C,"expanded",k[1].id==="softmax"),(!M||V&3&&q!==(q=ve(pe("transformer-blocks",k[0],{expanded:k[1].id!==null}))+" svelte-1jtwro5"))&&g(e,"class",q)},i(k){if(!M){for(let V=0;V<m.length;V+=1)O(w[V]);M=!0}},o(k){w=w.filter(Boolean);for(let V=0;V<w.length;V+=1)W(w[V]);M=!1},d(k){k&&_(e),Be(w,k),c=!1,Ue(d)}}}function Er(n,e,l){let t,o,r,s;Ee(n,We,u=>l(1,t=u)),Ee(n,Ft,u=>l(2,o=u)),Ee(n,Pt,u=>l(3,r=u)),Ee(n,bt,u=>l(4,s=u));let{className:f=void 0}=e;const i=()=>{Ft.set(!0)},a=()=>{Ft.set(!1)};return n.$$set=u=>{"className"in u&&l(0,f=u.className)},[f,t,o,r,s,i,a]}class Ir extends je{constructor(e){super(),Ge(this,e,Er,kr,Oe,{className:0})}}function Dr(n){let e,l,t,o;return{c(){e=B("div"),l=De("svg"),t=De("g"),o=De("g"),this.h()},l(r){e=T(r,"DIV",{class:!0});var s=P(e);l=qe(s,"svg",{class:!0});var f=P(l);t=qe(f,"g",{class:!0}),P(t).forEach(_),o=qe(f,"g",{class:!0}),P(o).forEach(_),f.forEach(_),s.forEach(_),this.h()},h(){g(t,"class","bars"),g(o,"class","bar-labels"),g(l,"class","h-full w-full"),g(e,"class","content-box probability grow svelte-8s3yoj")},m(r,s){G(r,e,s),I(e,l),I(l,t),I(l,o),n[7](l)},p:He,i:He,o:He,d(r){r&&_(e),n[7](null)}}}const xl=4;let qr=1;function Cr(n,e,l){let t,o;Ee(n,xt,H=>l(5,t=H)),Ee(n,Ht,H=>l(6,o=H));const{theme:r}=Dt(qt);let{rowHeight:s}=e,{rowGap:f}=e,{hoveredIndex:i=null}=e,a,u=r.colors.gray[300],h=r.colors.purple[400],{drawBars:p=()=>{const H=o==null?void 0:o.prediction,R=nt(a);let F=dl().domain([0,Lo(H,A=>A.adjustedProbability)]).range([0,(a==null?void 0:a.clientWidth)-Tt*3]);R.select("g.bars").selectAll("rect").data(H).join("rect").attr("x",0).attr("y",(A,z)=>z*s+z*f+s/2-xl/2).attr("height",xl).attr("width",A=>F(A.adjustedProbability)).attr("rx",1).attr("ry",1).attr("fill",(A,z)=>z===i?h:(t==null?void 0:t.rank)===z?Kt:u).on("mouseenter",function(A,z){l(1,i=z.rank),nt(this).style("cursor","pointer")}).on("mouseleave",()=>l(1,i=null)).transition().ease(go).duration(500).attr("width",A=>F(A.adjustedProbability)),R.select("g.bar-labels").selectAll("text").data(H).join("text").attr("fill",(A,z)=>z===i?h:(t==null?void 0:t.rank)===z?Kt:u).on("mouseenter",function(A,z){l(1,i=z.rank),nt(this).style("cursor","pointer")}).on("mouseleave",()=>{l(1,i=null)}).attr("x",A=>.4*Tt+F(A.adjustedProbability)).attr("y",(A,z)=>z*s+z*f).attr("dy",s/2+3).attr("text-anchor","start").style("font-size","0.75rem").transition().duration(500).tween("text",function(A){const z=nt(this),ee=_o(z.text().replace("%",""),A.adjustedProbability*100);return function(C){z.text(ee(C).toFixed(qr)+"%")}})}}=e;_t(()=>{p()});const b=()=>{if(!a)return;const H=nt(a);H.selectAll("g.bars rect").attr("fill",(R,F)=>F===i?h:(t==null?void 0:t.rank)===F?Kt:u),H.selectAll("g.bar-labels text").attr("fill",(R,F)=>F===i?h:(t==null?void 0:t.rank)===F?Kt:u)};function N(H){Je[H?"unshift":"push"](()=>{a=H,l(0,a)})}return n.$$set=H=>{"rowHeight"in H&&l(2,s=H.rowHeight),"rowGap"in H&&l(3,f=H.rowGap),"hoveredIndex"in H&&l(1,i=H.hoveredIndex),"drawBars"in H&&l(4,p=H.drawBars)},n.$$.update=()=>{n.$$.dirty&81&&o&&a&&p(),n.$$.dirty&2&&i!==void 0&&b(),n.$$.dirty&32&&t&&b()},[a,i,s,f,p,t,o,N]}class Sr extends je{constructor(e){super(),Ge(this,e,Cr,Dr,Oe,{rowHeight:2,rowGap:3,hoveredIndex:1,drawBars:4})}}function Wl(n,e,l){const t=n.slice();return t[36]=e[l],t[38]=l,t}function Xl(n,e,l){const t=n.slice();return t[39]=e[l],t[38]=l,t}function Zl(n,e,l){const t=n.slice();return t[41]=e[l],t[38]=l,t}function Ar(n){let e,l=n[9][n[38]]+"",t,o;return{c(){e=ue("Token ID: "),t=ue(l),o=U()},l(r){e=de(r,"Token ID: "),t=de(r,l),o=x(r)},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s[0]&512&&l!==(l=r[9][r[38]]+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Kl(n){let e,l=(n[41].token.trim()===""?" ":n[41].token)+"",t,o,r,s,f,i;function a(){return n[21](n[38])}return r=new et({props:{class:"popover",placement:"left",type:"light",$$slots:{default:[Ar]},$$scope:{ctx:n}}}),{c(){e=B("div"),t=ue(l),o=U(),ie(r.$$.fragment),this.h()},l(u){e=T(u,"DIV",{role:!0,class:!0});var h=P(e);t=de(h,l),h.forEach(_),o=x(u),ae(r.$$.fragment,u),this.h()},h(){var u;g(e,"role","group"),g(e,"class","text-box svelte-xhmodo"),oe(e,"highlight",n[38]===n[5]),oe(e,"sample_highlight",n[10]===n[38]),oe(e,"final_token_highlight",((u=n[11])==null?void 0:u.rank)===n[38])},m(u,h){G(u,e,h),I(e,t),G(u,o,h),ce(r,u,h),s=!0,f||(i=[ye(e,"mouseenter",a),ye(e,"mouseleave",n[22])],f=!0)},p(u,h){var b;n=u,(!s||h[0]&4)&&l!==(l=(n[41].token.trim()===""?" ":n[41].token)+"")&&Ve(t,l),(!s||h[0]&32)&&oe(e,"highlight",n[38]===n[5]),(!s||h[0]&1024)&&oe(e,"sample_highlight",n[10]===n[38]),(!s||h[0]&2048)&&oe(e,"final_token_highlight",((b=n[11])==null?void 0:b.rank)===n[38]);const p={};h[0]&512|h[1]&4096&&(p.$$scope={dirty:h,ctx:n}),r.$set(p)},i(u){s||(O(r.$$.fragment,u),s=!0)},o(u){W(r.$$.fragment,u),s=!1},d(u){u&&(_(e),_(o)),fe(r,u),f=!1,Ue(i)}}}function Yl(n){let e,l='<div class="title-box token-string !justify-end svelte-xhmodo"><div class="title-text svelte-xhmodo">Tokens</div></div> <div class="title-box logits svelte-xhmodo"><div class="title-text svelte-xhmodo">Logits</div></div> <div class="title-box exponents svelte-xhmodo"><div class="title-text svelte-xhmodo">Exponents</div></div> <div class="title-box probability svelte-xhmodo"><div class="title-text svelte-xhmodo">Probability</div></div>';return{c(){e=B("div"),e.innerHTML=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-16l107t"&&(e.innerHTML=l),this.h()},h(){g(e,"class","softmax-subtitle softmax-detail flex text-center text-xs opacity-0 svelte-xhmodo")},m(t,o){G(t,e,o)},d(t){t&&_(e)}}}function Ql(n){let e,l,t,o,r=$e(n[8]),s=[];for(let h=0;h<r.length;h+=1)s[h]=en(Xl(n,r,h));const f=h=>W(s[h],1,1,()=>{s[h]=null});let i=$e(n[7]),a=[];for(let h=0;h<i.length;h+=1)a[h]=tn(Wl(n,i,h));const u=h=>W(a[h],1,1,()=>{a[h]=null});return{c(){e=B("div");for(let h=0;h<s.length;h+=1)s[h].c();l=U(),t=B("div");for(let h=0;h<a.length;h+=1)a[h].c();this.h()},l(h){e=T(h,"DIV",{class:!0});var p=P(e);for(let N=0;N<s.length;N+=1)s[N].l(p);p.forEach(_),l=x(h),t=T(h,"DIV",{class:!0});var b=P(t);for(let N=0;N<a.length;N+=1)a[N].l(b);b.forEach(_),this.h()},h(){g(e,"class","content-box vector-box logits ml-2 svelte-xhmodo"),g(t,"class","content-box vector-box exponents svelte-xhmodo")},m(h,p){G(h,e,p);for(let b=0;b<s.length;b+=1)s[b]&&s[b].m(e,null);G(h,l,p),G(h,t,p);for(let b=0;b<a.length;b+=1)a[b]&&a[b].m(t,null);o=!0},p(h,p){if(p[0]&7456){r=$e(h[8]);let b;for(b=0;b<r.length;b+=1){const N=Xl(h,r,b);s[b]?(s[b].p(N,p),O(s[b],1)):(s[b]=en(N),s[b].c(),O(s[b],1),s[b].m(e,null))}for(Ne(),b=r.length;b<s.length;b+=1)f(b);Le()}if(p[0]&3488){i=$e(h[7]);let b;for(b=0;b<i.length;b+=1){const N=Wl(h,i,b);a[b]?(a[b].p(N,p),O(a[b],1)):(a[b]=tn(N),a[b].c(),O(a[b],1),a[b].m(t,null))}for(Ne(),b=i.length;b<a.length;b+=1)u(b);Le()}},i(h){if(!o){for(let p=0;p<r.length;p+=1)O(s[p]);for(let p=0;p<i.length;p+=1)O(a[p]);o=!0}},o(h){s=s.filter(Boolean);for(let p=0;p<s.length;p+=1)W(s[p]);a=a.filter(Boolean);for(let p=0;p<a.length;p+=1)W(a[p]);o=!1},d(h){h&&(_(e),_(l),_(t)),Be(s,h),Be(a,h)}}}function Jl(n){let e,l=n[39].toFixed(2)+"",t,o,r,s,f,i;function a(){return n[23](n[38])}return r=new et({props:{class:"popover",placement:"left",type:"light",$$slots:{default:[Vr]},$$scope:{ctx:n}}}),{c(){e=B("div"),t=ue(l),o=U(),ie(r.$$.fragment),this.h()},l(u){e=T(u,"DIV",{role:!0,class:!0});var h=P(e);t=de(h,l),h.forEach(_),o=x(u),ae(r.$$.fragment,u),this.h()},h(){var u;g(e,"role","group"),g(e,"class","text-box text-center svelte-xhmodo"),oe(e,"highlight",n[38]===n[5]),oe(e,"sample_highlight",n[10]===n[38]),oe(e,"final_token_highlight",((u=n[11])==null?void 0:u.rank)===n[38])},m(u,h){G(u,e,h),I(e,t),G(u,o,h),ce(r,u,h),s=!0,f||(i=[ye(e,"mouseenter",a),ye(e,"mouseleave",n[24])],f=!0)},p(u,h){var b;n=u,(!s||h[0]&256)&&l!==(l=n[39].toFixed(2)+"")&&Ve(t,l),(!s||h[0]&32)&&oe(e,"highlight",n[38]===n[5]),(!s||h[0]&1024)&&oe(e,"sample_highlight",n[10]===n[38]),(!s||h[0]&2048)&&oe(e,"final_token_highlight",((b=n[11])==null?void 0:b.rank)===n[38]);const p={};h[0]&4352|h[1]&4096&&(p.$$scope={dirty:h,ctx:n}),r.$set(p)},i(u){s||(O(r.$$.fragment,u),s=!0)},o(u){W(r.$$.fragment,u),s=!1},d(u){u&&(_(e),_(o)),fe(r,u),f=!1,Ue(i)}}}function Vr(n){let e=(n[39]*n[12]).toFixed(2)+"",l,t,o,r,s=n[39].toFixed(2)+"",f,i;return{c(){l=ue(e),t=ue(" ÷ "),o=ue(n[12]),r=ue(" = "),f=ue(s),i=U()},l(a){l=de(a,e),t=de(a," ÷ "),o=de(a,n[12]),r=de(a," = "),f=de(a,s),i=x(a)},m(a,u){G(a,l,u),G(a,t,u),G(a,o,u),G(a,r,u),G(a,f,u),G(a,i,u)},p(a,u){u[0]&4352&&e!==(e=(a[39]*a[12]).toFixed(2)+"")&&Ve(l,e),u[0]&4096&&Ve(o,a[12]),u[0]&256&&s!==(s=a[39].toFixed(2)+"")&&Ve(f,s)},d(a){a&&(_(l),_(t),_(o),_(r),_(f),_(i))}}}function en(n){let e,l,t=n[39]!==void 0&&Jl(n);return{c(){t&&t.c(),e=mt()},l(o){t&&t.l(o),e=mt()},m(o,r){t&&t.m(o,r),G(o,e,r),l=!0},p(o,r){o[39]!==void 0?t?(t.p(o,r),r[0]&256&&O(t,1)):(t=Jl(o),t.c(),O(t,1),t.m(e.parentNode,e)):t&&(Ne(),W(t,1,1,()=>{t=null}),Le())},i(o){l||(O(t),l=!0)},o(o){W(t),l=!1},d(o){o&&_(e),t&&t.d(o)}}}function Nr(n){let e,l=n[8][n[38]].toFixed(2)+"",t,o,r=n[36].toFixed(2)+"",s,f;return{c(){e=ue("exp("),t=ue(l),o=ue(") = "),s=ue(r),f=U()},l(i){e=de(i,"exp("),t=de(i,l),o=de(i,") = "),s=de(i,r),f=x(i)},m(i,a){G(i,e,a),G(i,t,a),G(i,o,a),G(i,s,a),G(i,f,a)},p(i,a){a[0]&256&&l!==(l=i[8][i[38]].toFixed(2)+"")&&Ve(t,l),a[0]&128&&r!==(r=i[36].toFixed(2)+"")&&Ve(s,r)},d(i){i&&(_(e),_(t),_(o),_(s),_(f))}}}function tn(n){let e,l=n[36].toExponential(2)+"",t,o,r,s,f,i;function a(){return n[25](n[38])}return r=new et({props:{class:"popover",placement:"left",type:"light",$$slots:{default:[Nr]},$$scope:{ctx:n}}}),{c(){e=B("div"),t=ue(l),o=U(),ie(r.$$.fragment),this.h()},l(u){e=T(u,"DIV",{role:!0,class:!0});var h=P(e);t=de(h,l),h.forEach(_),o=x(u),ae(r.$$.fragment,u),this.h()},h(){var u;g(e,"role","group"),g(e,"class","text-box text-center svelte-xhmodo"),oe(e,"highlight",n[38]===n[5]),oe(e,"sample_highlight",n[10]===n[38]),oe(e,"final_token_highlight",((u=n[11])==null?void 0:u.rank)===n[38])},m(u,h){G(u,e,h),I(e,t),G(u,o,h),ce(r,u,h),s=!0,f||(i=[ye(e,"mouseenter",a),ye(e,"mouseleave",n[26])],f=!0)},p(u,h){var b;n=u,(!s||h[0]&128)&&l!==(l=n[36].toExponential(2)+"")&&Ve(t,l),(!s||h[0]&32)&&oe(e,"highlight",n[38]===n[5]),(!s||h[0]&1024)&&oe(e,"sample_highlight",n[10]===n[38]),(!s||h[0]&2048)&&oe(e,"final_token_highlight",((b=n[11])==null?void 0:b.rank)===n[38]);const p={};h[0]&384|h[1]&4096&&(p.$$scope={dirty:h,ctx:n}),r.$set(p)},i(u){s||(O(r.$$.fragment,u),s=!0)},o(u){W(r.$$.fragment,u),s=!1},d(u){u&&(_(e),_(o)),fe(r,u),f=!1,Ue(i)}}}function Lr(n){let e,l,t="<div>Probabilities</div>",o,r,s,f,i,a,u,h,p,b,N,H,R,F,A,z,ee,C,q,M,c,d=$e(n[2]),m=[];for(let $=0;$<d.length;$+=1)m[$]=Kl(Zl(n,d,$));const w=$=>W(m[$],1,1,()=>{m[$]=null});let y=n[1]&&Yl(),k=n[1]&&Ql(n);function V($){n[27]($)}function v($){n[28]($)}let E={rowGap:n[16],rowHeight:n[15]};return n[5]!==void 0&&(E.hoveredIndex=n[5]),n[4]!==void 0&&(E.drawBars=n[4]),A=new Sr({props:E}),Je.push(()=>$l(A,"hoveredIndex",V)),Je.push(()=>$l(A,"drawBars",v)),{c(){e=B("div"),l=B("div"),l.innerHTML=t,o=U(),r=B("div"),s=B("div"),f=U(),i=B("div"),a=B("div");for(let $=0;$<m.length;$+=1)m[$].c();u=U(),h=B("div"),p=U(),b=B("div"),y&&y.c(),N=U(),H=B("div"),R=B("div"),k&&k.c(),F=U(),ie(A.$$.fragment),this.h()},l($){e=T($,"DIV",{class:!0,role:!0});var D=P(e);l=T(D,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-1d64i2n"&&(l.innerHTML=t),o=x(D),r=T(D,"DIV",{class:!0,style:!0});var L=P(r);s=T(L,"DIV",{class:!0}),P(s).forEach(_),f=x(L),i=T(L,"DIV",{class:!0});var S=P(i);a=T(S,"DIV",{class:!0});var j=P(a);for(let se=0;se<m.length;se+=1)m[se].l(j);j.forEach(_),u=x(S),h=T(S,"DIV",{class:!0}),P(h).forEach(_),S.forEach(_),p=x(L),b=T(L,"DIV",{class:!0});var X=P(b);y&&y.l(X),N=x(X),H=T(X,"DIV",{class:!0});var he=P(H);R=T(he,"DIV",{class:!0});var Q=P(R);k&&k.l(Q),Q.forEach(_),F=x(he),ae(A.$$.fragment,he),he.forEach(_),X.forEach(_),L.forEach(_),D.forEach(_),this.h()},h(){g(l,"class","title expandable svelte-xhmodo"),g(l,"role","none"),g(s,"class","bounding softmax-bounding svelte-xhmodo"),oe(s,"active",n[6]&&!n[1]),g(a,"class","content-box token-string svelte-xhmodo"),g(h,"class","vector vocab opacity-1 w-0"),g(i,"class","first-column relative flex justify-end"),g(R,"class","softmax-detail expandable flex gap-2 opacity-0"),g(H,"class","content-row flex gap-2"),g(b,"class","second-column flex flex-col svelte-xhmodo"),g(r,"class","content resize-watch relative svelte-xhmodo"),g(r,"style",`--softmax-row-height: ${n[15]}px;--softmax-row-gap: ${n[16]}px`),g(e,"class",C=ve(pe("softmax",n[0],{expanded:n[1]}))+" svelte-xhmodo"),g(e,"role","none")},m($,D){G($,e,D),I(e,l),I(e,o),I(e,r),I(r,s),I(r,f),I(r,i),I(i,a);for(let L=0;L<m.length;L+=1)m[L]&&m[L].m(a,null);I(i,u),I(i,h),I(r,p),I(r,b),y&&y.m(b,null),I(b,N),I(b,H),I(H,R),k&&k.m(R,null),I(H,F),ce(A,H,null),n[29](e),q=!0,M||(c=[ye(l,"click",n[14]),ye(l,"keydown",n[14]),ye(l,"mouseenter",n[17]),ye(l,"mouseleave",n[18]),ye(e,"click",n[13]),ye(e,"keydown",n[13])],M=!0)},p($,D){if((!q||D[0]&66)&&oe(s,"active",$[6]&&!$[1]),D[0]&3620){d=$e($[2]);let S;for(S=0;S<d.length;S+=1){const j=Zl($,d,S);m[S]?(m[S].p(j,D),O(m[S],1)):(m[S]=Kl(j),m[S].c(),O(m[S],1),m[S].m(a,null))}for(Ne(),S=d.length;S<m.length;S+=1)w(S);Le()}$[1]?y||(y=Yl(),y.c(),y.m(b,N)):y&&(y.d(1),y=null),$[1]?k?(k.p($,D),D[0]&2&&O(k,1)):(k=Ql($),k.c(),O(k,1),k.m(R,null)):k&&(Ne(),W(k,1,1,()=>{k=null}),Le());const L={};!z&&D[0]&32&&(z=!0,L.hoveredIndex=$[5],bl(()=>z=!1)),!ee&&D[0]&16&&(ee=!0,L.drawBars=$[4],bl(()=>ee=!1)),A.$set(L),(!q||D[0]&3&&C!==(C=ve(pe("softmax",$[0],{expanded:$[1]}))+" svelte-xhmodo"))&&g(e,"class",C)},i($){if(!q){for(let D=0;D<d.length;D+=1)O(m[D]);O(k),O(A.$$.fragment,$),q=!0}},o($){m=m.filter(Boolean);for(let D=0;D<m.length;D+=1)W(m[D]);W(k),W(A.$$.fragment,$),q=!1},d($){$&&_(e),Be(m,$),y&&y.d(),k&&k.d(),fe(A),n[29](null),M=!1,Ue(c)}}}function Mr(n,e,l){let t,o,r,s,f,i,a,u,h;Ee(n,Ht,X=>l(19,f=X)),Ee(n,We,X=>l(20,i=X)),Ee(n,io,X=>l(10,a=X)),Ee(n,xt,X=>l(11,u=X)),Ee(n,ul,X=>l(12,h=X));let{className:p=void 0}=e;Dt(qt),ll("block-id","softmax");const b=tl("block-id");let N=!1;const H=()=>{N||(We.set({id:b}),C())},R=X=>{X.stopPropagation(),X.preventDefault(),N?(We.set({id:null}),q()):(We.set({id:b}),C())};let F;function A(X){N&&!F.contains(X.target)&&We.set({id:null})}_t(()=>(document.body.addEventListener("click",A),()=>{document.body.removeEventListener("click",A)}));let z,ee;const C=async()=>{z=It.Flip.getState(".softmax .softmax-detail.expandable"),l(1,N=!0),await Ut(),ct.set(".steps",{justifyContent:"end"}),ct.set(".softmax-detail",{opacity:0}),It.Flip.from(z,{duration:.5,ease:"power2.inOut",onComplete:()=>{ee==null||ee()}}),ct.to(".softmax-detail",{opacity:1,duration:.2,delay:.5})},q=async()=>{z=It.Flip.getState(".softmax .softmax-detail.expandable"),l(1,N=!1),await Ut(),await It.Flip.from(z,{duration:.5,ease:"power2.inOut",onComplete:()=>{ee==null||ee()}}),ct.to(".softmax-detail",{opacity:0,duration:.2}),ct.set(".steps",{justifyContent:"start"})};let M=Tt*1.2,c=.4*Tt,d=null,m=!1;function w(){l(6,m=!0)}function y(){l(6,m=!1)}const k=X=>l(5,d=X),V=()=>l(5,d=null),v=X=>l(5,d=X),E=()=>l(5,d=null),$=X=>l(5,d=X),D=()=>l(5,d=null);function L(X){d=X,l(5,d)}function S(X){ee=X,l(4,ee)}function j(X){Je[X?"unshift":"push"](()=>{F=X,l(3,F)})}return n.$$set=X=>{"className"in X&&l(0,p=X.className)},n.$$.update=()=>{n.$$.dirty[0]&1048578&&i.id!==b&&N&&(l(1,N=!1),q()),n.$$.dirty[0]&524288&&l(2,t=(f==null?void 0:f.prediction)||[]),n.$$.dirty[0]&4&&l(9,o=t==null?void 0:t.map(X=>X.tokenId)),n.$$.dirty[0]&4&&l(8,r=(t==null?void 0:t.map(X=>X.adjustedLogit))||[]),n.$$.dirty[0]&4&&l(7,s=(t==null?void 0:t.map(X=>X.adjustedExp))||[])},[p,N,t,F,ee,d,m,s,r,o,a,u,h,H,R,M,c,w,y,f,i,k,V,v,E,$,D,L,S,j]}class Br extends je{constructor(e){super(),Ge(this,e,Mr,Lr,Oe,{className:0},null,[-1,-1])}}function Tr(n){let e,l="Drop out is";return{c(){e=B("div"),e.textContent=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-ohkp45"&&(e.textContent=l),this.h()},h(){g(e,"class","dropout-content")},m(t,o){G(t,e,o)},p:He,d(t){t&&_(e)}}}function Pr(n){let e,l;return e=new ol({props:{class:pe("popover dropout-popover text-sm",n[1]),title:"Drop out",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,transition:at,params:{duration:0},$$slots:{default:[Tr]},$$scope:{ctx:n}}}),{c(){ie(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,o){ce(e,t,o),l=!0},p(t,[o]){const r={};o&2&&(r.class=pe("popover dropout-popover text-sm",t[1])),o&1&&(r.offset=t[0]),o&4&&(r.triggeredBy=t[2]),o&8&&(r.trigger=t[3]),o&16&&(r.placement=t[4]),o&32&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){W(e.$$.fragment,t),l=!1},d(t){fe(e,t)}}}function Hr(n,e,l){let{offset:t=void 0}=e,{className:o=void 0}=e,{triggeredBy:r=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,o=i.className),"triggeredBy"in i&&l(2,r=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,o,r,s,f]}class Or extends je{constructor(e){super(),Ge(this,e,Hr,Pr,Oe,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function jr(n){let e,l="Layer normalization is";return{c(){e=B("div"),e.textContent=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-qw3l61"&&(e.textContent=l),this.h()},h(){g(e,"class","ln-content")},m(t,o){G(t,e,o)},p:He,d(t){t&&_(e)}}}function Gr(n){let e,l;return e=new ol({props:{class:pe("popover ln-popover text-sm",n[1]),title:"Layer Normalization",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,transition:at,params:{duration:0},$$slots:{default:[jr]},$$scope:{ctx:n}}}),{c(){ie(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,o){ce(e,t,o),l=!0},p(t,[o]){const r={};o&2&&(r.class=pe("popover ln-popover text-sm",t[1])),o&1&&(r.offset=t[0]),o&4&&(r.triggeredBy=t[2]),o&8&&(r.trigger=t[3]),o&16&&(r.placement=t[4]),o&32&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){W(e.$$.fragment,t),l=!1},d(t){fe(e,t)}}}function Rr(n,e,l){let{offset:t=void 0}=e,{className:o=void 0}=e,{triggeredBy:r=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,o=i.className),"triggeredBy"in i&&l(2,r=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,o,r,s,f]}class zr extends je{constructor(e){super(),Ge(this,e,Rr,Gr,Oe,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function Fr(n){let e,l=`The GELU (Gaussian Error Linear Unit) activation function combines linear and non-linear
		behavior by scaling inputs using the Gaussian cumulative distribution function. It retains small
		negative values for smoother gradients and is effective in models like BERT.`;return{c(){e=B("div"),e.textContent=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1ri460b"&&(e.textContent=l),this.h()},h(){g(e,"class","activation-content svelte-60plg2")},m(t,o){G(t,e,o)},p:He,d(t){t&&_(e)}}}function Ur(n){let e,l;return e=new ol({props:{class:pe("popover activation-popover text-sm",n[1]),title:"GeLu Activation",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,transition:at,params:{duration:0},$$slots:{default:[Fr]},$$scope:{ctx:n}}}),{c(){ie(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,o){ce(e,t,o),l=!0},p(t,[o]){const r={};o&2&&(r.class=pe("popover activation-popover text-sm",t[1])),o&1&&(r.offset=t[0]),o&4&&(r.triggeredBy=t[2]),o&8&&(r.trigger=t[3]),o&16&&(r.placement=t[4]),o&32&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){W(e.$$.fragment,t),l=!1},d(t){fe(e,t)}}}function xr(n,e,l){let{offset:t=void 0}=e,{className:o=void 0}=e,{triggeredBy:r=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e;return n.$$set=i=>{"offset"in i&&l(0,t=i.offset),"className"in i&&l(1,o=i.className),"triggeredBy"in i&&l(2,r=i.triggeredBy),"trigger"in i&&l(3,s=i.trigger),"placement"in i&&l(4,f=i.placement)},[t,o,r,s,f]}class Wr extends je{constructor(e){super(),Ge(this,e,xr,Ur,Oe,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function Xr(n){let e,l="Residual out is";return{c(){e=B("div"),e.textContent=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-124ixs1"&&(e.textContent=l),this.h()},h(){g(e,"class","residual-content")},m(t,o){G(t,e,o)},p:He,d(t){t&&_(e)}}}function Zr(n){let e,l;return e=new ol({props:{class:pe("popover residual-popover text-sm",n[1]),title:"Residual",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],arrow:!1,transition:at,params:{duration:0},reference:n[5],$$slots:{default:[Xr]},$$scope:{ctx:n}}}),{c(){ie(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,o){ce(e,t,o),l=!0},p(t,[o]){const r={};o&2&&(r.class=pe("popover residual-popover text-sm",t[1])),o&1&&(r.offset=t[0]),o&4&&(r.triggeredBy=t[2]),o&8&&(r.trigger=t[3]),o&16&&(r.placement=t[4]),o&32&&(r.reference=t[5]),o&64&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){W(e.$$.fragment,t),l=!1},d(t){fe(e,t)}}}function Kr(n,e,l){let{offset:t=void 0}=e,{className:o=void 0}=e,{triggeredBy:r=void 0}=e,{trigger:s="hover"}=e,{placement:f="right"}=e,{reference:i}=e;return n.$$set=a=>{"offset"in a&&l(0,t=a.offset),"className"in a&&l(1,o=a.className),"triggeredBy"in a&&l(2,r=a.triggeredBy),"trigger"in a&&l(3,s=a.trigger),"placement"in a&&l(4,f=a.placement),"reference"in a&&l(5,i=a.reference)},[t,o,r,s,f,i]}class Yr extends je{constructor(e){super(),Ge(this,e,Kr,Zr,Oe,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4,reference:5})}}function ln(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function nn(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function on(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function rn(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function sn(n,e,l){const t=n.slice();return t[15]=e[l],t[17]=l,t}function Qr(n){let e,l,t,o,r,s,f=$e(n[4]),i=[];for(let u=0;u<f.length;u+=1)i[u]=an(ln(n,f,u));const a=u=>W(i[u],1,1,()=>{i[u]=null});return{c(){e=B("div");for(let u=0;u<i.length;u+=1)i[u].c();this.h()},l(u){e=T(u,"DIV",{id:!0,class:!0,role:!0});var h=P(e);for(let p=0;p<i.length;p+=1)i[p].l(h);h.forEach(_),this.h()},h(){g(e,"id",l=`${n[0]}-end`),g(e,"class",t=ve(pe("operation-col column residual",n[1]))+" svelte-cfq6hx"),g(e,"role","group")},m(u,h){G(u,e,h);for(let p=0;p<i.length;p+=1)i[p]&&i[p].m(e,null);o=!0,r||(s=[ye(e,"mouseenter",n[5]),ye(e,"mouseleave",n[6])],r=!0)},p(u,h){if(h&27){f=$e(u[4]);let p;for(p=0;p<f.length;p+=1){const b=ln(u,f,p);i[p]?(i[p].p(b,h),O(i[p],1)):(i[p]=an(b),i[p].c(),O(i[p],1),i[p].m(e,null))}for(Ne(),p=f.length;p<i.length;p+=1)a(p);Le()}(!o||h&1&&l!==(l=`${u[0]}-end`))&&g(e,"id",l),(!o||h&2&&t!==(t=ve(pe("operation-col column residual",u[1]))+" svelte-cfq6hx"))&&g(e,"class",t)},i(u){if(!o){for(let h=0;h<f.length;h+=1)O(i[h]);o=!0}},o(u){i=i.filter(Boolean);for(let h=0;h<i.length;h+=1)W(i[h]);o=!1},d(u){u&&_(e),Be(i,u),r=!1,Ue(s)}}}function Jr(n){let e,l,t,o,r,s,f,i,a=$e(n[4]),u=[];for(let p=0;p<a.length;p+=1)u[p]=cn(nn(n,a,p));const h=p=>W(u[p],1,1,()=>{u[p]=null});return t=new Yr({props:{reference:`#${n[0]}-start`,triggeredBy:`[id^='${n[0]}-']`,offset:1}}),{c(){e=B("div");for(let p=0;p<u.length;p+=1)u[p].c();l=U(),ie(t.$$.fragment),this.h()},l(p){e=T(p,"DIV",{id:!0,class:!0,role:!0});var b=P(e);for(let N=0;N<u.length;N+=1)u[N].l(b);l=x(b),ae(t.$$.fragment,b),b.forEach(_),this.h()},h(){g(e,"id",o=`${n[0]}-start`),g(e,"class",r=ve(pe("operation-col column residual",n[1]))+" svelte-cfq6hx"),g(e,"role","group")},m(p,b){G(p,e,b);for(let N=0;N<u.length;N+=1)u[N]&&u[N].m(e,null);I(e,l),ce(t,e,null),s=!0,f||(i=[ye(e,"mouseenter",n[5]),ye(e,"mouseleave",n[6])],f=!0)},p(p,b){if(b&27){a=$e(p[4]);let H;for(H=0;H<a.length;H+=1){const R=nn(p,a,H);u[H]?(u[H].p(R,b),O(u[H],1)):(u[H]=cn(R),u[H].c(),O(u[H],1),u[H].m(e,l))}for(Ne(),H=a.length;H<u.length;H+=1)h(H);Le()}const N={};b&1&&(N.reference=`#${p[0]}-start`),b&1&&(N.triggeredBy=`[id^='${p[0]}-']`),t.$set(N),(!s||b&1&&o!==(o=`${p[0]}-start`))&&g(e,"id",o),(!s||b&2&&r!==(r=ve(pe("operation-col column residual",p[1]))+" svelte-cfq6hx"))&&g(e,"class",r)},i(p){if(!s){for(let b=0;b<a.length;b+=1)O(u[b]);O(t.$$.fragment,p),s=!0}},o(p){u=u.filter(Boolean);for(let b=0;b<u.length;b+=1)W(u[b]);W(t.$$.fragment,p),s=!1},d(p){p&&_(e),Be(u,p),fe(t),f=!1,Ue(i)}}}function es(n){let e,l,t,o,r,s,f,i=$e(n[4]),a=[];for(let h=0;h<i.length;h+=1)a[h]=fn(on(n,i,h));const u=h=>W(a[h],1,1,()=>{a[h]=null});return t=new zr({props:{triggeredBy:`#${n[0]}`}}),{c(){e=B("div");for(let h=0;h<a.length;h+=1)a[h].c();l=U(),ie(t.$$.fragment),this.h()},l(h){e=T(h,"DIV",{id:!0,class:!0,role:!0});var p=P(e);for(let b=0;b<a.length;b+=1)a[b].l(p);l=x(p),ae(t.$$.fragment,p),p.forEach(_),this.h()},h(){g(e,"id",n[0]),g(e,"class",o=ve(pe("operation-col column ln",n[1]))+" svelte-cfq6hx"),g(e,"role","group")},m(h,p){G(h,e,p);for(let b=0;b<a.length;b+=1)a[b]&&a[b].m(e,null);I(e,l),ce(t,e,null),r=!0,s||(f=[ye(e,"mouseenter",n[11]),ye(e,"mouseleave",n[12])],s=!0)},p(h,p){if(p&26){i=$e(h[4]);let N;for(N=0;N<i.length;N+=1){const H=on(h,i,N);a[N]?(a[N].p(H,p),O(a[N],1)):(a[N]=fn(H),a[N].c(),O(a[N],1),a[N].m(e,l))}for(Ne(),N=i.length;N<a.length;N+=1)u(N);Le()}const b={};p&1&&(b.triggeredBy=`#${h[0]}`),t.$set(b),(!r||p&1)&&g(e,"id",h[0]),(!r||p&2&&o!==(o=ve(pe("operation-col column ln",h[1]))+" svelte-cfq6hx"))&&g(e,"class",o)},i(h){if(!r){for(let p=0;p<i.length;p+=1)O(a[p]);O(t.$$.fragment,h),r=!0}},o(h){a=a.filter(Boolean);for(let p=0;p<a.length;p+=1)W(a[p]);W(t.$$.fragment,h),r=!1},d(h){h&&_(e),Be(a,h),fe(t),s=!1,Ue(f)}}}function ts(n){let e,l,t,o,r,s,f,i=$e(n[4]),a=[];for(let h=0;h<i.length;h+=1)a[h]=un(rn(n,i,h));const u=h=>W(a[h],1,1,()=>{a[h]=null});return t=new Or({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=B("div");for(let h=0;h<a.length;h+=1)a[h].c();l=U(),ie(t.$$.fragment),this.h()},l(h){e=T(h,"DIV",{id:!0,class:!0,role:!0});var p=P(e);for(let b=0;b<a.length;b+=1)a[b].l(p);l=x(p),ae(t.$$.fragment,p),p.forEach(_),this.h()},h(){g(e,"id",n[0]),g(e,"class",o=ve(pe("operation-col column dropout",n[1]))+" svelte-cfq6hx"),g(e,"role","group")},m(h,p){G(h,e,p);for(let b=0;b<a.length;b+=1)a[b]&&a[b].m(e,null);I(e,l),ce(t,e,null),r=!0,s||(f=[ye(e,"mouseenter",n[9]),ye(e,"mouseleave",n[10])],s=!0)},p(h,p){if(p&26){i=$e(h[4]);let N;for(N=0;N<i.length;N+=1){const H=rn(h,i,N);a[N]?(a[N].p(H,p),O(a[N],1)):(a[N]=un(H),a[N].c(),O(a[N],1),a[N].m(e,l))}for(Ne(),N=i.length;N<a.length;N+=1)u(N);Le()}const b={};p&1&&(b.triggeredBy=`#${h[0]}`),t.$set(b),(!r||p&1)&&g(e,"id",h[0]),(!r||p&2&&o!==(o=ve(pe("operation-col column dropout",h[1]))+" svelte-cfq6hx"))&&g(e,"class",o)},i(h){if(!r){for(let p=0;p<i.length;p+=1)O(a[p]);O(t.$$.fragment,h),r=!0}},o(h){a=a.filter(Boolean);for(let p=0;p<a.length;p+=1)W(a[p]);W(t.$$.fragment,h),r=!1},d(h){h&&_(e),Be(a,h),fe(t),s=!1,Ue(f)}}}function ls(n){let e,l,t,o,r,s,f,i=$e(n[4]),a=[];for(let h=0;h<i.length;h+=1)a[h]=dn(sn(n,i,h));const u=h=>W(a[h],1,1,()=>{a[h]=null});return t=new Wr({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=B("div");for(let h=0;h<a.length;h+=1)a[h].c();l=U(),ie(t.$$.fragment),this.h()},l(h){e=T(h,"DIV",{id:!0,class:!0,role:!0});var p=P(e);for(let b=0;b<a.length;b+=1)a[b].l(p);l=x(p),ae(t.$$.fragment,p),p.forEach(_),this.h()},h(){g(e,"id",n[0]),g(e,"class",o=ve(pe("operation-col column activation",n[1]))+" svelte-cfq6hx"),g(e,"role","group")},m(h,p){G(h,e,p);for(let b=0;b<a.length;b+=1)a[b]&&a[b].m(e,null);I(e,l),ce(t,e,null),r=!0,s||(f=[ye(e,"mouseenter",n[7]),ye(e,"mouseleave",n[8])],s=!0)},p(h,p){if(p&26){i=$e(h[4]);let N;for(N=0;N<i.length;N+=1){const H=sn(h,i,N);a[N]?(a[N].p(H,p),O(a[N],1)):(a[N]=dn(H),a[N].c(),O(a[N],1),a[N].m(e,l))}for(Ne(),N=i.length;N<a.length;N+=1)u(N);Le()}const b={};p&1&&(b.triggeredBy=`#${h[0]}`),t.$set(b),(!r||p&1)&&g(e,"id",h[0]),(!r||p&2&&o!==(o=ve(pe("operation-col column activation",h[1]))+" svelte-cfq6hx"))&&g(e,"class",o)},i(h){if(!r){for(let p=0;p<i.length;p+=1)O(a[p]);O(t.$$.fragment,h),r=!0}},o(h){a=a.filter(Boolean);for(let p=0;p<a.length;p+=1)W(a[p]);W(t.$$.fragment,h),r=!1},d(h){h&&_(e),Be(a,h),fe(t),s=!1,Ue(f)}}}function an(n){let e,l;return e=new Wt({props:{id:n[0],className:pe(n[1],{last:n[17]===n[4].length-1}),type:"residual-end",head:n[17]===0,active:n[3]}}),{c(){ie(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,o){ce(e,t,o),l=!0},p(t,o){const r={};o&1&&(r.id=t[0]),o&18&&(r.className=pe(t[1],{last:t[17]===t[4].length-1})),o&8&&(r.active=t[3]),e.$set(r)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){W(e.$$.fragment,t),l=!1},d(t){fe(e,t)}}}function cn(n){let e,l;return e=new Wt({props:{id:n[0],className:pe(n[1],{last:n[17]===n[4].length-1}),type:"residual-start",head:n[17]===0,active:n[3]}}),{c(){ie(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,o){ce(e,t,o),l=!0},p(t,o){const r={};o&1&&(r.id=t[0]),o&18&&(r.className=pe(t[1],{last:t[17]===t[4].length-1})),o&8&&(r.active=t[3]),e.$set(r)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){W(e.$$.fragment,t),l=!1},d(t){fe(e,t)}}}function fn(n){let e,l;return e=new Wt({props:{className:pe(n[1],{last:n[17]===n[4].length-1}),type:"ln",tail:n[17]===n[4].length-1,active:n[3]}}),{c(){ie(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,o){ce(e,t,o),l=!0},p(t,o){const r={};o&18&&(r.className=pe(t[1],{last:t[17]===t[4].length-1})),o&16&&(r.tail=t[17]===t[4].length-1),o&8&&(r.active=t[3]),e.$set(r)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){W(e.$$.fragment,t),l=!1},d(t){fe(e,t)}}}function un(n){let e,l;return e=new Wt({props:{className:pe(n[1],{last:n[17]===n[4].length-1}),type:"dropout",tail:n[17]===n[4].length-1,active:n[3]}}),{c(){ie(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,o){ce(e,t,o),l=!0},p(t,o){const r={};o&18&&(r.className=pe(t[1],{last:t[17]===t[4].length-1})),o&16&&(r.tail=t[17]===t[4].length-1),o&8&&(r.active=t[3]),e.$set(r)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){W(e.$$.fragment,t),l=!1},d(t){fe(e,t)}}}function dn(n){let e,l;return e=new Wt({props:{className:pe(n[1],{last:n[17]===n[4].length-1}),type:"activation",tail:n[17]===n[4].length-1,active:n[3]}}),{c(){ie(e.$$.fragment)},l(t){ae(e.$$.fragment,t)},m(t,o){ce(e,t,o),l=!0},p(t,o){const r={};o&18&&(r.className=pe(t[1],{last:t[17]===t[4].length-1})),o&16&&(r.tail=t[17]===t[4].length-1),o&8&&(r.active=t[3]),e.$set(r)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){W(e.$$.fragment,t),l=!1},d(t){fe(e,t)}}}function ns(n){let e,l,t,o;const r=[ls,ts,es,Jr,Qr],s=[];function f(i,a){return i[2]==="activation"?0:i[2]==="dropout"?1:i[2]==="ln"?2:i[2]==="residual-start"?3:i[2]==="residual-end"?4:-1}return~(e=f(n))&&(l=s[e]=r[e](n)),{c(){l&&l.c(),t=mt()},l(i){l&&l.l(i),t=mt()},m(i,a){~e&&s[e].m(i,a),G(i,t,a),o=!0},p(i,[a]){let u=e;e=f(i),e===u?~e&&s[e].p(i,a):(l&&(Ne(),W(s[u],1,1,()=>{s[u]=null}),Le()),~e?(l=s[e],l?l.p(i,a):(l=s[e]=r[e](i),l.c()),O(l,1),l.m(t.parentNode,t)):l=null)},i(i){o||(O(l),o=!0)},o(i){W(l),o=!1},d(i){i&&_(t),~e&&s[e].d(i)}}}function os(n,e,l){let t;Ee(n,bt,A=>l(4,t=A));let{id:o}=e,{className:r=void 0}=e,{type:s=void 0}=e,f=!1;const i=()=>{l(3,f=!0);const A=document.querySelector(`#${o}-start`),z=document.querySelector(`#${o}-end`),ee=nt(`.residual-connector.${o}`);ee.style("opacity",1),h(ee),A==null||A.classList.add("active"),z==null||z.classList.add("active")};let a;const u=()=>{l(3,f=!1);const A=document.querySelector(`#${o}-start`),z=document.querySelector(`#${o}-end`),ee=nt(`.residual-connector.${o}`);ee.style("opacity",0),a&&(a.kill(),ee.style("stroke-dashoffset",0)),A==null||A.classList.remove("active"),z==null||z.classList.remove("active")},h=A=>{a=ct.to(A.node(),{strokeDashoffset:-50,duration:1,repeat:-1,ease:"none"})},p=()=>{l(3,f=!0)},b=()=>{l(3,f=!1)},N=()=>{l(3,f=!0)},H=()=>{l(3,f=!1)},R=()=>{l(3,f=!0)},F=()=>{l(3,f=!1)};return n.$$set=A=>{"id"in A&&l(0,o=A.id),"className"in A&&l(1,r=A.className),"type"in A&&l(2,s=A.type)},[o,r,s,f,t,i,u,p,b,N,H,R,F]}class pt extends je{constructor(e){super(),Ge(this,e,os,ns,Oe,{id:0,className:1,type:2})}}function hn(n,e,l){const t=n.slice();return t[19]=e[l],t[21]=l,t}function pn(n,e,l){const t=n.slice();return t[19]=e[l],t[21]=l,t}function vn(n,e,l){const t=n.slice();return t[19]=e[l],t[21]=l,t}function mn(n,e,l){const t=n.slice();return t[19]=e[l],t[21]=l,t}function gn(n,e,l){const t=n.slice();return t[19]=e[l],t[21]=l,t}function _n(n,e,l){const t=n.slice();return t[19]=e[l],t[21]=l,t}function bn(n){let e,l="Token";return{c(){e=B("div"),e.textContent=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-6k2z6t"&&(e.textContent=l),this.h()},h(){g(e,"class","subtitle embedding-detail svelte-1iayxn1")},m(t,o){G(t,e,o)},d(t){t&&_(e)}}}function $n(n){let e,l,t=n[19]+"",o;return{c(){e=B("div"),l=B("span"),o=ue(t),this.h()},l(r){e=T(r,"DIV",{class:!0});var s=P(e);l=T(s,"SPAN",{class:!0});var f=P(l);o=de(f,t),f.forEach(_),s.forEach(_),this.h()},h(){g(l,"class","label svelte-1iayxn1"),g(e,"class","cell svelte-1iayxn1"),oe(e,"last",n[21]===n[4].length-1)},m(r,s){G(r,e,s),I(e,l),I(l,o)},p(r,s){s&16&&t!==(t=r[19]+"")&&Ve(o,t),s&16&&oe(e,"last",r[21]===r[4].length-1)},d(r){r&&_(e)}}}function wn(n){let e,l,t,o,r,s="Token<br/>Embedding",f,i,a,u,h,p,b,N,H="Positional<br/>Encoding",R,F,A,z,ee;e=new et({props:{triggeredBy:".embedding .vector",placement:"right",class:"popover",$$slots:{default:[rs]},$$scope:{ctx:n}}}),f=new yl({props:{id:"token-embedding",$$slots:{default:[ss]},$$scope:{ctx:n}}});let C=$e(n[4]),q=[];for(let v=0;v<C.length;v+=1)q[v]=yn(gn(n,C,v));const M=v=>W(q[v],1,1,()=>{q[v]=null});let c=$e(n[4]),d=[];for(let v=0;v<c.length;v+=1)d[v]=kn(mn(n,c,v));R=new yl({props:{id:"position-embedding",$$slots:{default:[as]},$$scope:{ctx:n}}});let m=$e(n[4]),w=[];for(let v=0;v<m.length;v+=1)w[v]=En(vn(n,m,v));const y=v=>W(w[v],1,1,()=>{w[v]=null});let k=$e(n[4]),V=[];for(let v=0;v<k.length;v+=1)V[v]=In(pn(n,k,v));return{c(){ie(e.$$.fragment),l=U(),t=B("div"),o=B("div"),r=B("span"),r.innerHTML=s,ie(f.$$.fragment),i=U();for(let v=0;v<q.length;v+=1)q[v].c();a=U(),u=B("div");for(let v=0;v<d.length;v+=1)d[v].c();h=U(),p=B("div"),b=B("div"),N=B("span"),N.innerHTML=H,ie(R.$$.fragment),F=U();for(let v=0;v<w.length;v+=1)w[v].c();A=U(),z=B("div");for(let v=0;v<V.length;v+=1)V[v].c();this.h()},l(v){ae(e.$$.fragment,v),l=x(v),t=T(v,"DIV",{class:!0});var E=P(t);o=T(E,"DIV",{class:!0});var $=P(o);r=T($,"SPAN",{"data-svelte-h":!0}),Ce(r)!=="svelte-1vtrff3"&&(r.innerHTML=s),ae(f.$$.fragment,$),$.forEach(_),i=x(E);for(let X=0;X<q.length;X+=1)q[X].l(E);E.forEach(_),a=x(v),u=T(v,"DIV",{class:!0});var D=P(u);for(let X=0;X<d.length;X+=1)d[X].l(D);D.forEach(_),h=x(v),p=T(v,"DIV",{class:!0});var L=P(p);b=T(L,"DIV",{class:!0});var S=P(b);N=T(S,"SPAN",{"data-svelte-h":!0}),Ce(N)!=="svelte-12blhrw"&&(N.innerHTML=H),ae(R.$$.fragment,S),S.forEach(_),F=x(L);for(let X=0;X<w.length;X+=1)w[X].l(L);L.forEach(_),A=x(v),z=T(v,"DIV",{class:!0});var j=P(z);for(let X=0;X<V.length;X+=1)V[X].l(j);j.forEach(_),this.h()},h(){g(o,"class","subtitle flex items-center gap-1 svelte-1iayxn1"),g(t,"class","column token-embedding embedding-detail svelte-1iayxn1"),g(u,"class","column symbol embedding-detail svelte-1iayxn1"),g(b,"class","subtitle flex gap-1 svelte-1iayxn1"),g(p,"class","column embedding-detail position-embedding svelte-1iayxn1"),g(z,"class","column symbol embedding-detail svelte-1iayxn1")},m(v,E){ce(e,v,E),G(v,l,E),G(v,t,E),I(t,o),I(o,r),ce(f,o,null),I(t,i);for(let $=0;$<q.length;$+=1)q[$]&&q[$].m(t,null);G(v,a,E),G(v,u,E);for(let $=0;$<d.length;$+=1)d[$]&&d[$].m(u,null);G(v,h,E),G(v,p,E),I(p,b),I(b,N),ce(R,b,null),I(p,F);for(let $=0;$<w.length;$+=1)w[$]&&w[$].m(p,null);G(v,A,E),G(v,z,E);for(let $=0;$<V.length;$+=1)V[$]&&V[$].m(z,null);ee=!0},p(v,E){const $={};E&134217760&&($.$$scope={dirty:E,ctx:v}),e.$set($);const D={};if(E&134217728&&(D.$$scope={dirty:E,ctx:v}),f.$set(D),E&16){C=$e(v[4]);let S;for(S=0;S<C.length;S+=1){const j=gn(v,C,S);q[S]?(q[S].p(j,E),O(q[S],1)):(q[S]=yn(j),q[S].c(),O(q[S],1),q[S].m(t,null))}for(Ne(),S=C.length;S<q.length;S+=1)M(S);Le()}if(E&16){c=$e(v[4]);let S;for(S=0;S<c.length;S+=1){const j=mn(v,c,S);d[S]?d[S].p(j,E):(d[S]=kn(),d[S].c(),d[S].m(u,null))}for(;S<d.length;S+=1)d[S].d(1);d.length=c.length}const L={};if(E&134217728&&(L.$$scope={dirty:E,ctx:v}),R.$set(L),E&80){m=$e(v[4]);let S;for(S=0;S<m.length;S+=1){const j=vn(v,m,S);w[S]?(w[S].p(j,E),O(w[S],1)):(w[S]=En(j),w[S].c(),O(w[S],1),w[S].m(p,null))}for(Ne(),S=m.length;S<w.length;S+=1)y(S);Le()}if(E&16){k=$e(v[4]);let S;for(S=0;S<k.length;S+=1){const j=pn(v,k,S);V[S]?V[S].p(j,E):(V[S]=In(),V[S].c(),V[S].m(z,null))}for(;S<V.length;S+=1)V[S].d(1);V.length=k.length}},i(v){if(!ee){O(e.$$.fragment,v),O(f.$$.fragment,v);for(let E=0;E<C.length;E+=1)O(q[E]);O(R.$$.fragment,v);for(let E=0;E<m.length;E+=1)O(w[E]);ee=!0}},o(v){W(e.$$.fragment,v),W(f.$$.fragment,v),q=q.filter(Boolean);for(let E=0;E<q.length;E+=1)W(q[E]);W(R.$$.fragment,v),w=w.filter(Boolean);for(let E=0;E<w.length;E+=1)W(w[E]);ee=!1},d(v){v&&(_(l),_(t),_(a),_(u),_(h),_(p),_(A),_(z)),fe(e,v),fe(f),Be(q,v),Be(d,v),fe(R),Be(w,v),Be(V,v)}}}function rs(n){let e,l=n[5].dimension+"",t,o;return{c(){e=ue("vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function ss(n){let e;return{c(){e=ue("Token Embedding is")},l(l){e=de(l,"Token Embedding is")},m(l,t){G(l,e,t)},d(l){l&&_(e)}}}function is(n){let e,l="id",t;return{c(){e=B("span"),e.textContent=l,t=B("br"),this.h()},l(o){e=T(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1e13gni"&&(e.textContent=l),t=T(o,"BR",{}),this.h()},h(){g(e,"class","label svelte-1iayxn1")},m(o,r){G(o,e,r),G(o,t,r)},d(o){o&&(_(e),_(t))}}}function yn(n){let e,l,t='<div class="flex flex-col items-center"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 31 9" fill="none" class="w-10 text-gray-300"><path fill="currentColor" d="M30.3886 4.74352C30.5839 4.54826 30.5839 4.23168 30.3886 4.03642L27.2067 0.854435C27.0114 0.659173 26.6948 0.659173 26.4996 0.854435C26.3043 1.0497 26.3043 1.36628 26.4996 1.56154L29.328 4.38997L26.4996 7.2184C26.3043 7.41366 26.3043 7.73024 26.4996 7.9255C26.6948 8.12076 27.0114 8.12076 27.2067 7.9255L30.3886 4.74352ZM0.31958 4.88997H30.0351V3.88997H0.31958V4.88997Z"></path></svg></div>',o,r,s,f,i,a,u,h,p=(Math.random()*1e4).toFixed()+"",b,N,H;f=new vt({props:{active:!0}});let R=n[21]===0&&is();return{c(){e=B("div"),l=B("div"),l.innerHTML=t,o=U(),r=B("div"),s=B("div"),ie(f.$$.fragment),i=U(),a=B("span"),R&&R.c(),u=U(),h=B("span"),b=ue(p),N=U(),this.h()},l(F){e=T(F,"DIV",{class:!0});var A=P(e);l=T(A,"DIV",{class:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-lh48yp"&&(l.innerHTML=t),o=x(A),r=T(A,"DIV",{class:!0});var z=P(r);s=T(z,"DIV",{class:!0});var ee=P(s);ae(f.$$.fragment,ee),ee.forEach(_),i=x(z),a=T(z,"SPAN",{class:!0});var C=P(a);R&&R.l(C),u=x(C),h=T(C,"SPAN",{class:!0});var q=P(h);b=de(q,p),q.forEach(_),C.forEach(_),z.forEach(_),N=x(A),A.forEach(_),this.h()},h(){g(l,"class","vocab-index ellipsis flex items-center text-right text-xs text-gray-400 svelte-1iayxn1"),g(s,"class",ve(`vector ${vl}`)+" svelte-1iayxn1"),g(h,"class","val svelte-1iayxn1"),g(a,"class","index-val text-xs svelte-1iayxn1"),g(r,"class","cell flex items-center svelte-1iayxn1"),g(e,"class","token-id flex items-center")},m(F,A){G(F,e,A),I(e,l),I(e,o),I(e,r),I(r,s),ce(f,s,null),I(r,i),I(r,a),R&&R.m(a,null),I(a,u),I(a,h),I(h,b),I(e,N),H=!0},p:He,i(F){H||(O(f.$$.fragment,F),H=!0)},o(F){W(f.$$.fragment,F),H=!1},d(F){F&&_(e),fe(f),R&&R.d()}}}function kn(n){let e,l="+";return{c(){e=B("div"),e.textContent=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-124y0va"&&(e.textContent=l),this.h()},h(){g(e,"class","cell svelte-1iayxn1")},m(t,o){G(t,e,o)},p:He,d(t){t&&_(e)}}}function as(n){let e;return{c(){e=ue("Positional Embedding is")},l(l){e=de(l,"Positional Embedding is")},m(l,t){G(l,e,t)},d(l){l&&_(e)}}}function cs(n){let e,l="position",t;return{c(){e=B("span"),e.textContent=l,t=B("br"),this.h()},l(o){e=T(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-4n0g90"&&(e.textContent=l),t=T(o,"BR",{}),this.h()},h(){g(e,"class","label svelte-1iayxn1")},m(o,r){G(o,e,r),G(o,t,r)},d(o){o&&(_(e),_(t))}}}function En(n){let e,l,t,o,r,s,f,i,a,u;t=new vt({props:{active:!0,colorScale:n[12]}});let h=n[21]===0&&cs();return{c(){e=B("div"),l=B("div"),ie(t.$$.fragment),o=U(),r=B("span"),h&&h.c(),s=U(),f=B("span"),i=ue(n[21]),a=U(),this.h()},l(p){e=T(p,"DIV",{class:!0});var b=P(e);l=T(b,"DIV",{class:!0});var N=P(l);ae(t.$$.fragment,N),N.forEach(_),o=x(b),r=T(b,"SPAN",{class:!0});var H=P(r);h&&h.l(H),s=x(H),f=T(H,"SPAN",{class:!0});var R=P(f);i=de(R,n[21]),R.forEach(_),H.forEach(_),a=x(b),b.forEach(_),this.h()},h(){g(l,"class",ve(`vector ${vl}`)+" svelte-1iayxn1"),g(f,"class","val svelte-1iayxn1"),g(r,"class","index-val text-xs svelte-1iayxn1"),g(e,"class","cell flex items-center svelte-1iayxn1")},m(p,b){G(p,e,b),I(e,l),ce(t,l,null),I(e,o),I(e,r),h&&h.m(r,null),I(r,s),I(r,f),I(f,i),I(e,a),u=!0},p:He,i(p){u||(O(t.$$.fragment,p),u=!0)},o(p){W(t.$$.fragment,p),u=!1},d(p){p&&_(e),fe(t),h&&h.d()}}}function In(n){let e,l="=";return{c(){e=B("div"),e.textContent=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1btrmmo"&&(e.textContent=l),this.h()},h(){g(e,"class","cell svelte-1iayxn1")},m(t,o){G(t,e,o)},p:He,d(t){t&&_(e)}}}function fs(n){let e,l=n[5].dimension+"",t,o;return{c(){e=ue("vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Dn(n){let e,l,t,o,r;return l=new vt({props:{active:n[3]||n[1]}}),o=new et({props:{placement:"right",class:"popover",$$slots:{default:[fs]},$$scope:{ctx:n}}}),{c(){e=B("div"),ie(l.$$.fragment),t=U(),ie(o.$$.fragment),this.h()},l(s){e=T(s,"DIV",{class:!0});var f=P(e);ae(l.$$.fragment,f),f.forEach(_),t=x(s),ae(o.$$.fragment,s),this.h()},h(){g(e,"class",ve(`vector ${vl}`)+" svelte-1iayxn1"),oe(e,"last",n[21]===n[4].length-1)},m(s,f){G(s,e,f),ce(l,e,null),G(s,t,f),ce(o,s,f),r=!0},p(s,f){const i={};f&10&&(i.active=s[3]||s[1]),l.$set(i),(!r||f&16)&&oe(e,"last",s[21]===s[4].length-1);const a={};f&134217760&&(a.$$scope={dirty:f,ctx:s}),o.$set(a)},i(s){r||(O(l.$$.fragment,s),O(o.$$.fragment,s),r=!0)},o(s){W(l.$$.fragment,s),W(o.$$.fragment,s),r=!1},d(s){s&&(_(e),_(t)),fe(l),fe(o,s)}}}function us(n){let e,l,t="<div>Embedding</div>",o,r,s,f,i,a,u,h,p,b,N,H,R,F,A,z,ee,C,q,M,c,d,m=n[1]&&bn(),w=$e(n[4]),y=[];for(let $=0;$<w.length;$+=1)y[$]=$n(_n(n,w,$));let k=n[1]&&wn(n),V=$e(n[4]),v=[];for(let $=0;$<V.length;$+=1)v[$]=Dn(hn(n,V,$));const E=$=>W(v[$],1,1,()=>{v[$]=null});return F=new pt({props:{type:"dropout",id:"embedding-dropout"}}),z=new pt({props:{type:"residual-start",id:"residual-first"}}),C=new pt({props:{type:"ln",id:"embedding-ln"}}),{c(){e=B("div"),l=B("div"),l.innerHTML=t,o=U(),r=B("div"),s=B("div"),f=B("div"),m&&m.c(),i=U();for(let $=0;$<y.length;$+=1)y[$].c();a=U(),u=B("div"),h=U(),k&&k.c(),p=U(),b=B("div"),N=B("div");for(let $=0;$<v.length;$+=1)v[$].c();H=U(),R=B("div"),ie(F.$$.fragment),A=U(),ie(z.$$.fragment),ee=U(),ie(C.$$.fragment),this.h()},l($){e=T($,"DIV",{class:!0,role:!0});var D=P(e);l=T(D,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-szi5cj"&&(l.innerHTML=t),o=x(D),r=T(D,"DIV",{class:!0});var L=P(r);s=T(L,"DIV",{class:!0});var S=P(s);f=T(S,"DIV",{class:!0});var j=P(f);m&&m.l(j),i=x(j);for(let se=0;se<y.length;se+=1)y[se].l(j);a=x(j),u=T(j,"DIV",{class:!0}),P(u).forEach(_),j.forEach(_),h=x(S),k&&k.l(S),S.forEach(_),p=x(L),b=T(L,"DIV",{class:!0});var X=P(b);N=T(X,"DIV",{class:!0});var he=P(N);for(let se=0;se<v.length;se+=1)v[se].l(he);he.forEach(_),H=x(X),R=T(X,"DIV",{class:!0});var Q=P(R);ae(F.$$.fragment,Q),A=x(Q),ae(z.$$.fragment,Q),ee=x(Q),ae(C.$$.fragment,Q),Q.forEach(_),X.forEach(_),L.forEach(_),D.forEach(_),this.h()},h(){g(l,"class","title expandable svelte-1iayxn1"),g(l,"role","none"),g(u,"class","bounding embedding-bounding svelte-1iayxn1"),oe(u,"active",n[3]&&!n[1]),g(f,"class","column token-string relative svelte-1iayxn1"),g(s,"class","token-column resizable resize-watch flex"),g(N,"class","column vectors svelte-1iayxn1"),g(R,"class","operations flex svelte-1iayxn1"),g(b,"class","vector-column relative flex"),g(r,"class","content relative svelte-1iayxn1"),g(e,"class",q=ve(pe("embedding",n[0],{expanded:n[1]}))+" svelte-1iayxn1"),g(e,"role","none")},m($,D){G($,e,D),I(e,l),I(e,o),I(e,r),I(r,s),I(s,f),m&&m.m(f,null),I(f,i);for(let L=0;L<y.length;L+=1)y[L]&&y[L].m(f,null);I(f,a),I(f,u),I(s,h),k&&k.m(s,null),I(r,p),I(r,b),I(b,N);for(let L=0;L<v.length;L+=1)v[L]&&v[L].m(N,null);I(b,H),I(b,R),ce(F,R,null),I(R,A),ce(z,R,null),I(R,ee),ce(C,R,null),n[13](e),M=!0,c||(d=[ye(l,"click",n[8]),ye(l,"keydown",n[8]),ye(l,"mouseenter",n[9]),ye(l,"mouseleave",n[10]),ye(e,"click",n[7]),ye(e,"keydown",n[7])],c=!0)},p($,[D]){if($[1]?m||(m=bn(),m.c(),m.m(f,i)):m&&(m.d(1),m=null),D&16){w=$e($[4]);let L;for(L=0;L<w.length;L+=1){const S=_n($,w,L);y[L]?y[L].p(S,D):(y[L]=$n(S),y[L].c(),y[L].m(f,a))}for(;L<y.length;L+=1)y[L].d(1);y.length=w.length}if((!M||D&10)&&oe(u,"active",$[3]&&!$[1]),$[1]?k?(k.p($,D),D&2&&O(k,1)):(k=wn($),k.c(),O(k,1),k.m(s,null)):k&&(Ne(),W(k,1,1,()=>{k=null}),Le()),D&58){V=$e($[4]);let L;for(L=0;L<V.length;L+=1){const S=hn($,V,L);v[L]?(v[L].p(S,D),O(v[L],1)):(v[L]=Dn(S),v[L].c(),O(v[L],1),v[L].m(N,null))}for(Ne(),L=V.length;L<v.length;L+=1)E(L);Le()}(!M||D&3&&q!==(q=ve(pe("embedding",$[0],{expanded:$[1]}))+" svelte-1iayxn1"))&&g(e,"class",q)},i($){if(!M){O(k);for(let D=0;D<V.length;D+=1)O(v[D]);O(F.$$.fragment,$),O(z.$$.fragment,$),O(C.$$.fragment,$),M=!0}},o($){W(k),v=v.filter(Boolean);for(let D=0;D<v.length;D+=1)W(v[D]);W(F.$$.fragment,$),W(z.$$.fragment,$),W(C.$$.fragment,$),M=!1},d($){$&&_(e),m&&m.d(),Be(y,$),k&&k.d(),Be(v,$),fe(F),fe(z),fe(C),n[13](null),c=!1,Ue(d)}}}const vl="bg-gray-300";function ds(n,e,l){let t,o,r;Ee(n,We,q=>l(11,t=q)),Ee(n,bt,q=>l(4,o=q)),Ee(n,Pt,q=>l(5,r=q));const{theme:s}=Dt(qt);let{className:f=void 0}=e;ll("block-id","embedding");const i=tl("block-id");let a=!1;const u=()=>{a||(We.set({id:i}),H())},h=q=>{q.stopPropagation(),q.preventDefault(),a?(We.set({id:null}),R()):(We.set({id:i}),H())};let p;function b(q){a&&!p.contains(q.target)&&We.set({id:null})}_t(()=>(document.body.addEventListener("click",b),()=>{document.body.removeEventListener("click",b)}));let N;const H=async()=>{N=It.Flip.getState(".embedding .token-column"),l(1,a=!0),await Ut(),It.Flip.from(N,{duration:.5,ease:"power2.inOut"}),ct.to(".embedding-detail",{opacity:1,duration:.5,delay:.5})},R=async()=>{N=It.Flip.getState(".embedding .token-column"),l(1,a=!1),await Ut(),It.Flip.from(N,{duration:.5,ease:"power2.inOut"})};let F=!1;function A(){l(3,F=!0)}function z(){l(3,F=!1)}const ee=(q,M)=>Zn().domain([0,.5,1]).range([s.colors.red[400],"white",s.colors.blue[400]])(q);function C(q){Je[q?"unshift":"push"](()=>{p=q,l(2,p)})}return n.$$set=q=>{"className"in q&&l(0,f=q.className)},n.$$.update=()=>{n.$$.dirty&2050&&t.id!==i&&a&&(l(1,a=!1),R())},[f,a,p,F,o,r,s,u,h,A,z,t,ee,C]}class hs extends je{constructor(e){super(),Ge(this,e,ds,us,Oe,{className:0})}}function qn(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function Cn(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function Sn(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function An(n,e,l){const t=n.slice();return t[10]=e[l],t[12]=l,t}function ps(n){let e,l=n[5].dimension+"",t,o;return{c(){e=ue("vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Vn(n){let e,l,t=n[10]+"",o,r,s,f,i,a,u,h,p,b,N,H,R;f=new vt({props:{colorScale:"purple",active:n[2]===n[12]}});function F(){return n[8](n[12])}return b=new et({props:{placement:"right",class:"popover",$$slots:{default:[ps]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("span"),o=ue(t),r=U(),s=B("div"),ie(f.$$.fragment),i=U(),a=B("div"),u=U(),h=B("div"),p=U(),ie(b.$$.fragment),this.h()},l(A){e=T(A,"DIV",{class:!0,role:!0});var z=P(e);l=T(z,"SPAN",{class:!0});var ee=P(l);o=de(ee,t),ee.forEach(_),r=x(z),s=T(z,"DIV",{class:!0});var C=P(s);ae(f.$$.fragment,C),i=x(C),a=T(C,"DIV",{class:!0}),P(a).forEach(_),u=x(C),h=T(C,"DIV",{class:!0}),P(h).forEach(_),C.forEach(_),z.forEach(_),p=x(A),ae(b.$$.fragment,A),this.h()},h(){g(l,"class","label float svelte-13p50c2"),g(a,"class","sub-vector x1-12 head1"),g(h,"class","sub-vector head-rest grow"),g(s,"class",ve(`vector flex flex-col  ${_s}`)+" svelte-13p50c2"),g(e,"class","cell"),g(e,"role","group"),oe(e,"last",n[12]===n[4].length-1)},m(A,z){G(A,e,z),I(e,l),I(l,o),I(e,r),I(e,s),ce(f,s,null),I(s,i),I(s,a),I(s,u),I(s,h),G(A,p,z),ce(b,A,z),N=!0,H||(R=[ye(e,"mouseenter",F),ye(e,"mouseleave",n[9])],H=!0)},p(A,z){n=A,(!N||z&16)&&t!==(t=n[10]+"")&&Ve(o,t);const ee={};z&4&&(ee.active=n[2]===n[12]),f.$set(ee),(!N||z&16)&&oe(e,"last",n[12]===n[4].length-1);const C={};z&65568&&(C.$$scope={dirty:z,ctx:n}),b.$set(C)},i(A){N||(O(f.$$.fragment,A),O(b.$$.fragment,A),N=!0)},o(A){W(f.$$.fragment,A),W(b.$$.fragment,A),N=!1},d(A){A&&(_(e),_(p)),fe(f),fe(b,A),H=!1,Ue(R)}}}function vs(n){let e,l=n[5].dimension*4+"",t,o;return{c(){e=ue("vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension*4+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Nn(n){let e,l,t,o,r,s,f;return t=new vt({props:{colorScale:"indigo"}}),s=new et({props:{placement:"right",class:"popover",$$slots:{default:[vs]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("div"),ie(t.$$.fragment),r=U(),ie(s.$$.fragment),this.h()},l(i){e=T(i,"DIV",{class:!0});var a=P(e);l=T(a,"DIV",{class:!0});var u=P(l);ae(t.$$.fragment,u),u.forEach(_),a.forEach(_),r=x(i),ae(s.$$.fragment,i),this.h()},h(){g(l,"class",ve(pe(`vector x4 ${bs} opacity-80`))+" svelte-13p50c2"),g(e,"class",o=ve(pe("cell x4",{small:n[12]!==0&&n[12]!==n[4].length-1}))+" svelte-13p50c2"),oe(e,"last",n[12]===n[4].length-1)},m(i,a){G(i,e,a),I(e,l),ce(t,l,null),G(i,r,a),ce(s,i,a),f=!0},p(i,a){(!f||a&16&&o!==(o=ve(pe("cell x4",{small:i[12]!==0&&i[12]!==i[4].length-1}))+" svelte-13p50c2"))&&g(e,"class",o),(!f||a&16)&&oe(e,"last",i[12]===i[4].length-1);const u={};a&65568&&(u.$$scope={dirty:a,ctx:i}),s.$set(u)},i(i){f||(O(t.$$.fragment,i),O(s.$$.fragment,i),f=!0)},o(i){W(t.$$.fragment,i),W(s.$$.fragment,i),f=!1},d(i){i&&(_(e),_(r)),fe(t),fe(s,i)}}}function Ln(n){let e,l,t=n[10]+"",o,r;return{c(){e=B("div"),l=B("span"),o=ue(t),r=U(),this.h()},l(s){e=T(s,"DIV",{class:!0});var f=P(e);l=T(f,"SPAN",{class:!0});var i=P(l);o=de(i,t),i.forEach(_),r=x(f),f.forEach(_),this.h()},h(){g(l,"class","label float svelte-13p50c2"),g(e,"class","cell"),oe(e,"last",n[12]===n[4].length-1)},m(s,f){G(s,e,f),I(e,l),I(l,o),I(e,r)},p(s,f){f&16&&t!==(t=s[10]+"")&&Ve(o,t),f&16&&oe(e,"last",s[12]===s[4].length-1)},d(s){s&&_(e)}}}function ms(n){let e,l=n[5].dimension+"",t,o;return{c(){e=ue("vector("),t=ue(l),o=ue(")")},l(r){e=de(r,"vector("),t=de(r,l),o=de(r,")")},m(r,s){G(r,e,s),G(r,t,s),G(r,o,s)},p(r,s){s&32&&l!==(l=r[5].dimension+"")&&Ve(t,l)},d(r){r&&(_(e),_(t),_(o))}}}function Mn(n){let e,l,t,o,r,s;return t=new vt({props:{colorScale:"blue"}}),r=new et({props:{placement:"right",class:"popover",$$slots:{default:[ms]},$$scope:{ctx:n}}}),{c(){e=B("div"),l=B("div"),ie(t.$$.fragment),o=U(),ie(r.$$.fragment),this.h()},l(f){e=T(f,"DIV",{class:!0});var i=P(e);l=T(i,"DIV",{class:!0});var a=P(l);ae(t.$$.fragment,a),a.forEach(_),i.forEach(_),o=x(f),ae(r.$$.fragment,f),this.h()},h(){g(l,"class",ve(`vector ${$s}`)+" svelte-13p50c2"),g(e,"class","cell"),oe(e,"last",n[12]===n[4].length-1)},m(f,i){G(f,e,i),I(e,l),ce(t,l,null),G(f,o,i),ce(r,f,i),s=!0},p(f,i){(!s||i&16)&&oe(e,"last",f[12]===f[4].length-1);const a={};i&65568&&(a.$$scope={dirty:i,ctx:f}),r.$set(a)},i(f){s||(O(t.$$.fragment,f),O(r.$$.fragment,f),s=!0)},o(f){W(t.$$.fragment,f),W(r.$$.fragment,f),s=!1},d(f){f&&(_(e),_(o)),fe(t),fe(r,f)}}}function gs(n){let e,l,t="MLP",o,r,s,f,i,a,u,h,p,b,N,H,R,F,A,z,ee,C,q,M,c,d,m,w,y,k,V,v,E,$,D,L,S,j,X,he=$e(n[4]),Q=[];for(let K=0;K<he.length;K+=1)Q[K]=Vn(An(n,he,K));const se=K=>W(Q[K],1,1,()=>{Q[K]=null});b=new pt({props:{type:"dropout",id:"mlp-first-dropout"}}),H=new pt({props:{type:"residual-end",id:"residual-first"}}),F=new pt({props:{type:"ln",id:"mlp-first-ln"}}),z=new pt({props:{type:"residual-start",id:"residual-second"}});let _e=$e(n[4]),le=[];for(let K=0;K<_e.length;K+=1)le[K]=Nn(Sn(n,_e,K));const Re=K=>W(le[K],1,1,()=>{le[K]=null});d=new pt({props:{type:"activation",id:"mlp-activation",className:"x4"}});let J=$e(n[4]),te=[];for(let K=0;K<J.length;K+=1)te[K]=Ln(Cn(n,J,K));V=new pt({props:{type:"residual-end",id:"residual-second"}}),E=new pt({props:{type:"ln",id:"mlp-second-ln"}});let Z=$e(n[4]),me=[];for(let K=0;K<Z.length;K+=1)me[K]=Mn(qn(n,Z,K));const Me=K=>W(me[K],1,1,()=>{me[K]=null});return{c(){e=B("div"),l=B("div"),l.textContent=t,o=U(),r=B("div"),s=B("div"),f=U(),i=B("div"),a=U(),u=B("div"),h=B("div");for(let K=0;K<Q.length;K+=1)Q[K].c();p=U(),ie(b.$$.fragment),N=U(),ie(H.$$.fragment),R=U(),ie(F.$$.fragment),A=U(),ie(z.$$.fragment),ee=U(),C=B("div"),q=B("div"),M=B("div");for(let K=0;K<le.length;K+=1)le[K].c();c=U(),ie(d.$$.fragment),m=U(),w=B("div"),y=B("div");for(let K=0;K<te.length;K+=1)te[K].c();k=U(),ie(V.$$.fragment),v=U(),ie(E.$$.fragment),$=U(),D=B("div");for(let K=0;K<me.length;K+=1)me[K].c();this.h()},l(K){e=T(K,"DIV",{class:!0});var ne=P(e);l=T(ne,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),Ce(l)!=="svelte-50ab67"&&(l.textContent=t),o=x(ne),r=T(ne,"DIV",{class:!0});var Y=P(r);s=T(Y,"DIV",{class:!0}),P(s).forEach(_),f=x(Y),i=T(Y,"DIV",{class:!0}),P(i).forEach(_),a=x(Y),u=T(Y,"DIV",{class:!0});var ke=P(u);h=T(ke,"DIV",{class:!0});var tt=P(h);for(let Ae=0;Ae<Q.length;Ae+=1)Q[Ae].l(tt);tt.forEach(_),p=x(ke),ae(b.$$.fragment,ke),N=x(ke),ae(H.$$.fragment,ke),R=x(ke),ae(F.$$.fragment,ke),A=x(ke),ae(z.$$.fragment,ke),ke.forEach(_),ee=x(Y),C=T(Y,"DIV",{class:!0});var Se=P(C);q=T(Se,"DIV",{class:!0});var ft=P(q);M=T(ft,"DIV",{class:!0});var ut=P(M);for(let Ae=0;Ae<le.length;Ae+=1)le[Ae].l(ut);ut.forEach(_),c=x(ft),ae(d.$$.fragment,ft),ft.forEach(_),m=x(Se),w=T(Se,"DIV",{class:!0});var Ze=P(w);y=T(Ze,"DIV",{class:!0});var dt=P(y);for(let Ae=0;Ae<te.length;Ae+=1)te[Ae].l(dt);dt.forEach(_),k=x(Ze),ae(V.$$.fragment,Ze),v=x(Ze),ae(E.$$.fragment,Ze),$=x(Ze),D=T(Ze,"DIV",{class:!0});var ht=P(D);for(let Ae=0;Ae<me.length;Ae+=1)me[Ae].l(ht);ht.forEach(_),Ze.forEach(_),Se.forEach(_),Y.forEach(_),ne.forEach(_),this.h()},h(){g(l,"class","title"),g(l,"role","group"),g(s,"class","bounding transformer-bounding svelte-13p50c2"),oe(s,"active",n[3]),g(i,"class","bounding mlp-bounding svelte-13p50c2"),oe(i,"active",n[1]),g(h,"class","column initial"),g(u,"class","layer first-layer flex svelte-13p50c2"),g(M,"class","column"),g(q,"class","projections flex"),g(y,"class","column out-label"),g(D,"class","column out"),g(w,"class","ouputs flex"),g(C,"class","layer second-layer flex justify-between svelte-13p50c2"),g(r,"class","content relative svelte-13p50c2"),g(e,"class",L=ve(pe("mlp",n[0]))+" svelte-13p50c2")},m(K,ne){G(K,e,ne),I(e,l),I(e,o),I(e,r),I(r,s),I(r,f),I(r,i),I(r,a),I(r,u),I(u,h);for(let Y=0;Y<Q.length;Y+=1)Q[Y]&&Q[Y].m(h,null);I(u,p),ce(b,u,null),I(u,N),ce(H,u,null),I(u,R),ce(F,u,null),I(u,A),ce(z,u,null),I(r,ee),I(r,C),I(C,q),I(q,M);for(let Y=0;Y<le.length;Y+=1)le[Y]&&le[Y].m(M,null);I(q,c),ce(d,q,null),I(C,m),I(C,w),I(w,y);for(let Y=0;Y<te.length;Y+=1)te[Y]&&te[Y].m(y,null);I(w,k),ce(V,w,null),I(w,v),ce(E,w,null),I(w,$),I(w,D);for(let Y=0;Y<me.length;Y+=1)me[Y]&&me[Y].m(D,null);S=!0,j||(X=[ye(l,"mouseenter",n[6]),ye(l,"mouseleave",n[7])],j=!0)},p(K,[ne]){if((!S||ne&8)&&oe(s,"active",K[3]),(!S||ne&2)&&oe(i,"active",K[1]),ne&52){he=$e(K[4]);let Y;for(Y=0;Y<he.length;Y+=1){const ke=An(K,he,Y);Q[Y]?(Q[Y].p(ke,ne),O(Q[Y],1)):(Q[Y]=Vn(ke),Q[Y].c(),O(Q[Y],1),Q[Y].m(h,null))}for(Ne(),Y=he.length;Y<Q.length;Y+=1)se(Y);Le()}if(ne&48){_e=$e(K[4]);let Y;for(Y=0;Y<_e.length;Y+=1){const ke=Sn(K,_e,Y);le[Y]?(le[Y].p(ke,ne),O(le[Y],1)):(le[Y]=Nn(ke),le[Y].c(),O(le[Y],1),le[Y].m(M,null))}for(Ne(),Y=_e.length;Y<le.length;Y+=1)Re(Y);Le()}if(ne&16){J=$e(K[4]);let Y;for(Y=0;Y<J.length;Y+=1){const ke=Cn(K,J,Y);te[Y]?te[Y].p(ke,ne):(te[Y]=Ln(ke),te[Y].c(),te[Y].m(y,null))}for(;Y<te.length;Y+=1)te[Y].d(1);te.length=J.length}if(ne&48){Z=$e(K[4]);let Y;for(Y=0;Y<Z.length;Y+=1){const ke=qn(K,Z,Y);me[Y]?(me[Y].p(ke,ne),O(me[Y],1)):(me[Y]=Mn(ke),me[Y].c(),O(me[Y],1),me[Y].m(D,null))}for(Ne(),Y=Z.length;Y<me.length;Y+=1)Me(Y);Le()}(!S||ne&1&&L!==(L=ve(pe("mlp",K[0]))+" svelte-13p50c2"))&&g(e,"class",L)},i(K){if(!S){for(let ne=0;ne<he.length;ne+=1)O(Q[ne]);O(b.$$.fragment,K),O(H.$$.fragment,K),O(F.$$.fragment,K),O(z.$$.fragment,K);for(let ne=0;ne<_e.length;ne+=1)O(le[ne]);O(d.$$.fragment,K),O(V.$$.fragment,K),O(E.$$.fragment,K);for(let ne=0;ne<Z.length;ne+=1)O(me[ne]);S=!0}},o(K){Q=Q.filter(Boolean);for(let ne=0;ne<Q.length;ne+=1)W(Q[ne]);W(b.$$.fragment,K),W(H.$$.fragment,K),W(F.$$.fragment,K),W(z.$$.fragment,K),le=le.filter(Boolean);for(let ne=0;ne<le.length;ne+=1)W(le[ne]);W(d.$$.fragment,K),W(V.$$.fragment,K),W(E.$$.fragment,K),me=me.filter(Boolean);for(let ne=0;ne<me.length;ne+=1)W(me[ne]);S=!1},d(K){K&&_(e),Be(Q,K),fe(b),fe(H),fe(F),fe(z),Be(le,K),fe(d),Be(te,K),fe(V),fe(E),Be(me,K),j=!1,Ue(X)}}}const _s="bg-purple-200",bs="bg-indigo-200",$s="bg-blue-200";function ws(n,e,l){let t,o,r;Ee(n,Ft,b=>l(3,t=b)),Ee(n,bt,b=>l(4,o=b)),Ee(n,Pt,b=>l(5,r=b));let{className:s=void 0}=e;ll("block-id","mlp");let f=!1;function i(){l(1,f=!0)}function a(){l(1,f=!1)}let u=null;const h=b=>{l(2,u=b)},p=()=>{l(2,u=null)};return n.$$set=b=>{"className"in b&&l(0,s=b.className)},[s,f,u,t,o,r,i,a,h,p]}class ys extends je{constructor(e){super(),Ge(this,e,ws,gs,Oe,{className:0})}}var ks=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,sl=Math.ceil,rt=Math.floor,Qe="[BigNumber Error] ",Bn=Qe+"Number primitive has more than 15 significant digits: ",it=1e14,we=14,il=9007199254740991,al=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],yt=1e7,ze=1e9;function lo(n){var e,l,t,o=A.prototype={constructor:A,toString:null,valueOf:null},r=new A(1),s=20,f=4,i=-7,a=21,u=-1e7,h=1e7,p=!1,b=1,N=0,H={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},R="0123456789abcdefghijklmnopqrstuvwxyz",F=!0;function A(c,d){var m,w,y,k,V,v,E,$,D=this;if(!(D instanceof A))return new A(c,d);if(d==null){if(c&&c._isBigNumber===!0){D.s=c.s,!c.c||c.e>h?D.c=D.e=null:c.e<u?D.c=[D.e=0]:(D.e=c.e,D.c=c.c.slice());return}if((v=typeof c=="number")&&c*0==0){if(D.s=1/c<0?(c=-c,-1):1,c===~~c){for(k=0,V=c;V>=10;V/=10,k++);k>h?D.c=D.e=null:(D.e=k,D.c=[c]);return}$=String(c)}else{if(!ks.test($=String(c)))return t(D,$,v);D.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}(k=$.indexOf("."))>-1&&($=$.replace(".","")),(V=$.search(/e/i))>0?(k<0&&(k=V),k+=+$.slice(V+1),$=$.substring(0,V)):k<0&&(k=$.length)}else{if(Te(d,2,R.length,"Base"),d==10&&F)return D=new A(c),q(D,s+D.e+1,f);if($=String(c),v=typeof c=="number"){if(c*0!=0)return t(D,$,v,d);if(D.s=1/c<0?($=$.slice(1),-1):1,A.DEBUG&&$.replace(/^0\.0*|\./,"").length>15)throw Error(Bn+c)}else D.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(m=R.slice(0,d),k=V=0,E=$.length;V<E;V++)if(m.indexOf(w=$.charAt(V))<0){if(w=="."){if(V>k){k=E;continue}}else if(!y&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){y=!0,V=-1,k=0;continue}return t(D,String(c),v,d)}v=!1,$=l($,d,10,D.s),(k=$.indexOf("."))>-1?$=$.replace(".",""):k=$.length}for(V=0;$.charCodeAt(V)===48;V++);for(E=$.length;$.charCodeAt(--E)===48;);if($=$.slice(V,++E)){if(E-=V,v&&A.DEBUG&&E>15&&(c>il||c!==rt(c)))throw Error(Bn+D.s*c);if((k=k-V-1)>h)D.c=D.e=null;else if(k<u)D.c=[D.e=0];else{if(D.e=k,D.c=[],V=(k+1)%we,k<0&&(V+=we),V<E){for(V&&D.c.push(+$.slice(0,V)),E-=we;V<E;)D.c.push(+$.slice(V,V+=we));V=we-($=$.slice(V)).length}else V-=E;for(;V--;$+="0");D.c.push(+$)}}else D.c=[D.e=0]}A.clone=lo,A.ROUND_UP=0,A.ROUND_DOWN=1,A.ROUND_CEIL=2,A.ROUND_FLOOR=3,A.ROUND_HALF_UP=4,A.ROUND_HALF_DOWN=5,A.ROUND_HALF_EVEN=6,A.ROUND_HALF_CEIL=7,A.ROUND_HALF_FLOOR=8,A.EUCLID=9,A.config=A.set=function(c){var d,m;if(c!=null)if(typeof c=="object"){if(c.hasOwnProperty(d="DECIMAL_PLACES")&&(m=c[d],Te(m,0,ze,d),s=m),c.hasOwnProperty(d="ROUNDING_MODE")&&(m=c[d],Te(m,0,8,d),f=m),c.hasOwnProperty(d="EXPONENTIAL_AT")&&(m=c[d],m&&m.pop?(Te(m[0],-ze,0,d),Te(m[1],0,ze,d),i=m[0],a=m[1]):(Te(m,-ze,ze,d),i=-(a=m<0?-m:m))),c.hasOwnProperty(d="RANGE"))if(m=c[d],m&&m.pop)Te(m[0],-ze,-1,d),Te(m[1],1,ze,d),u=m[0],h=m[1];else if(Te(m,-ze,ze,d),m)u=-(h=m<0?-m:m);else throw Error(Qe+d+" cannot be zero: "+m);if(c.hasOwnProperty(d="CRYPTO"))if(m=c[d],m===!!m)if(m)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))p=m;else throw p=!m,Error(Qe+"crypto unavailable");else p=m;else throw Error(Qe+d+" not true or false: "+m);if(c.hasOwnProperty(d="MODULO_MODE")&&(m=c[d],Te(m,0,9,d),b=m),c.hasOwnProperty(d="POW_PRECISION")&&(m=c[d],Te(m,0,ze,d),N=m),c.hasOwnProperty(d="FORMAT"))if(m=c[d],typeof m=="object")H=m;else throw Error(Qe+d+" not an object: "+m);if(c.hasOwnProperty(d="ALPHABET"))if(m=c[d],typeof m=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(m))F=m.slice(0,10)=="0123456789",R=m;else throw Error(Qe+d+" invalid: "+m)}else throw Error(Qe+"Object expected: "+c);return{DECIMAL_PLACES:s,ROUNDING_MODE:f,EXPONENTIAL_AT:[i,a],RANGE:[u,h],CRYPTO:p,MODULO_MODE:b,POW_PRECISION:N,FORMAT:H,ALPHABET:R}},A.isBigNumber=function(c){if(!c||c._isBigNumber!==!0)return!1;if(!A.DEBUG)return!0;var d,m,w=c.c,y=c.e,k=c.s;e:if({}.toString.call(w)=="[object Array]"){if((k===1||k===-1)&&y>=-ze&&y<=ze&&y===rt(y)){if(w[0]===0){if(y===0&&w.length===1)return!0;break e}if(d=(y+1)%we,d<1&&(d+=we),String(w[0]).length==d){for(d=0;d<w.length;d++)if(m=w[d],m<0||m>=it||m!==rt(m))break e;if(m!==0)return!0}}}else if(w===null&&y===null&&(k===null||k===1||k===-1))return!0;throw Error(Qe+"Invalid BigNumber: "+c)},A.maximum=A.max=function(){return ee(arguments,-1)},A.minimum=A.min=function(){return ee(arguments,1)},A.random=function(){var c=9007199254740992,d=Math.random()*c&2097151?function(){return rt(Math.random()*c)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(m){var w,y,k,V,v,E=0,$=[],D=new A(r);if(m==null?m=s:Te(m,0,ze),V=sl(m/we),p)if(crypto.getRandomValues){for(w=crypto.getRandomValues(new Uint32Array(V*=2));E<V;)v=w[E]*131072+(w[E+1]>>>11),v>=9e15?(y=crypto.getRandomValues(new Uint32Array(2)),w[E]=y[0],w[E+1]=y[1]):($.push(v%1e14),E+=2);E=V/2}else if(crypto.randomBytes){for(w=crypto.randomBytes(V*=7);E<V;)v=(w[E]&31)*281474976710656+w[E+1]*1099511627776+w[E+2]*4294967296+w[E+3]*16777216+(w[E+4]<<16)+(w[E+5]<<8)+w[E+6],v>=9e15?crypto.randomBytes(7).copy(w,E):($.push(v%1e14),E+=7);E=V/7}else throw p=!1,Error(Qe+"crypto unavailable");if(!p)for(;E<V;)v=d(),v<9e15&&($[E++]=v%1e14);for(V=$[--E],m%=we,V&&m&&(v=al[we-m],$[E]=rt(V/v)*v);$[E]===0;$.pop(),E--);if(E<0)$=[k=0];else{for(k=-1;$[0]===0;$.splice(0,1),k-=we);for(E=1,v=$[0];v>=10;v/=10,E++);E<we&&(k-=we-E)}return D.e=k,D.c=$,D}}(),A.sum=function(){for(var c=1,d=arguments,m=new A(d[0]);c<d.length;)m=m.plus(d[c++]);return m},l=function(){var c="0123456789";function d(m,w,y,k){for(var V,v=[0],E,$=0,D=m.length;$<D;){for(E=v.length;E--;v[E]*=w);for(v[0]+=k.indexOf(m.charAt($++)),V=0;V<v.length;V++)v[V]>y-1&&(v[V+1]==null&&(v[V+1]=0),v[V+1]+=v[V]/y|0,v[V]%=y)}return v.reverse()}return function(m,w,y,k,V){var v,E,$,D,L,S,j,X,he=m.indexOf("."),Q=s,se=f;for(he>=0&&(D=N,N=0,m=m.replace(".",""),X=new A(w),S=X.pow(m.length-he),N=D,X.c=d(gt(ot(S.c),S.e,"0"),10,y,c),X.e=X.c.length),j=d(m,w,y,V?(v=R,c):(v=c,R)),$=D=j.length;j[--D]==0;j.pop());if(!j[0])return v.charAt(0);if(he<0?--$:(S.c=j,S.e=$,S.s=k,S=e(S,X,Q,se,y),j=S.c,L=S.r,$=S.e),E=$+Q+1,he=j[E],D=y/2,L=L||E<0||j[E+1]!=null,L=se<4?(he!=null||L)&&(se==0||se==(S.s<0?3:2)):he>D||he==D&&(se==4||L||se==6&&j[E-1]&1||se==(S.s<0?8:7)),E<1||!j[0])m=L?gt(v.charAt(1),-Q,v.charAt(0)):v.charAt(0);else{if(j.length=E,L)for(--y;++j[--E]>y;)j[E]=0,E||(++$,j=[1].concat(j));for(D=j.length;!j[--D];);for(he=0,m="";he<=D;m+=v.charAt(j[he++]));m=gt(m,$,v.charAt(0))}return m}}(),e=function(){function c(w,y,k){var V,v,E,$,D=0,L=w.length,S=y%yt,j=y/yt|0;for(w=w.slice();L--;)E=w[L]%yt,$=w[L]/yt|0,V=j*E+$*S,v=S*E+V%yt*yt+D,D=(v/k|0)+(V/yt|0)+j*$,w[L]=v%k;return D&&(w=[D].concat(w)),w}function d(w,y,k,V){var v,E;if(k!=V)E=k>V?1:-1;else for(v=E=0;v<k;v++)if(w[v]!=y[v]){E=w[v]>y[v]?1:-1;break}return E}function m(w,y,k,V){for(var v=0;k--;)w[k]-=v,v=w[k]<y[k]?1:0,w[k]=v*V+w[k]-y[k];for(;!w[0]&&w.length>1;w.splice(0,1));}return function(w,y,k,V,v){var E,$,D,L,S,j,X,he,Q,se,_e,le,Re,J,te,Z,me,Me=w.s==y.s?1:-1,K=w.c,ne=y.c;if(!K||!K[0]||!ne||!ne[0])return new A(!w.s||!y.s||(K?ne&&K[0]==ne[0]:!ne)?NaN:K&&K[0]==0||!ne?Me*0:Me/0);for(he=new A(Me),Q=he.c=[],$=w.e-y.e,Me=k+$+1,v||(v=it,$=st(w.e/we)-st(y.e/we),Me=Me/we|0),D=0;ne[D]==(K[D]||0);D++);if(ne[D]>(K[D]||0)&&$--,Me<0)Q.push(1),L=!0;else{for(J=K.length,Z=ne.length,D=0,Me+=2,S=rt(v/(ne[0]+1)),S>1&&(ne=c(ne,S,v),K=c(K,S,v),Z=ne.length,J=K.length),Re=Z,se=K.slice(0,Z),_e=se.length;_e<Z;se[_e++]=0);me=ne.slice(),me=[0].concat(me),te=ne[0],ne[1]>=v/2&&te++;do{if(S=0,E=d(ne,se,Z,_e),E<0){if(le=se[0],Z!=_e&&(le=le*v+(se[1]||0)),S=rt(le/te),S>1)for(S>=v&&(S=v-1),j=c(ne,S,v),X=j.length,_e=se.length;d(j,se,X,_e)==1;)S--,m(j,Z<X?me:ne,X,v),X=j.length,E=1;else S==0&&(E=S=1),j=ne.slice(),X=j.length;if(X<_e&&(j=[0].concat(j)),m(se,j,_e,v),_e=se.length,E==-1)for(;d(ne,se,Z,_e)<1;)S++,m(se,Z<_e?me:ne,_e,v),_e=se.length}else E===0&&(S++,se=[0]);Q[D++]=S,se[0]?se[_e++]=K[Re]||0:(se=[K[Re]],_e=1)}while((Re++<J||se[0]!=null)&&Me--);L=se[0]!=null,Q[0]||Q.splice(0,1)}if(v==it){for(D=1,Me=Q[0];Me>=10;Me/=10,D++);q(he,k+(he.e=D+$*we-1)+1,V,L)}else he.e=$,he.r=+L;return he}}();function z(c,d,m,w){var y,k,V,v,E;if(m==null?m=f:Te(m,0,8),!c.c)return c.toString();if(y=c.c[0],V=c.e,d==null)E=ot(c.c),E=w==1||w==2&&(V<=i||V>=a)?Jt(E,V):gt(E,V,"0");else if(c=q(new A(c),d,m),k=c.e,E=ot(c.c),v=E.length,w==1||w==2&&(d<=k||k<=i)){for(;v<d;E+="0",v++);E=Jt(E,k)}else if(d-=V,E=gt(E,k,"0"),k+1>v){if(--d>0)for(E+=".";d--;E+="0");}else if(d+=k-v,d>0)for(k+1==v&&(E+=".");d--;E+="0");return c.s<0&&y?"-"+E:E}function ee(c,d){for(var m,w,y=1,k=new A(c[0]);y<c.length;y++)w=new A(c[y]),(!w.s||(m=St(k,w))===d||m===0&&k.s===d)&&(k=w);return k}function C(c,d,m){for(var w=1,y=d.length;!d[--y];d.pop());for(y=d[0];y>=10;y/=10,w++);return(m=w+m*we-1)>h?c.c=c.e=null:m<u?c.c=[c.e=0]:(c.e=m,c.c=d),c}t=function(){var c=/^(-?)0([xbo])(?=\w[\w.]*$)/i,d=/^([^.]+)\.$/,m=/^\.([^.]+)$/,w=/^-?(Infinity|NaN)$/,y=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,V,v,E){var $,D=v?V:V.replace(y,"");if(w.test(D))k.s=isNaN(D)?null:D<0?-1:1;else{if(!v&&(D=D.replace(c,function(L,S,j){return $=(j=j.toLowerCase())=="x"?16:j=="b"?2:8,!E||E==$?S:L}),E&&($=E,D=D.replace(d,"$1").replace(m,"0.$1")),V!=D))return new A(D,$);if(A.DEBUG)throw Error(Qe+"Not a"+(E?" base "+E:"")+" number: "+V);k.s=null}k.c=k.e=null}}();function q(c,d,m,w){var y,k,V,v,E,$,D,L=c.c,S=al;if(L){e:{for(y=1,v=L[0];v>=10;v/=10,y++);if(k=d-y,k<0)k+=we,V=d,E=L[$=0],D=rt(E/S[y-V-1]%10);else if($=sl((k+1)/we),$>=L.length)if(w){for(;L.length<=$;L.push(0));E=D=0,y=1,k%=we,V=k-we+1}else break e;else{for(E=v=L[$],y=1;v>=10;v/=10,y++);k%=we,V=k-we+y,D=V<0?0:rt(E/S[y-V-1]%10)}if(w=w||d<0||L[$+1]!=null||(V<0?E:E%S[y-V-1]),w=m<4?(D||w)&&(m==0||m==(c.s<0?3:2)):D>5||D==5&&(m==4||w||m==6&&(k>0?V>0?E/S[y-V]:0:L[$-1])%10&1||m==(c.s<0?8:7)),d<1||!L[0])return L.length=0,w?(d-=c.e+1,L[0]=S[(we-d%we)%we],c.e=-d||0):L[0]=c.e=0,c;if(k==0?(L.length=$,v=1,$--):(L.length=$+1,v=S[we-k],L[$]=V>0?rt(E/S[y-V]%S[V])*v:0),w)for(;;)if($==0){for(k=1,V=L[0];V>=10;V/=10,k++);for(V=L[0]+=v,v=1;V>=10;V/=10,v++);k!=v&&(c.e++,L[0]==it&&(L[0]=1));break}else{if(L[$]+=v,L[$]!=it)break;L[$--]=0,v=1}for(k=L.length;L[--k]===0;L.pop());}c.e>h?c.c=c.e=null:c.e<u&&(c.c=[c.e=0])}return c}function M(c){var d,m=c.e;return m===null?c.toString():(d=ot(c.c),d=m<=i||m>=a?Jt(d,m):gt(d,m,"0"),c.s<0?"-"+d:d)}return o.absoluteValue=o.abs=function(){var c=new A(this);return c.s<0&&(c.s=1),c},o.comparedTo=function(c,d){return St(this,new A(c,d))},o.decimalPlaces=o.dp=function(c,d){var m,w,y,k=this;if(c!=null)return Te(c,0,ze),d==null?d=f:Te(d,0,8),q(new A(k),c+k.e+1,d);if(!(m=k.c))return null;if(w=((y=m.length-1)-st(this.e/we))*we,y=m[y])for(;y%10==0;y/=10,w--);return w<0&&(w=0),w},o.dividedBy=o.div=function(c,d){return e(this,new A(c,d),s,f)},o.dividedToIntegerBy=o.idiv=function(c,d){return e(this,new A(c,d),0,1)},o.exponentiatedBy=o.pow=function(c,d){var m,w,y,k,V,v,E,$,D,L=this;if(c=new A(c),c.c&&!c.isInteger())throw Error(Qe+"Exponent not an integer: "+M(c));if(d!=null&&(d=new A(d)),v=c.e>14,!L.c||!L.c[0]||L.c[0]==1&&!L.e&&L.c.length==1||!c.c||!c.c[0])return D=new A(Math.pow(+M(L),v?c.s*(2-Qt(c)):+M(c))),d?D.mod(d):D;if(E=c.s<0,d){if(d.c?!d.c[0]:!d.s)return new A(NaN);w=!E&&L.isInteger()&&d.isInteger(),w&&(L=L.mod(d))}else{if(c.e>9&&(L.e>0||L.e<-1||(L.e==0?L.c[0]>1||v&&L.c[1]>=24e7:L.c[0]<8e13||v&&L.c[0]<=9999975e7)))return k=L.s<0&&Qt(c)?-0:0,L.e>-1&&(k=1/k),new A(E?1/k:k);N&&(k=sl(N/we+2))}for(v?(m=new A(.5),E&&(c.s=1),$=Qt(c)):(y=Math.abs(+M(c)),$=y%2),D=new A(r);;){if($){if(D=D.times(L),!D.c)break;k?D.c.length>k&&(D.c.length=k):w&&(D=D.mod(d))}if(y){if(y=rt(y/2),y===0)break;$=y%2}else if(c=c.times(m),q(c,c.e+1,1),c.e>14)$=Qt(c);else{if(y=+M(c),y===0)break;$=y%2}L=L.times(L),k?L.c&&L.c.length>k&&(L.c.length=k):w&&(L=L.mod(d))}return w?D:(E&&(D=r.div(D)),d?D.mod(d):k?q(D,N,f,V):D)},o.integerValue=function(c){var d=new A(this);return c==null?c=f:Te(c,0,8),q(d,d.e+1,c)},o.isEqualTo=o.eq=function(c,d){return St(this,new A(c,d))===0},o.isFinite=function(){return!!this.c},o.isGreaterThan=o.gt=function(c,d){return St(this,new A(c,d))>0},o.isGreaterThanOrEqualTo=o.gte=function(c,d){return(d=St(this,new A(c,d)))===1||d===0},o.isInteger=function(){return!!this.c&&st(this.e/we)>this.c.length-2},o.isLessThan=o.lt=function(c,d){return St(this,new A(c,d))<0},o.isLessThanOrEqualTo=o.lte=function(c,d){return(d=St(this,new A(c,d)))===-1||d===0},o.isNaN=function(){return!this.s},o.isNegative=function(){return this.s<0},o.isPositive=function(){return this.s>0},o.isZero=function(){return!!this.c&&this.c[0]==0},o.minus=function(c,d){var m,w,y,k,V=this,v=V.s;if(c=new A(c,d),d=c.s,!v||!d)return new A(NaN);if(v!=d)return c.s=-d,V.plus(c);var E=V.e/we,$=c.e/we,D=V.c,L=c.c;if(!E||!$){if(!D||!L)return D?(c.s=-d,c):new A(L?V:NaN);if(!D[0]||!L[0])return L[0]?(c.s=-d,c):new A(D[0]?V:f==3?-0:0)}if(E=st(E),$=st($),D=D.slice(),v=E-$){for((k=v<0)?(v=-v,y=D):($=E,y=L),y.reverse(),d=v;d--;y.push(0));y.reverse()}else for(w=(k=(v=D.length)<(d=L.length))?v:d,v=d=0;d<w;d++)if(D[d]!=L[d]){k=D[d]<L[d];break}if(k&&(y=D,D=L,L=y,c.s=-c.s),d=(w=L.length)-(m=D.length),d>0)for(;d--;D[m++]=0);for(d=it-1;w>v;){if(D[--w]<L[w]){for(m=w;m&&!D[--m];D[m]=d);--D[m],D[w]+=it}D[w]-=L[w]}for(;D[0]==0;D.splice(0,1),--$);return D[0]?C(c,D,$):(c.s=f==3?-1:1,c.c=[c.e=0],c)},o.modulo=o.mod=function(c,d){var m,w,y=this;return c=new A(c,d),!y.c||!c.s||c.c&&!c.c[0]?new A(NaN):!c.c||y.c&&!y.c[0]?new A(y):(b==9?(w=c.s,c.s=1,m=e(y,c,0,3),c.s=w,m.s*=w):m=e(y,c,0,b),c=y.minus(m.times(c)),!c.c[0]&&b==1&&(c.s=y.s),c)},o.multipliedBy=o.times=function(c,d){var m,w,y,k,V,v,E,$,D,L,S,j,X,he,Q,se=this,_e=se.c,le=(c=new A(c,d)).c;if(!_e||!le||!_e[0]||!le[0])return!se.s||!c.s||_e&&!_e[0]&&!le||le&&!le[0]&&!_e?c.c=c.e=c.s=null:(c.s*=se.s,!_e||!le?c.c=c.e=null:(c.c=[0],c.e=0)),c;for(w=st(se.e/we)+st(c.e/we),c.s*=se.s,E=_e.length,L=le.length,E<L&&(X=_e,_e=le,le=X,y=E,E=L,L=y),y=E+L,X=[];y--;X.push(0));for(he=it,Q=yt,y=L;--y>=0;){for(m=0,S=le[y]%Q,j=le[y]/Q|0,V=E,k=y+V;k>y;)$=_e[--V]%Q,D=_e[V]/Q|0,v=j*$+D*S,$=S*$+v%Q*Q+X[k]+m,m=($/he|0)+(v/Q|0)+j*D,X[k--]=$%he;X[k]=m}return m?++w:X.splice(0,1),C(c,X,w)},o.negated=function(){var c=new A(this);return c.s=-c.s||null,c},o.plus=function(c,d){var m,w=this,y=w.s;if(c=new A(c,d),d=c.s,!y||!d)return new A(NaN);if(y!=d)return c.s=-d,w.minus(c);var k=w.e/we,V=c.e/we,v=w.c,E=c.c;if(!k||!V){if(!v||!E)return new A(y/0);if(!v[0]||!E[0])return E[0]?c:new A(v[0]?w:y*0)}if(k=st(k),V=st(V),v=v.slice(),y=k-V){for(y>0?(V=k,m=E):(y=-y,m=v),m.reverse();y--;m.push(0));m.reverse()}for(y=v.length,d=E.length,y-d<0&&(m=E,E=v,v=m,d=y),y=0;d;)y=(v[--d]=v[d]+E[d]+y)/it|0,v[d]=it===v[d]?0:v[d]%it;return y&&(v=[y].concat(v),++V),C(c,v,V)},o.precision=o.sd=function(c,d){var m,w,y,k=this;if(c!=null&&c!==!!c)return Te(c,1,ze),d==null?d=f:Te(d,0,8),q(new A(k),c,d);if(!(m=k.c))return null;if(y=m.length-1,w=y*we+1,y=m[y]){for(;y%10==0;y/=10,w--);for(y=m[0];y>=10;y/=10,w++);}return c&&k.e+1>w&&(w=k.e+1),w},o.shiftedBy=function(c){return Te(c,-il,il),this.times("1e"+c)},o.squareRoot=o.sqrt=function(){var c,d,m,w,y,k=this,V=k.c,v=k.s,E=k.e,$=s+4,D=new A("0.5");if(v!==1||!V||!V[0])return new A(!v||v<0&&(!V||V[0])?NaN:V?k:1/0);if(v=Math.sqrt(+M(k)),v==0||v==1/0?(d=ot(V),(d.length+E)%2==0&&(d+="0"),v=Math.sqrt(+d),E=st((E+1)/2)-(E<0||E%2),v==1/0?d="5e"+E:(d=v.toExponential(),d=d.slice(0,d.indexOf("e")+1)+E),m=new A(d)):m=new A(v+""),m.c[0]){for(E=m.e,v=E+$,v<3&&(v=0);;)if(y=m,m=D.times(y.plus(e(k,y,$,1))),ot(y.c).slice(0,v)===(d=ot(m.c)).slice(0,v))if(m.e<E&&--v,d=d.slice(v-3,v+1),d=="9999"||!w&&d=="4999"){if(!w&&(q(y,y.e+s+2,0),y.times(y).eq(k))){m=y;break}$+=4,v+=4,w=1}else{(!+d||!+d.slice(1)&&d.charAt(0)=="5")&&(q(m,m.e+s+2,1),c=!m.times(m).eq(k));break}}return q(m,m.e+s+1,f,c)},o.toExponential=function(c,d){return c!=null&&(Te(c,0,ze),c++),z(this,c,d,1)},o.toFixed=function(c,d){return c!=null&&(Te(c,0,ze),c=c+this.e+1),z(this,c,d)},o.toFormat=function(c,d,m){var w,y=this;if(m==null)c!=null&&d&&typeof d=="object"?(m=d,d=null):c&&typeof c=="object"?(m=c,c=d=null):m=H;else if(typeof m!="object")throw Error(Qe+"Argument not an object: "+m);if(w=y.toFixed(c,d),y.c){var k,V=w.split("."),v=+m.groupSize,E=+m.secondaryGroupSize,$=m.groupSeparator||"",D=V[0],L=V[1],S=y.s<0,j=S?D.slice(1):D,X=j.length;if(E&&(k=v,v=E,E=k,X-=k),v>0&&X>0){for(k=X%v||v,D=j.substr(0,k);k<X;k+=v)D+=$+j.substr(k,v);E>0&&(D+=$+j.slice(k)),S&&(D="-"+D)}w=L?D+(m.decimalSeparator||"")+((E=+m.fractionGroupSize)?L.replace(new RegExp("\\d{"+E+"}\\B","g"),"$&"+(m.fractionGroupSeparator||"")):L):D}return(m.prefix||"")+w+(m.suffix||"")},o.toFraction=function(c){var d,m,w,y,k,V,v,E,$,D,L,S,j=this,X=j.c;if(c!=null&&(v=new A(c),!v.isInteger()&&(v.c||v.s!==1)||v.lt(r)))throw Error(Qe+"Argument "+(v.isInteger()?"out of range: ":"not an integer: ")+M(v));if(!X)return new A(j);for(d=new A(r),$=m=new A(r),w=E=new A(r),S=ot(X),k=d.e=S.length-j.e-1,d.c[0]=al[(V=k%we)<0?we+V:V],c=!c||v.comparedTo(d)>0?k>0?d:$:v,V=h,h=1/0,v=new A(S),E.c[0]=0;D=e(v,d,0,1),y=m.plus(D.times(w)),y.comparedTo(c)!=1;)m=w,w=y,$=E.plus(D.times(y=$)),E=y,d=v.minus(D.times(y=d)),v=y;return y=e(c.minus(m),w,0,1),E=E.plus(y.times($)),m=m.plus(y.times(w)),E.s=$.s=j.s,k=k*2,L=e($,w,k,f).minus(j).abs().comparedTo(e(E,m,k,f).minus(j).abs())<1?[$,w]:[E,m],h=V,L},o.toNumber=function(){return+M(this)},o.toPrecision=function(c,d){return c!=null&&Te(c,1,ze),z(this,c,d,2)},o.toString=function(c){var d,m=this,w=m.s,y=m.e;return y===null?w?(d="Infinity",w<0&&(d="-"+d)):d="NaN":(c==null?d=y<=i||y>=a?Jt(ot(m.c),y):gt(ot(m.c),y,"0"):c===10&&F?(m=q(new A(m),s+y+1,f),d=gt(ot(m.c),m.e,"0")):(Te(c,2,R.length,"Base"),d=l(gt(ot(m.c),y,"0"),10,c,w,!0)),w<0&&m.c[0]&&(d="-"+d)),d},o.valueOf=o.toJSON=function(){return M(this)},o._isBigNumber=!0,o[Symbol.toStringTag]="BigNumber",o[Symbol.for("nodejs.util.inspect.custom")]=o.valueOf,n!=null&&A.set(n),A}function st(n){var e=n|0;return n>0||n===e?e:e-1}function ot(n){for(var e,l,t=1,o=n.length,r=n[0]+"";t<o;){for(e=n[t++]+"",l=we-e.length;l--;e="0"+e);r+=e}for(o=r.length;r.charCodeAt(--o)===48;);return r.slice(0,o+1||1)}function St(n,e){var l,t,o=n.c,r=e.c,s=n.s,f=e.s,i=n.e,a=e.e;if(!s||!f)return null;if(l=o&&!o[0],t=r&&!r[0],l||t)return l?t?0:-f:s;if(s!=f)return s;if(l=s<0,t=i==a,!o||!r)return t?0:!o^l?1:-1;if(!t)return i>a^l?1:-1;for(f=(i=o.length)<(a=r.length)?i:a,s=0;s<f;s++)if(o[s]!=r[s])return o[s]>r[s]^l?1:-1;return i==a?0:i>a^l?1:-1}function Te(n,e,l,t){if(n<e||n>l||n!==rt(n))throw Error(Qe+(t||"Argument")+(typeof n=="number"?n<e||n>l?" out of range: ":" not an integer: ":" not a primitive number: ")+String(n))}function Qt(n){var e=n.c.length-1;return st(n.e/we)==e&&n.c[e]%2!=0}function Jt(n,e){return(n.length>1?n.charAt(0)+"."+n.slice(1):n)+(e<0?"e":"e+")+e}function gt(n,e,l){var t,o;if(e<0){for(o=l+".";++e;o+=l);n=o+n}else if(t=n.length,++e>t){for(o=l,e-=t;--e;o+=l);n+=o}else e<t&&(n=n.slice(0,e)+"."+n.slice(e));return n}lo();const{theme:Es}=Dt(qt),Ye=(n,e,l={})=>{const{color:t="rgba(255,255,255,0)",duration:o=.2,ease:r="power1.in",offset:s={from:"0%",to:"100%"},position:f="+=0",...i}=l,{from:a="0%",to:u="100%"}=s,h=Array.isArray(e)?e.map(p=>p.getAttribute("stop-color")):e.getAttribute("stop-color");n.fromTo(e,{attr:{offset:a,"stop-color":t}},{attr:{offset:u,"stop-color":t},duration:o,ease:r,...i},f).to(e,{attr:{offset:u,"stop-color":p=>Array.isArray(e)?h[p]:h},duration:o,ease:r,...i},"-=50%")},Lt=Es.colors.gray[100],zt=.2,Is=async n=>new Promise(e=>{var Me,K,ne,Y,ke,tt,Se,ft,ut,Ze,dt,ht,Ae,At,Ot,jt,Gt,be,Ie,Fe,Xe,Ke;const l=ct.timeline({onComplete:e}),t=.02,o=document.querySelectorAll(".embedding .content .last");l.fromTo(o,{opacity:0},{opacity:1,duration:t});const r=document.querySelectorAll(".sankey .embedding .last");l.set(r,{opacity:Kn});const s=(Me=document.querySelector("#gray-blue-last"))==null?void 0:Me.querySelectorAll("stop")[1];Ye(l,s,{duration:t*10});const f=document.querySelectorAll(".attention .column .vector.last");l.fromTo(f,{opacity:0},{opacity:1,duration:t});const i=document.querySelectorAll(".sankey-top .attention .last"),a=document.querySelectorAll(".sankey-back .attention .last"),u=document.querySelectorAll(".sankey-top .attention .to-attention-out");l.set(i,{opacity:Et}),l.set(a,{opacity:Mt}),l.set(u,{opacity:hl});const h=(K=document.querySelector("#blue-blue-last"))==null?void 0:K.querySelectorAll("stop")[1],p=(ne=document.querySelector("#red-red-last"))==null?void 0:ne.querySelectorAll("stop")[1],b=(Y=document.querySelector("#green-green-last"))==null?void 0:Y.querySelectorAll("stop")[1],N=(ke=document.querySelector("#blue-blue2-last"))==null?void 0:ke.querySelectorAll("stop")[1],H=(tt=document.querySelector("#red-red2-last"))==null?void 0:tt.querySelectorAll("stop")[1],R=(Se=document.querySelector("#green-green2-last"))==null?void 0:Se.querySelectorAll("stop")[1];Ye(l,[h,p,b,N,H,R],{duration:t*10});const F=document.querySelectorAll(".attention .head-block .qkv .column .last");l.fromTo(F,{opacity:0},{opacity:1,duration:t});const A=document.querySelectorAll(".sankey-top g.attention path.key-to-attention"),z=document.querySelectorAll(".sankey-top g.attention path.query-to-attention"),ee=document.querySelector(".attention .attention-result");[...A,...z].forEach(xe=>{const Pe=xe.getTotalLength();xe.style.strokeDasharray=Pe,xe.style.strokeDashoffset=Pe});const C=.4,q=Number((C/n).toFixed(2));l.to(A,{strokeDashoffset:0,stagger:q,duration:C,ease:"power2.out"}).to(z,{strokeDashoffset:0,stagger:q,duration:C,ease:"power2.out"},"<").from(ee.querySelectorAll("svg circle"),{scale:0,transformOrigin:"50% 50%",opacity:0,delay:C/n,stagger:Number((C/Math.pow(n,2)).toFixed(2)),ease:"power2.out",duration:C},"<");const M=(ft=document.querySelector("#green-purple"))==null?void 0:ft.querySelectorAll("stop")[1],c=(ut=document.querySelector("#transparent-purple2"))==null?void 0:ut.querySelectorAll("stop")[1];Ye(l,[c,M],{color:Lt,position:"<50%"});const d=document.querySelectorAll(".attention .head-block .head-out .column .cell"),m=document.querySelector(".attention .head-block .head-out .title");l.fromTo([d,m],{opacity:(xe,Pe)=>Pe.classList.contains("last")?0:zt},{opacity:1,duration:t});const w=(Ze=document.querySelector("#purple-purple"))==null?void 0:Ze.querySelectorAll("stop")[1],y=(dt=document.querySelector("#transparent-purple"))==null?void 0:dt.querySelectorAll("stop")[1],k=(ht=document.querySelector("#purple-purple-last"))==null?void 0:ht.querySelectorAll("stop")[1],V=(Ae=document.querySelector("#transparent-purple-last"))==null?void 0:Ae.querySelectorAll("stop")[1];l.set([w,k],{opacity:Et}),l.set([y,V],{opacity:Mt}),Ye(l,[w,y],{color:Lt}),Ye(l,[k,V],{position:"<"});const v=document.querySelectorAll(".mlp .first-layer .cell");l.fromTo(v,{opacity:(xe,Pe)=>Pe.classList.contains("last")?0:zt},{opacity:1,duration:t});const E=document.querySelectorAll(".sankey .mlp .last");l.set(E,{opacity:pl});const $=(At=document.querySelector("#purple-indigo"))==null?void 0:At.querySelectorAll("stop")[1],D=(Ot=document.querySelector("#purple-indigo-last"))==null?void 0:Ot.querySelectorAll("stop")[1];Ye(l,$,{color:Lt}),Ye(l,D,{position:"<"});const L=document.querySelectorAll(".mlp .second-layer .projections .cell");l.fromTo(L,{opacity:(xe,Pe)=>Pe.classList.contains("last")?0:zt},{opacity:1,duration:t});const S=(jt=document.querySelector("#indigo-blue"))==null?void 0:jt.querySelectorAll("stop")[1],j=(Gt=document.querySelector("#indigo-blue-last"))==null?void 0:Gt.querySelectorAll("stop")[1];Ye(l,S,{color:Lt}),Ye(l,j,{position:"<"});const X=document.querySelectorAll(".mlp .second-layer .ouputs .cell");l.fromTo(X,{opacity:(xe,Pe)=>Pe.classList.contains("last")?0:zt},{opacity:1,duration:t});const he=document.querySelectorAll(".sankey .transformer-blocks .last");l.set(he,{opacity:Yn});const Q=(be=document.querySelector("#blue-white-blue"))==null?void 0:be.querySelectorAll("stop")[1],se=(Ie=document.querySelector("#blue-white-blue"))==null?void 0:Ie.querySelectorAll("stop")[3],_e=(Fe=document.querySelector("#blue-white-blue-last"))==null?void 0:Fe.querySelectorAll("stop")[1],le=(Xe=document.querySelector("#blue-white-blue-last"))==null?void 0:Xe.querySelectorAll("stop")[3],Re=ct.timeline({});Ye(Re,Q,{color:Lt,duration:t*5,offset:{to:"50%"},ease:"sine.inOut"}),Ye(Re,_e,{duration:t*5,offset:{to:"50%"},ease:"sine.inOut",position:"<"}),Ye(Re,se,{duration:t*5,color:Lt,offset:{from:"50%"},ease:"sine.inOut"}),Ye(Re,le,{duration:t*5,offset:{from:"50%"},ease:"sine.inOut",position:"<"}),l.add(Re);const J=document.querySelectorAll(".transformer-blocks .cell");l.fromTo(J,{opacity:(xe,Pe)=>Pe.classList.contains("last")?0:zt},{opacity:1,duration:t});const te=document.querySelectorAll(".sankey .linear-softmax .last");l.set(te,{opacity:Qn});const Z=(Ke=document.querySelector("#blue-gray"))==null?void 0:Ke.querySelectorAll("stop")[1];Ye(l,Z,{offset:{to:"50%"}});const me=document.querySelectorAll(".softmax .content");l.fromTo(me,{opacity:0},{opacity:1,duration:t})}),Ds=async()=>{};ao.wasm.wasmPaths="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/";const no=20,qs=async(n,e)=>{wl.set(!0);const{token_ids:l,input_tokens:t}=await As(n);bt.set(t);const{outputs:o,prediction:r}=await Ns(l),s=Wn(r,e),f=Xn(s,no);Ht.set({outputs:o,prediction:s,sampled:f}),setTimeout(async()=>{await Is(t.length),xt.set(f),wl.set(!1)},0)},Cs=async(n,e)=>{const l=Wn(n,e),t=Xn(l,no);Ht.update(o=>({...o,prediction:l})),await Ds(),xt.set(t)},Ss=n=>{const e=Math.max(...n),l=n.map(o=>Math.exp(o-e)),t=l.reduce((o,r)=>o+r,0);return l.map(o=>o/t)},As=async n=>{const e=await xn.from_pretrained("Xenova/gpt2"),l=e.encode(n),t=l.map(o=>e.decode([o])).flat();return{token_ids:l,input_tokens:t}},Vs=(n,e,l,t)=>{const o=Array.from(n).map((r,s)=>({tokenId:s,logit:r,probability:e[s]}));return o.sort((r,s)=>s.probability-r.probability),o.slice(0,t).map((r,s)=>({...r,rank:s,token:l.decode([r.tokenId])}))},Ns=async n=>{try{const e=new co("int64",n,[1,n.length]),l=ro(Fn);if(!l)throw new Error("Model session is not initialized.");const t={input:e},o=await l.run(t),r=o.linear_output.data,s=Ss(r),f=await xn.from_pretrained("Xenova/gpt2"),a=Vs(r,s,f,100);return{outputs:Ls.reduce((h,p)=>{const b=o[p],N={...b,data:xo([...b.cpuData],b.dims)};return h[p]=N,h},{}),prediction:a}}catch(e){throw console.error("Error during inference:",e.message),e}},Ls=["block_0_attn_head_0_attn","block_0_attn_head_0_attn_scaled","block_0_attn_head_0_attn_masked","block_0_attn_head_0_attn_softmax","block_0_attn_head_0_attn_dropout","linear_output"];async function Ms(n){const e=await fetch(n);if(!e.ok)throw new Error(`Failed to fetch ${n}`);return e.arrayBuffer()}async function Bs(n){const e=await Promise.all(n.map(r=>Ms(r))),l=e.reduce((r,s)=>r+s.byteLength,0),t=new Uint8Array(l);let o=0;for(const r of e)t.set(new Uint8Array(r),o),o+=r.byteLength;return t.buffer}function Tn(n){let e,l,t,o,r,s,f;return l=new bo({}),{c(){e=B("div"),ie(l.$$.fragment),this.h()},l(i){e=T(i,"DIV",{class:!0,style:!0,role:!0});var a=P(e);ae(l.$$.fragment,a),a.forEach(_),this.h()},h(){g(e,"class","qkv-weight-popover weight-popover svelte-1cfr5kc"),g(e,"style",t=`left:${n[0].left}px;top:${n[0].top}px;`),g(e,"role","group")},m(i,a){G(i,e,a),ce(l,e,null),r=!0,s||(f=[ye(e,"mouseenter",n[3]),ye(e,"mouseleave",n[4])],s=!0)},p(i,a){(!r||a&1&&t!==(t=`left:${i[0].left}px;top:${i[0].top}px;`))&&g(e,"style",t)},i(i){r||(O(l.$$.fragment,i),i&&(o||Bt(()=>{o=so(e,at,{duration:300}),o.start()})),r=!0)},o(i){W(l.$$.fragment,i),r=!1},d(i){i&&_(e),fe(l),s=!1,Ue(f)}}}function Ts(n){let e,l,t=(n[2]==="embedding"||n[1])&&Tn(n);return{c(){t&&t.c(),e=mt()},l(o){t&&t.l(o),e=mt()},m(o,r){t&&t.m(o,r),G(o,e,r),l=!0},p(o,[r]){o[2]==="embedding"||o[1]?t?(t.p(o,r),r&6&&O(t,1)):(t=Tn(o),t.c(),O(t,1),t.m(e.parentNode,e)):t&&(Ne(),W(t,1,1,()=>{t=null}),Le())},i(o){l||(O(t),l=!0)},o(o){W(t),l=!1},d(o){o&&_(e),t&&t.d(o)}}}function Ps(n,e,l){let t;Ee(n,fl,a=>l(2,t=a));let o,r={left:0,top:0},s=!1;return _t(()=>{const a=()=>{var F;const h=window.scrollX,p=(F=document.querySelector(".top-bar"))==null?void 0:F.offsetHeight,b=document.querySelector(".step.embedding .content"),N=document.querySelector(".step.mlp .content"),H=b.getBoundingClientRect(),R=N.getBoundingClientRect();l(0,r={left:H.right+h,top:H.top-p}),R.left+h,R.top-p};return a(),o=new ResizeObserver(h=>{a()}),(document==null?void 0:document.querySelectorAll(".resize-watch")).forEach(h=>o.observe(h)),()=>{o.disconnect()}}),[r,s,t,()=>{l(1,s=!0)},()=>{l(1,s=!1)}]}class Hs extends je{constructor(e){super(),Ge(this,e,Ps,Ts,Oe,{})}}function Pn(n){let e,l,t,o,r,s,f,i,a,u,h;return{c(){e=B("div"),t=U(),o=B("div"),f=U(),i=B("div"),this.h()},l(p){e=T(p,"DIV",{class:!0}),P(e).forEach(_),t=x(p),o=T(p,"DIV",{class:!0}),P(o).forEach(_),f=x(p),i=T(p,"DIV",{class:!0}),P(i).forEach(_),this.h()},h(){g(e,"class","dim svelte-p1rtu3"),g(o,"class",r=ve(pe("dim-partial left",`${n[2].id||""}`))+" svelte-p1rtu3"),g(i,"class",a=ve(pe("dim-partial right",`${n[2].id||""}`))+" svelte-p1rtu3")},m(p,b){G(p,e,b),G(p,t,b),G(p,o,b),G(p,f,b),G(p,i,b),h=!0},p(p,b){(!h||b&4&&r!==(r=ve(pe("dim-partial left",`${p[2].id||""}`))+" svelte-p1rtu3"))&&g(o,"class",r),(!h||b&4&&a!==(a=ve(pe("dim-partial right",`${p[2].id||""}`))+" svelte-p1rtu3"))&&g(i,"class",a)},i(p){h||(p&&Bt(()=>{h&&(l||(l=Vt(e,at,{duration:100},!0)),l.run(1))}),p&&Bt(()=>{h&&(s||(s=Vt(o,at,{duration:100},!0)),s.run(1))}),p&&Bt(()=>{h&&(u||(u=Vt(i,at,{duration:100},!0)),u.run(1))}),h=!0)},o(p){p&&(l||(l=Vt(e,at,{duration:100},!1)),l.run(0)),p&&(s||(s=Vt(o,at,{duration:100},!1)),s.run(0)),p&&(u||(u=Vt(i,at,{duration:100},!1)),u.run(0)),h=!1},d(p){p&&(_(e),_(t),_(o),_(f),_(i)),p&&l&&l.end(),p&&s&&s.end(),p&&u&&u.end()}}}function Os(n){let e,l,t,o,r,s,f,i,a,u,h,p,b,N,H,R,F,A,z,ee,C,q=!!n[2].id&&Pn(n);return o=new jo({}),i=new hs({props:{className:"step"}}),u=new pr({props:{className:"step"}}),p=new ys({props:{className:"step"}}),N=new Ir({props:{className:"step"}}),R=new Br({props:{className:"step"}}),z=new Hs({}),{c(){e=B("div"),q&&q.c(),l=U(),t=B("div"),ie(o.$$.fragment),r=U(),s=B("div"),f=B("div"),ie(i.$$.fragment),a=U(),ie(u.$$.fragment),h=U(),ie(p.$$.fragment),b=U(),ie(N.$$.fragment),H=U(),ie(R.$$.fragment),A=U(),ie(z.$$.fragment),this.h()},l(M){e=T(M,"DIV",{class:!0,style:!0});var c=P(e);q&&q.l(c),l=x(c),t=T(c,"DIV",{class:!0});var d=P(t);ae(o.$$.fragment,d),d.forEach(_),r=x(c),s=T(c,"DIV",{class:!0});var m=P(s);f=T(m,"DIV",{class:!0});var w=P(f);ae(i.$$.fragment,w),a=x(w),ae(u.$$.fragment,w),h=x(w),ae(p.$$.fragment,w),b=x(w),ae(N.$$.fragment,w),H=x(w),ae(R.$$.fragment,w),w.forEach(_),A=x(m),ae(z.$$.fragment,m),m.forEach(_),c.forEach(_),this.h()},h(){g(t,"class","sankey opacity-1 svelte-p1rtu3"),oe(t,"attention",n[2].id==="attention"),g(f,"class","steps svelte-p1rtu3"),Bt(()=>n[7].call(f)),oe(f,"expanded",!!n[2].id),g(s,"class","nodes resize-watch svelte-p1rtu3"),g(e,"class","main-section h-full w-full"),g(e,"style",ee=`--vector-height: ${n[1]}px;--title-height: ${n[3]}px;--content-height:${n[0]-n[3]}px;`)},m(M,c){G(M,e,c),q&&q.m(e,null),I(e,l),I(e,t),ce(o,t,null),I(e,r),I(e,s),I(s,f),ce(i,f,null),I(f,a),ce(u,f,null),I(f,h),ce(p,f,null),I(f,b),ce(N,f,null),I(f,H),ce(R,f,null),F=Rn(f,n[7].bind(f)),I(s,A),ce(z,s,null),C=!0},p(M,[c]){M[2].id?q?(q.p(M,c),c&4&&O(q,1)):(q=Pn(M),q.c(),O(q,1),q.m(e,l)):q&&(Ne(),W(q,1,1,()=>{q=null}),Le()),(!C||c&4)&&oe(t,"attention",M[2].id==="attention"),(!C||c&4)&&oe(f,"expanded",!!M[2].id),(!C||c&3&&ee!==(ee=`--vector-height: ${M[1]}px;--title-height: ${M[3]}px;--content-height:${M[0]-M[3]}px;`))&&g(e,"style",ee)},i(M){C||(O(q),O(o.$$.fragment,M),O(i.$$.fragment,M),O(u.$$.fragment,M),O(p.$$.fragment,M),O(N.$$.fragment,M),O(R.$$.fragment,M),O(z.$$.fragment,M),C=!0)},o(M){W(q),W(o.$$.fragment,M),W(i.$$.fragment,M),W(u.$$.fragment,M),W(p.$$.fragment,M),W(N.$$.fragment,M),W(R.$$.fragment,M),W(z.$$.fragment,M),C=!1},d(M){M&&_(e),q&&q.d(),fe(o),fe(i),fe(u),fe(p),fe(N),fe(R),F(),fe(z)}}}function js(n,e,l){let t,o,r,s,f,i;Ee(n,bt,b=>l(4,t=b)),Ee(n,Ht,b=>l(5,o=b)),Ee(n,ul,b=>l(8,r=b)),Ee(n,xt,b=>l(6,s=b)),Ee(n,el,b=>l(1,f=b)),Ee(n,We,b=>l(2,i=b)),_t(async()=>{const N=Array(63).fill(0).map((q,M)=>`${qo}/gpt2.onnx.part${M}`),H=await Bs(N),R=new Blob([H],{type:"application/octet-stream"}),F=URL.createObjectURL(R),A=await fo.create(F,{});Fn.set(A),uo.set(!1);const z=ho.subscribe(q=>{qs(q.trim(),r)});let ee=!0;const C=ul.subscribe(q=>{if(ee){ee=!1;return}Cs(o==null?void 0:o.prediction,q)});return()=>{z(),C()}});let a=0,u=Tt*5;const h=()=>{const b=Tt*.5*(t.length-1),N=Math.min(Math.max((a-u-b)/t.length/po,vo),mo);el.set(N),zn.set(t.length*N*3+b)};function p(){a=this.offsetHeight,l(0,a)}return n.$$.update=()=>{n.$$.dirty&32&&console.log("data",o),n.$$.dirty&64&&console.log("p tkn",s),n.$$.dirty&17&&(a||t.length)&&h()},[a,f,i,u,t,o,s,p]}class Ys extends je{constructor(e){super(),Ge(this,e,js,Os,Oe,{})}}export{Ys as component,Ks as universal};

<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="./favicon.png" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Jersey+10&display=swap" rel="stylesheet" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="./_app/immutable/assets/0.CpdGWp9k.css" rel="stylesheet">
		<link href="./_app/immutable/assets/HelpPopover.BAxkvAQM.css" rel="stylesheet">
		<link href="./_app/immutable/assets/2.DSPRdWaT.css" rel="stylesheet">
		<link href="./_app/immutable/assets/QKVWeightPopover.BAjhBQfT.css" rel="stylesheet">
		<link rel="modulepreload" href="./_app/immutable/entry/start.D2Y0oza0.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/entry.BG1wjWjM.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/scheduler.BvdSgcxT.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/index.CRtEE1wu.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/paths.bN-0eCfp.js">
		<link rel="modulepreload" href="./_app/immutable/entry/app.rf2C4sZP.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/index.DGxhJfay.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/0.DGkxURZn.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/index.BOCEUJb6.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/HelpPopover.DE5qBhsY.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/2.__LYfGa-.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/QKVWeightPopover.js1T3oG1.js"><title>Transformer Explainer</title><!-- HEAD_svelte-elip4h_START --><!-- HEAD_svelte-elip4h_END -->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">   <div id="app" style="--min-screen-width:1400px;--min-column-width:26px;--predicted-color:#7E3AF2;" class="svelte-ptfu7x"><div id="landing" class="svelte-ptfu7x"><header class="svelte-ptfu7x"><div class="top-bar flex w-full items-center gap-4 px-10 py-2 svelte-15vq1w1"><div class="logo text-bold text-gray-700 svelte-15vq1w1" data-svelte-h="svelte-793i68">T<span class="small svelte-15vq1w1">RANSFORMER</span> E<span class="small svelte-15vq1w1">XPLAINER</span></div> <div class="inputs flex grow items-center"><div class="flex w-full"><div class="grow"><div class="input-area flex flex-shrink-0 svelte-1o1cvvp">    <div class="flex flex-1 items-center gap-1 whitespace-nowrap"><form class="flex w-full items-center gap-2"><div class="inline-flex rounded-lg shadow-sm w-full grow" role="group"><button type="button"  class="select-button inline-flex items-center justify-center border border-s-0 border-gray-200 bg-white px-3 py-2 text-center text-xs font-medium text-gray-900 first:rounded-s-lg first:border-s last:rounded-e-lg svelte-1o1cvvp">Examples<svg xmlns="http://www.w3.org/2000/svg" fill="none" color="currentColor" class="shrink-0 pointer-events-none h-4 w-4 text-gray-500" role="img" aria-label="chevron down outline" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m8 10 4 4 4-4"></path></svg> </button> <div></div>    <div class="input-container relative svelte-1o1cvvp disabled"><div contenteditable="false" class="input-box svelte-1o1cvvp" placeholder="Test your own input text" role="input"><span class="user-input">Data visualization empowers users to</span><span class="predicted svelte-1o1cvvp"> create</span></div>  <span class="helper-text svelte-1o1cvvp" data-svelte-h="svelte-d2s81t">Try the examples while GPT-2 model is being downloaded (600MB)</span></div></div>  <button disabled class="generate-button rounded-lg text-center text-sm shadow-sm disabled svelte-1o1cvvp" type="submit">Generate</button></form></div> <div class="temperature-slider text-gray-900 svelte-1cjlkip"><div class="slider-container flex w-full flex-col items-end svelte-1cjlkip"><div class="flex w-full shrink-0 items-center justify-between"><div class="temperature-text flex items-center gap-[2px] svelte-1cjlkip"><div data-svelte-h="svelte-knfc80">Temperature</div> <div id="temperature-help" class="help"><svg class="h-4 w-4 text-gray-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M478-240q21 0 35.5-14.5T528-290q0-21-14.5-35.5T478-340q-21 0-35.5 14.5T428-290q0 21 14.5 35.5T478-240Zm-36-154h74q0-33 7.5-52t42.5-52q26-26 41-49.5t15-56.5q0-56-41-86t-97-30q-57 0-92.5 30T342-618l66 26q5-18 22.5-39t53.5-21q32 0 48 17.5t16 38.5q0 20-12 37.5T506-526q-44 39-54 59t-10 73Zm38 314q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z"></path></svg></div> <div></div>   </div> <div class="temperature-value svelte-1cjlkip"><p>1</p></div></div> <input disabled class="slider svelte-1cjlkip" type="range" min="0" max="17" step="1" value="8"></div> </div> </div></div></div></div> <div class="icons flex items-center gap-4" data-svelte-h="svelte-ys0ard"> <a href="https://github.com/poloclub/transformer-explainer" target="_blank"><svg class="h-6 w-6 text-gray-800 dark:text-white svelte-15vq1w1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.006 2a9.847 9.847 0 0 0-6.484 2.44 10.32 10.32 0 0 0-3.393 6.17 10.48 10.48 0 0 0 1.317 6.955 10.045 10.045 0 0 0 5.4 4.418c.504.095.683-.223.683-.494 0-.245-.01-1.052-.014-1.908-2.78.62-3.366-1.21-3.366-1.21a2.711 2.711 0 0 0-1.11-1.5c-.907-.637.07-.621.07-.621.317.044.62.163.885.346.266.183.487.426.647.71.135.253.318.476.538.655a2.079 2.079 0 0 0 2.37.196c.045-.52.27-1.006.635-1.37-2.219-.259-4.554-1.138-4.554-5.07a4.022 4.022 0 0 1 1.031-2.75 3.77 3.77 0 0 1 .096-2.713s.839-.275 2.749 1.05a9.26 9.26 0 0 1 5.004 0c1.906-1.325 2.74-1.05 2.74-1.05.37.858.406 1.828.101 2.713a4.017 4.017 0 0 1 1.029 2.75c0 3.939-2.339 4.805-4.564 5.058a2.471 2.471 0 0 1 .679 1.897c0 1.372-.012 2.477-.012 2.814 0 .272.18.592.687.492a10.05 10.05 0 0 0 5.388-4.421 10.473 10.473 0 0 0 1.313-6.948 10.32 10.32 0 0 0-3.39-6.165A9.847 9.847 0 0 0 12.007 2Z" clip-rule="evenodd"></path></svg></a></div> </div></header> <main id="main" style="padding-top:0px" class="svelte-ptfu7x"><div class="main-section h-full w-full" style="--vector-height: 12px;--title-height: 80px;--content-height:-80px;">  <div class="sankey opacity-1 svelte-1w84t81"><svg id="back" class="sankey-back absolute left-0 top-0 h-full w-full" style="z-index:11;"></svg> <svg class="sankey-top absolute left-0 top-0 h-full w-full" style="z-index:12;"></svg></div> <div class="nodes resize-watch svelte-1w84t81"><div class="steps svelte-1w84t81"><div class="embedding step svelte-1iayxn1" role="none"><div class="title expandable svelte-1iayxn1" role="none" data-svelte-h="svelte-szi5cj"><div>Embedding</div></div> <div class="content relative svelte-1iayxn1"><div class="token-column resizable resize-watch flex"> <div class="column token-string relative svelte-1iayxn1"> <div class="cell svelte-1iayxn1"><span class="label svelte-1iayxn1">Data</span> </div><div class="cell svelte-1iayxn1"><span class="label svelte-1iayxn1"> visualization</span> </div><div class="cell svelte-1iayxn1"><span class="label svelte-1iayxn1"> em</span> </div><div class="cell svelte-1iayxn1"><span class="label svelte-1iayxn1">powers</span> </div><div class="cell svelte-1iayxn1"><span class="label svelte-1iayxn1"> users</span> </div><div class="cell svelte-1iayxn1 last"><span class="label svelte-1iayxn1"> to</span> </div> <div class="bounding embedding-bounding svelte-1iayxn1"></div></div> </div> <div class="vector-column relative flex"><div class="column vectors svelte-1iayxn1"><div class="vector bg-gray-300 svelte-1iayxn1"><canvas class="svelte-ex5m8"></canvas></div> <div></div>   <div class="vector bg-gray-300 svelte-1iayxn1"><canvas class="svelte-ex5m8"></canvas></div> <div></div>   <div class="vector bg-gray-300 svelte-1iayxn1"><canvas class="svelte-ex5m8"></canvas></div> <div></div>   <div class="vector bg-gray-300 svelte-1iayxn1"><canvas class="svelte-ex5m8"></canvas></div> <div></div>   <div class="vector bg-gray-300 svelte-1iayxn1"><canvas class="svelte-ex5m8"></canvas></div> <div></div>   <div class="vector bg-gray-300 svelte-1iayxn1 last"><canvas class="svelte-ex5m8"></canvas></div> <div></div>   </div> <div class="operations flex svelte-1iayxn1"><div id="embedding-dropout" class="operation-col column dropout svelte-cfq6hx" role="group"><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> <svg class="guide svelte-1jqlo12" width="44px"><path d="M44.3186 4.46399C44.5314 4.28801 44.5613 3.97284 44.3853 3.76004L41.5175 0.292199C41.3416 0.0793953 41.0264 0.0495441 40.8136 0.225525C40.6008 0.401505 40.5709 0.716677 40.7469 0.929481L43.296 4.012L40.2135 6.56113C40.0007 6.73711 39.9709 7.05228 40.1468 7.26509C40.3228 7.47789 40.638 7.50774 40.8508 7.33176L44.3186 4.46399ZM44.0471 3.58091C38.7621 3.08034 27.8926 4.80481 18.3357 11.5838C8.74613 18.386 0.5 30.2626 0.5 50H1.5C1.5 30.5889 9.58721 19.0154 18.9143 12.3994C28.2741 5.76023 38.9045 4.0983 43.9529 4.57645L44.0471 3.58091Z" class="svelte-1jqlo12"></path><text x="4" y="60" text-anchor="middle" class="svelte-1jqlo12">Dropout</text></svg></div> <div></div>   </div> <div id="residual-first-start" class="operation-col column residual svelte-cfq6hx" role="group"><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path id="residual-first" class="head svelte-1jqlo12" d="M0,0 Q0,-16 30,-16"></path> <text x="30" y="-26" dy="4" dx="4" class="svelte-1jqlo12">Residual</text><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div> <div></div>   </div> <div id="embedding-ln" class="operation-col column ln svelte-cfq6hx" role="group"><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> <svg class="guide svelte-1jqlo12" width="27px"><path d="M27.3536 4.35355C27.5488 4.15829 27.5488 3.84171 27.3536 3.64645L24.1716 0.46447C23.9763 0.269208 23.6597 0.269208 23.4645 0.464471C23.2692 0.659733 23.2692 0.976316 23.4645 1.17158L26.2929 4L23.4645 6.82843C23.2692 7.02369 23.2692 7.34028 23.4645 7.53554C23.6597 7.7308 23.9763 7.7308 24.1716 7.53554L27.3536 4.35355ZM27 3.5C20.3125 3.50001 15.2969 6.63952 11.5638 11.7944C7.84616 16.9278 5.39057 24.0677 3.75991 32.1346C0.498061 48.2711 0.5 68.3247 0.5 84H1.5C1.5 68.2984 1.50194 48.352 4.74009 32.3328C6.35943 24.3218 8.77884 17.3448 12.3737 12.3809C15.9531 7.4384 20.6875 4.50001 27 4.5V3.5Z" class="svelte-1jqlo12"></path><text x="4" y="95" text-anchor="middle" class="svelte-1jqlo12">Layer Normalization</text></svg></div> <div></div>   </div></div></div></div> </div> <div class="attention step svelte-1hsibq9"><div class="title svelte-1hsibq9" role="group" data-svelte-h="svelte-n6swon"><div>Multi-head Self Attention</div></div> <div class="content relative svelte-1hsibq9"><div class="bounding transformer-bounding svelte-1hsibq9" data-svelte-h="svelte-vte4ua"><div class="bounding-title svelte-1hsibq9">Transformer Block 1</div></div> <div class="bounding attention-bounding svelte-1hsibq9" style="padding-bottom:96px"></div>  <div class="column"><div class="qkv-weighted vector x3 flex flex-col" role="group"><div class="sub-vector query relative flex grow flex-col bg-blue-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-blue-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-10ub4hf">Q</span> </div></div> <div class="sub-vector key relative flex grow flex-col bg-red-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-red-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-1c09r6x">K</span> </div></div> <div class="sub-vector value relative flex grow flex-col bg-green-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-green-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-j40kxg">V</span></div> </div></div> <div></div>   <div class="qkv-weighted vector x3 flex flex-col" role="group"><div class="sub-vector query relative flex grow flex-col bg-blue-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-blue-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-10ub4hf">Q</span> </div></div> <div class="sub-vector key relative flex grow flex-col bg-red-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-red-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-1c09r6x">K</span> </div></div> <div class="sub-vector value relative flex grow flex-col bg-green-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-green-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-j40kxg">V</span></div> </div></div> <div></div>   <div class="qkv-weighted vector x3 flex flex-col" role="group"><div class="sub-vector query relative flex grow flex-col bg-blue-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-blue-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-10ub4hf">Q</span> </div></div> <div class="sub-vector key relative flex grow flex-col bg-red-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-red-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-1c09r6x">K</span> </div></div> <div class="sub-vector value relative flex grow flex-col bg-green-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-green-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-j40kxg">V</span></div> </div></div> <div></div>   <div class="qkv-weighted vector x3 flex flex-col" role="group"><div class="sub-vector query relative flex grow flex-col bg-blue-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-blue-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-10ub4hf">Q</span> </div></div> <div class="sub-vector key relative flex grow flex-col bg-red-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-red-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-1c09r6x">K</span> </div></div> <div class="sub-vector value relative flex grow flex-col bg-green-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-green-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-j40kxg">V</span></div> </div></div> <div></div>   <div class="qkv-weighted vector x3 flex flex-col" role="group"><div class="sub-vector query relative flex grow flex-col bg-blue-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-blue-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-10ub4hf">Q</span> </div></div> <div class="sub-vector key relative flex grow flex-col bg-red-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-red-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-1c09r6x">K</span> </div></div> <div class="sub-vector value relative flex grow flex-col bg-green-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-green-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-j40kxg">V</span></div> </div></div> <div></div>   <div class="qkv-weighted vector x3 flex flex-col last" role="group"><div class="sub-vector query relative flex grow flex-col bg-blue-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-blue-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-10ub4hf">Q</span> </div></div> <div class="sub-vector key relative flex grow flex-col bg-red-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-red-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-1c09r6x">K</span> </div></div> <div class="sub-vector value relative flex grow flex-col bg-green-200 svelte-1hsibq9"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1 bg-green-300 svelte-1hsibq9"></div> <div class="sub-vector head-rest grow svelte-1hsibq9"><span data-svelte-h="svelte-j40kxg">V</span></div> </div></div> <div></div>   </div> <div class="heads svelte-1hsibq9"><div class="multi-head flex w-full svelte-1k8s99h"><div class="first-head-content svelte-1k8s99h"><div class="head-block flex w-full items-center justify-between px-2" style="height:256px;"><div class="qkv flex h-full flex-col justify-center gap-[5rem] pl-[6rem]"><div class="column query"><div class="title svelte-1hsibq9" data-svelte-h="svelte-1a2739d">Query</div> <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9">Data</span> <div class="vector x1-12  bg-blue-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9"> visualization</span> <div class="vector x1-12  bg-blue-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9"> em</span> <div class="vector x1-12  bg-blue-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9">powers</span> <div class="vector x1-12  bg-blue-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9"> users</span> <div class="vector x1-12  bg-blue-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs last"><span class="label float svelte-1hsibq9"> to</span> <div class="vector x1-12  bg-blue-300 svelte-1hsibq9"></div></div> <div></div>   </div> <div class="column key"><div class="title svelte-1hsibq9" data-svelte-h="svelte-bmmhtu">Key</div> <div class="head1 cell x1-12 text-xs class:last=false svelte-1hsibq9"><span class="label float svelte-1hsibq9">Data</span> <div class="vector x1-12 bg-red-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs class:last=false svelte-1hsibq9"><span class="label float svelte-1hsibq9"> visualization</span> <div class="vector x1-12 bg-red-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs class:last=false svelte-1hsibq9"><span class="label float svelte-1hsibq9"> em</span> <div class="vector x1-12 bg-red-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs class:last=false svelte-1hsibq9"><span class="label float svelte-1hsibq9">powers</span> <div class="vector x1-12 bg-red-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs class:last=false svelte-1hsibq9"><span class="label float svelte-1hsibq9"> users</span> <div class="vector x1-12 bg-red-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs class:last=true svelte-1hsibq9"><span class="label float svelte-1hsibq9"> to</span> <div class="vector x1-12 bg-red-300 svelte-1hsibq9"></div></div> <div></div>   </div> <div class="column value"><div class="title svelte-1hsibq9" data-svelte-h="svelte-17pe084">Value</div> <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9">Data</span> <div class="vector x1-12 bg-green-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9"> visualization</span> <div class="vector x1-12 bg-green-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9"> em</span> <div class="vector x1-12 bg-green-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9">powers</span> <div class="vector x1-12 bg-green-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs"><span class="label float svelte-1hsibq9"> users</span> <div class="vector x1-12 bg-green-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 text-xs last"><span class="label float svelte-1hsibq9"> to</span> <div class="vector x1-12 bg-green-300 svelte-1hsibq9"></div></div> <div></div>   </div></div> <div class="resize-watch attention-matrix flex"><div class="flex items-center gap-8 px-5" style="--attention-matrix-width: 0px;"> <div role="none" class="attention-matrix-container relative flex svelte-1v8zpbw"><div class="attention-matrix attention-qk flex flex-col items-center svelte-1v8zpbw"><div data-id="matrix" class="main matrix-container flex flex-col items-center gap-1 leading-none"> <div class="matrix inline-block  align-top"> <div class="relative"><svg class="matrix-svg relative" width="111" height="111"></svg>  </div></div> </div> <div class="matrix-label svelte-1v8zpbw" data-svelte-h="svelte-8hsrtb">Dot product</div> <div></div>    <div class="color-scale svelte-1v8zpbw"><span class="val svelte-1v8zpbw">-25.3</span> <div class="bar svelte-1v8zpbw"></div> <span class="val svelte-1v8zpbw">7.4</span></div></div>  <div class="attention-matrix attention-mask flex flex-col items-center svelte-1v8zpbw"><svg class="arrow svelte-1v8zpbw" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 12H5m14 0-4 4m4-4-4-4"></path></svg> <div><div data-id="matrix" class="prev absolute top-0 left-0 pointer-events-none matrix-container flex flex-col items-center gap-1 leading-none"> <div class="matrix inline-block  align-top"> <div class="relative"><svg class="matrix-svg relative" width="111" height="111"></svg>  </div></div> </div> <div data-id="matrix" class="main opacity-0 matrix-container flex flex-col items-center gap-1 leading-none"> <div class="matrix inline-block  align-top"> <div class="relative"><svg class="matrix-svg relative" width="111" height="111"></svg>  </div></div> </div></div> <div class="matrix-label svelte-1v8zpbw" data-svelte-h="svelte-15vmxu9">Scaling · Mask</div> <div></div>    <div class="color-scale svelte-1v8zpbw" data-svelte-h="svelte-bz6asq"><span class="val svelte-1v8zpbw">-3.0</span> <div class="bar svelte-1v8zpbw"></div> <span class="val svelte-1v8zpbw">3.0</span></div></div>  <div class="attention-matrix attention-softmax flex flex-col items-center svelte-1v8zpbw"><svg class="arrow svelte-1v8zpbw" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 12H5m14 0-4 4m4-4-4-4"></path></svg> <div><div data-id="matrix" class="prev absolute top-0 left-0  pointer-events-none matrix-container flex flex-col items-center gap-1 leading-none"> <div class="matrix inline-block  align-top"> <div class="relative"><svg class="matrix-svg relative" width="111" height="111"></svg>  </div></div> </div> <div data-id="matrix" class="main opacity-0 matrix-container flex flex-col items-center gap-1 leading-none"> <div class="matrix inline-block  align-top"> <div class="relative"><svg class="matrix-svg relative" width="111" height="111"></svg>  </div></div> </div></div> <div class="matrix-label svelte-1v8zpbw" data-svelte-h="svelte-1fyrzav">Softmax · Dropout</div> <div></div>    <div class="color-scale svelte-1v8zpbw" data-svelte-h="svelte-1lh8vbm"><span class="val svelte-1v8zpbw">-1.0</span> <div class="bar svelte-1v8zpbw"></div> <span class="val svelte-1v8zpbw">1.0</span></div></div> <div class="attention-matrix attention-result flex flex-col items-center attention-initial attention-out svelte-1v8zpbw"><div data-id="matrix" class="main matrix-container flex flex-col items-center gap-1 leading-none"> <div class="matrix inline-block  align-top"> <div class="relative"><svg class="matrix-svg relative" width="111" height="111"></svg>  </div></div> </div> <div class="matrix-label svelte-1v8zpbw" data-svelte-h="svelte-10aghm9">Attention</div></div></div> </div></div> <div class="head-out mx-[2rem]"><div class="column out"><div class="title svelte-1hsibq9" data-svelte-h="svelte-68unf9">Out</div> <div class="head1 cell x1-12"><div class="vector x1-12 bg-purple-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12"><div class="vector x1-12 bg-purple-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12"><div class="vector x1-12 bg-purple-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12"><div class="vector x1-12 bg-purple-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12"><div class="vector x1-12 bg-purple-300 svelte-1hsibq9"></div></div> <div></div>   <div class="head1 cell x1-12 last"><div class="vector x1-12 bg-purple-300 svelte-1hsibq9"></div></div> <div></div>   </div></div> <div class="head-title absolute bottom-2 right-3 text-right text-gray-400">Head 1 of 12</div></div> </div><div class="rest absolute first" style="transform:translate(5px,8px) scale(1); 
      z-index: 11;opacity:0.9;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(10px,16px) scale(1); 
      z-index: 10;opacity:0.8;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(15px,24px) scale(1); 
      z-index: 9;opacity:0.7;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(20px,32px) scale(1); 
      z-index: 8;opacity:0.6;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(25px,40px) scale(1); 
      z-index: 7;opacity:0.5;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(30px,48px) scale(1); 
      z-index: 6;opacity:0.3999999999999999;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(35px,56px) scale(1); 
      z-index: 5;opacity:0.29999999999999993;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(40px,64px) scale(1); 
      z-index: 4;opacity:0.19999999999999996;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(45px,72px) scale(1); 
      z-index: 3;opacity:0.1;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(50px,80px) scale(1); 
      z-index: 2;opacity:0.1;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(55px,88px) scale(1); 
      z-index: 1;opacity:0.1;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div><div class="rest absolute" style="transform:translate(60px,96px) scale(1); 
      z-index: 0;opacity:0.1;"><div class="card svelte-1k8s99h" style="width: 0px; height: 0px;"></div> </div> </div></div></div> </div> <div class="mlp step svelte-13p50c2"><div class="title" role="group" data-svelte-h="svelte-50ab67">MLP</div> <div class="content relative svelte-13p50c2"><div class="bounding transformer-bounding svelte-13p50c2"></div> <div class="bounding mlp-bounding svelte-13p50c2"></div> <div class="layer first-layer flex svelte-13p50c2"><div class="column initial"><div class="cell" role="group"><span class="label float svelte-13p50c2">Data</span> <div class="vector flex flex-col  bg-purple-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1"></div> <div class="sub-vector head-rest grow"></div> </div></div> <div></div>   <div class="cell" role="group"><span class="label float svelte-13p50c2"> visualization</span> <div class="vector flex flex-col  bg-purple-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1"></div> <div class="sub-vector head-rest grow"></div> </div></div> <div></div>   <div class="cell" role="group"><span class="label float svelte-13p50c2"> em</span> <div class="vector flex flex-col  bg-purple-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1"></div> <div class="sub-vector head-rest grow"></div> </div></div> <div></div>   <div class="cell" role="group"><span class="label float svelte-13p50c2">powers</span> <div class="vector flex flex-col  bg-purple-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1"></div> <div class="sub-vector head-rest grow"></div> </div></div> <div></div>   <div class="cell" role="group"><span class="label float svelte-13p50c2"> users</span> <div class="vector flex flex-col  bg-purple-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1"></div> <div class="sub-vector head-rest grow"></div> </div></div> <div></div>   <div class="cell last" role="group"><span class="label float svelte-13p50c2"> to</span> <div class="vector flex flex-col  bg-purple-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> <div class="sub-vector x1-12 head1"></div> <div class="sub-vector head-rest grow"></div> </div></div> <div></div>   </div> <div id="mlp-first-dropout" class="operation-col column dropout svelte-cfq6hx" role="group"><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> </div><div class="cell dropout last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line svelte-1jqlo12" d="M0,0 L0,12"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg> <svg class="guide svelte-1jqlo12" width="44px"><path d="M44.3186 4.46399C44.5314 4.28801 44.5613 3.97284 44.3853 3.76004L41.5175 0.292199C41.3416 0.0793953 41.0264 0.0495441 40.8136 0.225525C40.6008 0.401505 40.5709 0.716677 40.7469 0.929481L43.296 4.012L40.2135 6.56113C40.0007 6.73711 39.9709 7.05228 40.1468 7.26509C40.3228 7.47789 40.638 7.50774 40.8508 7.33176L44.3186 4.46399ZM44.0471 3.58091C38.7621 3.08034 27.8926 4.80481 18.3357 11.5838C8.74613 18.386 0.5 30.2626 0.5 50H1.5C1.5 30.5889 9.58721 19.0154 18.9143 12.3994C28.2741 5.76023 38.9045 4.0983 43.9529 4.57645L44.0471 3.58091Z" class="svelte-1jqlo12"></path><text x="4" y="60" text-anchor="middle" class="svelte-1jqlo12">Dropout</text></svg></div> <div></div>   </div> <div id="residual-first-end" class="operation-col column residual svelte-cfq6hx" role="group"><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path id="residual-first" class="head svelte-1jqlo12" d="M0,0 Q0,-16 -30,-16"></path> <path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div></div> <div id="mlp-first-ln" class="operation-col column ln svelte-cfq6hx" role="group"><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> <svg class="guide svelte-1jqlo12" width="27px"><path d="M27.3536 4.35355C27.5488 4.15829 27.5488 3.84171 27.3536 3.64645L24.1716 0.46447C23.9763 0.269208 23.6597 0.269208 23.4645 0.464471C23.2692 0.659733 23.2692 0.976316 23.4645 1.17158L26.2929 4L23.4645 6.82843C23.2692 7.02369 23.2692 7.34028 23.4645 7.53554C23.6597 7.7308 23.9763 7.7308 24.1716 7.53554L27.3536 4.35355ZM27 3.5C20.3125 3.50001 15.2969 6.63952 11.5638 11.7944C7.84616 16.9278 5.39057 24.0677 3.75991 32.1346C0.498061 48.2711 0.5 68.3247 0.5 84H1.5C1.5 68.2984 1.50194 48.352 4.74009 32.3328C6.35943 24.3218 8.77884 17.3448 12.3737 12.3809C15.9531 7.4384 20.6875 4.50001 27 4.5V3.5Z" class="svelte-1jqlo12"></path><text x="4" y="95" text-anchor="middle" class="svelte-1jqlo12">Layer Normalization</text></svg></div> <div></div>   </div> <div id="residual-second-start" class="operation-col column residual svelte-cfq6hx" role="group"><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path id="residual-second" class="head svelte-1jqlo12" d="M0,0 Q0,-16 30,-16"></path> <text x="30" y="-26" dy="4" dx="4" class="svelte-1jqlo12">Residual</text><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-start cell last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div> <div></div>   </div></div> <div class="layer second-layer flex justify-between svelte-13p50c2"><div class="projections flex"><div class="column"><div class="cell x4 svelte-13p50c2"><div class="vector x4 bg-indigo-200 opacity-80 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell x4 small svelte-13p50c2"><div class="vector x4 bg-indigo-200 opacity-80 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell x4 small svelte-13p50c2"><div class="vector x4 bg-indigo-200 opacity-80 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell x4 small svelte-13p50c2"><div class="vector x4 bg-indigo-200 opacity-80 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell x4 small svelte-13p50c2"><div class="vector x4 bg-indigo-200 opacity-80 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell x4 svelte-13p50c2 last"><div class="vector x4 bg-indigo-200 opacity-80 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   </div> <div id="mlp-activation" class="operation-col column activation x4 svelte-cfq6hx" role="group"><div class="cell activation x4 svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line line1 svelte-1jqlo12" d="M0,0 L0,90%"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg></div><div class="cell activation x4 svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line line1 svelte-1jqlo12" d="M0,0 L0,90%"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg></div><div class="cell activation x4 svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line line1 svelte-1jqlo12" d="M0,0 L0,90%"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg></div><div class="cell activation x4 svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line line1 svelte-1jqlo12" d="M0,0 L0,90%"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg></div><div class="cell activation x4 svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line line1 svelte-1jqlo12" d="M0,0 L0,90%"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg></div><div class="cell activation x4 last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path class="line line1 svelte-1jqlo12" d="M0,0 L0,90%"></path><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle></svg></div> <div></div>   </div></div> <div class="ouputs flex"><div class="column out-label"><div class="cell"><span class="label float svelte-13p50c2">Data</span> </div><div class="cell"><span class="label float svelte-13p50c2"> visualization</span> </div><div class="cell"><span class="label float svelte-13p50c2"> em</span> </div><div class="cell"><span class="label float svelte-13p50c2">powers</span> </div><div class="cell"><span class="label float svelte-13p50c2"> users</span> </div><div class="cell last"><span class="label float svelte-13p50c2"> to</span> </div></div> <div id="residual-second-end" class="operation-col column residual svelte-cfq6hx" role="group"><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path id="residual-second" class="head svelte-1jqlo12" d="M0,0 Q0,-16 -30,-16"></path> <path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div><div class="residual residual-end cell last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><path d="M0,0 L0,12" class="svelte-1jqlo12"></path></svg></div></div> <div id="mlp-second-ln" class="operation-col column ln svelte-cfq6hx" role="group"><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> </div><div class="cell ln last svelte-1jqlo12"><div class="cursor svelte-1jqlo12"></div> <svg class="main svelte-1jqlo12"><circle class="icon svelte-1jqlo12" cx="50%" cy="50%" r="3"></circle><path class="line svelte-1jqlo12" d="
     M 0 0
    C 0 3, 2.4000000000000004 3, 2.4000000000000004 6
    C 2.4000000000000004 9, 0 9, 0 12
  "></path></svg> <svg class="guide svelte-1jqlo12" width="27px"><path d="M27.3536 4.35355C27.5488 4.15829 27.5488 3.84171 27.3536 3.64645L24.1716 0.46447C23.9763 0.269208 23.6597 0.269208 23.4645 0.464471C23.2692 0.659733 23.2692 0.976316 23.4645 1.17158L26.2929 4L23.4645 6.82843C23.2692 7.02369 23.2692 7.34028 23.4645 7.53554C23.6597 7.7308 23.9763 7.7308 24.1716 7.53554L27.3536 4.35355ZM27 3.5C20.3125 3.50001 15.2969 6.63952 11.5638 11.7944C7.84616 16.9278 5.39057 24.0677 3.75991 32.1346C0.498061 48.2711 0.5 68.3247 0.5 84H1.5C1.5 68.2984 1.50194 48.352 4.74009 32.3328C6.35943 24.3218 8.77884 17.3448 12.3737 12.3809C15.9531 7.4384 20.6875 4.50001 27 4.5V3.5Z" class="svelte-1jqlo12"></path><text x="4" y="95" text-anchor="middle" class="svelte-1jqlo12">Layer Normalization</text></svg></div> <div></div>   </div> <div class="column out"><div class="cell"><div class="vector bg-blue-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell"><div class="vector bg-blue-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell"><div class="vector bg-blue-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell"><div class="vector bg-blue-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell"><div class="vector bg-blue-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   <div class="cell last"><div class="vector bg-blue-200 svelte-13p50c2"><canvas class="svelte-ex5m8"></canvas> </div></div> <div></div>   </div></div></div></div> </div> <div class="transformer-blocks step svelte-1jtwro5" role="group"><div class="title"></div> <div class="content svelte-1jtwro5"><div class="column final relative svelte-1jtwro5"><div class="guide flex flex-col items-start gap-1 svelte-1jtwro5"> <div class="text svelte-1jtwro5">11 more identical<br><span class="highlight svelte-1jtwro5" data-svelte-h="svelte-m89yhc">Transformer<br>Blocks</span>.</div> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-300" viewBox="0 0 3 5" fill="none"><path d="M1.18221 4.58047C1.23103 4.62928 1.31017 4.62928 1.35899 4.58047L2.15448 3.78497C2.2033 3.73616 2.2033 3.65701 2.15448 3.6082C2.10567 3.55938 2.02652 3.55938 1.97771 3.6082L1.2706 4.3153L0.563493 3.6082C0.514677 3.55938 0.435531 3.55938 0.386716 3.6082C0.3379 3.65701 0.3379 3.73616 0.386716 3.78497L1.18221 4.58047ZM1.1456 0.285461V4.49208H1.3956V0.285461H1.1456Z" fill="currentColor"></path></svg></div> <div class="cell svelte-1jtwro5"><div class="vector shrink-0 bg-blue-200 svelte-1jtwro5"><canvas class="svelte-ex5m8"></canvas></div> <div></div>     </div><div class="cell svelte-1jtwro5"><div class="vector shrink-0 bg-blue-200 svelte-1jtwro5"><canvas class="svelte-ex5m8"></canvas></div> <div></div>     </div><div class="cell svelte-1jtwro5"><div class="vector shrink-0 bg-blue-200 svelte-1jtwro5"><canvas class="svelte-ex5m8"></canvas></div> <div></div>     </div><div class="cell svelte-1jtwro5"><div class="vector shrink-0 bg-blue-200 svelte-1jtwro5"><canvas class="svelte-ex5m8"></canvas></div> <div></div>     </div><div class="cell svelte-1jtwro5"><div class="vector shrink-0 bg-blue-200 svelte-1jtwro5"><canvas class="svelte-ex5m8"></canvas></div> <div></div>     </div><div class="cell svelte-1jtwro5 last"><div class="vector shrink-0 bg-blue-200 last-token svelte-1jtwro5"><canvas class="svelte-ex5m8"></canvas></div> <div></div>     </div></div> <div class="second-column svelte-1jtwro5"><div class="prob-dim svelte-1jtwro5"></div></div></div> </div> <div class="softmax step svelte-1dtizln" role="none"><div class="title expandable svelte-1dtizln" role="none" data-svelte-h="svelte-1d64i2n"><div>Probabilities</div></div> <div class="content resize-watch relative svelte-1dtizln" style="--softmax-row-height: 22.4px;--softmax-row-gap: 8px"><div class="bounding softmax-bounding svelte-1dtizln"></div> <div class="first-column relative flex justify-end"><div class="content-box token-string svelte-1dtizln"><div role="group" class="text-box svelte-1dtizln"><span> visualize</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln   final_token_highlight"><span> create</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> see</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> make</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> easily</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> quickly</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> explore</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> find</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> understand</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> build</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> better</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> identify</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> take</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> visually</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> analyze</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> discover</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> design</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> visual</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> get</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> view</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> compare</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> use</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> generate</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> access</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> navigate</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> think</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> share</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> determine</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> draw</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> look</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> track</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> choose</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span>:</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> monitor</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> capture</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> interact</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> plan</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> map</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> connect</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> learn</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> focus</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> do</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> predict</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> perform</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> chart</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> manage</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> work</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> organize</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> search</span> <div></div>    </div><div role="group" class="text-box svelte-1dtizln"><span> control</span> <div></div>    </div></div> <div class="vector vocab opacity-1 w-0"></div></div> <div class="second-column flex flex-col svelte-1dtizln"> <div class="content-row flex gap-2"><div class="softmax-detail expandable flex gap-2 opacity-0"></div> <div class="content-box probability grow svelte-8s3yoj"><svg class="h-full w-full"><g class="bars"></g><g class="bar-labels"></g></svg> </div></div></div></div> </div></div>  </div> </div></main></div> <div class="article h-auto w-full"><div id="description" class="svelte-1doaq90" data-svelte-h="svelte-pftdet"><div class="article-section svelte-1doaq90"><h1 class="svelte-1doaq90">What is a Transformer?</h1> <p class="svelte-1doaq90">Transformer is a neural network architecture that has fundamentally changed the approach to
			Artificial Intelligence. Transformer was first introduced in the seminal paper
			<a href="https://dl.acm.org/doi/10.5555/3295222.3295349" title="ACM Digital Library" target="_blank" class="svelte-1doaq90">&quot;Attention is All You Need&quot;</a>
			in 2017 and has since become the go-to architecture for deep learning models, powering text-generative
			models like OpenAI&#39;s <strong>GPT</strong>, Meta&#39;s <strong>Llama</strong>, and Google&#39;s
			<strong>Gemini</strong>. Beyond text, Transformer is also applied in
			<a href="https://huggingface.co/learn/audio-course/en/chapter3/introduction" title="Hugging Face" target="_blank" class="svelte-1doaq90">audio generation</a>,
			<a href="https://huggingface.co/learn/computer-vision-course/unit3/vision-transformers/vision-transformers-for-image-classification" title="Hugging Face" target="_blank" class="svelte-1doaq90">image recognition</a>,
			<a href="https://elifesciences.org/articles/82819" title="eLife" class="svelte-1doaq90">protein structure prediction</a>, and even
			<a href="https://www.deeplearning.ai/the-batch/reinforcement-learning-plus-transformers-equals-efficiency/" title="Deep Learning AI" target="_blank" class="svelte-1doaq90">game playing</a>, demonstrating its versatility across numerous domains.</p> <p class="svelte-1doaq90">Fundamentally, text-generative Transformer models operate on the principle of <strong>next-word prediction</strong>: given a text prompt from the user, what is the <em>most probable next word</em> that will follow
			this input? The core innovation and power of Transformers lie in their use of self-attention mechanism,
			which allows them to process entire sequences and capture long-range dependencies more effectively
			than previous architectures.</p> <p class="svelte-1doaq90">GPT-2 family of models are prominent examples of text-generative Transformers. Transformer
			Explainer is powered by the
			<a href="https://huggingface.co/openai-community/gpt2" title="Hugging Face" target="_blank" class="svelte-1doaq90">GPT-2</a>
			(small) model which has 124 million parameters. While it is not the latest or most powerful Transformer
			model, it shares many of the same architectural components and principles found in the current
			state-of-the-art models making it an ideal starting point for understanding the basics.</p></div> <div class="article-section svelte-1doaq90"><h1 class="svelte-1doaq90">Transformer Architecture</h1> <p class="svelte-1doaq90">Every text-generative Transformer consists of these three <strong>key components</strong>:</p> <ol class="svelte-1doaq90"><li class="svelte-1doaq90"><strong class="bold-purple svelte-1doaq90">Embedding</strong>: Text input is divided into smaller units
				called tokens, which can be words or subwords. These tokens are converted into numerical
				vectors called embeddings, which capture the semantic meaning of words.</li> <li class="svelte-1doaq90"><strong class="bold-purple svelte-1doaq90">Transformer Block</strong> is the fundamental building block of
				the model that processes and transforms the input data. Each block includes:
				<ul class=" svelte-1doaq90"><li class="svelte-1doaq90"><strong>Attention Mechanism</strong>, the core component of the Transformer block. It
						allows tokens to communicate with other tokens, capturing contextual information and
						relationships between words.</li> <li class="svelte-1doaq90"><strong>MLP (Multilayer Perceptron) Layer</strong>, a feed-forward network that operates
						on each token independently. While the goal of the attention layer is to route
						information between tokens, the goal of the MLP is to refine each token&#39;s
						representation.</li></ul></li> <li class="svelte-1doaq90"><strong class="bold-purple svelte-1doaq90">Output Probabilities</strong>: The final linear and softmax
				layers transform the processed embeddings into probabilities, enabling the model to make
				predictions about the next token in a sequence.</li></ol> <div class="architecture-section svelte-1doaq90"><h2 class="svelte-1doaq90">Embedding</h2> <p class="svelte-1doaq90">Let&#39;s say you want to generate text using a Transformer model. You add the prompt like this
				one: <code class="svelte-1doaq90">“Data visualization empowers users to”</code>. This input needs to be converted
				into a format that the model can understand and process. That is where embedding comes in:
				it transforms the text into a numerical representation that the model can work with. To
				convert a prompt into embedding, we need to 1) tokenize the input, 2) obtain token
				embeddings, 3) add positional information, and finally 4) add up token and position
				encodings to get the final embedding. Let’s see how each of these steps is done.</p> <div class="figure svelte-1doaq90"><img src="./article_assets/embedding.png" width="60%" height="60%" align="middle" class="svelte-1doaq90"></div> <div class="figure-caption svelte-1doaq90">Figure <span class="attention">1</span>. Expanding the Embedding layer view, showing how the
				input prompt is converted to a vector representation. The process involves
				<span class="fig-numbering">(1)</span> Tokenization, (2) Token Embedding, (3) Positional Encoding,
				and (4) Final Embedding.</div> <div class="article-subsection svelte-1doaq90"><h3 class="svelte-1doaq90">Step 1: Tokenization</h3> <p class="svelte-1doaq90">Tokenization is the process of breaking down the input text into smaller, more manageable
					pieces called tokens. These tokens can be a word or a subword. The words <code class="svelte-1doaq90">&quot;Data&quot;</code>
					and <code class="svelte-1doaq90">&quot;vizualization&quot;</code> corresponds to unique tokens, while the word
					<code class="svelte-1doaq90">&quot;empowers&quot;</code>
					is split into two tokens. The full vocabulary of tokens is decided before training the model:
					GPT-2&#39;s vocabulary has <code class="svelte-1doaq90">50,257</code> unique tokens. Now that we split our input text
					into tokens with distinct IDs, we can obtain their vector representation from embeddings.</p></div> <div class="article-subsection svelte-1doaq90"><h3 class="svelte-1doaq90">Step 2. Token Embedding</h3> <p class="svelte-1doaq90">GPT-2 Small represents each token in the vocabulary as a 768-dimensional vector; the
					dimension of the vector depends on the model. These embedding vectors are stored in a
					matrix of shape <code class="svelte-1doaq90">(50, 257, 768)</code>, containing approximately 39 million
					parameters! This extensive matrix allows the model to assign semantic meaning to each
					token.</p></div> <div class="article-subsection svelte-1doaq90"><h3 class="svelte-1doaq90">Step 3. Positional Encoding</h3> <p class="svelte-1doaq90">The Embedding layer also encodes information about each token&#39;s position in the input
					prompt. Different models use various methods for positional encoding. GPT-2 trains its own
					positional encoding matrix from scratch, integrating it directly into the training
					process.</p> </div> <div class="article-subsection svelte-1doaq90"><h3 class="svelte-1doaq90">Step 4. Final Embedding</h3> <p class="svelte-1doaq90">Finally, we sum the token and positional encodings to get the final embedding
					representation. This combined representation captures both the semantic meaning of the
					tokens and their position in the input sequence.</p></div></div> <div class="architecture-section svelte-1doaq90"><h2 class="svelte-1doaq90">Transformer Block</h2> <p class="svelte-1doaq90">The core of the Transformer&#39;s processing lies in the Transformer block, which comprises
				multi-head self-attention and a Multi-Layer Perceptron layer. Most models consist of
				multiple such blocks that are stacked sequentially one after the other. The token
				representations evolve through layers, from the first block to the 12th one, allowing the
				model to build up an intricate understanding of each token. This layered approach leads to
				higher-order representations of the input.</p> <div class="article-subsection svelte-1doaq90"><h3 class="svelte-1doaq90">Multi-Head Self-Attention</h3> <p class="svelte-1doaq90">The self-attention mechanism enables the model to focus on relevant parts of the input
					sequence, allowing it to capture complex relationships and dependencies within the data.
					Let’s look at how this self-attention is computed step-by-step.</p> <div class="article-subsection-l2 svelte-1doaq90"><h4 class="svelte-1doaq90">Step 1: Query, Key, and Value Matrices</h4> <div class="figure svelte-1doaq90"><img src="./article_assets/QKV.png" width="80%" align="middle" class="svelte-1doaq90"></div> <div class="figure-caption svelte-1doaq90">Figure <span class="attention">2</span>. Computing Query, Key, and Value matrices from
						the original embedding.</div> <p class="svelte-1doaq90">Each token&#39;s embedding vector is transformed into three vectors:
						<span class="q-color svelte-1doaq90">Query (Q)</span>,
						<span class="k-color svelte-1doaq90">Key (K)</span>, and
						<span class="v-color svelte-1doaq90">Value (V)</span>. These vectors are derived by multiplying the
						input embedding matrix with learned weight matrices for
						<span class="q-color svelte-1doaq90">Q</span>,
						<span class="k-color svelte-1doaq90">K</span>, and
						<span class="v-color svelte-1doaq90">V</span>. Here&#39;s a web search analogy to help us build some
						intuition behind these matrices:</p> <ul class="svelte-1doaq90"><li class="svelte-1doaq90"><strong class="q-color font-medium svelte-1doaq90">Query (Q)</strong> is the search text you type in
							the search engine bar. This is the token you want to
							<em>&quot;find more information about&quot;</em>.</li> <li class="svelte-1doaq90"><strong class="k-color font-medium svelte-1doaq90">Key (K)</strong> is the title of each web page in the
							search result window. It represents the possible tokens the query can attend to.</li> <li class="svelte-1doaq90"><strong class="v-color font-medium svelte-1doaq90">Value (V)</strong> is the actual content of web pages
							shown. Once we matched the appropriate search term (Query) with the relevant results (Key),
							we want to get the content (Value) of the most relevant pages.</li></ul> <p class="svelte-1doaq90">By using these QKV values, the model can calculate attention scores, which determine how
						much focus each token should receive when generating predictions.</p></div> <div class="article-subsection-l2 svelte-1doaq90"><h4 class="svelte-1doaq90">Step 2: Masked Self-Attention</h4> <p class="svelte-1doaq90">Masked self-attention allows the model to generate sequences by focusing on relevant
						parts of the input while preventing access to future tokens.</p> <div class="figure svelte-1doaq90"><img src="./article_assets/attention.png" width="80%" align="middle" class="svelte-1doaq90"></div> <div class="figure-caption svelte-1doaq90">Figure <span class="attention">3</span>. Using Query, Key, and Value matrices to
						calculate masked self-attention.</div> <ul class="svelte-1doaq90"><li class="svelte-1doaq90"><strong>Attention Score</strong>: The dot product of
							<span class="q-color svelte-1doaq90">Query</span>
							and <span class="k-color svelte-1doaq90">Key</span> matrices determines the alignment of each query with
							each key, producing a square matrix that reflects the relationship between all input tokens.</li> <li class="svelte-1doaq90"><strong>Masking</strong>: A mask is applied to the upper triangle of the attention
							matrix to prevent the model from accessing future tokens, setting these values to
							negative infinity. The model needs to learn how to predict the next token without
							“peeking” into the future.</li> <li class="svelte-1doaq90"><strong>Softmax</strong>: After masking, the attention score is converted into
							probability by the softmax operation which takes the exponent of each attention score.
							Each row of the matrix sums up to one and indicates the relevance of every other token
							to the left of it.</li></ul></div> <div class="article-subsection-l2 svelte-1doaq90"><h4 class="svelte-1doaq90">Step 3: Output</h4> <p class="svelte-1doaq90">The model uses the masked self-attention scores and multiplies them with the
						<span class="v-color svelte-1doaq90">Value</span> matrix to get the
						<span class="purple-color svelte-1doaq90">final output</span>
						of the self-attention mechanism. GPT-2 has <code class="svelte-1doaq90">12</code> self-attention heads, each capturing
						different relationships between tokens. The outputs of these heads are concatenated and passed
						through a linear projection.</p></div> <div class="article-subsection svelte-1doaq90"><h3 class="svelte-1doaq90">MLP: Multi-Layer Perceptron</h3> <div class="figure svelte-1doaq90"><img src="./article_assets/mlp.png" width="70%" align="middle" class="svelte-1doaq90"></div> <div class="figure-caption svelte-1doaq90">Figure <span class="attention">4</span>. Using MLP layer to project the self-attention
						representations into higher dimensions to enhance the model&#39;s representational capacity.</div> <p class="svelte-1doaq90">After the multiple heads of self-attention capture the diverse relationships between the
						input tokens, the concatenated outputs are passed through the Multilayer Perceptron
						(MLP) layer to enhance the model&#39;s representational capacity. The MLP block consists of
						two linear transformations with a GELU activation function in between. The first linear
						transformation increases the dimensionality of the input four-fold from <code class="svelte-1doaq90">768</code>
						to <code class="svelte-1doaq90">3072</code>. The second linear transformation reduces the dimensionality back
						to the original size of <code class="svelte-1doaq90">768</code>, ensuring that the subsequent layers receive
						inputs of consistent dimensions. Unlike the self-attention mechanism, the MLP processes
						tokens independently and simply map them from one representation to another.</p></div> <div class="architecture-section svelte-1doaq90"><h2 class="svelte-1doaq90">Output Probabilities</h2> <p class="svelte-1doaq90">After the input has been processed through all Transformer blocks, the output is passed
						through the final linear layer to prepare it for token prediction. This layer projects
						the final representations into a <code class="svelte-1doaq90">50,257</code>
						dimensional space, where every token in the vocabulary has a corresponding value called
						<code class="svelte-1doaq90">logit</code>. Any token can be the next word, so this process allows us to simply
						rank these tokens by their likelihood of being that next word. We then apply the softmax
						function to convert the logits into a probability distribution that sums to one. This
						will allow us to sample the next token based on its likelihood.</p> <div class="figure svelte-1doaq90"><img src="./article_assets/softmax.png" width="60%" align="middle" class="svelte-1doaq90"></div> <div class="figure-caption svelte-1doaq90">Figure <span class="attention">5</span>. Each token in the vocabulary is assigned a
						probability based on the model&#39;s output logits. These probabilities determine the
						likelihood of each token being the next word in the sequence.</div> <p class="svelte-1doaq90">The final step is to generate the next token by sampling from this distribution The <code class="svelte-1doaq90">temperature</code>
						hyperparameter plays a critical role in this process. Mathematically speaking, it is a very
						simple operation: model output logits are simply divided by the
						<code class="svelte-1doaq90">temperature</code>:</p> <ul class="svelte-1doaq90"><li class="svelte-1doaq90"><code class="svelte-1doaq90">temperature = 1</code>: Dividing logits by one has no effect on the softmax
							outputs.</li> <li class="svelte-1doaq90"><code class="svelte-1doaq90">temperature &lt; 1</code>: Lower temperature makes the model more confident and
							deterministic by sharpening the probability distribution, leading to more predictable
							outputs.</li> <li class="svelte-1doaq90"><code class="svelte-1doaq90">temperature &gt; 1</code>: Higher temperature creates a softer probability
							distribution, allowing for more randomness in the generated text – what some refer to
							as model <em>“creativity”</em>.</li></ul> <p class="svelte-1doaq90">Adjust the temperature and see how you can balance between deterministic and diverse
						outputs!</p></div> <div class="architecture-section svelte-1doaq90"><h2 class="svelte-1doaq90">Advanced Architectural Features</h2> <p class="svelte-1doaq90">There are several advanced architectural features that enhance the performance of
						Transformer models. While important for the model&#39;s overall performance, they are not as
						important for understanding the core concepts of the architecture. Layer Normalization,
						Dropout, and Residual Connections are crucial components in Transformer models,
						particularly during the training phase. Layer Normalization stabilizes training and
						helps the model converge faster. Dropout prevents overfitting by randomly deactivating
						neurons. Residual Connections allows gradients to flow directly through the network and
						helps to prevent the vanishing gradient problem.</p> <div class="article-subsection svelte-1doaq90"><h3 class="svelte-1doaq90">Layer Normalization</h3> <p class="svelte-1doaq90">Layer Normalization helps to stabilize the training process and improves convergence.
							It works by normalizing the inputs across the features, ensuring that the mean and
							variance of the activations are consistent. This normalization helps mitigate issues
							related to internal covariate shift, allowing the model to learn more effectively and
							reducing the sensitivity to the initial weights. Layer Normalization is applied twice in each
							Transformer block, once before the self-attention mechanism and once before the MLP
							layer.</p></div> <div class="article-subsection svelte-1doaq90"><h3 class="svelte-1doaq90">Dropout</h3> <p class="svelte-1doaq90">Dropout is a regularization technique used to prevent overfitting in neural networks
							by randomly setting a fraction of model weights to zero during training. This
							encourages the model to learn more robust features and reduces dependency on specific
							neurons, helping the network generalize better to new, unseen data. During model
							inference, dropout is deactivated. This essentially means that we are using an
							ensemble of the trained subnetworks, which leads to a better model performance.</p></div> <div class="article-subsection svelte-1doaq90"><h3 class="svelte-1doaq90">Residual Connections</h3> <p class="svelte-1doaq90">Residual connections were first introduced in the ResNet model in 2015. This
							architectural innovation revolutionized deep learning by enabling the training of very
							deep neural networks. Essentially, residual connections are shortcuts that bypass one
							or more layers, adding the input of a layer to its output. This helps mitigate the
							vanishing gradient problem, making it easier to train deep networks with multiple
							Transformer blocks stacked on top of each other. In GPT-2, residual connections are
							used twice within each Transformer block: once before the MLP and once after, ensuring
							that gradients flow more easily, and earlier layers receive sufficient updates during
							backpropagation.</p></div></div> <div class="article-section svelte-1doaq90"><h1 class="svelte-1doaq90">Interactive Features</h1> <p class="svelte-1doaq90">Transformer Explainer is built to be interactive and allows you to explore the inner
						workings of the Transformer. Here are some of the interactive features you can play
						with:</p> <ul class="svelte-1doaq90"><li class="svelte-1doaq90"><strong>Input your own text sequence</strong> to see how the model processes it and predicts
							the next word. Explore attention weights, intermediate computations, and see how the final
							output probabilities are calculated.</li> <li class="svelte-1doaq90"><strong>Use the temperature slider</strong> to control the randomness of the model’s predictions.
							Explore how you can make the model output more deterministic or more creative by changing
							the temperature value.</li> <li class="svelte-1doaq90"><strong>Interact with attention maps</strong> to see how the model focuses on different
							tokens in the input sequence. Hover over tokens to highlight their attention weights and
							explore how the model captures context and relationships between words.</li></ul></div> <div class="article-section svelte-1doaq90"><h2 class="svelte-1doaq90">Video Tutorial</h2> <div class="video-container svelte-1doaq90"><iframe src="https://www.youtube.com/embed/ECR4oAwocjs" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="svelte-1doaq90"></iframe></div></div> <div class="article-section svelte-1doaq90"><h2 class="svelte-1doaq90">How is Transformer Explainer Implemented?</h2> <p class="svelte-1doaq90">Transformer Explainer features a live GPT-2 (small) model running directly in the
						browser. This model is derived from the PyTorch implementation of GPT by Andrej
						Karpathy&#39;s
						<a href="https://github.com/karpathy/nanoGPT" title="Github" target="_blank" class="svelte-1doaq90">nanoGPT project</a>
						and has been converted to
						<a href="https://onnxruntime.ai/" title="ONNX" target="_blank" class="svelte-1doaq90">ONNX Runtime</a>
						for seamless in-browser execution. The interface is built using JavaScript, with
						<a href="https://kit.svelte.dev/" title="Svelte" target="_blank" class="svelte-1doaq90">Svelte</a>
						as a front-end framework and
						<a href="http://D3.js" title="D3" target="_blank" class="svelte-1doaq90">D3.js</a>
						for creating dynamic visualizations. Numerical values are updated live following the user
						input.</p></div> <div class="article-section svelte-1doaq90"><h2 class="svelte-1doaq90">Who developed the Transformer Explainer?</h2> <p class="svelte-1doaq90">Transformer Explainer was created by

						<a href="https://aereeeee.github.io/" target="_blank" class="svelte-1doaq90">Aeree Cho</a>,
						<a href="https://www.linkedin.com/in/chaeyeonggracekim/" target="_blank" class="svelte-1doaq90">Grace C. Kim</a>,
						<a href="https://alexkarpekov.com/" target="_blank" class="svelte-1doaq90">Alexander Karpekov</a>,
						<a href="https://alechelbling.com/" target="_blank" class="svelte-1doaq90">Alec Helbling</a>,
						<a href="https://zijie.wang/" target="_blank" class="svelte-1doaq90">Jay Wang</a>,
						<a href="https://seongmin.xyz/" target="_blank" class="svelte-1doaq90">Seongmin Lee</a>,
						<a href="https://bhoov.com/" target="_blank" class="svelte-1doaq90">Benjamin Hoover</a>, and
						<a href="https://poloclub.github.io/polochau/" target="_blank" class="svelte-1doaq90">Polo Chau</a>

						at the Georgia Institute of Technology.</p></div></div></div></div> </div></div>  </div> 
			
			<script>
				{
					__sveltekit_m5roj4 = {
						base: new URL(".", location).pathname.slice(0, -1),
						assets: "/transformer-explainer"
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("./_app/immutable/entry/start.D2Y0oza0.js"),
						import("./_app/immutable/entry/app.rf2C4sZP.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
